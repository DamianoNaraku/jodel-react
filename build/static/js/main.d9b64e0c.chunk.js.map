{"version":3,"sources":["common/libraries/prj_json2xml.js","common/libraries/prj_xml2json.js","graph/graphElement/sharedTypes/sharedTypes.tsx","joiner/classes.ts","joiner/proxy.ts","common/DV.tsx","common/Geom.ts","common/Uhtml.ts","common/UX.tsx","model/classes/D.ts","model/classes/L.ts","model/dataStructure/GraphDataElements.tsx","view/viewPoint/viewpoint.ts","redux/store.tsx","redux/reducer/reducer.ts","redux/createStore.ts","debugtools/debug.tsx","ocl/ocl.tsx","joiner/ExecuteOnRead.ts","joiner/index.ts","components/rightbar/oclEditor/OclEditor.tsx","../node_modules/jstransform/node_modules/source-map/lib/source-map sync","redux/selectors/selectors.ts","api/data.ts","model/logicWrapper/LModelElement.tsx","redux/action/action.ts","joiner/types.ts","components/forEndUser/OCLEditor.tsx","components/forEndUser/Input.tsx","components/forEndUser/TextArea.tsx","components/forEndUser/Select.tsx","components/forEndUser/Image.tsx","components/forEndUser/Edge.tsx","components/logger/DataOutput.tsx","components/logger/loggerComponent.tsx","components/forEndUser/Overlap.tsx","components/colorScheme/colorScheme.tsx","graph/defaultNode/DefaultNode.tsx","graph/graph/graphContainer.tsx","graph/edge/Edge.tsx","graph/edge/Edges.tsx","graph/damedges/damedge.tsx","joiner/components.tsx","common/U.ts","components/rightbar/structureEditor/editors/MqttEditor.tsx","components/rightbar/structureEditor/editors/Value.tsx","components/rightbar/structureEditor/Structure.tsx","components/rightbar/structureEditor/StructureEditor.tsx","components/rightbar/treeEditor/treeEditor.tsx","components/rightbar/viewsEditor/Views.tsx","components/rightbar/viewsEditor/data/InfoData.tsx","components/rightbar/viewsEditor/data/NodeData.tsx","components/rightbar/jsxEditor/JsxEditor.tsx","components/rightbar/viewsEditor/data/TemplateData.tsx","components/rightbar/viewsEditor/data/EdgeData.tsx","components/rightbar/viewsEditor/data/EdgePointData.tsx","components/rightbar/viewsEditor/View.tsx","components/rightbar/viewsEditor/ViewsEditor.tsx","components/rightbar/styleEditor/StyleEditor.tsx","components/rightbar/edgeEditor/EdgeEditor.tsx","components/rightbar/viewpointsEditor/ViewpointsEditor.tsx","components/rightbar/console/Console.tsx","components/toolbar/ToolBar.tsx","graph/edge/PendingEdge.tsx","memorec/api.ts","components/toolbar/ContextMenu.tsx","graph/edges/ReferenceEdge.tsx","graph/edges/ExtendEdge.tsx","graph/edges/ValueEdge.tsx","graph/edges/EdgesManager.tsx","components/abstract/tabs/MetamodelTab.tsx","components/abstract/tabs/ModelTab.tsx","components/abstract/tabs/InfoTab.tsx","components/abstract/tabs/TestTab.tsx","components/abstract/tabs/IotTab.tsx","components/abstract/DockLayout.tsx","static/img/splash.png","components/topbar/SaveManager.ts","components/topbar/undoredocomponent.tsx","components/room/RoomManager.tsx","components/topbar/Topbar.tsx","popup/Cleaning.tsx","App.tsx","components/room/RoomAttacher.tsx","components/room/RoomChecker.tsx","router/Router.tsx","index.tsx","firebase/environment.ts","firebase/index.ts","graph/vertex/Vertex.tsx","view/viewElement/view.tsx","graph/graphElement/graphElement.tsx"],"names":["json2xml","o","tab","toXml","v","name","ind","xml","Array","i","n","length","hasChild","m","charAt","substr","toString","replace","X","toObj","nodeType","attributes","nodeName","nodeValue","firstChild","textChild","cdataChild","hasElementChild","nextSibling","match","removeWhite","escape","innerXml","documentElement","alert","toJson","json","join","arr","node","s","innerHTML","asXml","c","txt","e","normalize","nxt","removeChild","xml2json","arguments","undefined","xml2jsonobj","GraphElementStatee","_classCallCheck","classes","GraphElementReduxStateProps","view","views","data","dataid","preRenderFunc","evalContext","template","graph","lastSelected","isEdgePending","GraphElementDispatchProps","GraphElementOwnProps","children","style","key","parentnodeid","nodeid","graphid","parentViewId","htmlindex","initialSize","EdgeStateProps","_GraphElementReduxSta","_inherits","_super2","_createSuper","_this2","_len2","args","_key2","call","apply","concat","viewpoint","start","end","windoww","window","console","warn","AbstractMixedClass","_createClass","value","logic","structure","singleton","CoordinateMode","EdgeHead","RuntimeAccessibleClass","_AbstractMixedClass","_super","_this","className","currentlevel","this","ret","push","__proto__","log","superclass","subclass","hasOwnProperty","subclasses","indexOf","_extends","prototype","contains","joinOriginal","separator","_len","separators","_key","isArray","_toConsumableArray","extendPrototypes","_i","_Object$values","Object","values","annotatedClasses","gclass","statickey","annotated","keys","baseObjInLookup","path","canThrow","state","map","d","DPointerTargetable","wrap","__isProxy","store","getState","idlookup","Log","exx","error","Error","Proxy","TargetableProxyHandler","MapProxyHandler","thiss","dclassname","superClassName","_RuntimeAccessibleCla","returnIfEqual","get","thisclass","extendTree","first","model","Leaf","constructor","Node","Abstract","Instantiable","instanceConstructor","RuntimeAccessible","predebug","_objectSpread","cname","pre","post","staticClassName","classnameFixedConstructorDoNotRenameWithoutSearchStrings","_obj$initBase","obj","_construct","classNameFromAnnotation","initBase","canFireActions","Constructors","_class2","t","father","persist","fatherType","callbacks","SetFieldAction","new","PointedBy","fromID","id","BEGIN","simpledatacallback","setTimeout","_step","_iterator","_createForOfIteratorHelper","done","cb","err","f","ex","ddebug","pendingCreation","END","CreateElementAction","_DState","DState","currentUser","DUser","users","models","_DParameter","DParameter","_x","defaultValue","_DClass","DClass","_DValue","DValue","targets","fromPointer","alreadyParsed","_step2","nextTargets","_iterator2","target","_step3","_iterator3","extendedBy","ext","pointer","_step4","_iterator4","instances","instance","_DReference","DReference","_DAttribute","DAttribute","_DObject","DObject","_x2","instanceoff","LPointerTargetable","instanceof","_DValue2","_x3","_x4","_x5","val","isMirage","edges","_DAnnotation","DAnnotation","_x6","_x7","source","details","_step5","_iterator5","det","makeID","tid","Date","getTime","maxID","_DNamedElement","DNamedElement","_x8","substring","_DTypedElement","DTypedElement","_x9","type","_DPackage","DPackage","_x10","_x11","uri","prefix","_DModel","DModel","_x12","_x13","isMetamodel","packages","SetRootFieldAction","_DOperation","DOperation","exceptions","implementation","_step6","_iterator6","exc","_DClass2","isInterface","isAbstract","isPrimitive","partial","partialdefaultname","interface","abstract","_DEnumLiteral","DEnumLiteral","_x14","literal","_DEnumerator","DEnumerator","_DVoidEdge","DVoidEdge","_x15","_x16","_x17","_x18","longestLabel","labels","startid","LGraphElement","getNodeId","endid","midnodes","midPoints","allNodes","allSegments","toFixed","_DGraphElement","DGraphElement","_x19","_x20","_x21","_x22","parentNodeID","parentgraphID","subElements","favoriteNode","zIndex","_DViewElement","DViewElement","_x23","_x24","_x25","jsxString","defaultVSize","usageDeclarations","constants","appliableToClasses","priority","subViews","oclApplyCondition","explicitApplicationPriority","GraphSize","size","storeSize","lazySizeUpdate","constraints","draggable","resizable","display","width","height","adaptWidth","adaptHeight","edgeStartOffset","GraphPoint","edgeEndOffset","edgeStartOffset_isPercentage","edgeEndOffset_isPercentage","edgeStartStopAtBoundaries","edgeEndStopAtBoundaries","bendingMode","EdgeBendingMode","Bezier_quadratic","edgeGapMode","EdgeGapMode","gap","edgePointCoordMode","relativeOffset","edgeHeadSize","edgeTailSize","_DGraph","DGraph","zoom","graphSize","_subMaps","_DVoidVertex","DVoidVertex","_x26","defaultVSizeObj","defaultVSizeFunc","func","_this3","isResized","lvertex","fromD","x","y","w","h","index","updateEPindex","_defaultVSizeObj","le","de","__raw","subelements","U","arrayRemoveAll","splice","current","modelid","DGraph_maxID","_class","_class4","_RuntimeAccessibleCla2","_DPointerTargetable","fakearg_detectwrongcalls","_this4","_storePath","pointedBy","startingPrefix","metaptr","lfather","from","childrenNames","increaseEndingNumber","newname","condition","ptr","p","_ptr","a","l","defaultComponent","_class3","set_extend","Pointers","_class6","filter","pointerval","includes","_class5","PendingPointedByPaths","_class8","to","solveAttempts","stackTrace","action","getStackTrace","canBeResolved","resolve","all","Action","parse","create","maxSolveAttempts","oldState","pendingPointedBy","pb","followPath","attemptResolve","_class7","_class10","lastIndexOf","split","field","modifier","oldValue","casee","oldtarget","actionpath","newtargetptr","newtarget","saveForLater","list","_class9","_class12","_DPointerTargetable2","_super3","_this5","_len3","_key3","__serialize","inspect","clonedCounter","__random","__info_of__id","str","msg","wrongAccessMessage","context","cannotSet","DeleteElementAction","_this6","_delete","extends","wrapAll","_class11","WPointerTargetable","_class13","_DPointerTargetable3","_super4","_this7","_len4","_key4","_class15","_class16","_DPointerTargetable4","_DUser","_super5","_this8","_len5","_key5","cursorPositionX","cursorPositionY","__isUser","now","token","LUser","_class18","_LPointerTargetable","_super6","_this9","_len6","_key6","cursorPosition","_class17","MyError","_class20","_Error","_super7","message","_console","_this10","proto","_assertThisInitialized","_len7","otherMsg","_key7","actualProto","setPrototypeOf","_wrapNativeSuper","_class19","JsType","printableTypeName","check","isExclusiveType","getTypes","_len8","acceptables","_key8","Uarr","arrayIntersection","stopIfTypeIsNot","_step7","_iterator7","isFunction","getFunctionSignatureFromComments","isLambda","isNonLambdaFunction","fallbackReturn","isObject","isLambdaFunction","isSymbol","isBoolean","isNumber","isBigint","isString","isNull","isUndefined","isDate","isAnyOfTypes","object","function","array","invalidSuperClassError","scname","exDevv","MixinFakeConstructor","isMixinFakeConstructor","MixOnlyFuncs","c1","c2","c1noconstructor","c2noconstructor","Mixin","c1name","c2name","init_constructor","date","lambdaFunction","nonLambdaFunction","symbol","null","boolean","number","bigint","string","buildWrapSignature","maxdepth","onlyUnique","self","dep","depsorted","byLevels","loopdetecter","namelist","olddep","flatMap","_step8","_iterator8","table","lparam","epsorted","_step9","_iterator9","D","L","signature","LogicContext","proxyObject","write","MapLogicContext","_LogicContext","proxy","subMaps","MyProxyHandler","g","proxyitself","getOwnPropertyNames","GetPathHandler","_MyProxyHandler","strbuilder","calls","targetObj","propKey","__asCalls","__asArray","Symbol","toPrimitive","__nested","_MyProxyHandler2","_RuntimeAccessibleCla3","_RuntimeAccessibleCla4","additionalPath","lg","exDev","propKeyStr","asString","_index","isConcatenable","subKey","get0","canThrowErrors","String","JSON","stringify","Math","random","typeName","$$typeof","getterMethod","_defaultGetter","lchildren","lc","concatenationTentative","concatenableHandler","getType","mapWrap","_defaultSetter","defaultSetter","proxyItself","set","arrayMergeInPlace","k","_TargetableProxyHandl","subMapKeys","submapkeys","getPath","ShortAttribETypes","DV","DefaultView","package","class","feature","enum","void","operation","operationm1","defaultPackage","publicmsg","debughiddenmsg","visibleMessage","replaceAll","debuginfo","error_string","head","inner","headstr","styleTranslateRotate","attrs","hoverAttrs","extend","reference","aggregation","composition","modename","tail","dashing","valuecolormap","EBoolean","EByte","EShort","EInt","ELong","EFloat","EDouble","EDate","EString","EChar","valuecolormap_str","_jsx","minHeight","_jsxs","background","color","IPoint","letters","other","clone","tentativeEnd","skipSqrt","d_pow2","pow","sqrt","p2","newInstance","p1","duplicate","p0","add","subtract","pt","scalar","isNaN","firstPt","secondPt","tolleranza","rectangle","Size","fromPoints","tolleranzaX","tolleranzaY","distanceFromLine","top","bot","abs","startVertexSize","debug","tl","tr","bl","br","R","T","B","min","markg","pt2","_IPoint$getM","getM","toRadians","directionVector","atan2","RadToDegree","_IPoint","dontmixwithPoint","Point","pageX","pageY","_IPoint2","dontmixwithGPoint","ISize","makePoint","xPercent","yPercent","minSize","maxSize","startx","starty","endx","endy","max","intersection","size2","sizes","isOverlapping","_ISize","dontMixWithGraphSize","element0","element","document","body","tmp","$element","$","tagName","sizeofvar","createElement","append","isOrphan","parentNode","ancestors","ancestorArray","displayStyles","_e$style","_ancestors$i","_ancestors$i$style","getComputedStyle","offset","left","getBoundingClientRect","_ancestors$_i$style","removeProperty","clear","minX","maxX","minY","$sizeofvar","_ISize2","dontMixWithSize","Geom","closestPoint","pt0","targetPt","gridAlign","m0","q0","q","getQ","Number","POSITIVE_INFINITY","allowT","allowB","allowL","allowR","intersectionT","intersectionB","intersectionL","intersectionR","isNumberBetween","lineToSegmentIntersection","prevPt","closestIntersection0","vertexGSize","NEGATIVE_INFINITY","closestmix","closest","segStart","segEnd","mode","closestmix2","sub","vicinanzaT","vicinanzaB","vicinanzaL","vicinanzaR","closestX","farthestX","floorX","floor","ceilX","ceil","closestY","farthestY","floorY","ceilY","_class14","is","DegreeToRad","TanToDegree","isPositiveZero","isNegativeZero","atan","radians","PI","degree","shape","tolerance","GeomTolerance","isOnHorizontalEdges","isOnVerticalEdges","isOnLeftEdge","isOnRightEdge","isOnTopEdge","isOnBottomEdge","top_closest","closestPointToSegment","bot_closest","left_closest","right_closest","top_distance","distanceFromPoint","bot_distance","left_distance","right_distance","min_distance","Infinity","x_intersect","y_intersect","maxY","mse","pmse","m2","q2","intersect","lineToLineIntersection","retIfParallel","retIfCoincident","startLine","endIfSegment","UX","fn","depthIndices","innermap","child","i1","React","isValidElement","props","cloneElement","recursiveMap","i2","ii","Children","i3","parentComponent","gvidmap_useless","indices","_WrappedComponent","_parentComponent$prop","_parentComponent$prop2","_parentComponent$prop3","_re$props$data","_re$props$initialSize","_re$props$startingSiz","_WrappedComponent2","re","ReactNodeAsElement","WrappedComponent","Components","Input","Select","TextArea","injectProps2","GraphElementComponent","DefaultNodeComponent","EdgeComponent","VertexComponent","injectProps","idbasename","_re$props$initialSize2","EdgePoint","startingSize","edgeProps","edgestart_id","edgeend_id","mycomponents","_deleteWithAlarm","_asyncToGenerator","_regeneratorRuntime","mark","_callee","lItem","MySwal","_context","prev","next","withReactContent","Swal","fire","title","showCancelButton","confirmButtonText","cancelButtonText","showLoaderOnConfirm","sent","delete","stop","_info","_callee2","text","_context2","DLog","LLog","isSelected","graphID","nodeID","b","allSubNodes","z","__info_of_z__","__info_of_zIndex__","html","position","htmlSize","htmlPosition","component","vertex","__info__of__vertex","__info__of__favoriteNode","startPoint","endPoint","__info_of__startPoint","__info_of__endPoint","__info_of__graph","innerGraph","__info_of__innnerGraph","outerGraph","__info_of__outerGraphGraph","__info_of__graphAncestors","graphAncestors","outerSize","__info_of__outerSize","innerSize","__info_of__innerSize","__info_of__size","get_innerGraph","isPointer","_defaultCollectionGetter","get_view","ee","lcurrent","dcurrent","DVertex","DGraphVertex","_dcurrent","get_size","set_size","get_w","set_w","get_h","set_h","get_component","canTriggerSet","get_innerSize","r","get_innerSize_impl","_component$props","nosize","get_outerGraph","coord","get_htmlSize","DEdgePoint","def","getSize","decodePosCoords","actualSize","of","updateSize","translateSize","encodePosCoords","get_html","set_zIndex","fromArr","isDeepStrictEqual","pointers","equals","arrdiff","arrayDifference","removed","oldsubelementid","subelement","added","newsubelementid","modelElementId","dataset","tocheck","checked","newtocheck","subnode","get_startEndPoint","isStart","isPercentage","_node","DGraph_makeID","dmp","out","$allnodes","matchedids","matchedidmap","objectFromArrayValues","allnodesarr","filternode","_d$dataset","_d$dataset2","$matched","$notMatched","LGraph","_LGraphElement","__info_of__translateSize","get_zoom","elem","targetid","_DGraphElement2","LVoidVertex","_LGraphElement2","__isDEdgePoint","LEdgePoint","_LVoidVertex","_super8","__isLEdgePoint","edge","__info_of__edge","set_father","sp0","ep0","absolute","sp","ep","relativePercent","relativeOffsetStart","relativeOffsetEnd","useStart","useEnd","offsetsp","offsetep","divide","_get","_getPrototypeOf","_DGraphElement3","_super9","_len9","_key9","__isDVertex","LVertex","_LVoidVertex2","_super10","_this11","_len10","_key10","__isLVertex","_class21","_class22","_DGraphElement4","_super11","_this12","_len11","_key11","__isDGraph","__isDGraphVertex","LG","_LGraph","_super12","LV","_LVertex","_super13","LGraphVertex","_class24","_MixOnlyFuncs","_super14","_this13","_len12","_key12","__isLGraph","__isLGraphVertex","_class23","SvgLetter","_class26","_DGraphElement5","_super15","_this14","_len13","_key13","__isDVoidEdge","DEdge","_class25","EdgeSegment","_class28","mid","svgLetter","gapMode","prevSegment","bezier","dpart","rad","radLabels","isLongest","label","Bezier_quadratic_mirrored","addBezierPoint","Bezier_cubic_mirrored","Bezier_cubic","Line","Elliptical_arc","Bezier_QT","Bezier_CS","prevedgemakerbezier","mirroredBezier","invertLastBezierPt","mToRad","finalpart","average","center","autoFill","lineFill","arcFill","vector","_class27","EdgeFillSegment","_EdgeSegment","_super16","LVoidEdge","_class30","_LGraphElement3","_super17","_this15","_len14","_key14","__isLVoidEdge","___info_of__allNodes","segments","segments_inner","segments_outer","__info_of__segments","__info_of__d","isHead","headSize0","segment0","zoom0","segment","get_segments","get_graph","headPos","secondIntersection","x4headsize","safeDistance","closestIntersection","useBezierPoints","_this16","headSize","headPos_impl","_this17","get_start","get_midnodes","get_end","_this18","impl_addMidPoints","nodes","labelmaker","labelmakerfunc","get_startPoint_Outer","get_endPoint_Outer","get_startPoint_inner","get_endPoint_inner","get_edgeStartEnd_inner","addM","doublingMidPoints","others","outer","getAnchorOffset","ge","rets","rete","base","get_endPoint","get_startPoint","get_points_impl","get_segments_outer","get_segments_impl","get_points","bm","vraw","segmentSize","svgLetterSize","increase","endindex","slice","fillSegments","snapSegmentsToNodeBorders","setLabels","rett","fillers","makeD","longestindex","longest","calcLength","get_label_impl","ci","canCutStart","canCutEnd","grid","curr","doStartCut","doEndCut","extpt","prevpt","get_edgeEnd_outer","get_edgeEnd_inner","_class29","_class32","_super18","_this19","_len15","_key15","__isDEdge","_class31","LEdge","_class34","_LVoidEdge","_super19","_this20","_len16","_key16","__isLEdge","_class33","DExtEdge","_class35","_class36","_DEdge","_super20","_this21","_len17","_key17","__isDExtEdge","LExtEdge","_class38","_LEdge","_super21","_this22","_len18","_key18","__isLExtEdge","_class37","DRefEdge","_class39","_class40","_DEdge2","_super22","_this23","_len19","_key19","__isDRefEdge","LRefEdge","_class42","_LEdge2","_super23","_this24","_len20","_key20","__isLRefEdge","_class41","DViewPoint","callback","LViewPoint","_LViewElement","LViewElement","statehistory","globalcanundostate","undoable","redoable","logs","viewelements","stackViews","graphs","voidvertexs","vertexs","graphvertexs","edgepoints","extEdges","refEdges","classifiers","enumerators","primitiveTypes","enumliterals","references","classs","operations","parameters","returnTypes","user","contextMenu","deleted","objects","_lastSelected","viewpoints","m2models","m1models","room","isCleaning","selected","iot","topics","memorec","_views","modelView","packageView","classView","enumView","enumeratorView","attributeView","referenceView","operationView","literalView","objectView","voidView","edgePointView","edgePointViewSVG","edgeViews","size0","size1","edgePreRenderFunc","makeEdgeView","tailSize","ev","new2","edgeView","svgHeadTail","valueView","query","makeDefaultGraphViews","_i2","primitiveType","dPrimitiveType","toUpperCase","ViewPointState","ModelStore","_meta","LState","ls","modelElement","deepCopyButOnlyFollowingPath","oldStateDoNotModify","prevAction","newVal","_action$path","newRoot","gotChanged","alreadyPastDivergencePoint","pathArray","trim","prevActionPathKey","isArrayAppend","isArrayRemove","endsWith","removedval","remove","oldpointerdestinations","difference","rem","CompositeActionReducer","actionBatch","_actions","actions","getSolveableActions","possibleInconsistencies","derivedActions","LoadAction","preexistingValue","isEqual","statefoldername","toLowerCase","sort","a1","a2","stringCompare","newState","actiontype","subType","SubType","vertexSubElements","updateRedundancies_OBSOLETE","initialState","storeLoaded","reducer","_reducer","ignoredFields","parsedAction","Firebase","addAction","then","times","UndoAction","undo","pop","RedoAction","doreducer","delta","objectDelta","filterundoableactions","isundo","undonestate","undorecursive","deltalevel","statelevel","ca","forceinit","CompositeAction","setSubclasses","dict","tree","TreeModel","childrenPropertyName","safe_parse","jodelInit","fixStatics","dClasses","getAllNames","rc","lClasses","dClassesmap","reduce","acc","lClassesmap","alld","alll","dname","tagless","buildLSingletons","defaultContext","Selectors","getAllClassesDictionary","fakeinit","createStore","Debug","nodeids","Set","allids","components","_s$model","timeoutTasks","largeTimeoutTasks","Company","employee","manager","Persona","age","isUnemployed","OCL","obj0","oclexp","typeused","oclEngine","OclEngine","typeregister","registerTypes","addOclExpression","notEmpty","name0","evaluate","keepIndex","returnType","res","bool","getEvaluatedContexts","getResult","company","Person","Componentss","wComponents","newkey","$$","prjson2xml","_pr_json2xml","prxml2json","_pr_xml2json","JSXT","jsxtt","info","OclEditorComponent","readOnly","getDefaultViewsID","Editor","onChange","options","defaultLanguage","OclEditorConnected","connect","ownProps","viewid","dispatch","OclEditor","webpackEmptyContext","req","code","module","exports","ViewEClassMatch","_state$_lastSelected","metamodel","me","LModelElement","_state$_lastSelected2","m1","dObjects","lObjects","dObject","LObject","dValues","lValues","dValue","LValue","getAllPrimitiveTypes","classList","dModels","LModel","resolvePointers","ptrs","ArrayMerge0","vv","gv","Classe","GClass","allIdByClassName","allDByClassName","allLByClassName","caseSensitive","getAll","classe","getByField","_d$field","dfield","queryJS","eval","IMPLICIT_MATCH","getViewpoint","constructors","getAllClasses","EXACT_MATCH","MISMATCH","ThisClass","gotSubclassMatch","classtarget","ClassTarget","classIsExtending","INHERITANCE_MATCH","classTarget","acceptEquality","v1","datascore","nodescore","v1MatchingEClassScore","matchesMetaClassTarget","v1OclScore","matchesOclCondition","v1SubViewScore","hisnode","selectedViewId","allViews","getAllViewElements","selectedView","parentView","sameViewPointSubViews","sortedPriority","Scored","scoreView","e1","e2","score","isOfSubclass","DModelElement","toObject","forGraph","asPointers","geid","lPackage","lClass","lOperation","classifier","lClassifier","SavePack","vertexpos","LocalStorage","_IStorage","autosave","localStorage","getItem","serialize","modelNumber","modelname","KeyList","lastOpenedModel","lastOpenedView","lastOpenedPosition","setLastOpened","del","IStorage","isOverwrite","deserialize","AccessModifier","EcoreParser","ecorejson","filename","parsedjson","temp","ECoreRoot","ecoreEPackage","pause","parsedElements","parseM2Model","parseM1Model","LinkAllNamesToIDs","fixNamingConflicts","resume","newBatch","fixObjectPointers","tmpparse","tempfix_untilopennewtabisdone","dobjects","lobjects","m1pointermap","ecorePointer","modified","newvalues","idMap","nameMap","replacePrimitiveMap","d_Estring","AttribETypes","shortkey","longkey","ecorename","dobj","_replaceRules","replacekey","valtmp","DfromPtr","_loop","dval","meta","ordinal","_LPointerTargetable$f","_LPointerTargetable$f2","ordinals","getLiteral","ptrkey","_step10","_iterator10","updateSuperClasses","generated","ECoreNamed","namee","pos","getChildren","annotations","getAnnotations","_step11","_iterator11","parseDAnnotation","_step12","_iterator12","parseDPackage","allmodels","_matchpkg$","xmlns","XMLinlineMarker","ns","findns","outerloop","key0","val0","key1","ECoreObject","xmi_version","xmlns_xmi","expected","namespacedclass","mmclass","getClassByNameSpace","_step13","roots_for_this_metaclass","_iterator13","rootjson","parseDObject","metaSuperClass","m2classes","parent","parentType","_meta2","_meta3","getobjectmetaclass","metaname","metafeature","classmeta","parseDValue","jsonvalues","features","_step15","_iterator15","ECoreAnnotation","childs","version","supportedEcoreVersions","read","ECorePackage","nsURI","nsPrefix","_step16","_iterator16","ECoreClass","xsitype","parseDClass","parseDEnum","instanceTypeName","eSuperTypes","eOperations","eStructuralFeatures","instanceClassName","tmps","_step17","functions","_iterator17","parseDOperation","_step18","_iterator18","xsiType","ECoreAttribute","parseDAttribute","parseDReference","ECoreEnum","eLiterals","serializable","_step19","_iterator19","parseDEnumLiteral","literals","EcoreLiteral","lowerBound","lowerbound","upperBound","upperbound","eType","containment","fromBoolString","ECoreReference","getEcoreTypeName","typekey","ordered","ECoreOperation","unique","eexceptions","visibility","_step20","_iterator20","parseDParameter","eAnnotations","isEmptyObject","throwError","mod","pkg","eClassifiers","cla","fun","eParameters","lit","valueIfNotFound","multiReplaceAll","classTypePrefix","ECoreDetail","xmlnsxmi","xmlnsxsi","xmiversion","xmlnsecore","ECoreParameter","xmlns_uri","XMIModel","DAnnotationDetail","__info_of__father","fatherList","__info_of_children__","subNodes","property","containers","loopdetectionobj","generateEcoreJson_impl","loopDetectionObj","cannotCall","includingthis","$class","$subnodes","find","nodehtmlarr","toArray","nodeidarr","dnodes","loopdetection","get_father","fatherFieldName","getFatherFieldToDelete","reduxFieldName","getReduxFieldToDelete","_Selectors$getState$_","fatherField","reduxField","superDelete","_l","nodeElements","nodeId","lNode","get_until_parent","get_children_idlist","logicContext","indexes","_this4$get_class","_this4$get_package","_ref","_this4$get_class2","_this4$get_package2","_this4$get_enum","_this4$get_class3","_this4$get_operation","get_class","addAttribute","get_package","addClass","get_model","addPackage","addReference","addEnumerator","get_enum","addLiteral","addOperation","get_operation","addParameter","get_addException","_context$data","dOperation","dClass","params","exception","_DModelElement","LAnnotation","_LModelElement","__namee","generateEcoreJson","deep","addAnnotation","ldet","we","lchild","LAnnotationDetail","_LModelElement2","LNamedElement","_LModelElement3","namespace","fullname","get_containers","reverse","_autofix_name","many","required","LTypedElement","_LNamedElement","classType","enumType","get_type","isClass","isEnum","typeEcoreString","typeString","t1","t2","ShortAttribSuperTypes","isExtending","DClassifier","_DPointerTargetable5","LClassifier","_LNamedElement2","_DPointerTargetable6","subpackages","dmodel","defaultname","setter","assign","LPackage","_LNamedElement3","enums","allSubPackages","allSubEnums","allSubClasses","classarr","enumarr","isPartial","partialDefaultName","get_addEnumerator","dc","get_enumerators","get_allSubPackages","get_allSubEnumerators","dpackage","oldList","diff","_arr","_arr2","_context$proxyObject$","canBeDeleted","_DPointerTargetable7","private","LOperation","_LTypedElement","signatureImplementation","par","get_execute","get_signatureImplementation","typedComments","typedcommentpre","typedcommentpost","typeToShortString","_i3","_arr3","superchildren","override","_DPointerTargetable8","getFirstPrimitiveTypes","LParameter","_LTypedElement2","_DPointerTargetable9","_len21","_key21","referencedBy","implements","implementedBy","LClass","_LClassifier","_len22","_key22","__info_of__extends","extendsChain","superclasses","__info_of__superclasses","ownAttributes","ownReferences","ownOperations","ownChildren","inheritedAttributes","inheritedReferences","inheritedOperations","inheritedChildren","allAttributes","allReferences","allOperations","allChildren","LAttribute","LReference","get_ownAttributes","get_ownReferences","get_ownOperations","get_extendsChain","superClass","get_inheritedAttributes","get_inheritedReferences","get_inheritedOperations","get_ownChildren","get_inheritedChildren","featurearr","operationsarr","att","ref","op","toBoolString","_i4","_arr4","_step14","_iterator14","_i5","_arr5","_i6","_arr6","_i7","_arr7","finalVal","_this25","output","reason","allTargetSuperClasses","_canExtend","plusThis","visited","queue","_queue","SetMerge","j","sc","_loop2","superchild","_canOverride","_canPolymorph","_mark","_ret2","_ret","orEqual","get_superclasses","force","newextends","newextendedBy","filteredPointedBy","DDataType","_DPointerTargetable10","_this26","_len23","_key23","LDataType","_class43","_class44","_LClassifier2","_this27","_len24","_key24","DStructuralFeature","_class46","_DPointerTargetable11","_this28","_len25","_key25","changeable","volatile","transient","unsettable","derived","_class45","LStructuralFeature","_class47","_class48","_LTypedElement3","_super24","_this29","_len26","_key26","_step21","_iterator21","_class50","_DPointerTargetable12","_super25","_this30","_len27","_key27","defaultValueLiteral","container","resolveProxies","opposite","_class49","_class51","_class52","_LStructuralFeature","_super26","_this31","_len28","_key28","_this32","dclass","set_type","has_opposite","oppositename","obsolete_attribute","_class54","_DPointerTargetable13","_super27","_this33","_len29","_key29","isID","_class53","_class55","_class56","_LStructuralFeature2","_super28","_this34","_len30","_key30","_context$proxyObject$2","_class57","_class58","_DPointerTargetable14","_super29","_this35","_len31","_key31","LEnumLiteral","_class59","_class60","_LNamedElement4","_super30","_this36","_len32","_key32","impl_generateEcoreJsonM1","get_value","set_value","sameOrdinalLit","_class61","_class62","_DPointerTargetable15","_super31","_this37","_len33","_key33","LEnumerator","_class63","_class64","_LDataType","_super32","_this38","_len34","_key34","_step22","_iterator22","_i8","_arr8","dliterals","currentOrdinal","_step23","_iterator23","dString","DModelM1","_class66","_super33","_this39","_len35","_key35","roots","_class65","LModelM1","_class68","_LNamedElement5","_super34","_this40","_len36","_key36","_class67","_class70","_DNamedElement2","_super35","_this41","_len37","_key37","dmodels","dmodelnames","_class69","EdgeStarter","_class72","sn","en","_this$startSize","_this$startVertexSize","otherPossibleEnds","startNode","endNode","startVertex","endVertex","startSize","endSize","endVertexSize","otherEnds","overlaps","vertexOverlaps","ends","_class71","_class74","_LNamedElement6","_super36","_this42","_len38","_key38","allSubAnnotations","allSubObjects","suggestedEdges","__info_of__suggestedEdges","_step24","packageArr","_iterator24","_step25","_iterator25","ecoreRootName","get_suggestedEdgesM2","get_suggestedEdgesM1","get_classes","alreadyAdded","SkipExtendNodeHidden","rootCall","_step26","_iterator26","eid","secondTierExtends","es","_step27","dependencies","src","pkgdependencies","_iterator27","srcnode","_step28","_iterator28","epnode","packageDependencies","pd","todo","_step29","_iterator29","_i10","_arr9","_step30","_iterator30","_i11","_arr10","get_objects","isRoot","_step31","_iterator31","_this43","pkguri","classname","get_getPackageByUri","_class73","DFactory_useless_","_class76","_DPointerTargetable16","_super37","_this44","_len39","_key39","ePackage","_class75","LFactory_useless_","_class78","_LModelElement4","_super38","_this45","_len40","_key40","_class77","EJavaObject","_class80","_class79","DMap","_class82","_Object","_super39","_this46","__isDMap","_class81","LMap","_class84","_LPointerTargetable2","_super40","_this47","_len41","_key41","__isLMap","_class83","_class86","_DPointerTargetable17","_super41","_this48","_len42","_key42","_class85","_class88","_LNamedElement7","_super42","_this49","_len43","_key43","allchildren","truechildren","deepSubObjects","subObjects","referenceFeatures","attributeFeatures","shapelessFeatures","conformchildren","_c$instanceof","_c$instanceof2","_step32","bymetaparent","_iterator32","vmeta","vmetaid","flat","get_uri","_context$proxyObject$3","_step33","_iterator33","getPathArr","ref_features","get_referenceFeatures","shapeless_features","get_shapelessFeatures","alreadyparsed","get_subObjects","_step34","_iterator34","includeshapeless","_value$instanceof","matchedFeature","asEcoreRoot","_step35","_iterator35","_removeConformity","_forceConformity","lmeta","_step36","refs","idmap","_iterator36","_step37","_iterator37","_step38","_iterator38","addValue","_step39","_iterator39","get_children","_step40","_iterator40","lValue","dFather","_this50","lastvisited","get_fatherList","_class87","_class90","_DModelElement2","_super43","_this51","_len44","_key44","topic","_class89","_class92","_LModelElement5","_super44","_this52","_len45","_key45","conformsTo","get_fromlfeature","iof","namedPointers","ecorePointers","shapeless","keepempties","withmetainfo","get_values","_type","fitSize","maxlimit","dmeta","typestr","numbermax","numbermin","round","rawValue","hidden","mapperfunc","numbercasting","_v$constructor","NaN","getFirstNumber","_ref2","_ref2$__raw","_ref2$__raw$values","forEach","struct","filterfunc","_l$father","_i12","_arr11","_i13","_arr12","_ref3","_ref3$__raw","_ref3$__raw$values","lval","limit","keepemptyquotes","_this53","valuestring_impl","havestrings","havechars","_i14","_arr13","vall","valstr","info0","skipSettingUndefined","oldVal","oldTarget","isContainment","isPtr","_this54","_val","_val2","success","lvale","lvalo","oldContainer","oldContainerValue","valarr","setValueAtPosition","_info$instanceof","metatype","_clearValueAtPosition","setMirage","get_setValueAtPosition","_step42","_iterator42","the_loop","generateEcoreJsonM1","_this55","_toString","get_getValues","_class91","pendingActions","hasBegun","deepnessLevel","actionstoPrepend","FINAL_END","sender","hasFired","consoleTargetSelector","stack","forceRelaunch","storee","executionCount","parse1","_Action","_Action2","fullpath","accessModifier","_SetRootFieldAction","_Action3","amount","notfire","act","_Action4","CombineHistoryAction","_Action5","_Action6","_SetFieldAction","_Action7","launch","ParsedAction","_SetRootFieldAction2","BidirectionalOCLEditor","_PureComponent","oclContainer","editor","createRef","loadEditor","prevProps","prevState","snapshot","xtext","url","baseUrl","createEditor","serviceUrl","syntaxDefinition","enableCors","ocltextchanged","getValue","oclText0","oclText","getAllMP","lmp","valids","validfilled","$htmlmatch","getNodes","removeClass","otherprops","_Fragment","onClick","getOclQuery","maxWidth","marginTop","PureComponent","OCLEditorConnected","objid","OCLEditorAce","InputComponent","fathers","fatherChain","editable","_selected$key","readonly","getter","jsxLabel","tooltip","css","inputClassName","autosize","notify","toast","dismiss","input","spellCheck","evt","cursor","asLabel","Toaster","InputConnected","_Object$keys","TextAreaComponent","TextAreaConnected","SelectComponent","_data$field","hasReturn","hasPrimitive","hasClasses","hasEnumerators","returns","primitives","primitive","enumerator","SelectConnected","ImageComponent","link","ImageConnected","Image","EdgeConnected","Xarrow","Edge","DataOutputComponent","ReactJson","collapsed","collapseStringsAfterLength","displayDataTypes","displayObjectSize","enableClipboard","groupArraysAfterLength","indentWidth","iconStyle","rootName","quotesOnKeys","shouldCollapse","sortKeys","theme","LoggerComponent","changeSearchTag","setState","searchTag","changeRegexpTag","searchTagAsRegExp","changeMinDate","minDate","changeMaxDate","maxDate","category","fullconcat","categoriesActive","messages","max_id","DDate","addYear","filters","tag","datafilter","loggers","registerLogger","cat","_this$state$filters$c","_this$state$filters","allCategories","activeCategories","isCatActive","allTags","arrayUnique","entries","parameter","Overlap","autosizex","cc","autosizey","defaultProps","ColorSchemeComponent","userColorSchemeCss","userMadeColorScheme","ColorScheme","_superclass","_this$props$data","_this$props$view","_this$props$views","skiparenderforloading","bugged","componentMap","dmodelMap","serializableProps","componentfunction","forceNodeType","Graph","Vertex","FieldComponent","Field","GraphVertexComponent","GraphVertex","VoidVertex","errorView","mapLModelStuff","mapViewStuff","DefaultNodeConnected","mapStateToProps","mapDispatchToProps","DefaultNode","GraphsContainerComponent","GraphsContainerConnected","GraphsContainer","crypto","require","_source","_source2","sourceNode","targetNode","showAnchor","_useStateIfMounted","useStateIfMounted","_useStateIfMounted2","_slicedToArray","middleAnchor","setMiddleAnchor","firstOptions","strokeWidth","showHead","lastOptions","showTail","tailShape","svgElem","rotate","fill","stroke","offsetForward","headColor","headShape","useEffectOnce","randomBytes","useEffect","middleware","drag","event","preventDefault","stopPropagation","onContextMenu","borderColor","EdgesConnected","lReference","lTarget","Edges","groupingsize","superclassGraphElementComponent","_superclassGraphEleme","classesoverride","startnodeid","endnodeid","superret","objectMergeInPlace","removeEmptyObjectKeys","DamEdge","isGraph","isVertex","variable","process","toCheck","ok","tx","every","deepEqual","Promise","characters","randomString","randomNumber","backdrop","showCloseButton","showConfirmButton","typeclassifier","toJSON","orderedChildren","Map","timestamp","patharr","chain","lastObject","lastkey","failedRemainingPath","lastval","kv","vals","searchText","replacement","objarr","_objarr","_out$_key","_log","_objarr2","endi","fname","starti","parcounter","parameterStr","returnstarti","returnendi","bodystarti","regexp","exec","defaultVal","typedesc","evalInContextAndScope","codeStr","scope0","context0","_scope","scope","sproto","cproto","_eval","prefixDeclarations","postfixDeclarations","isStrict","Function","execInContextAndScope","evalInContext","js","funcName","time","results","timeEnd","elseReturn","useEval","script","eDev","domelem","stopNode","includeSelf","containerTag","cost","levenshtein","names","lowest","previous","distance","recursive","logger","namestr","suggestions","getClosestPropertyNames","file","reader","FileReader","onload","result","readAsText","extensions","readContent","myFileReader","show","htmlNode","highestTimeoutId","clearTimeout","sliceCalls","stacksToSkip","caller","getCaller","gotcalledby","srcElement","prop","isContentEditable","attr","modifyFirst","iterables","_iterables","iterable","item","arr1","arr2","arrtarget","arrays","arri","ArrayAdd","throwIfContained","param","_param$constructor","s1","s2","suffix","suf","otherArrs","_otherArrs","ignoreNonNumbers","allowDecimal","numberEnd","parseFloat","num","allowLastNonNumberChars","increaseWhile","regexpstr","matches","RegExp","objA","objB","keya","_constructor$prototyp","_constructor$__proto_","chainoutoutrecursive","currentRecursion","maxRecursion","cache","__allprototypes","getAllPrototypes","subconstructor","superconstructor","returnIfNull","returnIfUndefined","retIfArray","ifNotBoolean","allowNull","allowUndefined","starting","final","arraySubtract","old","neww","newwobj","oldobj","objdiff","changed","subold","subnew","removedprefix","pathseparator","flattenObjectToRoot","maxkeylength","maxsubpaths","maxvallength","toolongreplacer","quotestrings","valueseparator","filterrow","rowpaths","flatten","halfpath","halfval","halfsubpaths","bestpathsize","best","filterbest","row","pathlength","fullstr","fullvalue","toFileName","htmla","blob","Blob","endings","blobUrl","URL","createObjectURL","href","download","appendChild","click","revokeObjectURL","formatted","lines","indent","lastType","transitions","ln","single","Boolean","closing","opening","fromTo","padding","replacer","space","tmpindex","allowDecimalDot","allowDecimalComma","valueifmismatch","commamode","floatregex","intregex","accumulator","withRepetitions","pairArrayElementsRepeatFunc","pairArrayElementsReducerFunc","decomment_line","decomment_block","trimLines","idPrefix","getID","idgenerator","inplace","setDate","getDate","setMonth","getMonth","setFullYear","getFullYear","fileTypes","onchange","readcontent","contentObj","fileLetti","files","fileReadContent","content","contentArr","setinfos","setAttribute","on","trigger","reset","inPlace","FocusHistoryEntry","SelectorOutput","jqselector","attrselector","attrRegex","resultSetAttr","resultSetElem","Keystrokes","ParseNumberOrBooleanOptions","nullValue","undefinedValue","allowedNan","nanValue","allowBooleans","trueValue","falseValue","triggerAt","tname","loggerMapping","_log2","originalFunc","restArgs","lastError","firstParam","restAgs","FileReadTypeEnum","image","audio","video","AndManyOthersButThereAreTooMuch","OrJustPutFileExtension","MqttEditorConnected","valueId","parsedTopic","MqttEditor","Value","_lValue$instanceof","stepSize","maxLength","filteredvalues","getValues","changeDValue","inputvalue","select_options","isattr","isenum","isref","isshapeless","containerObjectsID","lm","validObjects","getObjects","_obj$instanceof","_feature$type","freeObjects","boundObjects","getAllEnumerators","shapelessObjects","classmap","free","bound","valueslist","step","placeholder","_filteredvalues$index","disabled","Structure","lModelElement","lModel","BaseEditor","lDataType","lEnum","DataTypeEditor","lTypedElement","lStructuralFeature","lAttribute","TypedElementEditor","StructuralFeatureEditor","lEnumLiteral","conform","forceConform","_me$instanceof","mm","getLastSelectedModel","debugmm","debugm","ModelEditor","PackageEditor","ClassEditor","AttributeEditor","ReferenceEditor","EnumEditor","EnumLiteralEditor","OperationEditor","ObjectEditor","ValueEditor","StructureEditorComponent","_this$props$selected","StructureEditorConnected","selectedid","StructureEditor","Child","TreeEditorConnected","TreeEditor","ViewsData","select","InfoData","_view$viewpoint","classesOptions","NodeData","JsxEditorComponent","jsx","setJsx","tabIndex","onBlur","JsxEditorConnected","JsxEditor","TemplateData","EdgeData","EdgePointData","ViewData","layout","dockbox","tabs","group","closable","DockLayout","defaultLayout","right","bottom","ViewsEditorConnected","ViewsEditor","StyleEditorConnected","_state$_lastSelected3","StyleEditor","EdgeEditorComponent","referenceM2","referenceM1","changeOptions","changeDisplayed","EdgeEditorConnected","EdgeEditor","ViewpointsEditorConnected","dViewPoint","backgroundColor","editName","filteredViews","ViewpointsEditor","ansiConvert","ansiconvert","hiddenkeys","fixproxy","_output","addLKeys","buildFunctionDocumentation","_output2","Lsingleton","comments","shortcuts","entryvalue","_hiddenkeys","ConsoleComponent","lastNode","expression","change","bind","_this$props$node","fromcomponent","_this$state$output","_this$props$node2","outstr","ashtml","contextkeys","_output$","_output3","_reactInternals","_isMounted","format","toHtml","util","commentKey","_commentVal","_commentVal2","_commentVal3","commentVal","objraw","setNativeConsoleVariables","whiteSpace","dangerouslySetInnerHTML","__html","_context$data2","ConsoleConnected","Console","ToolBarConnected","metamodelId","_props$selected","_props$selected2","_props$selected3","downward","addChildren","items","myDictValidator","reactNodes","_data","item_dname","ledge","dedge","wedge","skip","longestSeg","longestIndex","segms","newmp","prevNodeid","prevnodeindex","mp","olddebug","addChild","getItems","upward","parentKey","_upward$child","lobj","lfeat","addObject","ToolBar","PendingEdgeConnected","mousePosition","setMousePosition","edgeSettings","updateMousePosition","clientX","clientY","addEventListener","removeEventListener","Xwrapper","PendingEdge","MemoRec","_post","axios","abrupt","_structuralFeature","named","memorecClasses","myClass","memorecModel","memorecObject","response","methodInvocations","methodDeclarations","_classifier","_callee3","memorecPackages","myPackage","_context3","ContextMenuConnected","mePointer","nodePointer","_memorec$data","jsxList","setMemorec","_useStateIfMounted3","_useStateIfMounted4","suggestedName","setSuggestedName","close","structuralFeature","suggestOnClass","isAttribute","dView","addView","recommendedItem","ContextMenu","childrens","ReferenceEdgeConnected","startOptions","endOptions","ReferenceEdge","ExtendEdgeConnected","ExtendEdge","ValueEdgeConnected","ValueEdge","_references","_values","instanceOf","valuePointers","referenceEdge","sourceID","targetID","extendEdge","_extendEdge$source","_extendEdge$target","valueEdge","_valueEdge$source","_valueEdge$target","MetamodelTabConnected","_ret$model","margin","MetamodelTab","ModelTabConnected","metamodelid","ModelTab","InfoTabConnected","metamodels","_model$instanceof","InfoTab","TestTabConnected","TestTab","IotTabConnected","setTopics","editTopic","IotTab","TabDataMaker","DockLayoutComponent","dock","dockPanel","dockContext","groups","floatable","maximizable","panelExtra","panelData","open","addMetamodel","addModel","test","iotEditor","structureEditor","treeEditor","viewsEditor","styleEditor","edgeEditor","viewpointEditor","ViewpointEditor","moveOnStructure","moveOnViews","iotLoaded","dockMove","newProps","newContext","oldProps","deltaM2","addedM2","removedM2","OPEN","CLOSE","deltaM1","addedM1","removedM1","getLayout","setLayout","getAllMetamodels","getAllModels","preConfirm","getElementById","isConfirmed","_addMetamodel","newName","mmid","modelNames","infoTab","dockRef","DockLayoutConnected","Dock","SaveManager","tmpsave","setItem","fullstatestr","_lmodel$instanceof","toXML","toFile","lmodel","getActiveModel","exportEcore","formatXml","ism2","fromXML","fromfile","importEcore_click0","_e$message","_e$message$substring","trace","filestring","jsonstring","jsonobj","fileRead","fileContents","_e$target$files","todoc","DOMParser","parseFromString","doctojson","doc","xmlDoc","importEcore","loopobj","jsonstr","loadOnModel","fromFile","UndoRedoState","hover","SaveManagerComponent","undoredolistoutdated","do_undo","undoenter","do_redo","redoenter","undoredoenter","redo","maxlistsize","ObjectToAssignementStrings","editedfullpath","pathsegment","printablePointer","beststr","overflow","marginLeft","paddingLeft","pointerEvents","undoleave","redoleave","SaveManagerConnected","RoomManagerConnected","root","loading","setLoading","getRandomString","createdBy","quit","removeRoom","location","deleteAllRoms","removeAllRooms","RoomManager","TopBarConnected","_useState","useState","_useState2","save","load","Undoredocomponent","exportEcore_click","importEcore_click","exportLayout_click","importLayout_click","TopBar","Cleaning","Oval","wrapperStyle","justifyContent","wrapperClass","secondaryColor","AppConnected","splash","setSplash","sleep","SplashImage","RoomAttacherConnected","setActions","roomSize","setRoomSize","_useStateIfMounted5","_useStateIfMounted6","setError","_useStateIfMounted7","_useStateIfMounted8","_useStateIfMounted9","_useStateIfMounted10","onSnapshot","db","getRoom","receivedAction","fromJson","RoomAttacher","RoomChecker","useParams","validCode","setValidCode","constraint","operator","App","Router","BrowserRouter","Routes","Route","ReactDOM","render","Provider","Env","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","_select","collectionName","isAND","DOC","_constraints","_args","collection","_selectWithConditions","_selectWithoutConditions","_selectWithConditions2","conditions","where","or","getDocs","_selectWithoutConditions2","_add","_callee4","_context4","setDoc","merge","_edit","_callee5","_context5","updateDoc","_remove","_callee6","_context6","deleteDoc","_addAction","_callee7","_context7","edit","firebase","firestore","FieldValue","arrayUnion","_removeRoom","_callee8","_context8","_removeAllRooms","_callee9","rooms","_context9","t0","finish","config","app","initializeApp","getFirestore","ThisStatee","_GraphElementStatee","forceupdate","dragHelper","outline","setSize","forceUpdate","setVertexProperties","hasSetVertexProperties","$measurable","opacity","helper","onDragStart","onDragEnd","resizeoptions","onResizeStart","resize","onResizeEnd","cssOverride","isEdgePoint","isVoid","classesOverride","styleOverride","OwnProps","_GraphElementOwnProps","StateProps","DispatchProps","_GraphElementDispatch","DGraphElementClass","VertexConnected","componentdebug","bindVertexSizeToView","scalezoomx","scalezoomy","storeTemporaryPositions","__info_of__bindVertexSizeToView","isNode","isEdge","__info_of__name","__info_of__constants","__info_of__preRenderFunc","__info_of__jsxString","__info_of__usageDeclarations","__info_of__forceNodeType","__info_of__scalezoomx","__info_of__scalezoomy","__info_of__appliableToClasses","__info_of__subViews","__info_of__oclApplyCondition","__info_of__explicitApplicationPriority","__info_of__defaultVSize","__info_of__adaptWidth","__info_of__adaptHeight","__info_of__draggable","__info_of__resizable","__info_of__query","__info_of__viewpoint","__info_of__display","__info_of__onDragStart","__info_of__onDragEnd","__info_of__onResizeStart","__info_of__onResizeEnd","__info_of__constraints","__info_of__bendingMode","__info_of__edgeGapMode","__info_of__storeSize","__info_of__lazySizeUpdate","__info_of__edgeStartOffset","__info_of__edgeEndOffset","__info_of__edgeStartOffset_isPercentage","__info_of__edgeEndOffset_isPercentage","__info_of__edgeStartStopAtBoundaries","__info_of__edgeEndStopAtBoundaries","__info_of__edgePointCoordMode","__info_of__edgeHeadSize","__info_of__edgeTailSize","edgeStrokeWidth","__info_of__edgeStrokeWidth","subViewsPointers","vp","vsize","newSize","set_generic_entry","DViewTransientProperties","_isDViewTransientProperties","LViewTransientProperties","_isLViewTransientProperties","makeEvalContext","_props$node","vcomponent","setTemplateString","stateProps","allProps","jsxCodeString","fromString","factory","eDevv","errorView_string","debugcount","maxRenderCounter","lastViewChanges","maxid","onLeave","onEnter","_this$props$data2","forUser","getSelected","displayError","errormsg","stackerrorlast","icol","irow","stackerrorlinenum","parseInt","col","jsxlines","culpritlinesPre","culpritline","culpritlinesPost","rowPre","rowPost","jsxcode","fontFamily","_this$props$isEdgePen","_this$props$data3","canExtend","_this$props$data4","_this$props$isEdgePen2","alreadySelected","_this$props$data5","styleoverride","_this$lastViewChanges","thischange","vid","newvid","newv","change_log","rnode","getTemplate","rawRElement","addprops","fiximport","_this$props$node3","viewStyle","order","onMouseEnter","onMouseLeave","rn","depthIndexes","injectProp","newid","nextProps","nextState","nextContext","shallowEqual","dnode","viewScores","getAppliedViews","_ownProps$data","meid","dGraphElementDataClass","isDGraph","dge","pendings","pending","edgeOwnProps","dGraphDataClass","startingobj","mapLGraphElementStuff","reduxProps","GraphElementConnected","GraphElement"],"mappings":"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","file":"static/js/main.d9b64e0c.chunk.js","sourcesContent":["/*\tThis work is licensed under Creative Commons GNU LGPL License.\r\n\r\n\tLicense: http://creativecommons.org/licenses/LGPL/2.1/\r\n   Version: 0.9\r\n\tAuthor:  Stefan Goessner/2006\r\n\tWeb:     http://goessner.net/ \r\n*/\r\nexport function json2xml(o, tab/*string, string*/) {\r\n   var toXml = function(v, name, ind) {\r\n      var xml = \"\";\r\n      if (v instanceof Array) {\r\n         for (var i=0, n=v.length; i<n; i++)\r\n            xml += ind + toXml(v[i], name, ind+\"\\t\") + \"\\n\";\r\n      }\r\n      else if (typeof(v) == \"object\") {\r\n         var hasChild = false;\r\n         xml += ind + \"<\" + name;\r\n         for (var m in v) {\r\n            if (m.charAt(0) == \"@\")\r\n               xml += \" \" + m.substr(1) + \"=\\\"\" + v[m].toString() + \"\\\"\";\r\n            else\r\n               hasChild = true;\r\n         }\r\n         xml += hasChild ? \">\" : \"/>\";\r\n         if (hasChild) {\r\n            for (var m in v) {\r\n               if (m == \"#text\")\r\n                  xml += v[m];\r\n               else if (m == \"#cdata\")\r\n                  xml += \"<![CDATA[\" + v[m] + \"]]>\";\r\n               else if (m.charAt(0) != \"@\")\r\n                  xml += toXml(v[m], m, ind+\"\\t\");\r\n            }\r\n            xml += (xml.charAt(xml.length-1)==\"\\n\"?ind:\"\") + \"</\" + name + \">\";\r\n         }\r\n      }\r\n      else {\r\n         xml += ind + \"<\" + name + \">\" + v.toString() +  \"</\" + name + \">\";\r\n      }\r\n      return xml;\r\n   }, xml=\"\";\r\n   for (var m in o)\r\n      xml += toXml(o[m], m, \"\");\r\n   return tab ? xml.replace(/\\t/g, tab) : xml.replace(/\\t|\\n/g, \"\");\r\n}\r\n","/*\tThis work is licensed under Creative Commons GNU LGPL License.\r\n\r\n\tLicense: http://creativecommons.org/licenses/LGPL/2.1/\r\n   Version: 0.9\r\n\tAuthor:  Stefan Goessner/2006\r\n\tWeb:     http://goessner.net/\r\n*/\r\nvar X = {\r\n   toObj: function(xml) {\r\n      var o = {};\r\n      if (xml.nodeType==1) {   // element node ..\r\n         if (xml.attributes.length)   // element with attributes  ..\r\n            for (var i=0; i<xml.attributes.length; i++)\r\n               o[\"@\"+xml.attributes[i].nodeName] = (xml.attributes[i].nodeValue||\"\").toString(); // dam: qua parsa attribs\r\n         if (xml.firstChild) { // element has child nodes ..\r\n            var textChild=0, cdataChild=0, hasElementChild=false;\r\n            for (var n=xml.firstChild; n; n=n.nextSibling) {\r\n               if (n.nodeType==1) hasElementChild = true;\r\n               else if (n.nodeType==3 && n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) textChild++; // non-whitespace text\r\n               else if (n.nodeType==4) cdataChild++; // cdata section node\r\n            }\r\n            if (hasElementChild) {\r\n               if (textChild < 2 && cdataChild < 2) { // structured element with evtl. a single text or/and cdata node ..\r\n                  X.removeWhite(xml);\r\n                  for (var n=xml.firstChild; n; n=n.nextSibling) {\r\n                     if (n.nodeType == 3)  // text node\r\n                        o[\"#text\"] = X.escape(n.nodeValue);\r\n                     else if (n.nodeType == 4)  // cdata node\r\n                        o[\"#cdata\"] = X.escape(n.nodeValue);\r\n                     else if (o[n.nodeName]) {  // multiple occurence of element ..\r\n                        if (o[n.nodeName] instanceof Array)\r\n                           o[n.nodeName][o[n.nodeName].length] = X.toObj(n);\r\n                        else\r\n                           o[n.nodeName] = [o[n.nodeName], X.toObj(n)];\r\n                     }\r\n                     else  // first occurence of element..\r\n                        o[n.nodeName] = X.toObj(n); // damiano: qua parsa sottonodi\r\n                  }\r\n               }\r\n               else { // mixed content\r\n                  if (!xml.attributes.length)\r\n                     o = X.escape(X.innerXml(xml));\r\n                  else\r\n                     o[\"#text\"] = X.escape(X.innerXml(xml));\r\n               }\r\n            }\r\n            else if (textChild) { // pure text\r\n               if (!xml.attributes.length)\r\n                  o = X.escape(X.innerXml(xml));\r\n               else\r\n                  o[\"#text\"] = X.escape(X.innerXml(xml));\r\n            }\r\n            else if (cdataChild) { // cdata\r\n               if (cdataChild > 1)\r\n                  o = X.escape(X.innerXml(xml));\r\n               else\r\n                  for (var n=xml.firstChild; n; n=n.nextSibling)\r\n                     o[\"#cdata\"] = X.escape(n.nodeValue);\r\n            }\r\n         }\r\n         if (!xml.attributes.length && !xml.firstChild) o = null;\r\n      }\r\n      else if (xml.nodeType==9) { // document.node\r\n         o = X.toObj(xml.documentElement);\r\n      }\r\n      else alert(\"unhandled node type: \" + xml.nodeType);\r\n      return o;\r\n   },\r\n   toJson: function(o, name, ind) {\r\n      var json = name ? (\"\\\"\"+name+\"\\\"\") : \"\";\r\n      if (o instanceof Array) {\r\n         for (var i=0,n=o.length; i<n; i++)\r\n            o[i] = X.toJson(o[i], \"\", ind+\"\\t\");\r\n         json += (name?\":[\":\"[\") + (o.length > 1 ? (\"\\n\"+ind+\"\\t\"+o.join(\",\\n\"+ind+\"\\t\")+\"\\n\"+ind) : o.join(\"\")) + \"]\";\r\n      }\r\n      else if (o == null)\r\n         json += (name&&\":\") + \"null\";\r\n      else if (typeof(o) == \"object\") {\r\n         var arr = [];\r\n         for (var m in o)\r\n            arr[arr.length] = X.toJson(o[m], m, ind+\"\\t\");\r\n         json += (name?\":{\":\"{\") + (arr.length > 1 ? (\"\\n\"+ind+\"\\t\"+arr.join(\",\\n\"+ind+\"\\t\")+\"\\n\"+ind) : arr.join(\"\")) + \"}\";\r\n      }\r\n      else if (typeof(o) == \"string\")\r\n         json += (name&&\":\") + \"\\\"\" + o.toString() + \"\\\"\";\r\n      else\r\n         json += (name&&\":\") + o.toString();\r\n      return json;\r\n   },\r\n   innerXml: function(node) {\r\n      var s = \"\"\r\n      if (\"innerHTML\" in node)\r\n         s = node.innerHTML;\r\n      else {\r\n         var asXml = function(n) {\r\n            var s = \"\";\r\n            if (n.nodeType == 1) {\r\n               s += \"<\" + n.nodeName;\r\n               for (var i=0; i<n.attributes.length;i++)\r\n                  s += \" \" + n.attributes[i].nodeName + \"=\\\"\" + (n.attributes[i].nodeValue||\"\").toString() + \"\\\"\";\r\n               if (n.firstChild) {\r\n                  s += \">\";\r\n                  for (var c=n.firstChild; c; c=c.nextSibling)\r\n                     s += asXml(c);\r\n                  s += \"</\"+n.nodeName+\">\";\r\n               }\r\n               else\r\n                  s += \"/>\";\r\n            }\r\n            else if (n.nodeType == 3)\r\n               s += n.nodeValue;\r\n            else if (n.nodeType == 4)\r\n               s += \"<![CDATA[\" + n.nodeValue + \"]]>\";\r\n            return s;\r\n         };\r\n         for (var c=node.firstChild; c; c=c.nextSibling)\r\n            s += asXml(c);\r\n      }\r\n      return s;\r\n   },\r\n   escape: function(txt) {\r\n      return txt.replace(/[\\\\]/g, \"\\\\\\\\\")\r\n          .replace(/[\\\"]/g, '\\\\\"')\r\n          .replace(/[\\n]/g, '\\\\n')\r\n          .replace(/[\\r]/g, '\\\\r');\r\n   },\r\n   removeWhite: function(e) {\r\n      e.normalize();\r\n      for (var n = e.firstChild; n; ) {\r\n         if (n.nodeType == 3) {  // text node\r\n            if (!n.nodeValue.match(/[^ \\f\\n\\r\\t\\v]/)) { // pure whitespace text node\r\n               var nxt = n.nextSibling;\r\n               e.removeChild(n);\r\n               n = nxt;\r\n            }\r\n            else\r\n               n = n.nextSibling;\r\n         }\r\n         else if (n.nodeType == 1) {  // element node\r\n            X.removeWhite(n);\r\n            n = n.nextSibling;\r\n         }\r\n         else                      // any other node\r\n            n = n.nextSibling;\r\n      }\r\n      return e;\r\n   }\r\n};\r\nexport function xml2json(xml, tab = '    '/*XML_DOM, string*/) {\r\n   if (xml.nodeType == 9) // document node\r\n      xml = xml.documentElement;\r\n   var json = X.toJson(X.toObj(X.removeWhite(xml)), xml.nodeName, \"\\t\");\r\n   return \"{\\n\" + tab + (tab ? json.replace(/\\t/g, tab) : json.replace(/\\t|\\n/g, \"\")) + \"\\n}\";\r\n}\r\nexport function xml2jsonobj(xml, tab= '    '){\r\n   return X.toObj(X.removeWhite(xml));\r\n}\r\n// damiano: i needX.toObj(X.removeWhite(xml))\r\n","import React, {CSSProperties, ReactNode} from \"react\";\r\nimport type {\r\n    DEdge,\r\n    DGraph,\r\n    DGraphElement,\r\n    DModelElement,\r\n    DViewElement,\r\n    Json,\r\n    LGraph,\r\n    LGraphElement,\r\n    LModelElement,\r\n    LViewElement,\r\n    Pointer, PrimitiveType\r\n} from \"../../../joiner\";\r\nimport {LClass, LEdge, LUser, LViewPoint} from \"../../../joiner\";\r\nimport {InitialVertexSize} from \"../../../joiner/types\";\r\n\r\nexport class GraphElementStatee {/*\r\n    constructor(preRenderFunc: string | undefined, evalContext: GObject, templatefunc: () => React.ReactNode) {\r\n        this.preRenderFunc = preRenderFunc;\r\n        this.evalContext = evalContext;\r\n        this.template = templatefunc;\r\n    }\r\n    preRenderFunc?: string;\r\n    evalContext: Json;\r\n    template: () => ReactNode;* /\r\n    nodeid: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    constructor(nodeid: Pointer<DGraphElement, 1, 1, LGraphElement>) {\r\n        this.nodeid = nodeid;\r\n    }*/\r\n    // displayPosition?: GraphSize; // used while dragging to prevent flood of redux events\r\n    classes!: string[];\r\n}\r\n\r\n\r\nexport class GraphElementReduxStateProps {\r\n    // userexample?: UserState; // todo: make and repace with proxy wrapper \"User\", or make a \"cached\" global variable synchronized with redux state for easier access\r\n    view!: LViewElement;\r\n    views!: LViewElement[]; // all applicable views\r\n    // graphID!: string;\r\n    data?: LModelElement;\r\n    dataid?: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    // model?: LModel;\r\n    // [userMappedFromRedux: string]: any; // roba che l'utente ha dichiarato di voler prendere dallo stato e redux gli carica nelle props\r\n    preRenderFunc?: string;\r\n    evalContext!: Json;\r\n    template!: string;\r\n    node!: LGraphElement;\r\n    graph!: LGraph;\r\n\r\n    lastSelected!: LModelElement | null;\r\n    isEdgePending!: { user: LUser, source: LClass };// vertex only\r\n}\r\n\r\nexport class GraphElementDispatchProps {\r\n}\r\n\r\nexport class GraphElementOwnProps {\r\n    data?: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    view?:Pointer<DViewElement, 1, 1, LViewElement>; // | LViewElement\r\n    // generic props for every component that this component will need to extend joining user-specified values and component-specific built-in values\r\n    children?: any;\r\n    style?: CSSProperties;\r\n    'class'?: string | string[];\r\n    'className'?: string | string[];\r\n    key?: string;\r\n    parentnodeid?: Pointer<DGraphElement, 1, 1, LGraphElement>; // Injected\r\n    nodeid?: Pointer<DGraphElement, 1, 1, LGraphElement>; // Injected\r\n    graphid?: Pointer<DGraph, 1, 1, LGraph>; // injected\r\n    parentViewId?: Pointer<DViewElement, 1, 1, LViewElement>; // injected\r\n    htmlindex?: number; // injected\r\n    initialSize?: InitialVertexSize;\r\n}\r\n\r\nexport class EdgeOwnProps extends GraphElementOwnProps {\r\n    onclick?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n    onmousedown?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n    isGraph?: boolean = false;\r\n    isVertex?: boolean = true;\r\n    start!: LGraphElement[\"id\"];\r\n    end!: LGraphElement[\"id\"];\r\n    label?: DEdge[\"longestLabel\"];\r\n    labels?: DEdge[\"labels\"];\r\n    key?: string;\r\n}\r\n\r\nexport class EdgeStateProps extends GraphElementReduxStateProps {\r\n    node!: LEdge;\r\n    lastSelected!: LModelElement | null;\r\n    isEdgePending!: { user: LUser, source: LClass };\r\n    viewpoint!: LViewPoint;\r\n    start!: LGraphElement;\r\n    end!: LGraphElement;\r\n    // key: string;\r\n}\r\n","import {Mixin} from \"ts-mixer\";\r\nimport type {\r\n    DEdge,\r\n    DEdgePoint,\r\n    DExtEdge,\r\n    DGraph,\r\n    DGraphElement,\r\n    DGraphVertex,\r\n    DRefEdge,\r\n    DVertex,\r\n    DVoidEdge,\r\n    DVoidVertex,\r\n    LEdge,\r\n    LEdgePoint,\r\n    LExtEdge,\r\n    LGraph,\r\n    LGraphElement,\r\n    LGraphVertex,\r\n    LRefEdge,\r\n    LVertex,\r\n    LVoidEdge,\r\n    LVoidVertex,\r\n    WEdge,\r\n    WEdgePoint,\r\n    WExtEdge,\r\n    WGraph,\r\n    WGraphElement,\r\n    WGraphVertex,\r\n    WRefEdge,\r\n    WVertex,\r\n    WVoidEdge,\r\n    WVoidVertex\r\n} from \"../model/dataStructure\";\r\nimport type {Class, Longest} from \"ts-mixer/dist/types/types\";\r\nimport type {\r\n    DAnnotation,\r\n    DAttribute,\r\n    DClass,\r\n    DClassifier,\r\n    DDataType,\r\n    DEnumerator,\r\n    DEnumLiteral,\r\n    DMap,\r\n    DModel,\r\n    DModelElement,\r\n    DNamedElement,\r\n    DObject,\r\n    DOperation,\r\n    DPackage,\r\n    DParameter,\r\n    DReference,\r\n    DStructuralFeature,\r\n    DTypedElement,\r\n    DValue,\r\n    LAnnotation,\r\n    LAttribute,\r\n    LClass,\r\n    LClassifier,\r\n    LDataType,\r\n    LEnumerator,\r\n    LEnumLiteral,\r\n    LMap,\r\n    LModel,\r\n    LModelElement,\r\n    LNamedElement,\r\n    LObject,\r\n    LOperation,\r\n    LPackage,\r\n    LParameter,\r\n    LReference,\r\n    LStructuralFeature,\r\n    LTypedElement,\r\n    LValue,\r\n    WAnnotation,\r\n    WAttribute,\r\n    WClass,\r\n    WClassifier,\r\n    WDataType,\r\n    WEnumerator,\r\n    WEnumLiteral,\r\n    WMap,\r\n    WModel,\r\n    WModelElement,\r\n    WNamedElement,\r\n    WObject,\r\n    WOperation,\r\n    WPackage,\r\n    WParameter,\r\n    WReference,\r\n    WStructuralFeature,\r\n    WTypedElement,\r\n    WValue\r\n} from \"../model/logicWrapper\";\r\n// import type {Pointer} from \"./typeconverter\";\r\nimport type {\r\n    CClass, Constructor, Dictionary, DocString, GObject, InitialVertexSize,\r\n    InitialVertexSizeFunc, InitialVertexSizeObj, orArr, Proxyfied, unArr\r\n} from \"./types\";\r\nimport {EdgeBendingMode, EdgeGapMode, PrimitiveType} from \"./types\";\r\nimport type {\r\n    DViewElement,\r\n    DViewTransientProperties,\r\n    LViewElement,\r\n    LViewTransientProperties,\r\n    WViewElement,\r\n    WViewTransientProperties\r\n} from \"../view/viewElement/view\";\r\nimport type {LogicContext} from \"./proxy\";\r\nimport type {EdgeSegment, DState, EdgeFillSegment} from \"./index\";\r\nimport {\r\n    Action,\r\n    BEGIN,\r\n    CreateElementAction,\r\n    DeleteElementAction,\r\n    END,\r\n    GraphPoint,\r\n    GraphSize,\r\n    IPoint,\r\n    Log,\r\n    ParsedAction,\r\n    SetFieldAction,\r\n    SetRootFieldAction,\r\n    store,\r\n    U,\r\n} from \"./index\";\r\nimport TreeModel from \"tree-model\";\r\nimport {cssNumber} from \"jquery\";\r\n\r\nvar windoww = window as any;\r\n// qui dichiarazioni di tipi che non sono importabili con \"import type\", ma che devono essere davvero importate a run-time (eg. per fare un \"extend\", chiamare un costruttore o usare un metodo statico)\r\n\r\n\r\nconsole.warn('ts loading classes');\r\n\r\n\r\n// annotation @RuntimeAccessible\r\n// import {store} from \"../redux/createStore\";\r\n\r\n\r\nabstract class AbstractMixedClass {\r\n    // superclass!: Dictionary<DocString<'parent class name', Class>>;\r\n    static logic: typeof LPointerTargetable;\r\n    static structure: typeof DPointerTargetable;\r\n    static singleton: LPointerTargetable;\r\n    // static [key: string]: any;\r\n    static init_constructor(...constructorArguments: any): void{}\r\n}\r\n\r\nexport abstract class RuntimeAccessibleClass extends AbstractMixedClass {\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static extendTree: TreeModel.Node<typeof RuntimeAccessibleClass>// Tree<string, typeof RuntimeAccessibleClass>;\r\n    // static name: never; // it breaks with minification, don't use it\r\n    static cname: string;\r\n\r\n    static set_extend(superclass: typeof RuntimeAccessibleClass, subclass: typeof RuntimeAccessibleClass): void{\r\n        if (!superclass.hasOwnProperty(\"subclasses\")) superclass.subclasses = [subclass];\r\n        else if (superclass.subclasses.indexOf(subclass) === -1) superclass.subclasses.push(subclass);\r\n        if (!subclass.hasOwnProperty(\"_extends\")) subclass._extends = [superclass];\r\n        else if (subclass._extends.indexOf(superclass) === -1) subclass._extends.push(superclass);\r\n    }\r\n\r\n    static extendPrototypes(){\r\n        (Array.prototype as any).contains = function (o:any): boolean{\r\n            return this.indexOf(o) !== -1;\r\n        };\r\n        (Array.prototype as any).joinOriginal = Array.prototype.join;\r\n        (Array.prototype as any).separator = function(...separators: any[]/*: orArr<(PrimitiveType | null | undefined | JSX.Element)[]>*/): (string|JSX.Element)[]{\r\n            if (Array.isArray(separators[0])) separators = separators[0]; // case .join([1,2,3])  --> .join(1, 2, 3)\r\n            // console.log(\"separators debug\", this, separators, this[0], typeof this[0]);\r\n            if (typeof this[0] !== \"object\") return (this as any).joinOriginal(separators);\r\n            // if JSX\r\n            // it handles empty cells like it handles '', but this is how native .join() handles them too: [emptyx5, \"a\", emptyx1, \"b\"].join(\",\") ->  ,,,,,a,,b\r\n            let ret/*:JSX.Element[]*/ = [];\r\n            for (let i = 0; i < this.length; i++){\r\n                if (i === 0) {ret.push(this[i]); continue;}\r\n                ret.push(...separators);\r\n                ret.push(this[i]);\r\n            }\r\n            return ret;\r\n        }\r\n    }\r\n    static fixStatics() {\r\n        this.extendPrototypes();\r\n        // problem: se lo statico è un valore primitivo ne genera una copia.\r\n        for (let classs of Object.values(RuntimeAccessibleClass.annotatedClasses)) {\r\n            let gclass = classs as GObject;\r\n            for (let statickey in gclass.s) { gclass[statickey] = gclass.s[statickey]; }\r\n        }\r\n    }\r\n    // static allRuntimeClasses: string[] = [];\r\n    static classes: Dictionary<string, typeof RuntimeAccessibleClass> = {};\r\n    static annotatedClasses: Dictionary<string, typeof RuntimeAccessibleClass> = {};\r\n\r\n    static getAllNames(annotated = false): string[] {\r\n        return Object.keys(annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes); }\r\n    static getAllClasses(annotated = false): typeof RuntimeAccessibleClass[] {\r\n        return Object.values(annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes); }\r\n    static getAllClassesDictionary(annotated = false): Dictionary<string, typeof RuntimeAccessibleClass> {\r\n        return annotated ? RuntimeAccessibleClass.annotatedClasses : RuntimeAccessibleClass.classes; }\r\n\r\n    static wrapAll<D extends RuntimeAccessibleClass, L extends LPointerTargetable = LPointerTargetable, CAN_THROW extends boolean = false,\r\n        RET extends CAN_THROW extends true ? L[] : L[] = CAN_THROW extends true ? L[] : L[] >\r\n    (data: D[] | Pointer<DPointerTargetable, 0, 'N'>, baseObjInLookup?: DPointerTargetable, path: string = '', canThrow: CAN_THROW = false as CAN_THROW, state?: DState): CAN_THROW extends true ? L[] : L[] {\r\n        if (!Array.isArray(data)) return [];\r\n        return data.map( d => DPointerTargetable.wrap(d, baseObjInLookup, path, canThrow, state)) as L[];\r\n    }\r\n\r\n    static wrap<D extends RuntimeAccessibleClass, L extends LPointerTargetable = LPointerTargetable, CAN_THROW extends boolean = false,\r\n        RET extends CAN_THROW extends true ? L : L | undefined = CAN_THROW extends true ? L : L | undefined>\r\n    (data: D | Pointer | undefined | null, baseObjInLookup?: DPointerTargetable, path: string = '', canThrow: CAN_THROW = false as CAN_THROW, state?: DState): CAN_THROW extends true ? L : L | undefined{\r\n        if (!data || (data as any).__isProxy) return data as any;\r\n        if (typeof data === 'string') {\r\n            if (!state) state = windoww.store.getState() as DState;\r\n            data = state.idlookup[data] as unknown as D;\r\n            if (!data) {\r\n                if (canThrow) return windoww.Log.exx('Cannot wrap:', {data, baseObjInLookup, path});\r\n                else return undefined as RET;\r\n            }\r\n        }\r\n        if (Array.isArray(data)) { console.error('use WrapAll instead for arrays', {data, baseObjInLookup, path, canThrow}); throw new Error(\"use WrapAll instead for arrays\"); }\r\n        if (!data) return data;\r\n        // console.log('ProxyWrapping:', {data, baseObjInLookup, path});\r\n        return new Proxy(data, new windoww.TargetableProxyHandler(data, baseObjInLookup, path)) as L;\r\n    }\r\n    /*\r\n        static mapWrap2<D extends DPointerTargetable, L extends LPointerTargetable>(map: RuntimeAccessibleClass, container: D, baseObjInLookup?: DPointerTargetable, path: string = ''): L{\r\n            if (!map || (map as any).__isProxy) return map as any;\r\n            if (typeof container === 'string') {\r\n                container = store.getState().idlookup[container] as unknown as D;\r\n                if (!container) { return Log.exx('Cannot wrap map:', {map, container, baseObjInLookup, path}); }\r\n            }\r\n            // console.log('ProxyWrapping:', {data, baseObjInLookup, path});\r\n            return new Proxy(map, new MapProxyHandler(map, baseObjInLookup, path));\r\n        }\r\n\r\n    */\r\n\r\n    static mapWrap(data: Dictionary, baseObjInLookup: DPointerTargetable, path: string, subMapKeys: string[] = []): Proxyfied<Dictionary> {\r\n        if (!data || (data as any).__isProxy) return data as any;\r\n        // console.error('GETMAP', {data, logicContext, path});\r\n        return new Proxy(data, new windoww.MapProxyHandler(data, baseObjInLookup, path));\r\n    }\r\n\r\n    className!: string;\r\n    protected constructor(...a:any) {\r\n        super();\r\n        // RuntimeAccessibleClass.init_constructor(this, ...a);\r\n        // this.className = this.constructor.name;\r\n        // nb: per i mixin questo settaggio viene sovrascritto. perchè il mixin crea le 2 classi ereditate separatamente con i loro costruttori e le incrocia. quindi devo settarlo dall'annotazione @ tramite prototype\r\n        // RuntimeAccessibleClass.allRuntimeClasses.push(this.className);\r\n    }\r\n\r\n    static init_constructor(thiss: any, ...args: any): void {\r\n\r\n        // this.className = this.constructor.name;\r\n        // let finalObject = this;\r\n        // if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") { let breakp = true; }\r\n        // this.init0(...arguments);\r\n        // thiss.className = this.name;\r\n    }\r\n\r\n    public static get<T extends typeof RuntimeAccessibleClass = typeof RuntimeAccessibleClass>(dclassname: string, annotated = false)\r\n        : T & {logic?: typeof LPointerTargetable} { return (annotated ? RuntimeAccessibleClass.annotatedClasses : this.classes)[dclassname] as any; }\r\n\r\n    public static extends(className?: string | typeof RuntimeAccessibleClass, superClassName?: string| typeof RuntimeAccessibleClass, returnIfEqual: boolean = true): boolean {\r\n        if (!className || !superClassName) return false;\r\n        const superclass = typeof superClassName === \"string\" ? RuntimeAccessibleClass.get(superClassName) : superClassName;\r\n        const thisclass = typeof className === \"string\" ? RuntimeAccessibleClass.get(className) : className;\r\n        if (!superclass || !thisclass) return false;\r\n        //console.trace(\"extends.1:\", {thisclass, superclass});\r\n        // console.log(\"extends.2:\", {iof:(thisclass instanceof superclass),\r\n        //     tree: !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)?.first((node) => node.model === thisclass))});\r\n        if (superclass === thisclass) return returnIfEqual;\r\n        // for (let aaa in RuntimeAccessibleClass.extendTree.find(superClassName)) { }\r\n\r\n        return (thisclass instanceof superclass)\r\n            ||\r\n            !!(RuntimeAccessibleClass.extendTree.first((node) => node.model === superclass)\r\n                ?.first((node) => node.model === thisclass))\r\n            ;// || true; // todo:noes not work with constructors\r\n    }\r\n\r\n    getAllPrototypeSuperClasses(): GObject[] {\r\n        let currentlevel = this;\r\n        let ret: GObject[] = [];\r\n        while (true) {\r\n            if (!currentlevel) break;\r\n            ret.push(currentlevel);\r\n            // @ts-ignore\r\n            currentlevel = currentlevel.__proto__;\r\n        }\r\n        console.log('constructor chain:', ret);\r\n        return ret;\r\n    }\r\n    /*initBase(){\r\n        let superclasses = this.getAllPrototypeSuperClasses();\r\n        for (let sc of superclasses) {\r\n            if (!sc.hasOwnProperty('init0')) continue;\r\n            console.log('initbase calling ', {thiss: this, sc, init0: sc.init0, args:sc.constructorArguments});\r\n            sc.init0.apply(this, ...(sc.constructorArguments || []));\r\n        }\r\n    }*/\r\n    // protected abstract init(...constructorParameters: any): void;\r\n    // NB: per colpa della limitazione #3 di ts-mixer,\r\n    // DEVO chiamare init su ogni oggetto per settargli il corretto this.className, altrimenti prende quello dell'ultima superclasse\r\n    /*protected init0(...constructorParameters: any): void {\r\n        let a = this;\r\n        let finalObject = this;\r\n        console.log('creation of___ ', {thiss: this, finalObject});\r\n        if (finalObject.constructor.name === \"DVoidVertex\" || finalObject.constructor.name === \"DGraphElement\") {\r\n            let breakp = true; }\r\n\r\n        (window as any)[finalObject.constructor.name] =\r\n            RuntimeAccessibleClass.classes[finalObject.constructor.name] = finalObject.constructor as any;\r\n        // @ts-ignore\r\n        // delete this.className;\r\n        this.className = (finalObject as any).__proto__.className;\r\n    }*/\r\n\r\n}\r\nexport function Obsolete<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Leaf<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Node<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Abstract<T extends any>( constructor: T & GObject): T { return constructor; }\r\nexport function Instantiable<T extends any>(constructor: T & GObject, instanceConstructor?: Constructor): T { return constructor; } // for m2 cklasses that have m1 instances\r\nexport function RuntimeAccessible<T extends any>(constructor: T & GObject): T {\r\n    // console.log('DecoratorTest', {constructor, arguments});\r\n    let predebug = {...RuntimeAccessibleClass.classes};\r\n    // @ts-ignore\r\n    RuntimeAccessibleClass.classes[constructor.cname] = constructor as any as typeof RuntimeAccessibleClass;\r\n    console.log(\"setting runtime accessible\", {key: constructor.cname, constructor, pre: predebug, post: {...RuntimeAccessibleClass.classes}});\r\n    if (!window[constructor.cname]) (window[constructor.cname] as any) = constructor;\r\n    constructor.prototype.className = constructor.cname;\r\n    //constructor.prototype.$$typeof = constructor.cname;\r\n    //constructor.prototype.typeName = constructor.cname;\r\n    (constructor as any).staticClassName = constructor.cname;\r\n    // @ts-ignore\r\n    // console.log('runtimeaccessible annotation:', {thiss:this, constructor});\r\n    //    const classnameFixedConstructor = constructor; //  function (...args) { let obj = new constructor(...args); obj.init?.(); obj.init0?.(); return obj; }\r\n\r\n    // @ts-ignore\r\n    let outerthis = this;\r\n    // @ts-ignore\r\n    const classnameFixedConstructorDoNotRenameWithoutSearchStrings = function (...args) {\r\n        // @ts-ignore\r\n        // console.log('runtimeaccessible annotation inner:', {thiss:this, outerthis, constructor});\r\n        // @ts-ignore\r\n        let obj = new constructor(...args);\r\n        obj.classNameFromAnnotation = constructor.cname;\r\n        obj.className = constructor.cname;\r\n        //obj.prototype.$$typeof = constructor.name;\r\n        // obj.prototype.typeName = constructor.name;\r\n        // obj.init?.();\r\n        // obj.init0?.();\r\n        obj.initBase?.();\r\n        // @ts-ignore\r\n        // console.log('runtimeaccessible annotation inner end:', {thiss:this, outerthis, constructor, obj});\r\n        return obj; }\r\n    RuntimeAccessibleClass.annotatedClasses[constructor.cname] = classnameFixedConstructorDoNotRenameWithoutSearchStrings as any as typeof RuntimeAccessibleClass;\r\n\r\n    for (let key in constructor) (classnameFixedConstructorDoNotRenameWithoutSearchStrings as GObject)[key] = constructor[key];\r\n    // constructor.constructor = classnameFixedConstructorDoNotRenameWithoutSearchStrings; return constructor;\r\n\r\n    // @ts-ignore\r\n    // for (let staticKey of constructor as GObject) { classnameFixedConstructorDoNotRenameWithoutSearchStrings[staticKey] = constructor[staticKey]; }\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype = constructor.prototype;\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.prototype.constructor = constructor.prototype.constructor;\r\n\r\n    // required for inheriting static methods\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.__proto__ = constructor.__proto__;\r\n    classnameFixedConstructorDoNotRenameWithoutSearchStrings.s = constructor;\r\n    // return classnameFixedConstructorDoNotRenameWithoutSearchStrings as any;\r\n    return constructor;\r\n}\r\n\r\n\r\n(window as any).RuntimeAccessibleClass = RuntimeAccessibleClass;\r\n// todo: problema: per creare un PointerTargetable ho bisogno dell'userid, e devo generarlo prima che venga generato l'initialState... dovrebbe venir servito con la pagina dal server. o passato come navigation props dalla pagina di login\r\n\r\n\r\n\r\nexport type DtoL<DX extends GObject, LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = LX;\r\nexport type DtoW<DX extends GObject, WX = DX extends DEnumerator ? WEnumerator : (DX extends DAttribute ? WAttribute : (DX extends DReference ? WReference : (DX extends DRefEdge ? WRefEdge : (DX extends DExtEdge ? WExtEdge : (DX extends DDataType ? WDataType : (DX extends DClass ? WClass : (DX extends DStructuralFeature ? WStructuralFeature : (DX extends DParameter ? WParameter : (DX extends DOperation ? WOperation : (DX extends DEdge ? WEdge : (DX extends DEdgePoint ? WEdgePoint : (DX extends DGraphVertex ? WGraphVertex : (DX extends DModel ? WModel : (DX extends DValue ? WValue : (DX extends DObject ? WObject : (DX extends DEnumLiteral ? WEnumLiteral : (DX extends DPackage ? WPackage : (DX extends DClassifier ? WClassifier : (DX extends DTypedElement ? WTypedElement : (DX extends DVertex ? WVertex : (DX extends DVoidEdge ? WVoidEdge : (DX extends DVoidVertex ? WVoidVertex : (DX extends DGraph ? WGraph : (DX extends DNamedElement ? WNamedElement : (DX extends DAnnotation ? WAnnotation : (DX extends DGraphElement ? WGraphElement : (DX extends DMap ? WMap : (DX extends DModelElement ? WModelElement : (DX extends DUser ? WUser : (DX extends DPointerTargetable ? WPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = WX;\r\n// export type DtoW<DX extends GObject, WX = Omit<DtoW0<DX>, 'id'>> = WX;\r\nexport type LtoD<LX extends LPointerTargetable, DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LRefEdge ? DRefEdge : (LX extends LExtEdge ? DExtEdge : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LEdge ? DEdge : (LX extends LEdgePoint ? DEdgePoint : (LX extends LGraphVertex ? DGraphVertex : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LVertex ? DVertex : (LX extends LVoidEdge ? DVoidEdge : (LX extends LVoidVertex ? DVoidVertex : (LX extends LGraph ? DGraph : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : (LX extends LGraphElement ? DGraphElement : (LX extends LMap ? DMap : (LX extends LModelElement ? DModelElement : (LX extends LUser ? DUser : (LX extends LPointerTargetable ? DPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = DX;\r\nexport type LtoW<LX extends LPointerTargetable, WX = LX extends LEnumerator ? WEnumerator : (LX extends LAttribute ? WAttribute : (LX extends LReference ? WReference : (LX extends LRefEdge ? WRefEdge : (LX extends LExtEdge ? WExtEdge : (LX extends LDataType ? WDataType : (LX extends LClass ? WClass : (LX extends LStructuralFeature ? WStructuralFeature : (LX extends LParameter ? WParameter : (LX extends LOperation ? WOperation : (LX extends LEdge ? WEdge : (LX extends LEdgePoint ? WEdgePoint : (LX extends LGraphVertex ? WGraphVertex : (LX extends LModel ? WModel : (LX extends LValue ? WValue : (LX extends LObject ? WObject : (LX extends LEnumLiteral ? WEnumLiteral : (LX extends LPackage ? WPackage : (LX extends LClassifier ? WClassifier : (LX extends LTypedElement ? WTypedElement : (LX extends LVertex ? WVertex : (LX extends LVoidEdge ? WVoidEdge : (LX extends LVoidVertex ? WVoidVertex : (LX extends LGraph ? WGraph : (LX extends LNamedElement ? WNamedElement : (LX extends LAnnotation ? WAnnotation : (LX extends LGraphElement ? WGraphElement : (LX extends LMap ? WMap : (LX extends LModelElement ? WModelElement : (LX extends LUser ? WUser : (LX extends LPointerTargetable ? WPointerTargetable : (ERROR)))))))))))))))))))))))))))))))> = WX;\r\nexport type WtoD<IN extends WPointerTargetable, OUT = IN extends WEnumerator ? DEnumerator : (IN extends WAttribute ? DAttribute : (IN extends WReference ? DReference : (IN extends WRefEdge ? DRefEdge : (IN extends WExtEdge ? DExtEdge : (IN extends WDataType ? DDataType : (IN extends WClass ? DClass : (IN extends WStructuralFeature ? DStructuralFeature : (IN extends WParameter ? DParameter : (IN extends WOperation ? DOperation : (IN extends WEdge ? DEdge : (IN extends WEdgePoint ? DEdgePoint : (IN extends WGraphVertex ? DGraphVertex : (IN extends WModel ? DModel : (IN extends WValue ? DValue : (IN extends WObject ? DObject : (IN extends WEnumLiteral ? DEnumLiteral : (IN extends WPackage ? DPackage : (IN extends WClassifier ? DClassifier : (IN extends WTypedElement ? DTypedElement : (IN extends WVertex ? DVertex : (IN extends WVoidEdge ? DVoidEdge : (IN extends WVoidVertex ? DVoidVertex : (IN extends WGraph ? DGraph : (IN extends WNamedElement ? DNamedElement : (IN extends WAnnotation ? DAnnotation : (IN extends WGraphElement ? DGraphElement : (IN extends WMap ? DMap : (IN extends WModelElement ? DModelElement : (IN extends WUser ? DUser : (IN extends WPointerTargetable ? DPointerTargetable : (IN extends WViewElement ? DViewElement : (IN extends WViewTransientProperties ? DViewTransientProperties : (ERROR)))))))))))))))))))))))))))))))))> = OUT;\r\nexport type WtoL<IN extends WPointerTargetable, OUT = IN extends WEnumerator ? LEnumerator : (IN extends WAttribute ? LAttribute : (IN extends WReference ? LReference : (IN extends WRefEdge ? LRefEdge : (IN extends WExtEdge ? LExtEdge : (IN extends WDataType ? LDataType : (IN extends WClass ? LClass : (IN extends WStructuralFeature ? LStructuralFeature : (IN extends WParameter ? LParameter : (IN extends WOperation ? LOperation : (IN extends WEdge ? LEdge : (IN extends WEdgePoint ? LEdgePoint : (IN extends WGraphVertex ? LGraphVertex : (IN extends WModel ? LModel : (IN extends WValue ? LValue : (IN extends WObject ? LObject : (IN extends WEnumLiteral ? LEnumLiteral : (IN extends WPackage ? LPackage : (IN extends WClassifier ? LClassifier : (IN extends WTypedElement ? LTypedElement : (IN extends WVertex ? LVertex : (IN extends WVoidEdge ? LVoidEdge : (IN extends WVoidVertex ? LVoidVertex : (IN extends WGraph ? LGraph : (IN extends WNamedElement ? LNamedElement : (IN extends WAnnotation ? LAnnotation : (IN extends WGraphElement ? LGraphElement : (IN extends WMap ? LMap : (IN extends WModelElement ? LModelElement : (IN extends WUser ? LUser : (IN extends WPointerTargetable ? LPointerTargetable : (IN extends WViewElement ? LViewElement : (IN extends WViewTransientProperties ? LViewTransientProperties : (ERROR)))))))))))))))))))))))))))))))))> = OUT;\r\nexport type labelfunc = (e:LVoidEdge, segment: EdgeSegment, allNodes: LEdge[\"allNodes\"], allSegments: EdgeSegment[]) => PrimitiveType;\r\nexport enum CoordinateMode {\r\n    \"absolute\"              = \"absolute\",\r\n    \"relativePercent\"       = \"relative%\",\r\n    \"relativeOffset\"        = \"relativeOffset\",\r\n    \"relativeOffsetStart\"   = \"relativeOffsetStart\",\r\n    \"relativeOffsetEnd\"     = \"relativeOffsetEnd\",\r\n}\r\n\r\nexport enum EdgeHead {\r\n    composition = \"EdgeComposition\",\r\n    aggregation = \"EdgeAggregation\",\r\n    reference   = \"EdgeReference\",\r\n    extend      = \"EdgeExtend\"\r\n}\r\n\r\n\r\n\r\nlet canFireActions: boolean = true;\r\n@RuntimeAccessible\r\nexport class Constructors<T extends DPointerTargetable>{\r\n    public static cname: string = \"Constructors\";\r\n    private thiss: T;\r\n    private persist: boolean;\r\n    private callbacks: Function[];\r\n    fatherType?: typeof RuntimeAccessibleClass;\r\n    constructor(t:T, father?: Pointer, persist: boolean = true, fatherType?: Constructor) {\r\n        persist = persist && canFireActions;\r\n        this.thiss = t;\r\n        this.persist = persist;\r\n        this.callbacks = [];\r\n        if (this.thiss.hasOwnProperty(\"father\")) {\r\n            (this.thiss as any).father = father;\r\n            persist && father && SetFieldAction.new(father, \"pointedBy\", PointedBy.fromID(t.id, \"father\" as any), '+=');\r\n        }\r\n        this.fatherType = fatherType as any;\r\n        if (this.persist) BEGIN()\r\n    }\r\n\r\n    static pause(): void { canFireActions = false; }\r\n    static resume(): void { canFireActions = true; }\r\n    // start(thiss: any): this { this.thiss = thiss; return this; }\r\n    end(simpledatacallback?: (d:T) => void): T {\r\n        console.log(\"doing callbacks\", this.callbacks, this);\r\n        if (simpledatacallback) simpledatacallback(this.thiss); // callback for setting primitive types, not pointers not context-dependant values (name being potentially invalid / chosen according to parent)\r\n        if (!this.persist) return this.thiss;\r\n        if (this.callbacks.length) {\r\n            setTimeout(() => {for (let cb of this.callbacks) cb();}, 0);\r\n        }\r\n        Log.ex(windoww.ddebug, \"stop\");\r\n        DPointerTargetable.pendingCreation[this.thiss.id] = this.thiss; // todo: removable?\r\n        END([CreateElementAction.new(this.thiss, true)])\r\n        /// todo: warning: there is a begin and end at constructor and end() methods, do not use BEGIN+END/TRANSACTION inside\r\n        return this.thiss; }\r\n\r\n\r\n    DState(): this {\r\n        let thiss: DState = this.thiss as any;\r\n        // todo: this must become a pointer to idlookup and fire a CreateNewElementAction\r\n        thiss.currentUser = DUser.new(undefined, false);\r\n        thiss.users = [thiss.currentUser.id];\r\n        thiss.models = [];\r\n        return this; }\r\n\r\n    DModelElement(): this { return this; }\r\n    DClassifier(): this { return this; }\r\n    DParameter(defaultValue?: any): this {\r\n        let thiss: DParameter = this.thiss as any;\r\n        thiss.defaultValue = defaultValue;\r\n        this.persist && thiss.father && SetFieldAction.new(thiss.father, \"parameters\", thiss.id, '+=', true);\r\n        return this; }\r\n    DStructuralFeature(): this {\r\n        if (this.thiss.className === 'DOperation') return this;\r\n        if (!this.persist) return this;\r\n        let thiss: DAttribute|DReference = this.thiss as any;\r\n        const _DClass: typeof DClass = windoww.DClass;\r\n        const _DValue: typeof DValue = windoww.DValue;\r\n\r\n\r\n        let targets: DClass[] = [_DClass.fromPointer(thiss.father)];\r\n        let alreadyParsed: Dictionary<Pointer, DClass> = {};\r\n        while(targets.length) {\r\n            let nextTargets = [];\r\n            for (let target of targets) {\r\n                if (alreadyParsed[target.id]) continue;\r\n                alreadyParsed[target.id] = target;\r\n                for(let ext of target.extendedBy) nextTargets.push(_DClass.fromPointer(ext));\r\n            }\r\n            targets = nextTargets;\r\n        }\r\n        this.persist && this.callbacks.push(()=>{\r\n            for(let pointer in alreadyParsed) {\r\n                for (let instance of alreadyParsed[pointer].instances) {\r\n                    _DValue.new(thiss.name, thiss.id, undefined, instance);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        return this;\r\n    }\r\n    DReference(): this {\r\n        let thiss: DReference = this.thiss as any;\r\n        // update father's collections (pointedby's here are set automatically)\r\n        this.persist && thiss.father && SetFieldAction.new(thiss.father, \"references\", thiss.id, '+=', true);\r\n        return this;\r\n    }\r\n    DAttribute(): this {\r\n        let thiss: DAttribute = this.thiss as any;\r\n        // update father's collections (pointedby's here are set automatically)\r\n        this.persist && thiss.father && SetFieldAction.new(thiss.father, \"attributes\", thiss.id, '+=', true);\r\n        return this; }\r\n    DDataType(): this { return this; }\r\n    DObject(instanceoff?: DObject[\"instanceof\"]): this {\r\n        let thiss: DObject = this.thiss as any;\r\n\r\n        if (this.persist && thiss.father) {\r\n            if (this.fatherType!.cname === \"DModel\") {\r\n                this.persist && thiss.father && SetFieldAction.new(thiss.father as Pointer<DModel>, \"objects\", thiss.id, '+=', true);\r\n            }\r\n            else {\r\n                // object containing object is not in any direct child collection. access through values\r\n                // this.persist && thiss.father && SetFieldAction.new(thiss.father as Pointer<DObject>, \"subpackages\", thiss.id, '+=', true);\r\n            }\r\n        }\r\n\r\n        if (this.persist && instanceoff) this.callbacks.push( () => {\r\n            (LPointerTargetable.wrap(thiss) as LObject).instanceof = instanceoff as any;\r\n        })\r\n        else thiss.instanceof = instanceoff || null;\r\n        //old ver: this.persist && instanceoff && SetFieldAction.new(thiss.id, \"instanceof\", instanceoff, undefined, true);\r\n        // update father's collections (pointedby's here are set automatically)\r\n        // this.persist && instanceoff && SetFieldAction.new(instanceoff, \"instances\", thiss.id, '+=', true);\r\n\r\n        return this; }\r\n\r\n    DValue(instanceoff?: DValue[\"instanceof\"], val?: DValue[\"values\"], isMirage?: DValue[\"isMirage\"]): this {\r\n        let thiss: DValue = this.thiss as any; thiss.edges = [];\r\n        thiss.values = val || [];\r\n        thiss.instanceof = instanceoff;\r\n        thiss.isMirage = isMirage || false;\r\n\r\n        // update father's collections (pointedby's here are set automatically)\r\n        if (this.persist && instanceoff) {\r\n            SetFieldAction.new(thiss.id, \"instanceof\", instanceoff, undefined, true);\r\n            SetFieldAction.new(instanceoff as Pointer<DAttribute>, \"instances\", thiss.id, '+=', true);\r\n        }\r\n        else thiss.instanceof = instanceoff;\r\n        this.persist && thiss.father && SetFieldAction.new(thiss.father, \"features\", thiss.id, '+=', true);\r\n        return this; }\r\n\r\n    DAnnotation(source?: DAnnotation[\"source\"], details?: DAnnotation[\"details\"]): this {\r\n        const thiss: DAnnotation = this.thiss as any;\r\n        thiss.source = source || '';\r\n        thiss.details = details || [];\r\n        if (this.persist && details) {\r\n            //BEGIN() Constructors is always already inside a transaction\r\n            for (let det of details) SetFieldAction.new(det, \"pointedBy\", PointedBy.fromID(thiss.id, \"details\"), '+=');\r\n            // update father's collections (pointedby's here are set automatically)\r\n            this.persist && thiss.father && SetFieldAction.new(thiss.father, \"annotations\", thiss.id, '+=', true);\r\n            //END()\r\n        }\r\n        return this; }\r\n\r\n    static makeID(): Pointer{ return new Date().getTime() + \"_\" + DUser.current + \"_\" + (DPointerTargetable.maxID++) }\r\n    DPointerTargetable(isUser: boolean = false, id?: string): this {\r\n        const thiss: DPointerTargetable = this.thiss as any;\r\n        thiss.id = id || Constructors.makeID();\r\n        console.log(\"DPointerTargetable id\", {id, tid: thiss.id})\r\n\r\n        thiss.className = (thiss.constructor as typeof RuntimeAccessibleClass).cname;\r\n        // this.className = thiss.className;\r\n        if (this.persist) {\r\n            // no pointedBy\r\n        }\r\n        return this; }\r\n\r\n    DUser(id?: DUser[\"id\"]): this {\r\n        const thiss: DPointerTargetable = this.thiss as any;\r\n        thiss.id = id ||  new Date().getTime() + '_USER_' + (DPointerTargetable.maxID++);\r\n        if (this.persist) {\r\n            // no pointedBy\r\n        }\r\n        return this; }\r\n\r\n    DNamedElement(name?: DNamedElement[\"name\"]): this {\r\n        const thiss: DNamedElement = this.thiss as any;\r\n        thiss.name = (name !== undefined) ? name || '' : thiss.constructor.name.substring(1) + \" 1\";\r\n        if (this.persist) {\r\n            // no pointedBy\r\n        }\r\n        return this; }\r\n\r\n    DTypedElement(type?: DTypedElement[\"type\"]): this {\r\n        const thiss: DTypedElement = this.thiss as any;\r\n        thiss.type = type as Pointer<DClassifier, 1, 1, LClassifier>;\r\n        if (this.persist) {\r\n            type && SetFieldAction.new(type, \"pointedBy\", PointedBy.fromID(thiss.id, \"type\"), '+=');\r\n        }\r\n        return this; }\r\n\r\n    DPackage(uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"]): this {\r\n        const thiss: DPackage = this.thiss as any;\r\n        thiss.uri = uri || '';// || 'org.jodel-react.username';\r\n        thiss.prefix = prefix || '';\r\n        if (this.persist) {\r\n            // no pointedBy\r\n            // update father's collections (pointedby's here are set automatically)\r\n            if (this.persist && thiss.father) {\r\n                if (this.fatherType!.cname === \"DModel\") {\r\n                    this.persist && thiss.father && SetFieldAction.new(thiss.father as Pointer<DModel>, \"packages\", thiss.id, '+=', true);\r\n                }\r\n                else {\r\n                    this.persist && thiss.father && SetFieldAction.new(thiss.father as Pointer<DPackage>, \"subpackages\", thiss.id, '+=', true);\r\n                }\r\n            }\r\n        }\r\n        return this; }\r\n\r\n    DModel(instanceoff?: DModel[\"instanceof\"], isMetamodel?: DModel[\"isMetamodel\"]): this {\r\n        const thiss: DModel = this.thiss as any;\r\n        thiss.packages = []; // packages;\r\n        thiss.instanceof = instanceoff || null;\r\n        thiss.isMetamodel = isMetamodel || false;\r\n        if (this.persist) {\r\n            if (instanceoff) SetFieldAction.new(instanceoff, \"pointedBy\", PointedBy.fromID(thiss.id, \"instanceof\"), '+=');\r\n            // instanceoff && SetFieldAction.new(instanceoff, 'models', thiss.id, '+=', true);\r\n            SetRootFieldAction.new(isMetamodel ? \"m2models\" : \"m1models\", thiss.id, \"+=\", true);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    DOperation(exceptions: DOperation[\"exceptions\"] = [], implementation?: string/*, parameters: DOperation[\"parameters\"] = []*/): this {\r\n        const thiss: DOperation = this.thiss as any;\r\n        // thiss.parameters = parameters;\r\n        thiss.implementation = implementation || 'return \"default placeholder function called\";'\r\n        thiss.exceptions = exceptions;\r\n        if (this.persist) {\r\n            //BEGIN()\r\n            // if (parameters) for (let par of parameters) SetFieldAction.new(par, \"pointedBy\", PointedBy.fromID(thiss.id, \"parameters\"), '+=');\r\n            if (exceptions) for (let exc of exceptions) SetFieldAction.new(exc, \"pointedBy\", PointedBy.fromID(thiss.id, \"exceptions\"), '+=');\r\n            // update father's collections (pointedby's here are set automatically)\r\n            this.persist && thiss.father && SetFieldAction.new(thiss.father, \"operations\", thiss.id, '+=', true);\r\n            //END()\r\n        }\r\n        return this; }\r\n\r\n    DClass(isInterface: DClass[\"interface\"] = false, isAbstract: DClass[\"abstract\"] = false, isPrimitive: LClassifier[\"isPrimitive\"] = false,\r\n           partial: DClass[\"partial\"] = false, partialdefaultname: DClass[\"partialdefaultname\"] = ''): this {\r\n        const thiss: DClass = this.thiss as any;\r\n        thiss.interface = isInterface;\r\n        thiss.abstract = isAbstract;\r\n        thiss.isPrimitive = isPrimitive;\r\n        thiss.partial = partial;\r\n        thiss.partialdefaultname = partialdefaultname;\r\n        // thiss.isClass = !isPrimitive;\r\n        // thiss.isEnum = false;\r\n\r\n        if (this.persist) {\r\n            // no pointedBy\r\n            // update father's collections (pointedby's here are set automatically)\r\n            this.persist && thiss.father && SetFieldAction.new(thiss.father, \"classifiers\", thiss.id, '+=', true);\r\n        }\r\n        return this; }\r\n\r\n    DEnumLiteral(value?: DEnumLiteral[\"value\"]): this { // vv4\r\n        const thiss: DEnumLiteral = this.thiss as any;\r\n        thiss.value = value as any; // undef is ok, handled in getter as automatic ordinal index\r\n        thiss.literal = thiss.name;\r\n        if (this.persist) {\r\n            // no pointedBy?\r\n            // update father's collections (pointedby's here are set automatically)\r\n            this.persist && thiss.father && SetFieldAction.new(thiss.father, \"literals\", thiss.id, '+=', true);\r\n        }\r\n        return this; }\r\n\r\n    DEnumerator(/*set it from DLiteral.new() instead literals: DEnumerator[\"literals\"] = []*/): this {\r\n        const thiss: DEnumerator = this.thiss as any;\r\n        // thiss.literals = literals;\r\n        // thiss.isClass = false;\r\n        // thiss.isEnum = true;\r\n        if (this.persist) {\r\n            // if (literals) for (let lit of literals) SetFieldAction.new(lit, \"pointedBy\", PointedBy.fromID(thiss.id, \"literals\"), '+=');\r\n            // update father's collections (pointedby's here are set automatically)\r\n            this.persist && thiss.father && SetFieldAction.new(thiss.father, \"classifiers\", thiss.id, '+=', true);\r\n        }\r\n        return this; }\r\n    DEdgePoint(): this { return this; }\r\n    DEdge(): this {\r\n        let thiss: DVoidEdge = this.thiss as any;\r\n        return this; }\r\n    DVertex(): this { return this; }\r\n    DVoidEdge(start: DGraphElement[\"id\"] | DGraphElement | LGraphElement | DModelElement[\"id\"] | DModelElement | LModelElement,\r\n          end: DGraphElement[\"id\"] | DGraphElement | LGraphElement | DModelElement[\"id\"] | DModelElement | LModelElement,\r\n          longestLabel: DEdge[\"longestLabel\"], labels: DEdge[\"labels\"]): this {\r\n        const thiss: DVoidEdge = this.thiss as any;\r\n        let startid: DGraphElement[\"id\"] = (windoww.LGraphElement as typeof LGraphElement).getNodeId(start);\r\n        let endid: DGraphElement[\"id\"] = (windoww.LGraphElement as typeof LGraphElement).getNodeId(end);\r\n        Log.ex(!startid || !endid, \"cannot create an edge without start or ending nodes\", {start, end, startid, endid});\r\n        thiss.midnodes = [];\r\n        thiss.midPoints = []; // the logic part which instructs to generate the midnodes\r\n        thiss.start = startid;\r\n        thiss.end = endid;\r\n        // thiss.labels = undefined;\r\n        let ll: labelfunc = (e: LVoidEdge, s: EdgeSegment, allNodes: LGraphElement[], allSegments: EdgeSegment[]\r\n        ) => /*defining the edge label (e.start.model as any)?.name + \" ~ \" + (e.end.model as any)?.name */\" (\" + s.length.toFixed(1) + \")\";\r\n        thiss.longestLabel = ll;\r\n        if (this.persist) {\r\n            startid && SetFieldAction.new(startid, \"pointedBy\", PointedBy.fromID<DVoidEdge>(thiss.id, \"start\"), '+=');\r\n            endid && SetFieldAction.new(endid, \"pointedBy\", PointedBy.fromID<DVoidEdge>(thiss.id, \"end\"), '+=');\r\n        }\r\n        return this; }\r\n    DExtEdge(): this { return this; }\r\n    DRefEdge(): this { return this; }\r\n\r\n    DGraphElement(model: DGraphElement[\"model\"]|null|undefined, parentNodeID: DGraphElement[\"father\"]|undefined, parentgraphID: DGraphElement[\"graph\"]|undefined,\r\n                  htmlindex: number): this {\r\n        const thiss: DGraphElement = this.thiss as any;\r\n        if (parentNodeID) thiss.father = parentNodeID;\r\n        if (parentgraphID) thiss.graph = parentgraphID;\r\n        thiss.model = model||undefined;\r\n        thiss.subElements = [];\r\n        thiss.favoriteNode = false;\r\n        thiss.zIndex = htmlindex;\r\n        //  if (nodeID) thiss.id = nodeID;\r\n        if (this.persist) {\r\n            model && SetFieldAction.new(model, \"pointedBy\", PointedBy.fromID<DGraphElement>(thiss.id, \"model\"), '+=');\r\n            parentgraphID && SetFieldAction.new(parentgraphID, \"pointedBy\", PointedBy.fromID<DGraphElement>(thiss.id, \"graph\"), '+=');\r\n            parentNodeID && SetFieldAction.new(thiss.father, \"pointedBy\", PointedBy.fromID<DGraphElement>(thiss.id, \"father\"), '+=');\r\n            // update collections (pointedby's here are set automatically)\r\n            parentNodeID && SetFieldAction.new(thiss.father, \"subElements\", thiss.id, '+=', true);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    DViewElement(name: string, jsxString: string, defaultVSize?: GraphSize, usageDeclarations: string = '', constants: string = '',\r\n                 preRenderFunc: string = '', appliableToClasses: string[] = [], oclApplyCondition: string = '', priority: number = 1): this {\r\n        const thiss: DViewElement = this.thiss as any;\r\n        thiss.name = name;\r\n        thiss.appliableToClasses = appliableToClasses;\r\n        thiss.jsxString = jsxString;\r\n        thiss.usageDeclarations = usageDeclarations;\r\n        thiss.constants = constants;\r\n        thiss.preRenderFunc = preRenderFunc;\r\n        // thiss.__transient = new DViewTransientProperties();\r\n        thiss.subViews = [];\r\n        thiss.oclApplyCondition = '';\r\n        thiss.explicitApplicationPriority = priority;\r\n        thiss.defaultVSize = defaultVSize || new GraphSize(0, 0, 351, 201);\r\n        thiss.size = {};\r\n        thiss.storeSize = false;\r\n        thiss.lazySizeUpdate = false;\r\n        thiss.constraints = [];\r\n        //thiss.useSizeFrom = EuseSizeFrom.node;\r\n        // thiss.adaptHeight = false;\r\n        // thiss.adaptWidth = false;\r\n\r\n\r\n        thiss.draggable = true;\r\n        thiss.resizable = true;\r\n        thiss.display = 'flex' as any;\r\n        thiss.width = 200;\r\n        thiss.height = 100;\r\n        thiss.adaptWidth = false;\r\n        thiss.adaptHeight = false; //'fit-content';\r\n\r\n        thiss.edgeStartOffset = new GraphPoint(50, 50);\r\n        thiss.edgeEndOffset = new GraphPoint(50, 50);\r\n        thiss.edgeStartOffset_isPercentage = true;\r\n        thiss.edgeEndOffset_isPercentage = true;\r\n        thiss.edgeStartStopAtBoundaries = true;\r\n        thiss.edgeEndStopAtBoundaries = true;\r\n        thiss.bendingMode = EdgeBendingMode.Bezier_quadratic;\r\n        thiss.edgeGapMode = EdgeGapMode.gap;\r\n        thiss.edgePointCoordMode = CoordinateMode.relativeOffset;\r\n        /// edge\r\n\r\n        thiss.edgeHeadSize = new GraphPoint(20, 20);\r\n        thiss.edgeTailSize = new GraphPoint(20, 20);\r\n\r\n        if (this.persist) {\r\n            // no pointedBy?\r\n        }\r\n        return this;\r\n    }\r\n\r\n    DViewPoint(): this {\r\n        return this;\r\n    }\r\n\r\n    static DGraph_maxID: number = 0;\r\n    public static DGraph_makeID(modelid: DGraph[\"model\"]): Pointer<DGraph, 1, 1, LGraph> {\r\n        if (!modelid) modelid = \"shapeless\";\r\n        return modelid + '^graph' + Constructors.DGraph_maxID++;\r\n    }\r\n    DGraph(): this {\r\n        const thiss: DGraph = this.thiss as any;\r\n        thiss.graph = thiss.id;\r\n        thiss.zoom = new GraphPoint(1, 1);\r\n        thiss.graphSize = new GraphSize(0, 0, 0, 0);  // GraphSize.apply(this, [0, 0, 0 ,0]);\r\n        thiss._subMaps = {zoom: true, graphSize: true}\r\n        if (this.persist) {\r\n            // no pointedBy?\r\n        }\r\n        return this; }\r\n\r\n    DVoidVertex(defaultVSize?: InitialVertexSize): this {\r\n        const thiss: DVoidVertex = this.thiss as any;\r\n        /*[]{}<>\r\n?'^~\r\n&&||\\+\r\n6nb*/\r\n        let defaultVSizeObj: InitialVertexSizeObj | undefined;\r\n        let defaultVSizeFunc: InitialVertexSizeFunc;\r\n        thiss.isResized = false;\r\n        let func: undefined | (() => void);\r\n        if (defaultVSize) {\r\n            func = () => {\r\n            BEGIN() // this executes after the Constructor.end() so it's necessary to start a new transaction\r\n            // fromPointer because i need to pick the one from the store that might be updated\r\n            //    with a view or other data instead of the D version i have here\r\n            let lvertex: LVoidVertex = LPointerTargetable.fromD(thiss);\r\n            if (typeof defaultVSize !== \"function\") {\r\n                defaultVSizeObj = defaultVSize;\r\n                //defaultVSizeFunc = () => defaultVSizeObj;\r\n            }\r\n            else {\r\n                defaultVSizeFunc = defaultVSize;\r\n                try { defaultVSizeObj = defaultVSizeFunc(lvertex.father, lvertex); }\r\n                catch (e) { Log.e(\"Error in user DefaultVSize function:\", {e, defaultVSizeFunc, txt:defaultVSizeFunc.toString()}); }\r\n            }\r\n            if (defaultVSizeObj) {\r\n                if (!this.persist) lvertex = thiss as any;\r\n                if (defaultVSizeObj.x !== undefined) lvertex.x = defaultVSizeObj.x;\r\n                if (defaultVSizeObj.y !== undefined) lvertex.y = defaultVSizeObj.y;\r\n                if (defaultVSizeObj.w !== undefined) lvertex.w = defaultVSizeObj.w;\r\n                if (defaultVSizeObj.h !== undefined) lvertex.h = defaultVSizeObj.h;\r\n\r\n                if ((defaultVSizeObj as any).index >= 0 && this.persist && thiss.className === \"DEdgePoint\") {\r\n                    let updateEPindex = () => {\r\n                        let lep = lvertex as LEdgePoint;\r\n                        let le: LVoidEdge = lep.father;\r\n                        let de: DVoidEdge = le.__raw;\r\n                        let subelements = [...de.subElements];\r\n                        let presubelements = [...subelements]; // a\r\n                        U.arrayRemoveAll(subelements, thiss.id);\r\n                        subelements.splice(defaultVSizeObj?.index as number, 0, thiss.id);\r\n                        // console.log(\"setting subelements\", {presubelements, subelements, de, le, thiss});\r\n                        le.subElements = subelements as any;\r\n                        // todo: this might break \"pointedBy\" x984\r\n                    }\r\n                    // updateEPindex();\r\n                    // it's already wrapped in a callback\r\n                    // but needs a second one because after node is created, id is auto-appended to this collection\r\n                    // and i need to rewrite that append by inserting my own customized index position\r\n                    console.log(\"setting subelements 0\", {updateEPindex});\r\n                    setTimeout(updateEPindex, 0);\r\n                    // NB: do not use this.callbacks.push because the body of this func is executed after Constructors.end() so end() can never find and execute it.\r\n                }\r\n            }\r\n            END() }\r\n        }\r\n\r\n        // func = ... the if (defaultVSizeObj) above\r\n        if (func) {\r\n            if (this.persist) this.callbacks.push(func as Function); // because i want to be sure the parent node exists too, not just this node.\r\n            // if (this.persist) this.callbacks.push(() => setTimeout(func as Function, 1)); // because i want to be sure the parent node exists too, not just this node.\r\n            else func();\r\n        }\r\n\r\n        if (this.persist) {\r\n            // no pointedBy?\r\n        }\r\n        return this; }\r\n\r\n\r\n}\r\n// export const Constructors = new _Constructors();\r\n\r\n@RuntimeAccessible\r\nexport class DPointerTargetable extends RuntimeAccessibleClass {\r\n    public static cname: string = \"DPointerTargetable\";\r\n    static defaultComponent: (ownProps: GObject, children?: (string | React.Component)[]) => React.ReactElement;\r\n    public static maxID: number = 0;\r\n    public static logic: typeof LPointerTargetable;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    _storePath?: string[];\r\n    _subMaps?: Dictionary<string, boolean>;\r\n    id!: Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    // pointedBy: DocString<'path in store'>[] = []; // NB: potrebbe contenere puntatori invalidi.\r\n    // se viene cancellato un intero oggetto A che contiene una lista di puntatori, gli oggetti che puntano ad A rimuovono A dai loro \"poitnedBy\",\r\n    // ma gli oggetti puntati da A tramite sotto-oggetti o attributi (subviews...) non vengono aggiornati in \"pointedby\"\r\n    pointedBy: PointedBy[] = [];\r\n    public className!: string;\r\n    static pendingCreation: Dictionary<Pointer, DPointerTargetable> = {};\r\n\r\n\r\n    static defaultname<L extends LModelElement = LModelElement>(startingPrefix: string | ((meta:L)=>string), father?: Pointer | DPointerTargetable | ((a:string)=>boolean), metaptr?: Pointer | null): string {\r\n        let lfather: LModelElement;\r\n        // startingPrefix = \"model_\", father = ((name: string) => !dmodelnames.includes(name))\r\n        if (father) {\r\n            if (typeof father === \"string\" || (father as any).className) { // Pointer or D\r\n                lfather = LPointerTargetable.wrap(father as DModelElement) as LModelElement;\r\n                if (!lfather) return (typeof startingPrefix === \"string\" ? startingPrefix : \"unnamed_elem\"); // can happen during parse when father ptr exist but it's not in store yet. not a prob\r\n                if (typeof startingPrefix !== \"string\") {\r\n                    let meta = LPointerTargetable.from(metaptr as Pointer);\r\n                    startingPrefix = startingPrefix(meta as L);\r\n                }\r\n                const childrenNames: (string)[] = lfather.children.map(c => (c as LNamedElement).name);\r\n                return U.increaseEndingNumber(startingPrefix + '0', false, false, (newname) => childrenNames.indexOf(newname) >= 0);\r\n            }\r\n            else {\r\n                let condition: (a:string)=>boolean = father as any;\r\n                return U.increaseEndingNumber(startingPrefix + '0', false, false, condition);\r\n            }\r\n        }\r\n        return startingPrefix + \"1\"; }\r\n\r\n    public static new(...a:any): DPointerTargetable { //father?: Pointer, persist: boolean = false, fatherType?: Constructor, ...a:any): DPointerTargetable {\r\n        Log.exx(\"cannot instantiate abstract class DPointerTargetable\");\r\n        return null as any;\r\n        // return new Constructors(new DPointerTargetable('dwc'), father, persist, fatherType).DPointerTargetable().end();\r\n    }\r\n    constructor(fakearg_detectwrongcalls:'dwc') {\r\n        super();\r\n        if (!fakearg_detectwrongcalls) throw new Error( \"cannot build D-objects using new keyword, use the static D-Class.new method instead\");\r\n    }\r\n\r\n    static fromL<LX extends LPointerTargetable,\r\n        DX = LX extends LEnumerator ? LEnumerator : (LX extends LAttribute ? LAttribute : (LX extends LReference ? LReference : (LX extends LRefEdge ? LRefEdge : (LX extends LExtEdge ? LExtEdge : (LX extends LDataType ? LDataType : (LX extends LClass ? LClass : (LX extends LStructuralFeature ? LStructuralFeature : (LX extends LParameter ? LParameter : (LX extends LOperation ? LOperation : (LX extends LEdge ? LEdge : (LX extends LEdgePoint ? LEdgePoint : (LX extends LGraphVertex ? LGraphVertex : (LX extends LModel ? LModel : (LX extends LValue ? LValue : (LX extends LObject ? LObject : (LX extends LEnumLiteral ? LEnumLiteral : (LX extends LPackage ? LPackage : (LX extends LClassifier ? LClassifier : (LX extends LTypedElement ? LTypedElement : (LX extends LVertex ? LVertex : (LX extends LVoidEdge ? LVoidEdge : (LX extends LVoidVertex ? LVoidVertex : (LX extends LGraph ? LGraph : (LX extends LNamedElement ? LNamedElement : (LX extends LAnnotation ? LAnnotation : (LX extends LGraphElement ? LGraphElement : (LX extends LMap ? LMap : (LX extends LModelElement ? LModelElement : (LX extends LUser ? LUser : (LX extends LPointerTargetable ? LPointerTargetable : (ERROR)))))))))))))))))))))))))))))))\r\n        >(data: LX): DX {\r\n        return data.__raw as any;\r\n    }\r\n\r\n\r\n    static fromPointer<// LOW extends number, UPP extends number | 'N',\r\n        T extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (T extends Pointer<infer D> ? D : 'undefined D'),\r\n        LOW extends (T extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (T extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (T extends Pointer<infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (T extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (T extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        RET = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n        INFERRED = {ret: RET, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR},>(ptr: T, s?: DState)\r\n        : RET {\r\n        s = s || store.getState();\r\n        if (Array.isArray(ptr)) {\r\n            return ptr.map( (p: Pointer) => DPointerTargetable.fromPointer(p, s)) as any;\r\n        }\r\n        if (typeof ptr !== \"string\") { ptr = (ptr as any)?.id; }\r\n        if (typeof ptr !== \"string\") { throw new Error(\"wrong parameter in DPointerTargetable.fromPointers()\"); }\r\n        return s.idlookup[ptr as string] as any;\r\n    }\r\n    static from<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (PTR extends Pointer<infer D> ? D : 'undefined D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (PTR extends Pointer<infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        LX extends LPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LRefEdge ? DRefEdge : (LX extends LExtEdge ? DExtEdge : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LEdge ? DEdge : (LX extends LEdgePoint ? DEdgePoint : (LX extends LGraphVertex ? DGraphVertex : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LVertex ? DVertex : (LX extends LVoidEdge ? DVoidEdge : (LX extends LVoidVertex ? DVoidVertex : (LX extends LGraph ? DGraph : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : (LX extends LGraphElement ? DGraphElement : (LX extends LMap ? DMap : (LX extends LModelElement ? DModelElement : (LX extends LUser ? DUser : (LX extends LPointerTargetable ? DPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = DX extends 'ERROR' ? RETPTR : (RETPTR extends DX ? RETPTR : DX),\r\n        INFERRED = {ret: RET, RETPTR:RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR | LX, s?: DState)\r\n        : RET {\r\n        s = s || store.getState();\r\n        return s.idlookup[ptr as string] as any;\r\n    }\r\n    static from0(a: any, ...aa: any): any { return null; }\r\n    static writeable<LX extends LPointerTargetable, WX = LtoW<LX>>(l: LX): WX { return l as any; }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, DPointerTargetable);\r\n/*\r\nlet d0: LClassifier = null as any;\r\nlet ptrr: Pointer<DPackage, 1, 'N', LPackage> = null as any;\r\nlet ptr1: Pointer<DPackage, 1, 1, LPackage> = null as any;\r\nlet dd = DPointerTargetable.from(d0.id);\r\n*/\r\n\r\n\r\n/*\r\ntype Pack1<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L>, R = {D:D, L:L, P:P} > = P|D|L\r\ntype PackArr<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = (ARR)[];\r\ntype Pack<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = ARR | (ARR)[];*/\r\n\r\n\r\n\r\n@RuntimeAccessible\r\nexport class Pointers{\r\n    public static cname: string = \"Pointers\";\r\n    static filterValid<P extends (Pointer | Pointer[]) = any, RET = P extends Pointer[] ? P : P | null>\r\n    (p: P): P | null {\r\n        const pointerval: DPointerTargetable | DPointerTargetable[] = DPointerTargetable.from(p);\r\n        if (Array.isArray(pointerval)) return pointerval.filter( p => !!p).map( p => p.id) as P;\r\n        if (!pointerval) return null;\r\n        return pointerval.id as P; }\r\n\r\n    fromArr<D extends DPointerTargetable, L extends LPointerTargetable, P extends Pointer> (val: (P | D | L | null | undefined)[] |  (P | D | L | null | undefined)): P[] {\r\n        if (!val) val = [];\r\n        if (!Array.isArray(val)) { val = [val]; }\r\n        if (!val.length) { return []; }\r\n        if ((val[0] as any).id) { val = (val as any as (LModelElement | DModelElement)[]).filter(v => !!v).map( (v) => v.id) as any[]; }\r\n        return val.filter( v => !!v) as any[]; }\r\n\r\n    fromm<D extends DPointerTargetable, L extends LPointerTargetable, P extends Pointer> (val: (P | D | L)): P | null { return !val ? null : (val as any).id; }\r\n\r\n    from0<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n        LX extends LPointerTargetable,\r\n        WX extends WPointerTargetable,\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LXX = DtoL<DX>,\r\n        DXX = LtoD<LX>,\r\n        LXFinal = LXX extends 'ERROR' ? LX : LXX,\r\n        DXFinal = DXX extends 'ERROR' ? DX : DXX,\r\n        RET = {d: DXFinal, l:LXFinal}, // Pointer<DX, 0 | 1, 1 | 'N', LX>\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, LXX: LXX, DXX: DXX, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(data: LX | DX | WX)\r\n        : INFERRED {\r\n        return null as any;\r\n    }\r\n\r\n\r\n    static from00<\r\n        // LOW extends number, UPP extends number | 'N',\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        DWL extends {id: any},\r\n        // PCK extends (T extends Pack<infer PPP> ? PPP : never),\r\n        //ISARR extends (T extends any[] ? true : false),\r\n        // PCK1 extends (T extends any[] ? null : T extends Pack1<infer PPP> ? PPP : never), //         PCK1 extends (T extends any[] ? true : false),\r\n        // PCKA extends (T extends PackArr<infer PPP> ? PPP : 'undefined_arrpack'),\r\n        // PTR extends DWL[\"id\"], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // T extends DWL | DWL[] | null | undefined,\r\n        /*DX extends (PTR extends Pointer<infer D0> ? D0 : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        LX extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n        RET = DX extends DPointerTargetable ? ( LOW extends number ? ( UPP extends number ? ( LX extends LPointerTargetable ? Pointer<DX, LOW, UPP, LX> : '_notret_L_') : '_notret_UPP_') : '_notret_LOW_') : '_notret_D_'\r\n        */\r\n        PTRPARAM = Pointer | Pointer[],\r\n        T = Exclude<DWL | DWL[] | PTRPARAM, unknown[]>,\r\n        // @ts-ignore\r\n        PTR = T extends null ? null : T extends undefined ? null : (T extends PTRPARAM ? T : (T extends any[] ? T[number]['id'][] : T['id'])),\r\n        // RET extends Pointer<DPointerTargetable, any, any, LPointerTargetable> = T extends DWL ? DWL[\"id\"] : (T extends DWL[] ? DWL[\"id\"] : null),\r\n        // INF = { PCK:PCK, ISARR: ISARR,  PTR: PTR, DWL: DWL, RET: RET}, // {DD:DD, LL: LL}//\r\n        >(data: T | T[] ): PTR { // RET | RET[] {\r\n        if (Array.isArray(data)) return data.filter(d => !!d).map(d => (typeof d === \"string\" ? d : (d as any as DWL).id)) as any;\r\n        else return (data ? (data as any).id : null);\r\n    } // stavolta fai infer so D|l.id\r\n\r\n\r\n    public static from<DX extends DPointerTargetable>(data:DX): DX[\"id\"]; // | {D:any};\r\n    public static from<DX extends DPointerTargetable>(data:DX[]): DX[\"id\"][]; // | {DD:any};\r\n    public static from<LX extends LPointerTargetable>(data:LX): LX[\"id\"]; // | {L:any};\r\n    public static from<LX extends LPointerTargetable>(data:LX[]): LX[\"id\"][]; // | {LL:any};\r\n    public static from<WX extends WPointerTargetable>(data:WX): WX[\"id\"]; // | {W:any};\r\n    public static from<WX extends WPointerTargetable>(data:WX[]): WX[\"id\"][]; // | {WW:any};\r\n    public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:PTR): PTR; // | {P:any};\r\n    public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:PTR[]): PTR[]; // | {PP:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T>): Pointer<LtoD<T>, 1, 1, T>; //{TEST1:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T>[]): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST111:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack<T>): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<P extends Pack<T> | undefined, T extends LPointerTargetable>(data: P): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<T extends LPointerTargetable>(data:PackArr<T>): Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T[]>): Pointer<LtoD<T>, 1, 1, T>; //{TEST1:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack1<T[]>[]): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST111:any};\r\n    public static from<T extends LPointerTargetable>(data:Pack<T[]>): Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    public static from<T extends LPointerTargetable>(data:PackArr<T[]>): Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n\r\n    /*\r\n        public static from(data:undefined): undefined; // | {D:any};\r\n        public static from<DX extends DPointerTargetable | undefined | null>(data:DX): DX extends DPointerTargetable ? DX[\"id\"] : DX; // | {D:any};\r\n        public static from<DX extends DPointerTargetable | undefined | null>(data:DX[]): DX extends DPointerTargetable ? DX[\"id\"][] : DX; // | {DD:any};\r\n        public static from<LX extends LPointerTargetable | undefined | null>(data:LX): LX extends LPointerTargetable ? LX[\"id\"] : LX; // | {L:any};\r\n        public static from<LX extends LPointerTargetable | undefined | null>(data:LX[]): LX extends LPointerTargetable ? LX[\"id\"][] : LX; // | {LL:any};\r\n        public static from<WX extends WPointerTargetable | undefined | null>(data:WX): WX extends WPointerTargetable ? WX[\"id\"] : WX; // | {W:any};\r\n        public static from<WX extends WPointerTargetable | undefined | null>(data:WX[]): WX extends WPointerTargetable ? WX[\"id\"][] : WX; // | {WW:any};\r\n        public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> | undefined | null>(data:PTR): PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> ? PTR : PTR; // | {P:any};\r\n        public static from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> | undefined | null>(data:PTR[]): PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable> ? PTR[] : PTR; // | {PP:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T> : T; //{TEST1:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T>[]): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST111:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:Pack<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST0:any};\r\n        public static from<T extends LPointerTargetable | undefined | null>(data:PackArr<T>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TESTARR:any};\r\n        // public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T[]>): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T> : T; //{TEST1:any};\r\n        // public static from<T extends LPointerTargetable | undefined | null>(data:Pack1<T[]>[]): T extends LPointerTargetable ? Pointer<LtoD<T>, 1, 1, T>[] : T; //{TEST111:any};\r\n        // DDD extends (T extends Pointer<infer D> ? D : 'undefined D'),*/\r\n    public static from<TT extends Pack<LPointerTargetable[]> | undefined | null,\r\n        // @ts-ignore\r\n        T extends (TT extends Pack<infer PTYPE> ? PTYPE : undefined)>(data:T): T extends null | undefined ? T : Pointer<LtoD<T>, 1, 1, T>[]; //{TEST0:any};\r\n    // @ts-ignore\r\n    public static from<T extends LPointerTargetable | undefined | null>(data: PackArr<T[]>): T extends null | undefined ? T : Pointer<LtoD<T>, 1, 1, T>[]; //{TESTARR:any};\r\n    public static from(data:null | undefined): null; // | {Dn:any};\r\n    public static from(data:(null | undefined)[]): []; // | {Dnn:any};\r\n    public static from(data:(null | undefined) | (null | undefined)[]): []; // | {Dn0:any};\r\n\r\n    // function from<PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:unknown | unknown[]): PTR | PTR[] | GObject {\r\n    public static from<T extends LClass, PTR extends Pointer<DPointerTargetable, 1, 1, LPointerTargetable>>(data:unknown | unknown[]): null | PTR | PTR[]{\r\n        if (!data) return null;\r\n        if (Array.isArray(data)) return data.filter(d => !!d).map(d => (typeof d === \"string\" ? d : (d as any).id)) as any;\r\n        return typeof data === \"string\" ? data : (data as any).id;\r\n    }\r\n\r\n    static isPointer(val: any): val is Pointer {\r\n        // todo: must refine this in a safer way\r\n        return typeof val === \"string\" ? val.includes(\"Pointer\") : false;\r\n    }\r\n}\r\n/*\r\nexport type Pack1<L extends LPointerTargetable | undefined | null,\r\n    // L extends LPointerTargetable | undefined | null = LL extends LPointerTargetable[] ? LPointerTargetable : null | undefined,\r\n    D extends (L extends LPointerTargetable ? LtoD<L> : undefined | null) = (L extends LPointerTargetable ? LtoD<L> : undefined | null)> =\r\n    L extends LPointerTargetable ? ( D extends DPointerTargetable ? D | L /*| LtoW<L>* / | Pointer<D, 1, 1, L> : L) : undefined;\r\nexport type PackArr<LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends LPointerTargetable | undefined | null = LL extends undefined | null ? undefined : unArr<LL>> = Pack1<L>[];\r\nexport type Pack<\r\n    LL extends orArr<LPointerTargetable> | undefined | null,\r\n    L extends unArr<LL> = unArr<LL>,\r\n    // L extends (LL extends orArr<LPointerTargetable> ? LPointerTargetable : undefined | null) = (LL extends orArr<LPointerTargetable> ? unArr<LL> : undefined)\r\n    >\r\n    = LL extends undefined ? undefined : Pack1<L> | PackArr<L>;\r\n*/\r\nexport type Pack1<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>,\r\n    D extends (L extends LPointerTargetable ? LtoD<L> : undefined) = (L extends LPointerTargetable ? LtoD<L> : undefined)> =\r\n    L extends LPointerTargetable ? ( D extends DPointerTargetable ? D | L | Pointer<D, 1, 1, L> : undefined) : undefined;\r\nexport type PackArr<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>> = Pack1<L>[];\r\nexport type Pack<LL extends orArr<LPointerTargetable> | undefined, L extends LPointerTargetable | undefined = unArr<LL>> = L extends undefined ? undefined : Pack1<L> | PackArr<L>;\r\n/*\r\nlet n: any = null;\r\nlet aa: DClass = n;\r\nlet ptrr = Pointers.from(aa.parent);\r\naa.parent = ptrr;*/\r\n\r\n@RuntimeAccessible\r\nexport class PendingPointedByPaths{\r\n    public static cname: string = \"PendingPointedByPaths\";\r\n    static all: PendingPointedByPaths[] = [];\r\n    // static pendingMoreThanTwice: ParsedAction[] = [];\r\n    static maxSolveAttempts: number = 20;\r\n    public solveAttempts: number = 1;\r\n    private stackTrace: string[];\r\n\r\n    // tmp fields, not sure what i need\r\n    public action!: ParsedAction; // todo: remove\r\n    static new(action: ParsedAction, oldState: DState): PendingPointedByPaths {\r\n        const ptr: Pointer = action.value;\r\n        const target: DPointerTargetable | null = oldState.idlookup[ptr as string];\r\n        let pendingPointedBy = new PendingPointedByPaths(action.path, ptr);\r\n        pendingPointedBy.action = action;\r\n        return pendingPointedBy;\r\n    }\r\n\r\n    private constructor(\r\n        public from: DocString<\"full Path in store including field key\">,\r\n        // todo 6: how about actions that do not include index but just += -= [] ?\r\n        public to: Pointer){\r\n        this.stackTrace = U.getStackTrace();\r\n    }\r\n    static attemptimplementationdelete(pb: PointedBy) {\r\n        let state: DState = store.getState();\r\n        let objectChain = U.followPath(state, pb.source);\r\n    }\r\n\r\n    public attemptResolve(state: DState): ParsedAction | null {\r\n        if (this.canBeResolved(state)) return this.resolve();\r\n        return null;\r\n    }\r\n\r\n    private resolve(): ParsedAction{\r\n        U.arrayRemoveAll(PendingPointedByPaths.all, this);\r\n        return Action.parse(SetRootFieldAction.create(\"idlookup.\" + this.to + '.pointedBy', PointedBy.new(this.action.path), '+=', false));\r\n    }\r\n\r\n    public saveForLater(): void { PendingPointedByPaths.all.push(this); }\r\n    private canBeResolved(state: DState): boolean {\r\n        this.solveAttempts++;\r\n        if (this.solveAttempts >= PendingPointedByPaths.maxSolveAttempts) Log.ex(\"pending PointedBy action is not revolved for too long, some pointer was wrongly set up.\", this.stackTrace, this, state);\r\n        return !!state.idlookup[this.to]; }\r\n\r\n    static getSolveableActions(oldState: DState): ParsedAction[] {\r\n        let allClone = [...this.all]; // necessary because the array will remove some elements during iteration as they are solved.\r\n        return allClone.map( p => p.attemptResolve(oldState)).filter(p => (!!p)) as ParsedAction[];\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class PointedBy{\r\n    public static cname: string = \"PointedBy\";\r\n    static list: string[] = [\"father\", \"parent\", \"annotations\", \"packages\", \"type\", \"subpackages\", \"classifiers\", \"exceptions\", \"parameters\", \"defaultValue\", \"instances\", \"operations\", \"features\", \"attributes\", \"references\", \"extends\", \"extendedBy\", \"implements\", \"implementedBy\", \"instanceof\", \"edges\", \"target\", \"opposite\", \"parameters\", \"exceptions\", \"literals\", \"values\"];\r\n    source: string; // elemento da cui parte il puntatore\r\n    // field: keyof DPointerTargetable;\r\n    // il bersaglio non c'è qui, perchè è l'oggetto che contiene questo dentro l'array pointedBy\r\n\r\n    /*private constructor(source: DPointerTargetable, field: any) {\r\n        this.source = source;\r\n        this.field = field;\r\n    }*/\r\n\r\n    static getPath(p: PointedBy) : string { return p.source.substring(0, p.source.lastIndexOf(\".\")); }\r\n    static getLastKey(p: PointedBy) : string { return p.source.substring(p.source.lastIndexOf(\".\")); }\r\n    static getPathArr(p: PointedBy) : string[] { return p.source.split('.'); }\r\n    private constructor(source: string) {\r\n        this.source = source;\r\n    }\r\n    static fromID<D extends DPointerTargetable>(ptr: Pointer<D>, field: keyof D) {\r\n        // Giordano: add ignore for webpack\r\n        //@ts-ignore\r\n        return PointedBy.new(\"idlookup.\" + ptr + \".\" + field);\r\n    }\r\n    static new(source: DocString<\"full path in store including key. like \\'idlookup.id.extends\\'\">, modifier: \"-=\" | \"+=\" | undefined = undefined, action?: ParsedAction): PointedBy {\r\n        // let source: DocString<\"full path in store including key\"> = action.path;\r\n        // if (source.includes(\"true\")) { console.error(this, action); throw new Error(\"mixed a bool\"); }\r\n        if (modifier) source = source.substring(0, source.length - (modifier?.length || 0));\r\n        return new PointedBy(source);\r\n    }\r\n    // static new0<D extends DPointerTargetable> (source: D, field: keyof D): PointedBy { return new PointedBy(source, field); }\r\n\r\n\r\n\r\n    public static remove(oldValue: Pointer | undefined, action: ParsedAction, state: DState, casee: \"+=\" | \"-=\" | undefined = undefined): DState {\r\n        if (!oldValue) return state;\r\n        let oldtarget: DPointerTargetable = state.idlookup[oldValue];// todo: if += -=\r\n        if (!oldtarget) return state;\r\n        let index = -1;\r\n        let actionpath: string = action.path.substring(0, action.path.length -(casee?.length || 0))\r\n        for (let i = 0; i < oldtarget.pointedBy.length; i++) { if (oldtarget.pointedBy[i].source === actionpath) {index = i; break; } }\r\n        if (index >= 0) {\r\n            state = {...state} as DState;\r\n            state.idlookup = {...state.idlookup};\r\n            state.idlookup[oldValue] =  {...oldtarget, pointedBy: [...oldtarget.pointedBy]} as any;\r\n            state.idlookup[oldValue].pointedBy.splice(index, 1) // in-place edit\r\n        }\r\n        // console.warn('pointedby remove:', {from: oldtarget.pointedBy, to: state.idlookup[oldValue].pointedBy, obj: state.idlookup[oldValue], index, oldValue, actionpath});\r\n        return state;\r\n    }\r\n\r\n    public static add(newtargetptr: Pointer | undefined, action: ParsedAction, state: DState, casee: \"+=\" | \"-=\" | undefined = undefined): DState {\r\n        if (!newtargetptr) return state;\r\n        // todo: if can't be done because newtarget doesn't exist, build an action from this and set it pending.\r\n        let newtarget: DPointerTargetable = state.idlookup[newtargetptr];\r\n        if (!newtarget) {\r\n            PendingPointedByPaths.new(action, state).saveForLater(); // {from: action.path, field: action.field, to: target});\r\n            return state;\r\n        }\r\n        let oldtarget = {...newtarget, pointedBy: [...newtarget.pointedBy]}\r\n        state = {...state} as DState;\r\n        state.idlookup = {...state.idlookup};\r\n        state.idlookup[newtargetptr] = {...newtarget, pointedBy:  [...newtarget.pointedBy, PointedBy.new(action.path, casee)]} as any;\r\n        // console.warn('pointedby add:', {from: oldtarget.pointedBy, to: state.idlookup[newtargetptr].pointedBy, obj: state.idlookup[newtargetptr]});\r\n        return state;\r\n    }\r\n}\r\n\r\ntype AnyPointer = Pointer<DPointerTargetable, number, number|'N', LPointerTargetable>;\r\n\r\n@RuntimeAccessible\r\nexport class LPointerTargetable<Context extends LogicContext<DPointerTargetable> = any, D extends DPointerTargetable = DPointerTargetable> extends DPointerTargetable {\r\n    public static cname: string = \"LPointerTargetable\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public static structure: typeof DPointerTargetable;\r\n    public static singleton: LPointerTargetable;\r\n    public __raw!: D;\r\n    public pointedBy!: PointedBy[];\r\n\r\n    public __isProxy!: boolean;\r\n    public __serialize!: DocString<\"json\">;\r\n    private inspect!:D;\r\n    private clonedCounter!:number;\r\n    private __random!:number;\r\n\r\n    private __info_of__id = {type:\"Pointer&lt;this&gt;\", txt:\"<a href=\\\"https://github.com/DamianoNaraku/jodel-react/wiki/identifiers\\\"><span>Unique identifier, and value used to point this object.</span></a>\"};\r\n\r\n    protected wrongAccessMessage(str: string): any {\r\n        let msg = \"Method \"+str+\" should not be called directly, attempting to do so should trigger get_\"+str+\"(). This is only a signature for type checking.\";\r\n        Log.ex(msg);\r\n        throw new Error(msg); }\r\n\r\n    public toString(): string { throw this.wrongAccessMessage(\"toString\"); }\r\n    protected get_toString(context: Context): () => string {\r\n        const data = context.data as DNamedElement;\r\n        return () => ( data.name ? data.name : data.className.substring(0));\r\n        // return () => data.id;\r\n    }\r\n\r\n\r\n    protected cannotSet(field: string): any { return Log.exx('\"' + field + '\" field is read-only', this); }\r\n    protected get_id(context: Context): this[\"id\"] { return context.data.id; }\r\n    protected set_id(): boolean { return this.cannotSet('id'); }\r\n\r\n    protected _get_default< DD extends DPointerTargetable, T extends string & keyof (DD) & keyof (L), L extends LModelElement = LModelElement>(data: DD, key: T): L[T]{\r\n        // @ts-ignore\r\n        return LPointerTargetable.from(data[key]); }\r\n\r\n    public delete(): void { throw this.wrongAccessMessage(\"delete\"); }\r\n    public _delete(context: Context): void { new DeleteElementAction(context.data); }\r\n    protected get_delete(context: Context): () => void {\r\n        return () => {\r\n            alert(\"Delete in LPOINTER\")\r\n            this._delete(context);\r\n        }\r\n    }\r\n\r\n    public get__extends(superClassName: string, context: LogicContext<DPointerTargetable>): boolean {\r\n        return RuntimeAccessibleClass.extends(context.data.className, superClassName);\r\n    }\r\n\r\n    /*\r\n    public get_pointedBy(superClassName: string, context: LogicContext<DPointerTargetable>): LPointerTargetable[] {\r\n        let state: GObject = windoww.store.getState();\r\n        function getForemostObjectInPath(path: DocString<'storePath'>): undefined | LPointerTargetable {\r\n            let lastPointableObject: undefined | DPointerTargetable;\r\n            let pathArray = path.split('.');\r\n            for (let key of pathArray) {\r\n                let currentObj: GObject = state[key];\r\n                if (!currentObj) break;\r\n                if (currentObj && currentObj.id && state.idlookup[currentObj.id]) lastPointableObject = state.idlookup[currentObj.id];\r\n            }\r\n            return lastPointableObject && DPointerTargetable.wrap(lastPointableObject);\r\n        }\r\n        return (context.data.pointedBy || []).map(getForemostObjectInPath).filter( lobj => !!lobj) as LPointerTargetable[];\r\n    }*/\r\n\r\n    public set_pointedBy(val: never, context: LogicContext<DPointerTargetable>): boolean {\r\n        windoww.Log.exx('pointedBy field should never be directly edited.', {context, val});\r\n        return false;\r\n    }\r\n\r\n\r\n\r\n\r\n    static fromD<DX extends DPointerTargetable,\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        >(data: DX): LX {\r\n        // return null as any;\r\n        if (Array.isArray(data)) return LPointerTargetable.wrapAll(data) as any;\r\n        return LPointerTargetable.wrap(data) as any;\r\n    }\r\n\r\n\r\n    static fromPointer<\r\n        T extends AnyPointer | AnyPointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        DDD extends (T extends Pointer<any, any, any, infer D> ? D : 'undefined L'),\r\n        LOW extends (T extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (T extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n\r\n        DDDARR extends (T extends Pointer<any, any, any, infer D>[] ? D : 'undefined_DARR'),\r\n        LOWARR extends (T extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (T extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n\r\n        RET = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n        INFERRED = {ret: RET, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR},>(ptr: T | undefined, state?: DState)\r\n        : RET {\r\n        // return null as any;\r\n        if (Array.isArray(ptr)) return LPointerTargetable.wrapAll(ptr as any, undefined, '', false, state) as any;\r\n        return LPointerTargetable.wrap(ptr) as any;\r\n    }\r\n    static fromArr<\r\n        PTR extends Pointer | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = LX extends 'ERROR' ? RETPTR : (RETPTR extends LX ? RETPTR : LX),\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR[] | DX[])\r\n        : RET[] {\r\n        return LPointerTargetable.from(ptr as any); }\r\n\r\n    static from<// LOW extends number, UPP extends number | 'N',\r\n        PTR extends Pointer<DPointerTargetable, 0|1, 1|'N', LPointerTargetable> | Pointer[], // <DPointerTargetable, 1, 'N', LPointerTargetable>,\r\n        // DDD extends (PTR extends Pointer<infer D> ? D : 'undefined_D'),\r\n        LOW extends (PTR extends Pointer<any, infer LO> ? LO : 'undefined_upp'),\r\n        UPP extends (PTR extends Pointer<any, number, infer UP> ? UP : 'undefined_low'),\r\n        DDD extends (PTR extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n        LOWARR extends (PTR extends Pointer<any, infer LO>[] ? LO : 'undefined_uppARR'),\r\n        UPPARR extends (PTR extends Pointer<any, number, infer UP>[] ? 'UP_is_N' : 'undefined_lowARR'),\r\n        DDDARR extends (PTR extends Pointer<any, any, any, infer LL>[] ? LL : 'undefined_LARR'),\r\n\r\n        DX extends DPointerTargetable,\r\n\r\n        RETPTR = UPPARR extends 'UP_is_N' ?\r\n            (DDDARR[]) : // 0...N\r\n            (UPP extends 1 ? (LOW extends 0 ? DDD | null : DDD) : // 0...1 && 1...1\r\n                (LOW extends 1 ? DDD : undefined)  //1...1\r\n                ),\r\n\r\n\r\n        // DX = LX extends LEnumerator ? DEnumerator : (LX extends LAttribute ? DAttribute : (LX extends LReference ? DReference : (LX extends LDataType ? DDataType : (LX extends LClass ? DClass : (LX extends LStructuralFeature ? DStructuralFeature : (LX extends LParameter ? DParameter : (LX extends LOperation ? DOperation : (LX extends LModel ? DModel : (LX extends LValue ? DValue : (LX extends LObject ? DObject : (LX extends LEnumLiteral ? DEnumLiteral : (LX extends LPackage ? DPackage : (LX extends LClassifier ? DClassifier : (LX extends LTypedElement ? DTypedElement : (LX extends LNamedElement ? DNamedElement : (LX extends LAnnotation ? DAnnotation : ('ERROR'))))))))))))))))),\r\n        LX = DX extends DEnumerator ? LEnumerator : (DX extends DAttribute ? LAttribute : (DX extends DReference ? LReference : (DX extends DRefEdge ? LRefEdge : (DX extends DExtEdge ? LExtEdge : (DX extends DDataType ? LDataType : (DX extends DClass ? LClass : (DX extends DStructuralFeature ? LStructuralFeature : (DX extends DParameter ? LParameter : (DX extends DOperation ? LOperation : (DX extends DEdge ? LEdge : (DX extends DEdgePoint ? LEdgePoint : (DX extends DGraphVertex ? LGraphVertex : (DX extends DModel ? LModel : (DX extends DValue ? LValue : (DX extends DObject ? LObject : (DX extends DEnumLiteral ? LEnumLiteral : (DX extends DPackage ? LPackage : (DX extends DClassifier ? LClassifier : (DX extends DTypedElement ? LTypedElement : (DX extends DVertex ? LVertex : (DX extends DVoidEdge ? LVoidEdge : (DX extends DVoidVertex ? LVoidVertex : (DX extends DGraph ? LGraph : (DX extends DNamedElement ? LNamedElement : (DX extends DAnnotation ? LAnnotation : (DX extends DGraphElement ? LGraphElement : (DX extends DMap ? LMap : (DX extends DModelElement ? LModelElement : (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))))))))))))))))))))))))))))))),\r\n        RET = LX extends 'ERROR' ? RETPTR : (RETPTR extends LX ? RETPTR : LX),\r\n        INFERRED = {ret: RET, RETPTR: RETPTR, upp: UPP, low:LOW, ddd: DDD, dddARR: DDDARR, lowARR: LOWARR, uppARR: UPPARR, LX:LX, DX:DX}>(ptr: PTR | DX, s?: DState)\r\n        : RET {\r\n        // return null as any;\r\n        if (Array.isArray(ptr)) return LPointerTargetable.wrapAll(ptr) as any;\r\n        return LPointerTargetable.wrap(ptr as any) as any;\r\n    }\r\n\r\n    // static from0(a: any, ...aa: any): any { return null; }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, LPointerTargetable);\r\n/*\r\nlet pttr: Pointer<DClassifier, 0, 1, LClassifier> = null as any;\r\nlet ptrany: Pointer<DClassifier, 0|1, 1|'N'>[] = null as any;\r\nlet ptrarr: Pointer<DClassifier>[] = null as any;\r\nlet ptrarr2: Pointer<DClassifier, 1, 'N'> = null as any;\r\nlet d: DClassifier = null as any;\r\nlet darr: DClassifier[] = null as any;\r\n\r\ntype VoidPtr = null | undefined | '';\r\nfunction dfrom<\r\n    PARAM extends orArr<AnyPointer | VoidPtr>,//orArr<WPointerTargetable | LPointerTargetable | DPointerTargetable | AnyPointer>,\r\n\r\n\r\n    DDD extends (PARAM extends Pointer<infer DD> ? DD : 'undefined_D'),\r\n    LOW extends (PARAM extends Pointer<any, infer LO> ? LO : 'undefined_low'),\r\n    LOW0 extends (PARAM extends Pointer<any, 0, any, any> ? 0 : never),\r\n    LOW1 extends (PARAM extends Pointer<any, 1, any, any> ? 1 : never),\r\n    LOW2 extends (VoidPtr extends PARAM ? 0 | 'first' : (PARAM extends VoidPtr ? 0 | 1 | 'second': 1|'third')),\r\n    UPP extends (PARAM extends Pointer<any, number, infer UP> ? UP : 'undefined_upp'),\r\n    LLL extends (PARAM extends Pointer<any, number, any, infer LL> ? LL : 'undefined_L'),\r\n\r\n\r\n\r\n    ISVOID extends PARAM extends VoidPtr  ? 'isvoid' : never,\r\n    ISARR extends PARAM extends [] ? true : false,\r\n    ISPTR extends (PARAM extends AnyPointer | VoidPtr ? 'ptr' : never),\r\n    ISPTRARR extends (PARAM extends (AnyPointer | VoidPtr)[] | Pointer<DPointerTargetable, 1|0, 'N', LPointerTargetable> ? 'ptr_arr' : never),\r\n    ISD extends (PARAM extends DPointerTargetable ? 'd' : never),\r\n    ISDARR extends (PARAM extends DPointerTargetable[] ? 'd_arr' : never),\r\n    ISL extends (PARAM extends LPointerTargetable ? 'l' : never),\r\n    ISLARR extends (PARAM extends LPointerTargetable[] ? 'l_arr' : never),\r\n    ISW extends (PARAM extends WPointerTargetable ? 'w' : never),\r\n    ISWARR extends (PARAM extends WPointerTargetable[] ? 'w_arr' : never),\r\n    // INFER = {LOW:LOW, UPP:UPP, DDD:DDD, LLL:LLL, LOW2:LOW2},\r\n    INFER = { LOW2:LOW2},\r\n    RET = ISVOID | ISPTR | ISPTRARR | ISD | ISDARR | ISL | ISLARR | ISW | ISWARR | INFER\r\n    >\r\n(ptr: PARAM): RET { return null as any; }\r\nlet Lptr = dfrom(pttr as Pointer<DClassifier, 0, 1, LClassifier> );\r\nlet Lptrany = dfrom(ptrany);\r\nlet Lptrarr = dfrom(ptrarr);\r\nlet Lptrarr2 = dfrom(ptrarr2);\r\nlet Ld = dfrom(d);\r\nlet Ldarr = dfrom(darr);*/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n@RuntimeAccessible\r\nexport class WPointerTargetable extends DPointerTargetable{\r\n    id!: never;\r\n    _storePath!: never;\r\n    _subMaps!: never;\r\n    pointedBy!: never;\r\n    // todo: WfromD, WfromL, WfromPointer, Wfrom\r\n\r\n    static fromD<DX extends DPointerTargetable, WX extends DtoW<DX>>(data: DX): WX { return LPointerTargetable.fromD(data) as any; }\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, LPointerTargetable);\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, WPointerTargetable);\r\nfunction fffff<DX, LX = DX extends DRefEdge ? LRefEdge : 'not'>( t: DX): LX { return null as any; }\r\nlet a: DGraphElement = null as any;\r\nlet bbb = LPointerTargetable.from(a);\r\nlet bb2 = fffff(a);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DUser extends DPointerTargetable{\r\n    public static cname: string = \"DUser\";\r\n    static current: DocString<Pointer<DUser, 1, 1>> = 'Pointer' + Date.now(); // todo\r\n    // Session's token that change for every session\r\n    static token: DocString<Pointer<DUser, 1, 1>> = 'Pointer' + Date.now();\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    cursorPositionX: number = 0;\r\n    cursorPositionY: number = 0;\r\n    // public static structure: typeof DPointerTargetable;\r\n    // public static singleton: LPointerTargetable;\r\n    id!: Pointer<DUser, 1, 1, LUser>;\r\n    __isUser: true = true; // necessary to trick duck typing to think this is NOT the superclass of anything that extends PointerTargetable.\r\n    public static new(id?: DUser[\"id\"], triggerActions: boolean = true): DUser {\r\n        return new Constructors(new DUser('dwc'), undefined, false).DPointerTargetable().DUser(id).end(); }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LUser extends LPointerTargetable { // MixOnlyFuncs(DUser, LPointerTargetable)\r\n    public static cname: string = \"LUser\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // public static structure: typeof DPointerTargetable;\r\n    // public static singleton: LPointerTargetable;\r\n    public __raw!: DUser;\r\n    id!: Pointer<DUser, 1, 1, LUser>;\r\n    __isUser!: true;\r\n    cursorPosition!: IPoint; //todo\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DUser);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LUser);\r\nexport type WUser = getWParams<LUser, DUser>;\r\n\r\n@RuntimeAccessible\r\nexport class MyError extends Error {\r\n    static cname: string = \"MyError\";\r\n    constructor(message?: string, ...otherMsg: any[]) {\r\n        // 'Error' breaks prototype chain here\r\n        super(message);\r\n        const proto = (this as any).__proto__;\r\n\r\n        console.error(proto.constructor.cname || proto.constructor.name, message, ...otherMsg);\r\n        // restore prototype chain\r\n        const actualProto = new.target.prototype;\r\n\r\n        if (Object.setPrototypeOf) { Object.setPrototypeOf(this, actualProto); }\r\n        else { (this as any).__proto__ = actualProto; }\r\n        (this as any).className = (this.constructor as typeof MyError).cname;\r\n    }\r\n}\r\n\r\n// @RuntimeAccessible\r\nexport class JsType{\r\n    public static all: JsType[] = [];\r\n    public static object: JsType = new JsType(\"object\", JsType.isObject, false);\r\n    public static function: JsType = new JsType(\"function\", JsType.isFunction, false);\r\n    public static array: JsType = new JsType(\"array\", JsType.isArray, false);\r\n    public static date: JsType = new JsType(\"Date\", JsType.isDate, false);\r\n\r\n    public static lambdaFunction: JsType = new JsType(\"lambda-function\", JsType.isLambdaFunction, true);\r\n    public static nonLambdaFunction: JsType = new JsType(\"non-lambda-function\", JsType.isNonLambdaFunction, true);\r\n    public static symbol: JsType = new JsType(\"symbol\", JsType.isSymbol, true);\r\n    public static undefined: JsType = new JsType(\"undefined\", JsType.isUndefined, true);\r\n    public static null: JsType = new JsType(\"null\", JsType.isNull, true);\r\n    public static boolean: JsType = new JsType(\"boolean\", JsType.isBoolean, true);\r\n    public static number: JsType = new JsType(\"number\", JsType.isNumber, true);\r\n    public static bigint: JsType = new JsType(\"bigint\", JsType.isBigint, true);\r\n    public static string: JsType = new JsType(\"string\", JsType.isString, true);\r\n\r\n    private constructor(public printableTypeName: string, public check: (data: any) => boolean, public isExclusiveType: boolean){\r\n        JsType.all.push(this);\r\n    }\r\n    public toString(): string { return this.printableTypeName; }\r\n    /*\r\n    * example: isObject but not Date, not function...\r\n    * */\r\n    public static isOnlyType(data: any, type: JsType): boolean { return !JsType.getTypes(data, type).length; }\r\n    public static isAnyOfTypes(data: any, ...acceptables: JsType[]): boolean { return !!windoww.Uarr.arrayIntersection(JsType.getTypes(data), acceptables).length; }\r\n    public static getTypes(data: any, stopIfTypeIsNot?: JsType): JsType[]{\r\n        const ret: JsType[] = [];\r\n        for (const type of JsType.all) {\r\n            if (type.check(data)) {\r\n                ret.push(data);\r\n                if (stopIfTypeIsNot !== type) { return []; }\r\n                if (type.isExclusiveType) return ret;\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    /// is...\r\n    public static isObject(data: GObject | any): boolean { return typeof data === \"object\"; }\r\n    public static isFunction(data: Function | any): boolean { return typeof data === \"function\"; }\r\n    public static isLambdaFunction(data: Function | any): boolean {\r\n        if (!JsType.isFunction(data)) return false;\r\n        return windoww.U.getFunctionSignatureFromComments(data).isLambda; }\r\n    public static isNonLambdaFunction(data: Function | any): boolean { return JsType.isFunction(data) && !JsType.isNonLambdaFunction(data); }\r\n    public static isArray(data: Array<any> | any): boolean { return Array.isArray(data); }\r\n    public static isSymbol(data: symbol | any): boolean { return typeof data === \"symbol\"; }\r\n    public static isBoolean(data: symbol | any): boolean { return !!data === data; }\r\n    public static isNumber(data: number | any): boolean { return typeof data === \"number\"; }\r\n    public static isBigint(data: bigint | any): boolean { return typeof data === \"bigint\"; }\r\n    public static isString(data: string | any): boolean { return typeof data === \"string\"; }\r\n    public static isNull(data: null | any): boolean { return data === null; }\r\n    public static isUndefined(data: undefined | any): boolean { return data === undefined; }\r\n    public static isDate(data: Date | any): boolean { return data instanceof Date; }\r\n\r\n    /// as...\r\n    public static asObject<T>(data: GObject | any, fallbackReturn: T): T | GObject { return JsType.isObject(data) ? data : fallbackReturn; }\r\n    public static asFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isFunction(data) ? data : fallbackReturn; }\r\n    public static asLambdaFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isLambdaFunction(data) ? data : fallbackReturn; }\r\n    public static asNonLambdaFunction<T>(data: Function | any, fallbackReturn: T): T | Function { return JsType.isNonLambdaFunction(data) ? data : fallbackReturn; }\r\n    public static asArray<T, A>(data: Array<A> | any, fallbackReturn: T): T | Array<A> { return JsType.isArray(data) ? data : fallbackReturn; }\r\n    public static asSymbol<T>(data: symbol | any, fallbackReturn: T): T | symbol { return JsType.isSymbol(data) ? data : fallbackReturn; }\r\n    public static asBoolean<T>(data: boolean | any, fallbackReturn: T): T | boolean { return JsType.isBoolean(data) ? data : fallbackReturn; }\r\n    public static asNumber<T>(data: number | any, fallbackReturn: T): T | number { return JsType.isNumber(data) ? data : fallbackReturn; }\r\n    public static asBigint<T>(data: bigint | any, fallbackReturn: T): T | bigint { return JsType.isBigint(data) ? data : fallbackReturn; }\r\n    public static asString<T>(data: string | any, fallbackReturn: T): T | string { return JsType.isString(data) ? data : fallbackReturn; }\r\n    public static asNull<T>(data: null | any, fallbackReturn: T): T | null { return JsType.isNull(data) ? data : fallbackReturn; }\r\n    public static asUndefined<T>(data: undefined | any, fallbackReturn: T): T | undefined { return JsType.isUndefined(data) ? data : fallbackReturn; }\r\n    public static asDate<T>(data: Date | any, fallbackReturn: T): T | Date { return JsType.isDate(data) ? data : fallbackReturn; }\r\n    public static isPrimitive(data: any) { return !JsType.isAnyOfTypes(data, JsType.object, JsType.function, JsType.array); }\r\n}\r\n\r\n\r\nfunction invalidSuperClassError(/*callee: Class,*/ scname: string, superclass: Class): (() => never) {\r\n    return () => { windoww.Log.exDevv('parent super class \"' + scname + '\" is not implementing init_constructor', {scname, superclass, }); throw new Error(); }\r\n}\r\n// @ts-ignore\r\nfunction MixinFakeConstructor() { this.isMixinFakeConstructor = true; }\r\nexport function MixOnlyFuncs2<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    Class<A1, I1, S1> & Class<A2, I2, S2>{\r\n    return MixOnlyFuncs(c1, c2) as any;\r\n}\r\nexport function MixOnlyFuncs3<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    Class<A1&A2, I1&I2, S1&S2>{\r\n    return MixOnlyFuncs(c1, c2) as any;\r\n}\r\nexport function MixOnlyFuncs<A1 extends any[], I1, S1, A2 extends any[], I2, S2>(c1: Class<A1, I1, S1> & typeof RuntimeAccessibleClass, c2: Class<A2, I2, S2> & typeof RuntimeAccessibleClass):\r\n    CClass<Longest<A1, A2>, I1 & I2\r\n        & {\r\n        // superclass: Dictionary<string, (/*thiss: I1 & I2,* / ...superConstructorParams:ConstructorParameters<Class<A1, I1, S1>> | ConstructorParameters<Class<A2, I2, S2>>) => void>,\r\n        superclass1: Dictionary<DocString<'constructor name to make sure the user knows what superclass constructor is calling'>,  (...superConstructor1Params:ConstructorParameters<Class<A1, I1, S1>>) => void>,\r\n        superclass2: Dictionary<DocString<'constructor name to make sure the user knows what superclass constructor is calling'>,  (...superConstructor2Params:ConstructorParameters<Class<A2, I2, S2>>) => void>,\r\n        // initt: Class<A1, I1, S1>\r\n    } & AbstractMixedClass\r\n        // , Omit<Omit<Omit<S1 & S2, 'init_constructor'>, 'logic'>, 'maxID'> & typeof AbstractMixedClass> {\r\n        , S1 & S2 & GObject & typeof AbstractMixedClass> {\r\n    // strategia: passo dei finti valori che copiano i prototipi delle classi sovrascrivendo i costruttori per evitare che chiami i costruttori delle superclassi\r\n    // ma che comunque erediti campi e funzioni\r\n    // @ts-ignore\r\n    let c1noconstructor: any = MixinFakeConstructor;\r\n    let c2noconstructor: any = MixinFakeConstructor;\r\n    c1noconstructor.prototype = c1.prototype;\r\n    c2noconstructor.prototype = c2.prototype;\r\n\r\n    let disableconstructor = false;\r\n    if (!disableconstructor) {\r\n        c1noconstructor = c1;\r\n        c2noconstructor = c2; }\r\n\r\n\r\n    let ret = Mixin(c1noconstructor, c2noconstructor);\r\n    let c1name = (c1.cname || c1.name) === 'classnameFixedConstructorDoNotRenameWithoutSearchStrings' ? c1.prototype.className : c1.cname || c1.name;\r\n    let c2name = (c2.cname || c2.name) === 'classnameFixedConstructorDoNotRenameWithoutSearchStrings' ? c2.prototype.className : c2.cname || c2.name;\r\n    //ret.prototype['superclass'] = {};\r\n    // ret.prototype['superclass'][c1name] = c1.prototype.init_constructor || invalidSuperClassError(c1name, c1);\r\n    // ret.prototype['superclass'][c2name] = c2.init_constructor || invalidSuperClassError(c2name, c2);\r\n    ret.prototype['superclass1'] = {};\r\n    ret.prototype['superclass2'] = {};\r\n    ret.prototype['superclass1'][c1name] = c1.init_constructor || invalidSuperClassError(c1name, c1);\r\n    ret.prototype['superclass2'][c2name] = c2.init_constructor || invalidSuperClassError(c2name, c2);\r\n    return ret;\r\n}\r\nconsole.warn('ts loaded classes');\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//*********************************************************************************************\r\n//*********************************************************************************************\r\n///////                              type juggling starts here                          ///////\r\n//*********************************************************************************************\r\n//*********************************************************************************************\r\n\r\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'> & {big: T};\r\n// export type NotAString<T extends any = 'uselessval'> = Omit<string, 'bold'>;\r\n// export type NotAString<T extends any = 'uselessval', T2 extends any = any, T3 extends any = any, T4 extends any = any> = string & Omit<string, 'bold'> & {bold: ()=>string};\r\nexport type NotAString<T extends any = 'uselessval', T2 extends any = any, T3 extends any = any, T4 extends any = any> = string & Omit<string, 'bold'> & {bolda?: T};\r\n// export type NotAString<T> = string;\r\n// type Pointer<T> = NotAString<T>;\r\nexport type Pointer<T extends DPointerTargetable = DPointerTargetable, lowerbound extends number = 1, upperbound extends number|'N' = 1,\r\n    RET extends LPointerTargetable = DtoL<T>> =\r\n    upperbound extends 'N' ? NotAString<T, lowerbound, upperbound, RET>[] : (\r\n        upperbound extends 0 ? never : (\r\n            lowerbound extends 0 ? (NotAString<T, lowerbound, upperbound, RET> | null) : NotAString<T, upperbound, lowerbound, RET>));\r\n\r\n\r\nexport type PtrString = any; // to convert Pointers to strings more explicitly then using as any\r\n// let ptr: Pointer<Object> = null as any;\r\n\r\nclass D extends DPointerTargetable{\r\n    parent!: Pointer<D>;\r\n    dattrib!: boolean;\r\n    juststring!: string;\r\n    nattrib!: number;\r\n    ddattrib!: Date\r\n}\r\n\r\nclass D2 extends D{\r\n    d2!: string;\r\n}\r\nclass D3 extends D{\r\n    d3!: string;\r\n}\r\n\r\n\r\n\r\ntype OverrideTypes<M, N> = { [P in keyof M]: P extends keyof N ? N[P] : M[P] }; // usage:  OverrideTypes<A, { x: number }>;\r\n\r\ninterface LFix {\r\n    parent: L;\r\n}\r\ninterface L { // no instances ever\r\n    parent: L;\r\n    lattrib: boolean;\r\n}\r\ninterface L2 extends L { // no instances ever\r\n    l2: string;\r\n}\r\ninterface L3 extends L{ // no instances ever\r\n    l3: string;\r\n}\r\n\r\nclass P { // singleton\r\n    get_parent(){}\r\n    set_parent(){}\r\n}\r\nclass P2 extends P { // singleton\r\n    get_d2() {}\r\n}\r\nclass P3 extends P { // singleton\r\n    get_d3() {}\r\n}\r\n\r\ntype ERROR = \"_TYPE_ERROR_\";\r\n// RegExp extends Animal ? number : string\r\n\r\n\r\nfunction buildWrapSignature(maxdepth = 100) {\r\n    let arr = windoww[\"DPointerTargetable\"].subclasses;\r\n    /*\r\n    let dict0 = arr.reduce((a, v) => ({ ...a, [v.name]: v}), {});\r\n    let dict = {}\r\n    for (let name in dict0) { let n = name.substring(1); dict[n] = {\"D\":dict0[\"D\"+n], \"L\":dict0[\"L\"+n]}; dict[\"D\"+n] = dict0[\"L\"+n]; dict[\"L\"+n] = dict0[\"D\"+n]; }\r\n    console.log(\"dict\", dict);\r\n    console.table(dict);\r\n    */\r\n    function onlyUnique(value: any, index: number, self: any) { return self.indexOf(value) === index; }\r\n\r\n    let dep = arr; // .map( (me) => { return {\"name\": me.name, \"me\": me, \"Derror\": (dict[me.name] || me).name, \"Lerror\": (dict[me.name] || me).name, \"subclasses\": [...me.subclasses]}});\r\n    let depsorted = [];\r\n\r\n    let byLevels = [];\r\n    let loopdetecter: any[] = [arr];\r\n    while (dep.length && maxdepth--) {\r\n        let namelist = dep.map((e: any) => e.name).filter(onlyUnique);\r\n        depsorted.push(...namelist);\r\n        byLevels.push([...namelist]);\r\n        let olddep = dep;\r\n        dep = dep.flatMap((d: any) => d.subclasses).filter(onlyUnique);\r\n        for (let d of dep) {\r\n            windoww.loopdetecter = loopdetecter;\r\n            windoww.dep = dep;\r\n            windoww.olddep = olddep;\r\n            windoww.byLevels = byLevels;\r\n            windoww.d = d;\r\n            if ( loopdetecter.includes(d.subclasses) ) throw new Error(\"class is not redefining subclasses static array: \" + d.name);\r\n            loopdetecter.push(d.subclasses);\r\n        }\r\n    }\r\n    console.log(\"byLevels\");\r\n    console.table(byLevels);\r\n\r\n    console.log(\"depsorted\", depsorted);\r\n\r\n    // console.log(\"map\");\r\n    // console.table(depsorted.map(dn => {let d = window[dn]; return !d ? \"\" :{name:d.name, scount: d.subclasses.length, subclasses:d.subclasses}}));\r\n\r\n\r\n    let goalSignature = \"function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\";\r\n    let lparam = \"ERROR\";\r\n    let epsorted = depsorted.map( e => e.substring(1)).filter(onlyUnique);\r\n    console.table(epsorted)\r\n    for (let e of epsorted) {\r\n        let D = \"D\" + e;\r\n        let L = \"L\" + e;\r\n        lparam = \"DX extends \" + D + \" ? \"  + L + \" : (\" + (lparam) + \")\";\r\n    }\r\n    let signature = \"function wrap<DX extends DPointerTargetable, LX = \" + lparam + \">(data: DX): LX {\";\r\n    return signature;\r\n}\r\nwindoww.buildWrapSignature = buildWrapSignature;\r\n// function wrap<DX extends D, LX = DX extends D2 ? L2: (DX extends D3 ? L3: (DX extends D ? L : ERROR))>(data: DX): LX {\r\n\r\n/*\r\n* NO    L -> D    /// l.__raw\r\n* NO    L -> Ptr  /// l.id\r\n*\r\n* NO    D -> Ptr   // d.id\r\n* YES   D -> L     // wrap\r\n*\r\n* NO    Ptr -> D\r\n* NO    Ptr -> L\r\n*\r\n*\r\n*\r\n*\r\n* DpointerTargetable.from( L or pointer )\r\n* LpointerTargetable.from( D or pointer )\r\n*\r\n* MyProxyHandler.wrap = LpointerTargetable.from;\r\n*\r\n* DpointerTargetable.toPointer( d );\r\n*\r\n* */\r\n\r\n\r\n\r\ntype subtract<P, C> = { [F in keyof P]: keyof C extends undefined ? undefined : P[F] };\r\ntype subtractDL = subtract<D, L>;\r\ntype Exclude3<T, U> = T & {[T in keyof U]: never};\r\ntype Override<A, B> = Omit<A, keyof B> & B; //////////////////////////////////////////// best solution so far\r\n\r\ntype Exclude2<Type, field> = {\r\n    [Property in keyof Type as Exclude<Property, keyof field>]: Type[Property]      /////////////////////////equally best solution\r\n};\r\n\r\n\r\ntype OnlyKeysOfTypeTmp<T, IncludeType> = ({[P in keyof T]: T[P] extends IncludeType ? P : never })[keyof T];\r\ntype OnlyKeysOfType<T, IncludeType> = Pick<T, OnlyKeysOfTypeTmp<T, IncludeType>>;\r\ntype RemoveKeysOfType<T, ExcludeType> = Exclude2<T, OnlyKeysOfType<T, ExcludeType>>;\r\n\r\n// todo: can't automatically convert D to L (generating the type instead of manual defining L) rules are: LClass <--- Pointer<LClass>, LClass[] <-- Pointer<LClass, 0, 'N'>, subobject = ? should not be there\r\n\r\n/**\r\n i have a documentation type that is actually a string, but it\\'s have a different purpose from the others, and i made a type to keep documentally separated.\r\n let's say it's\r\n type StringOf<P> = string; // regardless of P\r\n\r\n and i use it to define objects\r\n\r\n class C {\r\n           str: StringOf<Date>;\r\n           str2: StringOf<number>;\r\n           purestring: string;\r\n           num: number\r\n         }\r\n now i want to crete a derivate type that excludes all properties of type StringOf from C\r\n\r\n\r\n\r\n type OnlyKeysOfTypeTmp<T, IncludeType> = ({[P in keyof T]: T[P] extends IncludeType ? P : never })[keyof T];\r\n type OnlyKeysOfType<T, IncludeType> = Pick<T, OnlyKeysOfTypeTmp<T, IncludeType>>;\r\n type RemoveKeysOfType<T, ExcludeType> = Exclude2<T, OnlyKeysOfType<T, string>>;\r\n\r\n type D = RemoveKeysOfType<C, StringOf<any>>\r\n due to duck typing, this removes all StringOf attributes, but also \"purestring\" attribute.\r\n how can i remove only StringOf attributes?\r\n\r\n\r\n */\r\n\r\n\r\n\r\nexport type getWParams<L extends LPointerTargetable, D extends Object> ={\r\n    // [Property in keyof ValidObj<L>]: L[Property] extends never ? never : L[Property]\r\n    [Property in keyof L]:/*\r\n            Property extends \"opposite\" ? LReference | DReference | Pointer<DReference> :\r\n            Property extends \"parent\" ? LModelElement | DModelElement | Pointer<DModelElement> :\r\n            Property extends \"annotations\" ? LAnnotation | DAnnotation | Pointer<DAnnotation> :*/\r\n    (Property extends string ? (\r\n        Property extends \"id\" ? 'id is read-only' :\r\n            //@ts-ignore\r\n            (L[`set_${Property}`] extends (a:any, b: any, ...b:any)=> any ? // at least 2 params: 1 for val and 1 for Context\r\n                // if a set_ first parameter is Context it means the set_ is ill-defined, need to change actual method signature.\r\n                //@ts-ignore\r\n                Parameters<L[`set_${Property}`]>[0] // if set_X function is defined, get first param\r\n                //@ts-ignore\r\n                : never ///D[Property] | `todo: should define set_${Property}` // default type if it's not assigned = type in the D version\r\n                )): never)\r\n} // & L\r\n","import type {DocString, DtoL, DtoW, GObject, Proxyfied, WPointerTargetable,} from \"../joiner\";\r\nimport {\r\n    Dictionary,\r\n    DModelElement,\r\n    DPointerTargetable,\r\n    JsType,\r\n    LModelElement,\r\n    Log,\r\n    LPointerTargetable,\r\n    Pointer,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    SetFieldAction,\r\n    SetRootFieldAction,\r\n    U\r\n} from \"../joiner\";\r\n\r\ntype NotAConcatenation = null;\r\ntype ERROR = \"_Type_Error_\";\r\n\r\n// (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (ERROR))\r\n// (DX extends DUser ? LUser : (DX extends DPointerTargetable ? LPointerTargetable : (           WViewElement\r\n//\r\n// (IN extends WViewElement ? LViewElement : (IN extends WViewTransientProperties ? LWiewTransientProperties : (ERROR)))\r\n// ))\r\n// type WtoL<WX extends WPointerTargetable> ='';\r\n\r\n@RuntimeAccessible\r\nexport class LogicContext<\r\n    DX extends GObject = DModelElement,\r\n    LX = DtoL<DX>,\r\n    // PF extends MyProxyHandler<DX> = MyProxyHandler<DX>,\r\n    WX = DtoW<DX>\r\n    > extends RuntimeAccessibleClass{\r\n    public static cname: string = \"LogicContext\";\r\n    // public proxyfyFunction: PF;\r\n    public proxyObject: LX;\r\n    public data: DX;// & GObject;\r\n    public write: WX;\r\n    constructor(proxyObject: LX, data: DX) {\r\n        super();\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        this.data = data;\r\n        this.proxyObject = proxyObject;\r\n        this.write = proxyObject as any;\r\n    }\r\n    /*\r\n        saveToRedux(propkey: \"keyof data\" | string, val: \"typeof data[path]\" | any): void { // todo: ask non stackoverflow\r\n            // todo, put data in redux store, path is \"obj1.obj2.obj3...\" might replace it with a path funciton that return the foremost nested object container\r\n            if (!propkey) {\r\n                // todo: set whole object instead of a property\r\n            }\r\n        }*/\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, LogicContext);\r\n@RuntimeAccessible\r\nexport class MapLogicContext extends LogicContext<GObject, LPointerTargetable, WPointerTargetable> {\r\n    public static cname: string = \"MapLogicContext\";\r\n    data: GObject;\r\n    path: string;\r\n    subMaps: string[];\r\n    constructor(proxy: LPointerTargetable, data: GObject, path: string, subMaps: string[] = []) {\r\n        super(proxy, data);\r\n        // this.proxyfyFunction = proxyfyFunction;\r\n        this.proxyObject = proxy;\r\n        this.data = data;\r\n        this.path = path;\r\n        this.subMaps = subMaps;\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(LogicContext, MapLogicContext);\r\n@RuntimeAccessible\r\nexport abstract class MyProxyHandler<T extends GObject> extends RuntimeAccessibleClass implements ProxyHandler<T>{\r\n    public static cname: string = \"MyProxyHandler\";\r\n    s: string = 'set_';\r\n    g: string = 'get_';\r\n    /*get(target: T, p: string | number | symbol, proxyitself: Proxyfied<T>): boolean {\r\n        switch (p) {\r\n            case '_isProxy': return true;\r\n            case 'init': return (this as any).init;\r\n            case 'init0': return (this as any).init0;\r\n            default: throw new Error('proxy get must be overridden, called for key: ' + (p as string));\r\n        }}*/\r\n    set(target: T, p: string | number | symbol, value: any, proxyitself: Proxyfied<T>): boolean { throw new Error('proxy set must be overridden'); }\r\n    deleteProperty(target: T, p: string | symbol): boolean { throw new Error('proxy delete must be overridden'); }\r\n\r\n    ownKeys(target: T): ArrayLike<string | symbol>{ return Object.getOwnPropertyNames(target); }\r\n    static wrap<D extends RuntimeAccessibleClass, L extends LPointerTargetable = LPointerTargetable, CAN_THROW extends boolean = false,\r\n        RET extends CAN_THROW extends true ? L : L | undefined  = CAN_THROW extends true ? L : L>\r\n    (data: D | Pointer | undefined | null, baseObjInLookup?: DPointerTargetable, path: string = '', canThrow: CAN_THROW = false as CAN_THROW): RET{\r\n\r\n//    static wrap<D extends RuntimeAccessibleClass, L extends LPointerTargetable, RET extends boolean = false>\r\n//        (data: D | Pointer<DViewElement>, baseObjInLookup?: DPointerTargetable, path: string = '', canthrow: RET = false as RET): RET {\r\n        return DPointerTargetable.wrap(data, baseObjInLookup, path) as RET; }\r\n\r\n    static isProxy(data: GObject): boolean { return data?.__isProxy || false; }\r\n}\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, MyProxyHandler);\r\nexport type GetPath<T = GObject> = T;\r\n/*\r\n* handling proxy += and proxy -=\r\n*\r\n* will become var = var + add; which will call Symbol.getPrimitive\r\nconsole.log(+obj2);     // 10        — hint is \"number\"         NaN with +array with multiple vals, +array[0] with array of size 1, NaN with functions & objects\r\nconsole.log(`${obj2}`); // \"hello\"   — hint is \"string\"         array => array.join(','), object => \"[object Object]\", function => function.toString() whole func definition with body code\r\nconsole.log(obj2 + \"\"); // \"true\"    — hint is \"default\"        array, object, function => same as with hint \"string\"\r\n*\r\n* */\r\n\r\n// NB: lclass.extends += somepointer will become: lclass.extends = lclass.extends + somepointer;\r\n// array + string will cause getPrimitive(\"default\") to array, then .join(',') on it, and finally and toString() to be called on all array members.\r\n// so pointers cannot include \",\" char and toString() must return a pointer to keep lclass.extends += somepointer as a valid expression;\r\n// -= will call getPrimitive(\"number\") which will result in array -> NaN, so NaN = NaN - pointer and cannot be done.\r\n\r\n@RuntimeAccessible\r\nclass GetPathHandler<T extends GObject> extends MyProxyHandler<T>{\r\n    strbuilder: string = '';\r\n    array: (string | number | symbol)[] = [];\r\n    calls: (GObject<'parameters of get calls'>)[] = [];\r\n    public static __asCalls: boolean = false;\r\n    public static __asArray: boolean = false;\r\n    public static __nested: boolean = true;\r\n\r\n    public constructor() { super(); }\r\n\r\n    get(targetObj: T, propKey: keyof T | string, proxyitself: Proxyfied<T>): any {\r\n        // console.log('GetPathHandler', {targetObj, propKey, proxyitself});\r\n        if (propKey === \"start\") { this.strbuilder = ''; this.array = []; }\r\n        if (propKey === '$') {\r\n            const ret = GetPathHandler.__asCalls ? this.calls : (GetPathHandler.__asArray ? this.array : this.strbuilder);\r\n            this.array = [];\r\n            this.strbuilder = '';\r\n            return ret; }\r\n        this.array.push(propKey);\r\n        this.calls.push(arguments);\r\n        if (propKey === Symbol.toPrimitive) {\r\n            console.log(\"toprimitive\");\r\n            return (...a: any)=> {console.log(\"toprimitive called with parameters\", a); }\r\n        }\r\n        if (!GetPathHandler.__asArray && !GetPathHandler.__asCalls) {\r\n            if (typeof propKey === \"symbol\") { this.strbuilder += propKey.toString(); }\r\n            else {\r\n                // Giordano: add ignore for webpack\r\n                //@ts-ignore\r\n                this.strbuilder += (this.strbuilder ? '.' : '') + propKey;\r\n            }\r\n        }\r\n        return GetPathHandler.__nested ? proxyitself : {};\r\n    }\r\n\r\n    set(target: T, p: string | number | symbol, value: any, proxyitself: Proxyfied<T>): boolean {\r\n        switch(p){\r\n            case '__asArray':\r\n            case '__asCalls':\r\n            case '__nested':\r\n                (GetPathHandler as any)[p] = value;\r\n                return true;\r\n            default:\r\n                throw new Error('getPath proxy cannot be written');\r\n        }\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(MyProxyHandler, GetPathHandler);\r\n@RuntimeAccessible\r\nexport class TargetableProxyHandler<ME extends GObject = DModelElement, LE extends LPointerTargetable = LModelElement> extends MyProxyHandler<ME> {\r\n    public static cname: string = \"TargetableProxyHandler\";\r\n// permette di fare cose tipo: user.name_surname che ritorna la concatenazione di nome e cognome anche se il campo name_surname non esiste.\r\n    lg: LE & GObject; // to disable type check easily and access 'set_' + varname dynamically\r\n    l: LE;\r\n    d: ME;\r\n    additionalPath: string;\r\n\r\n    public baseObjInLookup: DPointerTargetable;\r\n\r\n    constructor(d: ME, baseObjInLookup?: DPointerTargetable, additionalPath: string = '', l?: LE) {\r\n        super();\r\n        this.d = d;\r\n        if (!l) {\r\n            l = RuntimeAccessibleClass.get(d.className)?.logic?.singleton as LE;\r\n            Log.exDev(!l, 'Trying to wrap class without singleton or logic mapped', { object: d })\r\n        }\r\n        this.baseObjInLookup = baseObjInLookup || d as any;\r\n        this.additionalPath = additionalPath;\r\n        this.l = l as LE;\r\n        this.lg = this.l;\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n\r\n    // damiano todo: this does not work\r\n    private concatenableHandler(targetObj: ME, propKey: number | string | symbol, proxyitself: Proxyfied<ME>): NotAConcatenation | any[] | string {\r\n        console.log(\"concatenableHandler 1\", {targetObj, propKey, proxyitself});\r\n        if (propKey in targetObj)  return null as NotAConcatenation;\r\n        const propKeyStr: null | string = U.asString(propKey, null);\r\n        let _index: number = propKeyStr ? propKeyStr.indexOf('_') : -1;\r\n        console.log(\"concatenableHandler 2\", {targetObj, propKey, propKeyStr, proxyitself, _index});\r\n        if (_index < 0) return null as NotAConcatenation;\r\n\r\n        let isConcatenable = true;\r\n        let ret: any[] = (propKey as string).split('_').map( (subKey: string) => {\r\n            console.log(\"concatenableHandler 3.0\", {targetObj, subKey, propKeyStr, proxyitself});\r\n            // se trovo multipli ___ li tratto come spazi aggiuntivi invece che come proprietà '' che ritornano undefined, così posso fare name___surname --> \"damiano   di vincenzo\"\r\n            let val: any = subKey === '' ? ' ' : this.get(targetObj, subKey, proxyitself);\r\n            console.log(\"concatenableHandler 3.1\", {targetObj, subKey, val, propKeyStr, proxyitself, isConcatenable});\r\n            isConcatenable = isConcatenable && JsType.isPrimitive(val);\r\n            console.log(\"concatenableHandler 3.2\", {targetObj, subKey, val, propKeyStr, proxyitself, isConcatenable});\r\n            return val;\r\n        });\r\n        console.log(\"concatenableHandler 4\", {targetObj, propKey, propKeyStr, proxyitself, ret, isConcatenable});\r\n        return isConcatenable ? ret.join(' ') : ret; }\r\n\r\n    public get(targetObj: ME, propKey: string | symbol, proxyitself: Proxyfied<ME>): any {\r\n        let ret;\r\n        let isError = false;\r\n        // console.error('_proxy get PRE:', {targetObj, propKey, proxyitself, arguments});\r\n        try { ret = this.get0(targetObj, propKey, proxyitself); } catch(e) { ret = e; isError = true;}\r\n\r\n        // if (isError) throw ret;\r\n        // console.error('_proxy get POST:', {targetObj, propKey, ret, isError});\r\n        return ret;\r\n    }\r\n\r\n    public get0(targetObj: ME, propKey: string | symbol, proxyitself: Proxyfied<ME>): any {\r\n        // console.log('proxy keysearch', {propKey, targetObj, l: this.l, proxyitself, d: this.d});\r\n        let canThrowErrors = true;\r\n        if (propKey === \"__raw\") return targetObj;\r\n\r\n        switch(typeof propKey){\r\n            case \"symbol\":\r\n                switch(String(propKey)){\r\n                    default: Log.exDevv('unexpected symbol:', propKey); break;\r\n                    case \"Symbol(Symbol.toPrimitive)\": return (targetObj as any)[propKey];//  || typeof targetObj;\r\n                }\r\n                return null;\r\n            case \"number\": return null;\r\n        }\r\n\r\n        switch(propKey){\r\n            case 'inspect': // node.js util\r\n            case '__Raw':\r\n            case '__raw': return targetObj;\r\n            case '__serialize': return JSON.stringify(targetObj);\r\n            case '__isproxy':\r\n            case '__isProxy': return true;\r\n            case '__random': return Math.random();\r\n            case 'editCount':\r\n            case 'clonedcounter':\r\n            case 'clonedCounter':\r\n                return targetObj.clonedCounter || 0;\r\n        }\r\n        if (propKey[0] === \"_\" && propKey.indexOf(\"__info_of__\")===0) {\r\n            return (this.l as GObject)[propKey];\r\n        }\r\n\r\n\r\n        const proxyacceptables = {typeName:'', $$typeof:''};\r\n        // check if exist directly in D.key, L.key or through a get_key\r\n        if (propKey in this.l || propKey in this.d || (this.l as GObject)[this.g + (propKey as string)] || propKey in proxyacceptables) {\r\n            // todo: il LogicContext passato come parametro risulta nell'autocompletion editor automaticamente generato, come passo un parametro senza passargli il parametro? uso arguments senza dichiararlo?\r\n            if (typeof propKey !== 'symbol' && this.g + propKey in this.lg) return this.lg[this.g + propKey](new LogicContext(proxyitself as any, targetObj));\r\n\r\n\r\n\r\n            // if specific custom getter exist\r\n            if (typeof propKey !== 'symbol' && this.g + propKey in this.lg) {\r\n                let getterMethod: Function = this.lg[this.g + propKey]; // || this.defaultGetter;\r\n                // console.log(\"gets method\", {getterMethod, lg:this.lg, thiss: this});\r\n                if (getterMethod) return getterMethod(new LogicContext(proxyitself as any, targetObj));\r\n\r\n            }\r\n            // if custom generic getter exist\r\n            if (this.lg._defaultGetter) return this.lg._defaultGetter(new LogicContext(proxyitself as any, targetObj), propKey);\r\n\r\n\r\n            switch (propKey){\r\n                default:\r\n                    //constructor.prototype.typeName\r\n                    // se esiste la proprietà ma non esiste il getter, che fare? do errore?\r\n                    // Log.eDevv(\"dev error: property exist but getter does not: \", propKey, this);\r\n                    // console.error('proxy GET direct match', {targetObj, propKey, ret: this.d[propKey as keyof ME]});\r\n                    // console.error('proxy GET direct match', {l:this.l});\r\n                    return this.d[propKey as keyof ME];\r\n                case '$$typeof':\r\n                case \"typeName\":\r\n                    return this.d.className;\r\n            }\r\n        }\r\n\r\n        // if not exist check for children names\r\n\r\n        if (typeof propKey === \"string\" && propKey !== \"children\" && (\"children\" in this.l)) { // __info_of_children__\r\n            let lchildren: LPointerTargetable[];\r\n            try { lchildren = this.get(targetObj, 'children', proxyitself); }\r\n            catch (e) { lchildren = []; }\r\n            // let dchildren: DPointerTargetable[] = lchildren.map<DPointerTargetable>(l => l.__raw as any);\r\n            let lc: GObject;\r\n            if (propKey[0] === \"@\") { propKey = propKey.substring(1); canThrowErrors = false; }\r\n            for (lc of lchildren) {\r\n                if (lc.name === propKey) return lc;\r\n            }\r\n        }\r\n\r\n        // if property do not exist, try a concatenation\r\n        let concatenationTentative = null;\r\n        try {concatenationTentative = this.concatenableHandler(targetObj, propKey, proxyitself); } catch(e) {}\r\n        if (concatenationTentative !== null) return concatenationTentative;\r\n        Log.ex(canThrowErrors,'GET property \"'+ (propKey as any)+ '\" do not exist in object of type \"' + U.getType(this.l) + \" DType:\" +  U.getType(this.l), {logic: this.l, data: targetObj});\r\n        return undefined;\r\n        // todo: credo che con espressioni sui tipi siano tipizzabili tutti i return di proprietà note eccetto quelle ottenute per concatenazione.\r\n    }\r\n\r\n    public defaultGetter(targetObj: ME, key: string, proxyitself: Proxyfied<ME>): any {\r\n        if (!targetObj) return targetObj;\r\n        if (!targetObj._subMaps || !targetObj._subMaps[key]) return (targetObj as Dictionary)[key];\r\n        // if is a nexted subobject\r\n        let context: MapLogicContext = new MapLogicContext(proxyitself as any, targetObj, key, []);\r\n        let retRaw: Dictionary = this.lg[this.s + key]\r\n        return MapProxyHandler.mapWrap((targetObj as Dictionary)[key], targetObj as any, this.additionalPath + '.' + key)\r\n    }\r\n\r\n    public defaultSetter(targetObj: DPointerTargetable, propKey: string, value: any, proxyitself?: Proxyfied<ME>): boolean {\r\n        SetFieldAction.new(targetObj, propKey as any, value);\r\n        return true;\r\n    }\r\n\r\n    public set(targetObj: ME, propKey: string | symbol, value: any, proxyitself?: Proxyfied<ME>): boolean {\r\n        let enableFallbackSetter = true;\r\n\r\n        // console.error('_proxy set PRE:', {targetObj, propKey, value, proxyitself, arguments});\r\n        // if (propKey in this.l || propKey in this.d || (this.l as GObject)[this.s + (propKey as string)] || (this.l as GObject)[(propKey as string)]) {\r\n        if (propKey in this.l || propKey in this.d || (this.l as GObject)[this.s + (propKey as string)]) {\r\n            // todo: il LogicContext passato come parametro risulta nell'autocompletion editor automaticamente generato, come passo un parametro senza passargli il parametro? uso arguments senza dichiararlo?\r\n            if (typeof propKey !== 'symbol' && this.s + propKey in this.lg) return this.lg[this.s + propKey](value, new LogicContext(proxyitself as any, targetObj));\r\n\r\n\r\n\r\n            // if custom generic getter exist\r\n            if (this.lg._defaultSetter) return this.lg._defaultSetter(value, new LogicContext(proxyitself as any, targetObj), propKey);\r\n            if (enableFallbackSetter) {\r\n                return this.defaultSetter(targetObj as any as DPointerTargetable, propKey as string, value, proxyitself);\r\n                // new SetFieldAction(new LogicContext(proxyitself as any, targetObj).data as any, propKey as string, value); return true;\r\n            }\r\n            // se esiste la proprietà ma non esiste il setter, che fare? do errore.\r\n            Log.eDevv(\"dev error: property exist but setter does not: \", propKey, this);\r\n            return false;\r\n        }\r\n        // if property do not exist\r\n        let breakpoint = 1;\r\n\r\n        // if custom generic getter exist\r\n        if (this.lg._defaultSetter) return this.lg._defaultSetter(value, new LogicContext(proxyitself as any, targetObj), propKey);\r\n        if (enableFallbackSetter && typeof (propKey === \"string\") && ((propKey as string)[0] === '_' || (propKey as string).indexOf('tmp') > 0)) {\r\n            return this.defaultSetter(targetObj as any as DPointerTargetable, propKey as string, value, proxyitself);\r\n            // new SetFieldAction(new LogicContext(proxyitself as any, targetObj).data as any, propKey as string, value); return true;\r\n        }\r\n        Log.exx('SET property \"set_' + (propKey as any) + '\" do not exist in object of type \"' + U.getType(this.l) + \" DType:\" +  U.getType(this.l), {'this': this, targetObj});\r\n        return false; }\r\n    /*      problema: ogni oggetto deve avere multipli puntatori, quando ne modifico uno devo modificarli tutti, come tengo traccia?\r\n            ipotesi 1: lo memorizzo in un solo posto (store.idlookup) e uso Pointer<type, lb, ub> che è una stringa che simula un puntatore\r\n            problema 1: se fornisco l'intero store ai componenti si aggiornano ad ogni singola modifica, se estraggo i campi interesasti le stringhe puntatore sono invariate ma il contenuto puntato è cambiato e il componente non lo sa...\r\n            problemone 2: non so a quali proprietà dello store devo abbonarmi, devo leggere sempre tutto lo store?\r\n            !!!!! soluzione 2?: dovrei dichiarare le variabili a cui mi abbono, salvarle nello stato e precaricarle tramite mapStateToProps*/\r\n\r\n    public deleteProperty(target: ME, key: string | symbol, proxyItself?: Proxyfied<any>): boolean {\r\n        if (typeof key === \"symbol\") return false;\r\n        this.set(target, key, undefined, proxyItself);\r\n        delete target[key];\r\n        return true; }\r\n\r\n    ownKeys(target: ME): ArrayLike<string | symbol>{\r\n        return U.arrayMergeInPlace(Object.keys(target), Object.keys(this.l).filter(k => k.indexOf('set_') !== 0 || k.indexOf('get_') !== 0));\r\n    }\r\n\r\n    /*\r\n    apply(target: DModelElement, thisArg: any, argArray: any[]): any {\r\n        // will i ever use it? dovrei pasare una funzione invece di una classe, quindi in questo caso credo wrappi solo il costruttore\r\n    }*/\r\n}\r\nRuntimeAccessibleClass.set_extend(MyProxyHandler, TargetableProxyHandler);\r\n@RuntimeAccessible\r\nexport class MapProxyHandler extends TargetableProxyHandler<Dictionary, LPointerTargetable> {\r\n    public static cname: string = \"MapProxyHandler\";\r\n    // todo: sposta alcune funzioni da TargetableProxy a MyProxy e fai estendere direttamente MyProxy a questa classe\r\n    public subMapKeys: Dictionary<string, any | Dictionary<DocString<'nested map keys'>>>;\r\n\r\n    constructor(d: Dictionary, baseObjInLookup: DPointerTargetable, additionalPath: string = '', subMapKeys: Dictionary<string, any | Dictionary<DocString<'nested map keys'>>> = {}) {\r\n        super(d, baseObjInLookup, additionalPath, LPointerTargetable.singleton);\r\n        this.subMapKeys = subMapKeys;\r\n    }\r\n\r\n    get(target: Dictionary, key: string | number | symbol, proxyitself: Proxyfied<Dictionary>): any {\r\n        if (typeof key === \"symbol\") return this.d[key as any];\r\n        let val: any = this.d[key];\r\n        if (key in this.subMapKeys && !(key in target)) { Log.exx('property not found in dictionary', {target, key, thiss:this, proxyitself, submapkeys: this.subMapKeys}); return undefined; }\r\n        if (key in this.subMapKeys) {\r\n            this.additionalPath += '.';\r\n            return MapProxyHandler.mapWrap( this.d, this.baseObjInLookup, this.additionalPath, this.subMapKeys[key]);\r\n            Log.exDevv('todo: wrap sub-map', {thiss: this});\r\n        }\r\n        return target[key as string]; }\r\n\r\n    set(target: Dictionary, key: string | number | symbol, value: any, proxyitself: Proxyfied<Dictionary>): boolean {\r\n        if (typeof key === \"symbol\") { Log.exx('cannot set a symbol in dictionary', {target, key, value, proxyitself}); return false; }\r\n        SetRootFieldAction.new(this.additionalPath + '.' + key, value, '',false)\r\n        return true;\r\n    }\r\n\r\n    public deleteProperty(target: Dictionary, key: string | symbol, proxyItself?: Proxyfied<any>): boolean {\r\n        if (typeof key === \"symbol\") return false;\r\n        this.set(target, key, undefined, proxyItself);\r\n        delete target[key];\r\n        return true; }\r\n}\r\nRuntimeAccessibleClass.set_extend(MyProxyHandler, MapProxyHandler);\r\n// 15-20 min + 5 di domande entro il 1° ottobre, discussione 10-12 ottobre\r\nexport const getPath: GetPath = new Proxy( {}, new GetPathHandler());\r\n(window as any).getPath = getPath;\r\n// usage: pathstring = ((getPath as DType).some.path.to.follow as any).$; // = \"some.path.to.follow\" with compilation-time validation\r\n","import {DocString, EdgeHead, ShortAttribETypes as SAType, U} from '../joiner';\r\nimport {GObject, RuntimeAccessible} from '../joiner';\r\nimport React, {ReactElement} from \"react\";\r\n// const beautify = require('js-beautify').html; // BEWARE: this adds some newline that might be breaking and introduce syntax errors in our JSX parser\r\nconst beautify = (s: any)=>s;\r\nlet ShortAttribETypes: typeof SAType = (window as any).ShortAttribETypes;\r\n\r\n@RuntimeAccessible\r\nexport class DV {\r\n    static cname: string = \"DV\";\r\n    public static modelView(): string { return beautify(DefaultView.model()); } // damiano: che fa beautify? magari potremmo settarlo in LView.set_jsx invece che solo qui, così viene formattato anche l'input utente?\r\n    public static packageView(): string { return beautify(DefaultView.package()); }\r\n    public static classView(): string { return beautify(DefaultView.class()); }\r\n    public static attributeView(): string { return beautify(DefaultView.feature()); }\r\n    public static referenceView(): string { return beautify(DefaultView.feature()); }\r\n    public static enumeratorView(): string { return beautify(DefaultView.enum()); }\r\n    public static literalView(): string { return beautify(DefaultView.literal()); }\r\n    public static voidView(): string { return beautify(DefaultView.void()); }\r\n    public static operationView(): string { return beautify(DefaultView.operation()); }\r\n    public static operationViewm1(): string { return beautify(DefaultView.operationm1()); }\r\n    public static objectView(): string { return beautify(DefaultView.object()); }\r\n    public static valueView(): string { return beautify(DefaultView.value()); }\r\n    public static defaultPackage(): string { return beautify(DefaultView.defaultPackage()); }\r\n    public static errorView_string(publicmsg: string | JSX.Element, debughiddenmsg?:any): string {\r\n        let visibleMessage = publicmsg && typeof publicmsg === \"string\" ? U.replaceAll(publicmsg, \"Parse Error: \", \"\") : publicmsg;\r\n        console.error(\"error in view:\", {publicmsg, debuginfo:debughiddenmsg}); return DefaultView.error_string(visibleMessage); }\r\n    public static errorView(publicmsg: string | JSX.Element, debughiddenmsg?:any): React.ReactNode {\r\n        let visibleMessage = publicmsg && typeof publicmsg === \"string\" ? U.replaceAll(publicmsg, \"Parse Error: \", \"\") : publicmsg;\r\n        console.error(\"error in view:\", {publicmsg, debuginfo:debughiddenmsg}); return DefaultView.error(visibleMessage); }\r\n\r\n    static edgePointView(): string { return beautify(\r\n        `<div className={\"edgePoint\"} tabIndex=\"-1\" hoverscale={\"hardcoded in css\"} style={{borderRadius:\"999px\", border: \"2px solid black\", background:\"transparent\", width:\"100%\", height:\"100%\"}} />`\r\n    )}\r\n    static edgePointViewSVG(): string { return beautify(\r\n        `<ellipse stroke={\"black\"} fill={\"red\"} cx={\"50\"} cy={\"50\"} rx={\"20\"} ry={\"20\"} />`\r\n        //`<ellipse stroke={\"black\"} fill={\"red\"} cx={this.props.node.x} cy={this.props.node.y} rx={this.props.node.w} ry={this.props.node.h} />`\r\n    )}\r\n\r\n    static svgHeadTail(head: \"Head\" | \"Tail\", type: EdgeHead): string {\r\n        let inner: string;\r\n        let headstr = head===\"Head\" ? \"this.segments.head\" : \"this.segments.tail\";\r\n        let styleTranslate = \"{}\"; // '{transform:\"translate(\" + ' + headstr + '.x + \"px, \" + ' + headstr + '.y + \"px)\"}';\r\n        let styleTranslateRotate = '{transform:\"translate(\" + ' + headstr + '.x + \"px, \" + ' + headstr + '.y + \"px) rotate(\" + (' + headstr + '.rad) + \"rad)\",' +\r\n            ' \"transformOrigin\":'+headstr+'.w/2+\"px \"+ '+headstr+'.h/2+\"px\"}';\r\n        let styleRotate = 'style={{transform:\"rotate(\" + ' + headstr + '.rad + \"rad), transformOrigin:\"noooope  not center\"}}'; // edgeHead EdgeReference\r\n        let attrs = `\\n\\t\\t\\t\\tstyle={`+styleTranslateRotate +`}\\n\\t\\t\\t\\t stroke={this.strokeColor} strokeWidth={this.strokeWidth}\r\n className={\"edge` + head + ` ` + type +` preview\"}></path>\\n`;\r\n        let path: string;\r\n        let hoverAttrs = `\\n\\t\\t\\t\\tstyle={`+styleTranslateRotate +`}\\n\\t\\t\\t\\t stroke={this.segments.all[0]&&(this.segments.all[0].length > this.strokeLengthLimit )&& this.strokeColorLong || this.strokeColorHover} strokeWidth={this.strokeWidthHover}\r\n className={\"edge` + head + ` ` + type +` clickable content\"}></path>\\n`;\r\n        switch(type) {\r\n            default:\r\n                inner = \"edge '\" + head + \"' with type: '\" +type + \"' not found\";\r\n                break;\r\n            case EdgeHead.extend:\r\n                path = `<path d={\"M 0 0   L \" + `+headstr+`.w + \" \" + `+headstr+`.h/2 + \"   L 0 \" + `+headstr+`.h + \"Z\" } fill=\"#fff\" `;\r\n                inner = path + attrs + \"\\n\\t\\t\\t\\t\" + path + hoverAttrs;\r\n                break;\r\n            case EdgeHead.reference:\r\n                path = `<path d={\"M 0 0   L \" + `+headstr+`.w + \" \" + `+headstr+`.h/2 + \"   L 0 \" + `+headstr+`.h } fill=\"none\" `;\r\n                inner = path + attrs + \"\\n\\t\\t\\t\\t\" + path + hoverAttrs;\r\n                break;\r\n            case EdgeHead.aggregation:\r\n                path = `<path d={\"M 0 \" + `+headstr+`.h/2 + \" L \" + `+headstr+`.w/2 + \" 0 L \" +\r\n                    `+headstr+`.w + \" \" +`+headstr+`.h/2 + \" L \" + `+headstr+`.w/2 + \" \" + `+headstr+`.h + \" Z\"} fill=\"#fff\" `;\r\n                inner = path + attrs + \"\\n\\t\\t\\t\\t\" + path + hoverAttrs;\r\n                break;\r\n            case EdgeHead.composition:\r\n                path = `<path d={\"M 0 \" + `+headstr+`.h/2 + \" L \" + `+headstr+`.w/2 + \" 0 L \" +\r\n                    `+headstr+`.w + \" \" + `+headstr+`.h/2 + \" L \" + `+headstr+`.w/2 + \" \" + `+headstr+`.h + \" Z\"} fill=\"#000\" `;\r\n                inner = path + attrs + \"\\n\\t\\t\\t\\t\" + path + hoverAttrs;\r\n                break;\r\n                /* `<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" style={overflow: \"visible\"}>\r\n                                            <path d={\"M 10 0 L 0 20 L 20 20 Z\"} fill=\"#ffffff\" stroke=\"#808080\" strokeWidth=\"1\"></path>\r\n                                         </svg>`;*/\r\n                //  style={transform: \"rotate3d(xcenter, ycenter, zcenter??, 90deg)\"}\r\n        }\r\n        //  transform={\"rotate(\"+`+headstr+`.rad+\"rad \"+ this.segments.all[0].start.pt.toString(false, \" \")}\r\n        return inner; // no wrap because of .hoverable > .preview  on root & subelements must be consecutive\r\n        // return `<g className=\"edge`+head + ` ` + type +`\" style={` + styleTranslate + `}>\\n`+ inner +`</g>`\r\n    }\r\n\r\n    // about label rotation in .edge > foreignObect > div (label)\r\n    // first transform is h-center. second is rotate, third adds [0, 50%] of 50% vertical offset AFTER rotation to take label out of edge. fourth is to add a margin.\r\n    static edgeView(modename: EdgeHead, head: DocString<\"JSX\">, tail: DocString<\"JSX\">, dashing: string | undefined): string { return beautify(\r\n        `<div className={\"edge ` + modename + `\"} style={{overflow: \"visible\", width:\"100%\", height:\"100%\", pointerEvents:\"none\"}}>\r\n            <svg className={\"hoverable\"} style={{width:\"100vw\", height:\"100vh\", pointerEvents:\"none\", overflow: \"visible\"}}>\r\n                { /* edge full segment */ }\r\n                <path className={\"preview\"} strokeWidth={this.strokeWidth}\r\n                stroke={this.strokeColor} fill={\"none\"} d={this.edge.d} strokeDasharray=\"` + dashing + `\"></path>\r\n                { /* edge separate segments */ }\r\n                { console.warn(\"inside jxs\", {thiss:this, segments:this.segments}) && null }\r\n                {this.segments.all.flatMap(s => [\r\n                    <path className={\"clickable content\"} style={{pointerEvents:\"all\"}} strokeWidth={this.strokeWidthHover}\r\n                    stroke={s.length > this.strokeLengthLimit && this.strokeColorLong || this.strokeColorHover}\r\n                     fill={\"none\"} d={s.dpart}></path>,\r\n                    s.label && <foreignObject style={{overflow: \"visible\", height:\"0\", width:\"0\", whiteSpace:\"pre\", x:(s.start.pt.x + s.end.pt.x)/2+\"px\", y:(s.start.pt.y + s.end.pt.y)/2+\"px\"}}>\r\n                    <div\r\n                     style={{width: \"fit-content\",\r\n                      transform: \"translate(-50%, 0%) rotate(\"+s.radLabels+\"rad) translate(0%, -\"+(1-0.5*Math.abs(Math.abs(s.radLabels)%Math.PI)/(Math.PI/2))*100+\"%)\"+\r\n                     \" translate(0%, -5px\", color: this.strokeColor}}>{s.label}</div>\r\n                    </foreignObject>\r\n                ])}\r\n            { /* edge head */ }\r\n            ` + head + `\r\n            { /* edge tail */ }\r\n            ` + tail + `\r\n            </svg>\r\n            { /* interactively added edgepoints */ }\r\n            {\r\n                edge.midPoints.map( m => <EdgePoint data={edge.father.model.id} initialSize={m} key={m.id} view={\"Pointer_ViewEdgePoint\"} /> )\r\n            }{\r\n                \r\n                false && edge.end.model.attributes.map( (m, index, arr) => <EdgePoint data={m.id} initialSize={(parent) => {\r\n                    let segs = parent.segments.segments;\r\n                    let pos = segs[0].start.pt.multiply(1-(index+1)/(arr.length+1), true).add(segs[segs.length-1].end.pt.multiply((index+1)/(arr.length+1), true));\r\n                    // console.trace(\"initial ep\", {segs, pos, ratio:(index+1)/(arr.length+1), s:segs[0].start.pt, e:segs[segs.length-1].end.pt});\r\n                    return {...pos, w:55, h:55}}} key={m.id} view={\"Pointer_ViewEdgePoint\"} /> )\r\n                    \r\n            }{\r\n                false && <EdgePoint key={\"midnode1\"} view={\"Pointer_ViewEdgePoint\"} />\r\n            }{\r\n                false && <EdgePoint key={\"midnode2\"} view={\"Pointer_ViewEdgePoint\"} />\r\n            }{\r\n                false && props.children && \"this would cause loop no idea why, needs to be fixed to allow passing EdgeNodes here\" || []\r\n            }\r\n        </div>`\r\n    )}\r\n}\r\n\r\nlet valuecolormap: GObject = {};\r\nvaluecolormap[ShortAttribETypes.EBoolean] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EByte] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EShort] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EInt] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.ELong] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EFloat] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EDouble] = \"orange\";\r\nvaluecolormap[ShortAttribETypes.EDate] = \"green\";\r\nvaluecolormap[ShortAttribETypes.EString] = \"green\";\r\nvaluecolormap[ShortAttribETypes.EChar] = \"green\";\r\nvaluecolormap[ShortAttribETypes.void] = \"gray\";\r\n\r\n// &&[]bn\r\nlet valuecolormap_str = JSON.stringify(valuecolormap);\r\n\r\n\r\nclass DefaultView {\r\n\r\n    public static model(): string {\r\n        return `<div className={'root model'}>\r\n            {!this.data && \"Model data missing.\"}\r\n            <div className=\"edges\" style={{zIndex:101, position: \"absolute\", height:0, width:0, overflow: \"visible\"}}>{[\r\n                    true && this.data.suggestedEdges.reference &&\r\n                    this.data.suggestedEdges.reference.map(\r\n                        se => (!se.vertexOverlaps)\r\n                         && <DamEdge start={se.start.father} end={se.end} view={\"Pointer_ViewEdge\" + ( se.start.containment && \"Composition\" || \"Association\")} key={se.start.node.id+\"~\"+se.end.node.id}/>)\r\n                         ,\r\n                    true && this.data.suggestedEdges.extend &&\r\n                    this.data.suggestedEdges.extend.map(\r\n                        se => (!se.vertexOverlaps)\r\n                         && <DamEdge start={se.start} end={se.end} view={\"Pointer_ViewEdgeInheritance\"} key={se.start.node.id+\"~\"+se.end.node.id}/>)]\r\n                }\r\n            </div>\r\n             {this.data && this.data.packages.map((pkg, index) => {\r\n                return <DefaultNode key={pkg.id} data={pkg.id}></DefaultNode>\r\n            })}\r\n            {this.data && this.data.allSubObjects.map((child, index) => {\r\n                return <DefaultNode key={child.id} data={child.id}></DefaultNode>\r\n            })}\r\n        </div>`;\r\n    }\r\n\r\n    public static void(): string {\r\n        return `<div className={'round bg-white root void model-less p-1'}>\r\n            <div>voidvertex element test</div>\r\n            <div>data: {this.props.data ? this.props.data.name : \"empty\"}</div>\r\n        </div>`;\r\n    }\r\n    public static package(): string {\r\n        return `<div className={'round bg-white root package'}>\r\n            { /*<Input jsxLabel={<b className={'package-name'}>EPackage:</b>} field={'name'} hidden={true} />*/ }\r\n            { console.log(\"evalcontex:\", {thiss: this, pname: this.pname, c: this._context}) && null}\r\n            {/*<Input jsxLabel={<b>{this.pname}:</b>} field={'name'} hidden={true} />*/}\r\n            <hr />\r\n            <div className={'package-children'}>\r\n            \r\n                {this.data.children.map((child, index) => {\r\n                    return <DefaultNode key={child.id} data={child.id}></DefaultNode>\r\n                })}\r\n            </div>\r\n        </div>`;\r\n    }\r\n\r\n    public static class(): string {\r\n        return `<div className={'round bg-white root class'}>\r\n            <Input jsxLabel={<b className={'class-name'}>EClass:</b>} \r\n                   data={this.data.id} field={'name'} hidden={true} autosize={true} />\r\n            <hr/>\r\n            {/* i kept them separated because i want them in this order. i could have used data.children once, or put all in same container to mix them. */}\r\n            <div className={'class-children'}>{ this.data.attributes.map(c => <DefaultNode key={c.id} data={c.id} />) }</div>\r\n            <div className={'class-children'}>{ this.data.references.map(c => <DefaultNode key={c.id} data={c.id} />) }</div>\r\n            <div className={'class-children'}>{ this.data.operations.map(c => <DefaultNode key={c.id} data={c.id} />) }</div>\r\n        </div>`;\r\n    }\r\n\r\n    public static enum(): string {\r\n        return `<div className={'round bg-white root enumerator'}>\r\n            <Input jsxLabel={<b className={'enumerator-name'}>EEnum:</b>} \r\n                   data={this.data.id} field={'name'} hidden={true} autosize={true} />\r\n            <hr />\r\n            <div className={'enumerator-children'}>\r\n                {this.data.children.map((child, index) => {\r\n                    return <DefaultNode key={child.id} data={child.id}></DefaultNode>\r\n                })}\r\n            </div>\r\n        </div>`;\r\n    }\r\n\r\n    public static feature(): string {\r\n        return `<div><Select className={'root feature'} data={this.data} field={'type'} label={this.data.name} /></div>`;\r\n    }\r\n\r\n    public static literal(): string {\r\n        return `<label className={'d-block text-center root literal'}>{this.data.name}</label>`\r\n    }\r\n\r\n    public static operation(): string {\r\n        return `<Select className={'root operation'} data={this.data} field={'type'} label={this.data.name+this.data.signature} />`;\r\n    }\r\n\r\n\r\n\r\n    public static operationm1(): string {\r\n        return `<div className={'d-flex root operationm1'} style={{paddingRight: \"6px\"}}>\r\n             {<label className={'d-block ms-1'}>{this.props.data.instanceof.name}</label>}\r\n            <label className={'d-block ms-auto hover-root'} style={{color:` + valuecolormap_str + `[this.props.data.values.type] || \"gray\"\r\n            }}>→→→{\r\n                <div className=\"hover-content\">{\r\n                    <ParameterForm operation = {this.props.data.id} vertical={true} />\r\n                }\r\n                }</label>\r\n        </div>`\r\n    }\r\n\r\n    public static object(): string {\r\n        return `<div className={'round bg-white root class'}>\r\n            <label className={'ms-1'}>\r\n                <Input jsxLabel={<b className={'class-name'}>{this.data.instanceof ? this.data.instanceof.name : \"Object\"}:</b>} \r\n                   data={this.data.id} field={'name'} hidden={true} autosize={true}/>\r\n            </label>\r\n            <hr />\r\n            <div className={'object-children'}>\r\n                {this.data.features.map((child, index) => {\r\n                    return <DefaultNode key={child.id} data={child.id}></DefaultNode>\r\n                })}\r\n            </div>\r\n        </div>`;\r\n    }\r\n\r\n    public static value() {\r\n        return `<div className={'d-flex root value'} style={{paddingRight: \"6px\"}}>\r\n             {this.props.data.instanceof && <label className={'d-block ms-1'}>{this.props.data.instanceof.name}</label>}\r\n             {!this.props.data.instanceof && <Input asLabel={true} data={this.data.id} field={'name'} hidden={true} autosize={true} />}\r\n            <label className={'d-block ms-auto'} style={{color:` + valuecolormap_str + `[this.props.data.values.type] || \"gray\"\r\n            }}>: {this.props.data.valuestring()}</label>\r\n        </div>`\r\n    }\r\n\r\n    public static defaultPackage() {\r\n        return `<div style={{backgroundColor: 'transparent', position: 'fixed', width: '-webkit-fill-available', height: '-webkit-fill-available'}}>\r\n            {this.data.children.map((child, index) => {\r\n            return <DefaultNode key={child.id} data={child.id}></DefaultNode>\r\n            })}\r\n        </div>`;\r\n    }\r\n\r\n    public static error(msg: undefined | string | JSX.Element) {\r\n        return <div className={'w-100 h-100 round bg-white border border-danger'} style={{minHeight:\"min-content\"}}>\r\n            <div className={'text-center text-danger'} style={{background:\"#fff7\"}}>\r\n                <b>SYNTAX ERROR</b>\r\n                <hr/>\r\n                <label className={'text-center mx-1 d-block'}>\r\n                    The JSX you provide is NOT valid!\r\n                </label>\r\n                {msg && <label className={'text-center mx-1 d-block'} style={{color:\"black\"}}>{msg}</label>}\r\n            </div>\r\n        </div>;\r\n    }\r\n    public static error_string(msg: undefined | string | JSX.Element): string {\r\n        return `<div className={'w-100 h-100 round bg-white border border-danger'} style={{minHeight:\"min-content\"}}>\r\n            <div className={'text-center text-danger'} style={{background:\"#fff7\"}}>\r\n                <b>SYNTAX ERROR</b>\r\n                <hr/>\r\n                <label className={'text-center mx-1 d-block'}>\r\n                    The JSX you provide is NOT valid!\r\n                </label>\r\n                ` + (msg ? `<label className={'text-center mx-1 d-block'} style={{color:\"black\"}>{\"` + msg + `\"}</label>` : \"\") + `\r\n            </div>\r\n        </div>`;\r\n    }\r\n\r\n}\r\n","import type { GObject, Temporary, TODO} from \"../joiner\";\r\nimport {DPointerTargetable, RuntimeAccessible, windoww, Log, RuntimeAccessibleClass} from \"../joiner\";\r\n\r\n@RuntimeAccessible\r\nexport abstract class IPoint extends RuntimeAccessibleClass {\r\n    static cname: string = \"IPoint\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public x!: number;\r\n    public y!: number;\r\n\r\n    // @ts-ignore static getM is not null but must be declared nullable to achieve subclass mixing\r\n    // public static getM? = function(firstPt: IPoint, secondPt: IPoint): number { return (firstPt.y - secondPt.y) / (firstPt.x - secondPt.x); }\r\n    public static getM(firstPt: IPoint, secondPt: IPoint): number { return (firstPt.y - secondPt.y) / (firstPt.x - secondPt.x); }\r\n    public static getQ(firstPt: IPoint, secondPt: IPoint, m?: number): number {\r\n        if (m === undefined) m = IPoint.getM(firstPt, secondPt);\r\n        return firstPt.y - (m * firstPt.x);\r\n    }\r\n\r\n    public constructor(x: number = 0, y: number = 0) {\r\n        super(); // super('dwc');\r\n        IPoint.init_constructor(this, x, y);\r\n    }\r\n\r\n    static init_constructor(thiss: GObject, x: any = 0, y: any = 0, ...a: any): void {\r\n        thiss.id = \"POINT_\" + (DPointerTargetable.maxID++) + \"_\" + new Date().getTime();\r\n        thiss.className = thiss.constructor.name;\r\n        if (x === null || x === undefined) thiss.x = undefined as Temporary;\r\n        else if (isNaN(+x)) { thiss.x = 0; }\r\n        else thiss.x = +x;\r\n        if (y === null || y === undefined) thiss.y = undefined as Temporary;\r\n        else if (isNaN(+y)) { thiss.y = 0; }\r\n        else thiss.y = +y;\r\n        thiss.className = this.cname;\r\n    }\r\n\r\n    public raw(): {x: number, y: number} { return {x: this.x, y: this.y}; }\r\n\r\n    public toString(letters: boolean=true, separator: string = \" \"): string {\r\n        if (letters) return  JSON.stringify({x:this.x, y: this.y});\r\n        else return this.x + separator + this.y + separator;\r\n    }\r\n    public clone(other: { x: number, y: number }): this { this.x = other.x; this.y = other.y; return this; }\r\n\r\n    protected abstract new(): this;\r\n    public duplicate(): this { const ret = this.new(); ret.clone(this); return ret; }\r\n\r\n    public distanceFromPoint(tentativeEnd: IPoint, skipSqrt: boolean = false): number {\r\n        let d_pow2 = (this.x - tentativeEnd.x)**2 + (this.y - tentativeEnd.y)**2;\r\n        return skipSqrt ? d_pow2 : Math.sqrt(d_pow2);\r\n        // return this.subtract(tentativeEnd, true).absolute();\r\n    }\r\n\r\n    public subtract(p2: IPoint, newInstance: boolean): this {\r\n        Log.e(!p2, 'subtract argument must be a valid point: ', p2);\r\n        let p1: this;\r\n        if (!newInstance) { p1 = this; } else { p1 = this.duplicate(); }\r\n        p1.x -= p2.x;\r\n        p1.y -= p2.y;\r\n        return p1; }\r\n\r\n    public add(p2: { x: number, y: number }, newInstance: boolean): this {\r\n        Log.e(!p2, 'add argument must be a valid point: ', p2);\r\n        let p1: this;\r\n        if (!newInstance) { p1 = this; } else { p1 = this.duplicate(); }\r\n        p1.x += p2.x;\r\n        p1.y += p2.y;\r\n        return p1; }\r\n\r\n    public addAll(p: IPoint[], newInstance: boolean): this {\r\n        let i;\r\n        let p0: this;\r\n        if (!newInstance) { p0 = this; } else { p0 = this.duplicate(); }\r\n        for (i = 0; i < p.length; i++) { p0.add(p[i], true); }\r\n        return p0; }\r\n\r\n    public subtractAll(p: this[], newInstance: boolean): this {\r\n        let i;\r\n        let p0: this;\r\n        if (!newInstance) { p0 = this; } else { p0 = this.duplicate(); }\r\n        for (i = 0; i < p.length; i++) { p0.subtract(p[i], true); }\r\n        return p0; }\r\n\r\n    public multiply(pt: Partial<this> | number, newInstance: boolean = false): this {\r\n        let ret: this = (newInstance ? this.duplicate() : this);\r\n        if (typeof pt === \"number\") {\r\n            ret.x *= pt;\r\n            ret.y *= pt;\r\n        }\r\n        else {\r\n            if (\"x\" in pt) ret.x *= pt.x as number;\r\n            if (\"y\" in pt) ret.y *= pt.y as number;\r\n        }\r\n        return ret; }\r\n\r\n    public divide(pt: Partial<this> | number, newInstance: boolean = false): this {\r\n        let ret = (newInstance ? this.duplicate() : this);\r\n        if (typeof pt === \"number\") {\r\n            ret.x /= pt;\r\n            ret.y /= pt;\r\n        }\r\n        else {\r\n            ret.x /= pt.x as number;\r\n            ret.y /= pt.y as number;\r\n        }\r\n        return ret; }\r\n\r\n    public multiplyScalar(scalar: number, newInstance: boolean): this {\r\n        Log.e(isNaN(+scalar), 'IPoint.multiply()', 'scalar argument must be a valid number: ', scalar);\r\n        let p1: this;\r\n        if (!newInstance) { p1 = this; } else { p1 = this.duplicate(); }\r\n        p1.x *= scalar;\r\n        p1.y *= scalar;\r\n        return p1; }\r\n\r\n    public divideScalar(scalar: number, newInstance: boolean): this {\r\n        Log.e(isNaN(+scalar), 'IPoint.divide()', 'scalar argument must be a valid number: ', scalar);\r\n        let p1: this;\r\n        if (!newInstance) { p1 = this; } else { p1 = this.duplicate(); }\r\n        p1.x /= scalar;\r\n        p1.y /= scalar;\r\n        return p1; }\r\n\r\n    public isInTheMiddleOf(firstPt: this, secondPt: this, tolleranza: number): boolean {\r\n        const rectangle: Size = Size.fromPoints(firstPt, secondPt);\r\n        const tolleranzaX = tolleranza; // actually should be cos * arctan(m);\r\n        const tolleranzaY = tolleranza; // actually should be sin * arctan(m);\r\n        if (this.x < rectangle.x - tolleranzaX || this.x > rectangle.x + rectangle.w + tolleranzaX) { return false; }\r\n        if (this.y < rectangle.y - tolleranzaX || this.y > rectangle.y + rectangle.h + tolleranzaY) { return false; }\r\n        // const m = IPoint.getM(firstPt, secondPt);\r\n        // const q = IPoint.getQ(firstPt, secondPt);\r\n        const lineDistance = this.distanceFromLine(firstPt, secondPt);\r\n        // console.log('distance:', lineDistance, ', this:', this, ', p1:', firstPt, ', p2:', secondPt);\r\n        return lineDistance <= tolleranza; }\r\n\r\n    public distanceFromLine(p1: IPoint, p2: IPoint): number {\r\n        const top: number =\r\n            + (p2.y - p1.y) * this.x\r\n            - (p2.x - p1.x) * this.y\r\n            + p2.x * p1.y\r\n            - p1.x * p2.y;\r\n        const bot =\r\n            (p2.y - p1.y) * (p2.y - p1.y) +\r\n            (p2.x - p1.x) * (p2.x - p1.x);\r\n        return Math.abs(top) / Math.sqrt(bot);  }\r\n\r\n    public equals(pt: IPoint, tolleranzaX: number = 0, tolleranzaY: number = 0): boolean {\r\n        if (pt === null) { return false; }\r\n        return Math.abs(this.x - pt.x) <= tolleranzaX && Math.abs(this.y - pt.y) <= tolleranzaY; }\r\n\r\n    public moveOnNearestBorder(startVertexSize: ISize, clone: boolean, graph: TODO/*IGraph*/, debug: boolean = true): IPoint {\r\n        const pt: IPoint = clone ? this.duplicate() : this;\r\n        const tl: IPoint = startVertexSize.tl();\r\n        const tr: IPoint = startVertexSize.tr();\r\n        const bl: IPoint = startVertexSize.bl();\r\n        const br: IPoint = startVertexSize.br();\r\n        const L: number = pt.distanceFromLine(tl, bl);\r\n        const R: number = pt.distanceFromLine(tr, br);\r\n        const T: number = pt.distanceFromLine(tl, tr);\r\n        const B: number = pt.distanceFromLine(bl, br);\r\n        const min: number = Math.min(L, R, T, B);\r\n        if (min === L) { pt.x = tl.x; }\r\n        if (min === R) { pt.x = tr.x; }\r\n        if (min === T) { pt.y = tr.y; }\r\n        if (min === B) { pt.y = br.y; }\r\n        if (debug && graph && pt instanceof GraphPoint) { graph.markg(pt, false, 'purple'); }\r\n        return pt; }\r\n\r\n    public getM(pt2: IPoint): number { return IPoint.getM?.(this, pt2) as unknown as number; }\r\n\r\n    public degreeWith(pt2: IPoint, toRadians: boolean): number {\r\n        const directionVector: IPoint = this.subtract(pt2, true);\r\n        const ret: number = Math.atan2(directionVector.y, directionVector.x);\r\n        return toRadians ? ret : windoww.U.RadToDegree(ret); }\r\n\r\n    public absolute(): number { return Math.sqrt(this.x * this.x + this.y * this.y); }\r\n    public set(x: number, y: number) { this.x = x; this.y = y; }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class GraphPoint extends IPoint{\r\n    static cname: string = \"GraphPoint\";\r\n    private dontmixwithPoint: any;\r\n    public static fromEvent(e: JQuery.ClickEvent | JQuery.MouseMoveEvent | JQuery.MouseUpEvent | JQuery.MouseDownEvent | JQuery.MouseEnterEvent | JQuery.MouseLeaveEvent | JQuery.MouseEventBase)\r\n        : GraphPoint | null {\r\n        if (!e) { return null; }\r\n        const p: Point = new Point(e.pageX, e.pageY);\r\n        const g: any = null;\r\n        throw new Error(\"todo: const g: IGraph = Status.status.getActiveModel().graph;\");\r\n        return g.toGraphCoord(p); }\r\n\r\n    protected new(): this { return new GraphPoint() as this;}\r\n\r\n}\r\n\r\n\r\n@RuntimeAccessible\r\nexport class Point extends IPoint{\r\n    static cname: string = \"Point\";\r\n    private dontmixwithGPoint: any;\r\n    /// https://stackoverflow.com/questions/6073505/what-is-the-difference-between-screenx-y-clientx-y-and-pagex-y\r\n    public static fromEvent(e: JQuery.ClickEvent | JQuery.MouseMoveEvent | JQuery.MouseUpEvent | JQuery.MouseDownEvent | JQuery.MouseEnterEvent | JQuery.MouseLeaveEvent | JQuery.MouseEventBase)\r\n        : Point {\r\n        const p: Point = new Point(e.pageX, e.pageY);\r\n        return p; }\r\n\r\n    protected new(): this { return new Point() as this;}\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, IPoint);\r\nRuntimeAccessibleClass.set_extend(IPoint, GraphPoint);\r\nRuntimeAccessibleClass.set_extend(IPoint, Point);\r\n@RuntimeAccessible\r\nexport abstract class ISize<PT extends IPoint = IPoint> extends RuntimeAccessibleClass {\r\n    static cname: string = \"ISize\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public x!: number;\r\n    public y!: number;\r\n    public w!: number;\r\n    public h!: number;\r\n    public constructor(x: number = 0, y: number = 0, w: number = 0, h: number = 0) {\r\n        super(); // super('dwc');\r\n        // do not override any fields from the DPointerTargetable, otherwise the ! in the override will reinizialize the attribute\r\n        // erasing the value set in super or in the functions called by the constructor as side effect (static_init called from constructor will be overridden too)\r\n        // if need to override types, build the \"new\" static function like in DModelElement\r\n        ISize.init_constructor(this, x, y, w, h);\r\n    }\r\n\r\n    static init_constructor(thiss: GObject, x: any = 0, y: any = 0, w: any = 0, h: any = 0, ...a: any): void {\r\n        thiss.id = \"SIZE_\" + (DPointerTargetable.maxID++) + \"_\" + new Date().getTime();\r\n        thiss.className = (thiss.constructor as typeof RuntimeAccessibleClass).cname;\r\n        if (x === null || x === undefined) thiss.x = undefined as Temporary;\r\n        else if (isNaN(+x)) { thiss.x = 0; }\r\n        else thiss.x = +x;\r\n        if (y === null || y === undefined) thiss.y = undefined as Temporary;\r\n        else if (isNaN(+y)) { thiss.y = 0; }\r\n        else thiss.y = +y;\r\n        if (w === null || w === undefined) thiss.w = undefined as Temporary;\r\n        else if (isNaN(+w)) { thiss.w = 0; }\r\n        else thiss.w = +w;\r\n        if (h === null || h === undefined) thiss.h = undefined as Temporary;\r\n        else if (isNaN(+h)) { thiss.h = 0; }\r\n        else thiss.h = +h;\r\n        thiss.className = this.cname; }\r\n\r\n    public toString(letters: boolean=true, separator: string = \" \"): string {\r\n        if (letters) return JSON.stringify({x: this.x, y: this.y, w: this.w, h: this.h});\r\n        else return this.x + separator + this.y + separator + this.w + separator + this.h;\r\n    }\r\n\r\n    public set(x?: number, y?: number, w?: number, h?: number): void {\r\n        if (x !== undefined) (this.x = +x);\r\n        if (y !== undefined) (this.y = +y);\r\n        if (w !== undefined) (this.w = +w);\r\n        if (h !== undefined) (this.h = +h);\r\n    }\r\n\r\n    protected abstract makePoint(x: number, y: number): PT;\r\n    protected abstract new(...args:any): this;\r\n    public clone(json: this): this { this.x = json.x; this.y = json.y; this.w = json.w; this.h = json.h; return this; }\r\n    public duplicate(): this { return this.new().clone(this); }\r\n\r\n    public add(pt2: number | {x?:number, y?:number, w?:number, h?:number}, newInstance?: boolean): this {\r\n        let thiss = newInstance ? this.duplicate() : this;\r\n        if (typeof pt2 === \"number\") { thiss.x += pt2; thiss.y += pt2; thiss.w += pt2; thiss.h += pt2; return thiss; }\r\n        if (pt2.x !== undefined) thiss.x += pt2.x;\r\n        if (pt2.y !== undefined) thiss.y += pt2.y;\r\n        if (pt2.w !== undefined) thiss.w += pt2.w;\r\n        if (pt2.h !== undefined) thiss.h += pt2.h;\r\n        return thiss; }\r\n\r\n    public subtract(pt2: number | {x?:number, y?:number, w?:number, h?:number}, newInstance?: boolean): this {\r\n        let thiss = newInstance ? this.duplicate() : this;\r\n        if (typeof pt2 === \"number\") { thiss.x -= pt2; thiss.y -= pt2; thiss.w -= pt2; thiss.h -= pt2; return thiss; }\r\n        if (pt2.x !== undefined) thiss.x -= pt2.x;\r\n        if (pt2.y !== undefined) thiss.y -= pt2.y;\r\n        if (pt2.w !== undefined) thiss.w -= pt2.w;\r\n        if (pt2.h !== undefined) thiss.h -= pt2.h;\r\n        return thiss; }\r\n\r\n    public multiply(pt2: number | {x?:number, y?:number, w?:number, h?:number}, newInstance?: boolean): this {\r\n        let thiss = newInstance ? this.duplicate() : this;\r\n        if (typeof pt2 === \"number\") { thiss.x *= pt2; thiss.y *= pt2; thiss.w *= pt2; thiss.h *= pt2; return thiss; }\r\n        if (pt2.x !== undefined) thiss.x *= pt2.x;\r\n        if (pt2.y !== undefined) thiss.y *= pt2.y;\r\n        if (pt2.w !== undefined) thiss.w *= pt2.w;\r\n        if (pt2.h !== undefined) thiss.h *= pt2.h;\r\n        return thiss; }\r\n\r\n    public divide(pt2: number | {x?:number, y?:number, w?:number, h?:number}, newInstance?: boolean): this {\r\n        let thiss = newInstance ? this.duplicate() : this;\r\n        if (typeof pt2 === \"number\") { thiss.x /= pt2; thiss.y /= pt2; thiss.w /= pt2; thiss.h /= pt2; return thiss; }\r\n        if (pt2.x !== undefined) thiss.x /= pt2.x;\r\n        if (pt2.y !== undefined) thiss.y /= pt2.y;\r\n        if (pt2.w !== undefined) thiss.w /= pt2.w;\r\n        if (pt2.h !== undefined) thiss.h /= pt2.h;\r\n        return thiss; }\r\n\r\n\r\n    public tl(): PT {     return this.makePoint(   this.x,                 this.y             ); }\r\n    public tr(): PT {     return this.makePoint(this.x + this.w,        this.y             ); }\r\n    public bl(): PT {     return this.makePoint(   this.x,              this.y + this.h    ); }\r\n    public br(): PT {     return this.makePoint(this.x + this.w,     this.y + this.h    ); }\r\n    public center(): PT { return this.makePoint(this.x + this.w / 2, this.y + this.h / 2); }\r\n    public relativePoint(xPercent: number, yPercent: number): PT { return this.makePoint(this.x + this.w * xPercent, this.y + this.h * yPercent); }\r\n    public equals(size: this): boolean { return this.x === size.x && this.y === size.y && this.w === size.w && this.h === size.h; }\r\n\r\n    /// field-wise Math.min()\r\n    public min(minSize: this, clone: boolean): this {\r\n        const ret: this = clone ? this.new() : this;\r\n        if (!isNaN(minSize.x) && ret.x < minSize.x) { ret.x = minSize.x; }\r\n        if (!isNaN(minSize.y) && ret.y < minSize.y) { ret.y = minSize.y; }\r\n        if (!isNaN(minSize.w) && ret.w < minSize.w) { ret.w = minSize.w; }\r\n        if (!isNaN(minSize.h) && ret.h < minSize.h) { ret.h = minSize.h; }\r\n        return ret; }\r\n    public max(maxSize: this, clone: boolean): this {\r\n        const ret: this = clone ? this.new() : this;\r\n        if (!isNaN(maxSize.x) && ret.x > maxSize.x) { ret.x = maxSize.x; }\r\n        if (!isNaN(maxSize.y) && ret.y > maxSize.y) { ret.y = maxSize.y; }\r\n        if (!isNaN(maxSize.w) && ret.w > maxSize.w) { ret.w = maxSize.w; }\r\n        if (!isNaN(maxSize.h) && ret.h > maxSize.h) { ret.h = maxSize.h; }\r\n        return ret; }\r\n\r\n    public intersection(size: this): this | null {\r\n        if (!size) return null;\r\n        // anche \"isinside\"\r\n        let startx, starty, endx, endy;\r\n        startx = Math.max(this.x, size.x);\r\n        starty = Math.max(this.y, size.y);\r\n        endx = Math.min(this.x + this.w, size.x + size.w);\r\n        endy = Math.min(this.y + this.h, size.y + size.h);\r\n        const intersection: this = this.new();\r\n        // intersection.set(0, 0, 0, 0);\r\n        intersection.x = startx;\r\n        intersection.y = starty;\r\n        intersection.w = endx - startx;\r\n        intersection.h = endy - starty;\r\n        const doesintersect: boolean = intersection.w > 0 && intersection.h > 0;\r\n        return (doesintersect) ? intersection: null; }\r\n\r\n    public contains(pt: PT): boolean {\r\n        return  pt.x >= this.x && pt.x <= this.x + this.w && pt.y >= this.y && pt.y <= this.y + this.h; }\r\n\r\n    public isOverlapping(size2: this): boolean { return !!this.intersection(size2); }\r\n    public isOverlappingAnyOf(sizes: this[]): boolean {\r\n        if (!sizes) return false;\r\n        for (let size of sizes) { if (this.isOverlapping(size)) return true; }\r\n        return false;\r\n    }\r\n\r\n    public multiplyPoint(other: PT, newInstance: boolean): this {\r\n        const ret: this = newInstance ? this.new() : this;\r\n        ret.x *= other.x;\r\n        ret.w *= other.x;\r\n        ret.y *= other.y;\r\n        ret.h *= other.y;\r\n        return ret; }\r\n\r\n    public dividePoint(other: PT, newInstance: boolean): this {\r\n        const ret: this = newInstance ? this.new() : this;\r\n        ret.x /= other.x;\r\n        ret.w /= other.x;\r\n        ret.y /= other.y;\r\n        ret.h /= other.y;\r\n        return ret; }\r\n\r\n    public boundary(size2: this): void {\r\n        /*let minx, maxx, miny, maxy;\r\n        if (size2.y < this.y) { miny = size2.y; /*maxy = this.y;* / } else { miny = this.y; /*maxy = size2.y;* / }\r\n        if (size2.x < this.x) { minx = size2.y; /*maxx = this.x;* / } else { minx = this.x; /*maxy = size2.x;* / }\r\n        if (size2.y + size2.h < this.y + this.h) maxy = this.y + this.h; else maxy = size2.y + size2.h;\r\n        if (size2.x + size2.w < this.x + this.w) maxx = this.x + this.w; else maxx = size2.x + size2.w;\r\n        */\r\n        this.h = (size2.y + size2.h > this.y + this.h ? size2.y + size2.h : this.y + this.h); // -miny\r\n        this.w = (size2.x + size2.w > this.x + this.w ? size2.x + size2.w : this.x + this.w); // -minx\r\n        if (this.y < size2.y) this.y = size2.y;\r\n        if (this.x < size2.x) this.x = size2.x;\r\n        this.h -= this.y;\r\n        this.w -= this.x;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class Size extends ISize<Point> {\r\n    static cname: string = \"Size\";\r\n    static subclasses: any[] = [];\r\n    private static sizeofvar: HTMLElement;\r\n    private static $sizeofvar: JQuery<HTMLElement>;\r\n    private dontMixWithGraphSize: any;\r\n\r\n    public static of(element0: Element, debug: boolean = false): Size {\r\n        let element: HTMLElement = element0 as HTMLElement;\r\n        Log.l(debug, 'sizeof()',  element);\r\n        Log.e(element as any === document, 'trying to measure document.');\r\n        if (element as any === document) { element = document.body as any; }\r\n        const $element = $(element);\r\n        Log.e(!element || element.tagName === 'foreignObject', 'sizeof()', 'SvgForeignElementObject have a bug with size, measure a child instead.', element);\r\n        let tmp;\r\n        let size: Size;\r\n        if (!Size.sizeofvar) {\r\n            Size.sizeofvar = document.createElement('div');\r\n            document.body.append(Size.sizeofvar); }\r\n\r\n        const isOrphan = element.parentNode === null;\r\n        // var visible = element.style.display !== 'none';\r\n        // var visible = $element.is(\":visible\"); crea bug quando un elemento è teoricamente visibile ma orfano\r\n        const ancestors =  windoww.U.ancestorArray(element);\r\n        const displayStyles: string[] = ancestors.map( (e: HTMLElement) => e?.style?.display);\r\n        if (isOrphan) { Size.sizeofvar.append(element); }\r\n        // show all and saveToDB visibility to restore it later\r\n        for (let i = 0; i < ancestors.length; i++) { // document has undefined style\r\n            displayStyles[i] = ancestors[i]?.style?.display;\r\n            if (displayStyles[i] === 'none' || (displayStyles[i] === '' && getComputedStyle(ancestors[i]).display === 'none')) { ancestors[i].style.display = 'block' }\r\n        }\r\n        tmp = $element.offset() as JQuery.Coordinates; // made sure cannot be undefined by removing display:none\r\n        size = new Size(tmp.left, tmp.top, 0, 0);\r\n        tmp = element.getBoundingClientRect();\r\n        size.w = tmp.width;\r\n        size.h = tmp.height;\r\n        // restore visibility\r\n        for (let i = 0; i < ancestors.length; i++) {\r\n            if (displayStyles[i] === ancestors[i].style?.display) continue;\r\n            if (displayStyles[i]) ancestors[i].style.display = displayStyles[i];\r\n            else ancestors[i].style.removeProperty('display');\r\n        }\r\n        if (isOrphan) {  windoww.U.clear(Size.sizeofvar); }\r\n        // Status.status.getActiveModel().graph.markS(size, false);\r\n        return size;\r\n    }\r\n\r\n    public static fromPoints(firstPt: IPoint, secondPt: IPoint): Size {\r\n        const minX = Math.min(firstPt.x, secondPt.x);\r\n        const maxX = Math.max(firstPt.x, secondPt.x);\r\n        const minY = Math.min(firstPt.y, secondPt.y);\r\n        const maxY = Math.max(firstPt.y, secondPt.y);\r\n        return new Size(minX, minY, maxX - minX, maxY - minY); }\r\n\r\n    protected makePoint(x: number, y: number): Point { return new Point(x, y); }\r\n    protected new(...args:any): this { return new Size(...args) as this; }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class GraphSize extends ISize<GraphPoint> {\r\n    static cname: string = \"GraphSize\";\r\n    private dontMixWithSize: any;\r\n\r\n    public static fromPoints(firstPt: GraphPoint, secondPt: GraphPoint): GraphSize {\r\n        const minX = Math.min(firstPt.x, secondPt.x);\r\n        const maxX = Math.max(firstPt.x, secondPt.x);\r\n        const minY = Math.min(firstPt.y, secondPt.y);\r\n        const maxY = Math.max(firstPt.y, secondPt.y);\r\n        return new GraphSize(minX, minY, maxX - minX, maxY - minY); }\r\n\r\n\r\n    public static closestIntersection(size: GraphSize, pt0: GraphPoint, targetPt: GraphPoint, gridAlign?: GraphPoint, m0?:number, q0?:number): GraphPoint | undefined {\r\n        let pt: GraphPoint = pt0.duplicate();\r\n        const m = m0 || GraphPoint.getM(targetPt, pt);\r\n        const q = q0 || GraphPoint.getQ(targetPt, pt);\r\n        // console.log(\"closestIntersection()\", {size, pt0, targetPt, m, q});\r\n        // if perfectly vertical line\r\n        if (m === Number.POSITIVE_INFINITY/* && q === Number.NEGATIVE_INFINITY*/) {\r\n            // top center\r\n            if (Math.abs(targetPt.y - size.y) <= Math.abs(targetPt.y - size.y - size.h)) return new GraphPoint(pt0.x, size.y);\r\n            // bottom center\r\n            else return new GraphPoint(pt0.x, size.y + size.h);\r\n        }\r\n        let tl = size.tl(), tr = size.tr(),\r\n            bl = size.bl(), br = size.br();\r\n        let allowT: boolean, allowB: boolean,\r\n            allowL: boolean, allowR: boolean;\r\n        /*let distanceT: number = Number.POSITIVE_INFINITY, distanceB: number = Number.POSITIVE_INFINITY,\r\n            distanceL: number = Number.POSITIVE_INFINITY, distanceR: number = Number.POSITIVE_INFINITY;*/\r\n        let intersectionT: GraphPoint | undefined, intersectionB: GraphPoint | undefined,\r\n            intersectionL: GraphPoint | undefined, intersectionR: GraphPoint | undefined;\r\n\r\n\r\n        allowT = Geom.isNumberBetween(tl.y, bl.y, targetPt.y);\r\n        allowB = Geom.isNumberBetween(bl.y, tl.y, targetPt.y);\r\n        allowL = Geom.isNumberBetween(tl.x, tr.x, targetPt.x);\r\n        allowR = Geom.isNumberBetween(tr.x, tl.x, targetPt.x);\r\n        // console.log(\"closestIntersection pt0\", {size, targetPt, pt0:pt0.raw(), gridAlign,\r\n        //     corners:{tl:tl.raw(), tr:tr.raw(), bl:bl.raw(), br:br.raw()}, allows:{allowT, allowB, allowL, allowR}});\r\n        if (!(allowT || allowB || allowL || allowR)) return undefined; // point is internal to size\r\n        if (allowT) intersectionT = Geom.lineToSegmentIntersection(tl, tr, q, m); else\r\n        if (allowB) intersectionB = Geom.lineToSegmentIntersection(bl, br, q, m); // NOT else, (T|B) AND (L|R) can happen, or just 1 or 0 of those.\r\n        if (allowL) intersectionL = Geom.lineToSegmentIntersection(tl, bl, q, m); else\r\n        if (allowR) intersectionR = Geom.lineToSegmentIntersection(tr, br, q, m);\r\n\r\n        // console.log(\"closestIntersection pt2\", {intersectionT, intersectionB, intersectionL, intersectionR});\r\n        // only 1 intersection can happen\r\n        return intersectionT || intersectionB || intersectionL || intersectionR;\r\n    }\r\n    public static closestIntersection_old(size: GraphSize, prevPt: GraphPoint, pt0: GraphPoint, gridAlign?: GraphPoint): GraphPoint | null {\r\n        let ret = GraphSize.closestIntersection0(size, prevPt, pt0, gridAlign) as any;\r\n        // Log.exDev(!Geom.isOnEdge(ret, size), 'ClosestIntersection failed. not on Vertex edge.', {ret, size, prevPt, pt0, gridAlign});\r\n        return ret;\r\n    }\r\n    private static closestIntersection0(vertexGSize: GraphSize, prevPt: GraphPoint, pt0: GraphPoint, gridAlign?: GraphPoint): GraphPoint | null {\r\n        let pt: GraphPoint | null = pt0.duplicate();\r\n        const m = GraphPoint.getM(prevPt, pt) as number;\r\n        const q = GraphPoint.getQ(prevPt, pt) as number;\r\n        // U.pe( Math.abs((pt.y - m * pt.x) - (prevPt.y - m * prevPt.x)) > .001, 'wrong math in Q:', (pt.y - m * pt.x), ' vs ', (prevPt.y - m * prevPt.x));\r\n        /*const isL = prevPt.x < pt.x;\r\n    const isT = prevPt.y < pt.y;\r\n    const isR = !isL;\r\n    const isB = !isT; */\r\n        if (m === Number.POSITIVE_INFINITY && q === Number.NEGATIVE_INFINITY) { // bottom middle\r\n            return new GraphPoint(vertexGSize.x + vertexGSize.w / 2, vertexGSize.y + vertexGSize.h); }\r\n        // console.log('pt:', pt, 'm:', m, 'q:', q);\r\n        let L: GraphPoint | null = new GraphPoint(0, 0);\r\n        let T: GraphPoint | null = new GraphPoint(0, 0);\r\n        let R: GraphPoint | null = new GraphPoint(0, 0);\r\n        let B: GraphPoint | null = new GraphPoint(0, 0);\r\n        L.x = vertexGSize.x;\r\n        L.y = m * L.x + q;\r\n        R.x = vertexGSize.x + vertexGSize.w;\r\n        R.y = m * R.x + q;\r\n        T.y = vertexGSize.y;\r\n        T.x = (T.y - q) / m;\r\n        B.y = vertexGSize.y + vertexGSize.h;\r\n        B.x = (B.y - q) / m;\r\n        // prendo solo il compreso pt ~ prevPt (escludo così il \"pierce\" sulla faccia opposta), prendo il più vicino al centro.\r\n        // console.log('4 possibili punti di intersezione (LTBR):', L, T, B, R);\r\n        /* this.owner.mark(this.owner.toHtmlCoord(T), true, 'blue');\r\n    this.owner.mark(this.owner.toHtmlCoord(B), false, 'violet');\r\n    this.owner.mark(this.owner.toHtmlCoord(L), false, 'red');\r\n    this.owner.mark(this.owner.toHtmlCoord(R), false, 'orange');*/\r\n        console.log(\"intersect pt1:\", {T, B, L, R});\r\n        if ( (B.x >= pt.x && B.x <= prevPt.x) || (B.x >= prevPt.x && B.x <= pt.x) ) { } else { B = null; }\r\n        if ( (T.x >= pt.x && T.x <= prevPt.x) || (T.x >= prevPt.x && T.x <= pt.x) ) { } else { T = null; }\r\n        if ( (L.y >= pt.y && L.y <= prevPt.y) || (L.y >= prevPt.y && L.y <= pt.y) ) { } else { L = null; }\r\n        if ( (R.y >= pt.y && R.y <= prevPt.y) || (R.y >= prevPt.y && R.y <= pt.y) ) { } else { R = null; }\r\n        console.log(\"intersect pt2:\", {T, B, L, R});\r\n        function closestmix(pt: GraphPoint, closest: GraphPoint, segStart: GraphPoint, segEnd: GraphPoint, mode: \"TB\" | \"LR\"): void {\r\n            // changes pt\r\n            pt.x = closest.x; pt.y = closest.y; return;\r\n            let main: \"x\" | \"y\", sub: \"x\" | \"y\";\r\n            if (mode === \"TB\") { main = \"y\"; sub = \"x\"; } else { main = \"x\"; sub = \"y\"; }\r\n            pt[main] = closest[main];\r\n            // if T[sub] is inside the top segment, take T[sub], otherwise closest between size.tl[sub] and size.tr[sub]\r\n            // pt[sub] = Math.max(segStart[sub], Math.min(segStart[sub], closest[sub]));\r\n            if (closest[sub] <= segEnd[sub] && closest[sub] >= segStart[sub]) pt[sub] = closest[sub];\r\n            else if (Math.abs(closest[sub]-segEnd[sub]) < Math.abs(closest[sub]-segStart[sub])) pt[sub] = segEnd[sub];\r\n            else pt[sub] = segStart[sub];\r\n        }\r\n        function closestmix2(pt: GraphPoint, closest: GraphPoint, segStart: GraphPoint, segEnd: GraphPoint, mode: \"TB\" | \"LR\"): void {\r\n            // changes closest\r\n            let main: \"x\" | \"y\", sub: \"x\" | \"y\";\r\n            if (mode === \"TB\") { main = \"y\"; sub = \"x\"; } else { main = \"x\"; sub = \"y\"; }\r\n            // closest[main] = pt[main];\r\n            // if T[sub] is inside the top segment, take T[sub], otherwise closest between size.tl[sub] and size.tr[sub]\r\n            // pt[sub] = Math.max(segStart[sub], Math.min(segStart[sub], closest[sub]));\r\n            if (closest[sub] <= segEnd[sub] && closest[sub] >= segStart[sub]) {/*no-op*/}\r\n            else if (Math.abs(closest[sub]-segEnd[sub]) < Math.abs(closest[sub]-segStart[sub])) closest[sub] = segEnd[sub];\r\n            else closest[sub] = segStart[sub];\r\n        }\r\n        console.log(\"intersect pt2.5:\");\r\n        try{\r\n            if(T) closestmix2(pt, T, vertexGSize.tl(), vertexGSize.tr(), \"TB\");\r\n            if(B) closestmix2(pt, B, vertexGSize.bl(), vertexGSize.br(), \"TB\");\r\n            if(R) closestmix2(pt, R, vertexGSize.tr(), vertexGSize.br(), \"LR\");\r\n            if(L) closestmix2(pt, L, vertexGSize.tl(), vertexGSize.bl(), \"LR\");\r\n        } catch(e){ console.error(\"intersect error\",e)}\r\n        // console.log('superstiti step1: (LTBR):', L, T, B, R);\r\n        console.log(\"intersect pt2.9:\");\r\n        const vicinanzaT = !T ? Number.POSITIVE_INFINITY : ((T.x - pt.x) * (T.x - pt.x)) + ((T.y - pt.y) * (T.y - pt.y));\r\n        const vicinanzaB = !B ? Number.POSITIVE_INFINITY : ((B.x - pt.x) * (B.x - pt.x)) + ((B.y - pt.y) * (B.y - pt.y));\r\n        const vicinanzaL = !L ? Number.POSITIVE_INFINITY : ((L.x - pt.x) * (L.x - pt.x)) + ((L.y - pt.y) * (L.y - pt.y));\r\n        const vicinanzaR = !R ? Number.POSITIVE_INFINITY : ((R.x - pt.x) * (R.x - pt.x)) + ((R.y - pt.y) * (R.y - pt.y));\r\n        const closest = Math.min(vicinanzaT, vicinanzaB, vicinanzaL, vicinanzaR);\r\n        console.log(\"intersect pt3:\", {vicinanzaT, vicinanzaB, vicinanzaL, vicinanzaR, closest});\r\n\r\n        // console.log( 'closest:', closest);\r\n        // succede quando pt e prevPt sono entrambi all'interno del rettangolo del vertice.\r\n        // L'edge non è visibile e il valore ritornato è irrilevante.\r\n\r\n        if (closest === Number.POSITIVE_INFINITY) {\r\n            /* top center */\r\n            pt = vertexGSize.tl();\r\n            pt.x += vertexGSize.w / 2; } else\r\n        if (closest === Number.POSITIVE_INFINITY) {\r\n            /* bottom center */\r\n            pt = vertexGSize.br();\r\n            pt.x -= vertexGSize.w / 2; } else\r\n        if (closest === vicinanzaT && T) {\r\n            closestmix(pt, T as any, vertexGSize.tl(), vertexGSize.tr(), \"TB\");\r\n            /*pt.y = T.y;\r\n            // if T.x is inside the top segment, take T.x, otherwise closest between size.tl.x and size.tr.x\r\n            if ((T.x <= tr.x && T.x >= tl.x)) pt.x = T.x;\r\n            else if (Math.abs(T.x-tr.x) < Math.abs(T.x-tl.x)) pt.x = tr.x;\r\n            else pt.x = tl.x;*/\r\n        }\r\n        if (closest === vicinanzaB) { closestmix(pt, B as any, vertexGSize.bl(), vertexGSize.br(), \"TB\"); } else\r\n        if (closest === vicinanzaR) { closestmix(pt, R as any, vertexGSize.tr(), vertexGSize.br(), \"LR\"); } else\r\n        if (closest === vicinanzaL) { closestmix(pt, L as any, vertexGSize.tl(), vertexGSize.bl(), \"LR\"); }\r\n\r\n        if (!gridAlign) { return pt; }\r\n        if (!pt) return null;\r\n        if (gridAlign.x && (pt === T || pt === B || isNaN(closest))) {\r\n            const floorX: number = Math.floor(pt.x / gridAlign.x) * gridAlign.x;\r\n            const ceilX: number = Math.ceil(pt.x / gridAlign.x) * gridAlign.x;\r\n            let closestX;\r\n            let farthestX;\r\n            if (Math.abs(floorX - pt.x) < Math.abs(ceilX - pt.x)) {\r\n                closestX = floorX; farthestX = ceilX;\r\n            } else { closestX = ceilX; farthestX = floorX; }\r\n\r\n            // todo: possibile causa del bug che non allinea punti fake a punti reali. nel calcolo realPT questo non viene fatto.\r\n            // if closest grid intersection is inside the vertex.\r\n            if (closestX >= vertexGSize.x && closestX <= vertexGSize.x + vertexGSize.w) { pt.x = closestX; } else\r\n                // if 2° closer grid intersection is inside the vertex.\r\n            if (closestX >= vertexGSize.x && closestX <= vertexGSize.x + vertexGSize.w) { pt.x = farthestX;\r\n                // if no intersection are inside the vertex (ignore grid)\r\n            } else { /* do nothing */ }\r\n        } else if (gridAlign.y && (pt === L || pt === R)) {\r\n            const floorY: number = Math.floor(pt.y / gridAlign.y) * gridAlign.y;\r\n            const ceilY: number = Math.ceil(pt.y / gridAlign.y) * gridAlign.y;\r\n            let closestY;\r\n            let farthestY;\r\n            if (Math.abs(floorY - pt.y) < Math.abs(ceilY - pt.y)) {\r\n                closestY = floorY; farthestY = ceilY;\r\n            } else { closestY = ceilY; farthestY = floorY; }\r\n\r\n            // if closest grid intersection is inside the vertex.\r\n            if (closestY >= vertexGSize.y && closestY <= vertexGSize.y + vertexGSize.h) { pt.y = closestY; } else\r\n                // if 2° closer grid intersection is inside the vertex.\r\n            if (closestY >= vertexGSize.y && closestY <= vertexGSize.y + vertexGSize.h) { pt.y = farthestY;\r\n                // if no intersection are inside the vertex (ignore grid)\r\n            } else { /* do nothing */ }\r\n        }\r\n        return pt; }\r\n\r\n\r\n    protected new(...args: any): this { return new GraphSize(...args) as this; }\r\n    protected makePoint(x: number, y: number): GraphPoint { return new GraphPoint(x, y) as GraphPoint; }\r\n\r\n    closestPoint(pt: GraphPoint): GraphPoint { return Geom.closestPoint(this, pt); }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, ISize);\r\nRuntimeAccessibleClass.set_extend(ISize, Size);\r\nRuntimeAccessibleClass.set_extend(ISize, GraphSize);\r\n@RuntimeAccessible\r\nexport class Geom extends RuntimeAccessibleClass {\r\n    static cname: string = \"Geom\";\r\n\r\n    static isPositiveZero(m: number): boolean {\r\n        if (!!Object.is) { return Object.is(m, +0); }\r\n        return (1 / m === Number.POSITIVE_INFINITY); }\r\n\r\n    static isNegativeZero(m: number): boolean {\r\n        if (!!Object.is) { return Object.is(m, -0); }\r\n        return (1 / m === Number.NEGATIVE_INFINITY); }\r\n\r\n    static TanToRadian(n: number): number { return Geom.DegreeToRad(Geom.TanToDegree(n)); }\r\n    static TanToDegree(n: number): number {\r\n        if (Geom.isPositiveZero(n)) { return 0; }\r\n        if (n === Number.POSITIVE_INFINITY) { return 90; }\r\n        if (Geom.isNegativeZero(n)) { return 180; }\r\n        if (n === Number.POSITIVE_INFINITY) { return 270; }\r\n        return Geom.RadToDegree((window as any).Math.atan(n)); }\r\n\r\n    static RadToDegree(radians: number): number { return radians * (180 / Math.PI); }\r\n    static DegreeToRad(degree: number): number { return degree * (Math.PI / 180); }\r\n\r\n\r\n\r\n    private static GeomTolerance = 0; // 0.001;\r\n    static isOnEdge(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        return Geom.isOnHorizontalEdges(pt, shape, tolerance) || Geom.isOnVerticalEdges(pt, shape, tolerance); }\r\n\r\n    static isOnVerticalEdges(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        return Geom.isOnLeftEdge(pt, shape, tolerance) || Geom.isOnRightEdge(pt, shape, tolerance); }\r\n\r\n    static isOnHorizontalEdges(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        return Geom.isOnTopEdge(pt, shape, tolerance) || Geom.isOnBottomEdge(pt, shape, tolerance); }\r\n\r\n    static isOnRightEdge(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        if (!pt || !shape) { return false; }\r\n        if (tolerance) return Math.abs(pt.x - (shape.x + shape.w)) < tolerance\r\n            && ( pt.y - shape.y > tolerance && pt.y - (shape.y + shape.h) < tolerance);\r\n        return (pt.x === shape.x + shape.w) && (pt.y >= shape.y && pt.y <= shape.y + shape.h);\r\n    }\r\n\r\n    static isOnLeftEdge(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        if (!pt || !shape) { return false; }\r\n        if (tolerance) return Math.abs(pt.x - shape.x) < tolerance\r\n            && (pt.y - shape.y > tolerance && pt.y - (shape.y + shape.h) < tolerance);\r\n        return (pt.x === shape.x) && (pt.y >= shape.y && pt.y <= shape.y + shape.h);\r\n    }\r\n\r\n    static isOnTopEdge(pt: GraphPoint, shape: GraphSize, tolerance: number = Geom.GeomTolerance): boolean {\r\n        if (!pt || !shape) { return false; }\r\n        if (tolerance) return Math.abs(pt.y - shape.y) < tolerance\r\n            && (pt.x - shape.x > tolerance && pt.x - (shape.x + shape.w) < tolerance);\r\n        return (pt.y === shape.y) && (pt.x >= shape.x && pt.x <= shape.x + shape.w);\r\n    }\r\n\r\n    static isOnBottomEdge(pt: GraphPoint, shape: GraphSize, tolerance?: number): boolean {\r\n        if (!pt || !shape) { return false; }\r\n        if (tolerance) return Math.abs(pt.y - shape.y + shape.h) < tolerance\r\n            && (pt.x - shape.x > tolerance && pt.x - (shape.x + shape.w) < tolerance);\r\n        return (pt.y === shape.y + shape.h) && (pt.x >= shape.x && pt.x <= shape.x + shape.w);\r\n    }\r\n\r\n    static closestPoint(size: GraphSize, pt: GraphPoint): GraphPoint {\r\n        let top_closest = Geom.closestPointToSegment(size.tl(), size.tr(), pt);\r\n        let bot_closest = Geom.closestPointToSegment(size.bl(), size.br(), pt);\r\n        let left_closest = Geom.closestPointToSegment(size.tl(), size.bl(), pt);\r\n        let right_closest = Geom.closestPointToSegment(size.tr(), size.br(), pt);\r\n\r\n        let top_distance = top_closest.distanceFromPoint(pt, false);\r\n        let bot_distance = bot_closest.distanceFromPoint(pt, false);\r\n        let left_distance = left_closest.distanceFromPoint(pt, false);\r\n        let right_distance = right_closest.distanceFromPoint(pt, false);\r\n\r\n        let min_distance = Math.min(top_distance, bot_distance, left_distance, right_distance);\r\n        if (min_distance === top_distance) return top_closest;\r\n        if (min_distance === bot_distance) return bot_closest;\r\n        if (min_distance === left_distance) return left_closest;\r\n        return right_closest;\r\n    }\r\n    static isMinusZero(number: number) {return 1/number == -Infinity;}\r\n    static closestPointToSegment(segStart: GraphPoint, segEnd:GraphPoint, pt: GraphPoint): GraphPoint{\r\n        // 1) find equation of line passing for start, end.\r\n        // 2) then find all perpendicular lines, then the perpendicular line that pass through pt\r\n        // 3) find intersection between Line(s,e) and line of point 2.\r\n        // 4A) IF intersection is part of segment(s,e) that is closest.\r\n        // 4B) ELSE, one of the 2 extremes of the segment is closest.\r\n\r\n        let x_intersect: number, y_intersect: number;\r\n        let s = segStart;\r\n        let e = segEnd;\r\n        let mse = (e.y - s.y) / (e.x - s.x);\r\n        if (mse === Number.POSITIVE_INFINITY || mse === Number.NEGATIVE_INFINITY) {\r\n            // s and e are both on the same y vertical line (same x)      // new GraphPoint(segStart.x, pt.y);\r\n            x_intersect = segStart.x;\r\n            y_intersect = pt.y;\r\n            // 1), 2), 3) all done shortcut\r\n        } else if (mse === 0 || Geom.isNegativeZero(mse)) {\r\n            // s and e are both on the same x horizontal line (same y)    // new GraphPoint(pt.x, segStart.y);\r\n            x_intersect = pt.x;\r\n            y_intersect = segStart.y\r\n            // 1), 2), 3) all done shortcut\r\n        }\r\n        else {\r\n            let q = s.y - mse*s.x; // y = mx + q           q = y-mx\r\n            // 1) done\r\n            let pmse = -1/mse; // perpendicular to mse\r\n            let pq = pt.y - pmse*pt.x;\r\n            // 2) done\r\n            //  m1 * x + q1 = y    -->   m1 * x + q1 = m2 * x + q2    -->    (m1-m2)x = q2-q1      -->     x=(q2-q1)/(m1-m2)\r\n            x_intersect = (pq-q)/(mse-pmse);\r\n            y_intersect = mse*(x_intersect) + q; //  y = mx +q\r\n            // 3) done\r\n        }\r\n\r\n        let maxX: number, minX: number;\r\n        let maxY: number, minY: number;\r\n        if (s.x > e.x) { maxX = s.x; minX = e.x; } else {  maxX = e.x; minX = s.x; }\r\n        if (s.y > e.y) { maxY = s.y; minY = e.y; } else {  maxY = e.y; minY = s.y; }\r\n        if (x_intersect >= minX && x_intersect <= maxX && y_intersect >= minY && y_intersect <= maxY) return new GraphPoint(x_intersect, y_intersect);\r\n        // 4A) IF done\r\n\r\n        let sdist = (s.x - x_intersect)**2 + (s.y - y_intersect)**2;  // actual distance is sqrt() of this, but i just need to find closest, not correct distance.\r\n        let edist = (e.x - x_intersect)**2 + (e.y - y_intersect)**2;\r\n        return (sdist < edist) ? new GraphPoint(s.x, s.y) : new GraphPoint(e.x, e.y);\r\n        // 4B) ELSE done\r\n    }\r\n\r\n    static lineToSegmentIntersection(segStart: GraphPoint, segEnd: GraphPoint, q: number, m: number): GraphPoint | undefined {\r\n        if (segStart.x === segEnd.x){\r\n            let y = m*segStart.x + q;\r\n            if (Geom.isNumberBetween(y, segStart.y, segEnd.y)) return new GraphPoint(segStart.x, y);\r\n            else return undefined;\r\n        }\r\n        else if (segStart.y === segEnd.y) {\r\n            let x = (segStart.y-q)/m;\r\n            if (Geom.isNumberBetween(x, segStart.x, segEnd.x)) return new GraphPoint(x, segStart.y);\r\n            else return undefined;\r\n            //\r\n        }\r\n\r\n        let m2 = segStart.getM(segEnd);\r\n        let q2 = IPoint.getQ(segStart, segEnd);\r\n        if (m === m2) {\r\n            if (q2 === q) return segStart; // line and segment coincident\r\n            return undefined; // parallel\r\n        }\r\n        let intersect = Geom.lineToLineIntersection(m, q, m2, q2);\r\n        if (intersect && Geom.isNumberBetween(intersect.x, segStart.x, segEnd.x) && Geom.isNumberBetween(intersect.y, segStart.y, segEnd.y)) return intersect;\r\n        else return undefined;\r\n    }\r\n\r\n    static isNumberBetween(target: number, s: number, e: number): boolean {\r\n        let max = Math.max(s, e);\r\n        let min = Math.min(s, e);\r\n        return target >= min && target <= max; }\r\n\r\n    private static lineToLineIntersection(m: number, q: number, m2: number, q2: number, retIfParallel: any = undefined, retIfCoincident: any = undefined): undefined | GraphPoint {\r\n        if (m === m2) {\r\n            if (q === q2) return retIfCoincident;\r\n            return retIfParallel;\r\n        }\r\n        if (m === Number.POSITIVE_INFINITY || m === Number.NEGATIVE_INFINITY || m2 === Number.POSITIVE_INFINITY || m2 === Number.NEGATIVE_INFINITY) {\r\n            // m or m2 are a vertical line, Q must be invalid too and i don't have a single point of the line.\r\n            // it's actually infinite possible vertical parallel lines.\r\n            return undefined;\r\n        }\r\n        /*\r\n            y = mx + q\r\n            y = nx + w\r\n            -->\r\n            mx + q = nx + w\r\n            -->\r\n            mx - nx = w - q\r\n            -->\r\n            x (m - n) = w - q\r\n            -->\r\n            x = (w - q)/(m - n)\r\n        */\r\n        let x = (q2-q)/(m-m2);\r\n        return new GraphPoint(x, m*x+q); }\r\n    // @param start, end: are for determining direction. every m is a line that can be seen in 2 direction\r\n    static mToRad(m: number, start: GraphPoint, end: GraphPoint): number {\r\n        let rad: number;\r\n        if (start.x === end.x) {\r\n            rad = (start.y < end.y) ? Math.PI * 3/2 :  Math.PI / 2;\r\n        } else {\r\n            // console.log(\"rad diagonal\", {base:  Math.atan(m), add: start.x > end.x, sx: start.x, ex: end.x});\r\n            rad = Math.atan(m) + (start.x > end.x ? 0 : Math.PI);\r\n        }\r\n        return rad; }\r\n\r\n    // intersect a rectangle with a line or segment (if end parameter is specified)\r\n    // @return: [0, 2] intersections\r\n    static lineToSizeIntersection_TODO(size: GraphSize, m: number, startLine: GraphPoint, endIfSegment?: GraphPoint): [] | [GraphPoint] | [GraphPoint, GraphPoint] {\r\n         // todo: use GraphSize.closestIntersection which is close. it is size-segment returning only the closest intersection\r\n        return [];\r\n    }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, Geom);\r\n","export class TagNames{\r\n    static FOREIGNOBJECT: \"FOREIGNOBJECT\" = \"FOREIGNOBJECT\";\r\n}\r\nexport class CSSRuleSorted{\r\n    public all: CSSStyleRule[];\r\n\r\n    constructor(styleNode: HTMLStyleElement) {\r\n        const oldParent = styleNode.parentElement;\r\n        if (!oldParent) document.body.append(styleNode);\r\n        const cssRuleList: CSSRuleList = styleNode.sheet!.cssRules || styleNode.sheet!.rules;\r\n        this.all = [...cssRuleList as any];\r\n        if (!oldParent) document.body.removeChild(styleNode);\r\n        // if (se aveva parent rimane attaccato lì e non serve fare questo) oldParent.append(styleNode);\r\n    }\r\n\r\n    public getCSSMediaRule(): CSSMediaRule[]{\r\n        return this.all.filter( (e, i): boolean => { return e instanceof CSSMediaRule; }) as any[];\r\n    }\r\n    public getCSSStyleRule(): CSSStyleRule[]{\r\n        return this.all.filter( (e, i): boolean  => { return e instanceof CSSStyleRule; }) as any[];\r\n    }\r\n    public notIn(list:CSSStyleRule[]): CSSStyleRule[] {\r\n        return this.all.filter( (e, i): boolean  => { return list.indexOf(e) !== -1; });\r\n    }\r\n}\r\n\r\n\r\nexport class CSSParser {\r\n    static parse(styleNode: HTMLStyleElement): CSSRuleSorted { return new CSSRuleSorted(styleNode); }\r\n}\r\n","import ReactJson from 'react-json-view' // npm i react-json-view\r\nimport React, {ReactElement, ReactNode} from \"react\";\r\nimport withReactContent from \"sweetalert2-react-content\";\r\nimport Swal from \"sweetalert2\";\r\nimport type { GraphElementOwnProps, GObject, Dictionary, DocString, Pointer } from \"../joiner\";\r\nimport type { InputOwnProps } from '../components/forEndUser/Input';\r\nimport type { SelectOwnProps } from '../components/forEndUser/Select';\r\nimport type { TextAreaOwnProps } from '../components/forEndUser/TextArea';\r\nimport {\r\n    LPointerTargetable, U, Log, GraphElementComponent,\r\n    windoww, RuntimeAccessible, EdgeComponent, RuntimeAccessibleClass, EdgeOwnProps, DGraphElement, DModelElement\r\n} from \"../joiner\";\r\n\r\n// U-functions that require jsx\r\n@RuntimeAccessible\r\nexport class UX{\r\n    static cname: string = \"UX\";\r\n\r\n    static recursiveMap<T extends ReactNode | ReactNode[] | null | undefined>(children: T, fn: (rn: T, i: number, depthIndices: number[])=>T, depthIndices: number[] = []): T {\r\n        // NB: depthIndices is correct but if there is an expression children evaluated to false like {false && <jsx>},\r\n        // it counts as children iterated regardless. so html indices might be apparently off, but like this is even safer as indices won't change when conditions are changed.\r\n        const innermap = (child: ReactNode, i1: number, depthIndices: number[]): T => {\r\n            if (!React.isValidElement(child)) { return child as T; }\r\n            if (child.props.children) {\r\n                // let deeperDepthIndices = [...depthIndices, i1];  // depthIndices; //\r\n                // should probably change deeperDepthIndices in [...deeperDepthIndices, i] in next uncommented line.\r\n                // Giordano: add ignore for webpack\r\n                //@ts-ignore\r\n                child = React.cloneElement(child, { children: UX.recursiveMap(child.props.children,\r\n                        (e: T, i2: number, ii) => fn(e, i2, ii), depthIndices) });\r\n            }\r\n            return fn(child as T, i1, depthIndices);\r\n        };\r\n        if (!Array.isArray(children)) return innermap(children as ReactNode, 0, [...depthIndices, 0]) as T;\r\n        return React.Children.map(children, (c: T, i3: number)=>innermap(c, i3, [...depthIndices,i3])) as T;\r\n    }\r\n    static injectProp(parentComponent: GraphElementComponent, e: ReactNode, gvidmap_useless: Dictionary<DocString<'VertexID'>, boolean>, parentnodeid: string, index: number, indices: number[]): ReactNode {\r\n        const re: ReactElement | null = UX.ReactNodeAsElement(e);\r\n        if (!re) return e;\r\n        // @ts-ignore this\r\n        // const parentComponent = this;\r\n        let type = (re.type as any).WrappedComponent?.name || re.type;\r\n        // const windoww = window as any;\r\n        // console.log('ux.injectingProp pre ', {type: (re.type as any).WrappedComponent?.name || re.type}, {mycomponents: windoww.mycomponents, re, props:re.props});\r\n        // add \"view\" (view id) prop as default to sub-elements of any depth to inherit the view of the parent unless the user forced another view to apply\r\n        switch (type) {\r\n            default:\r\n                // console.count('ux.injectingProp case default: ' + type);\r\n                return re;\r\n            /*\r\n            case windoww.Components.Input.name:\r\n            case windoww.Components.Textarea.name:\r\n                const objid =  re.props.obj?.id || re.props.obj || parentComponent.props.data.id;\r\n                const ret = React.cloneElement(re, {key: re.props.key || parentComponent.props.view.id + '_' + parentComponent.props.data.id + '_' + re.props.field, obj: objid, obj2: objid});\r\n                //console.log('relement Input set props',\r\n                //    {'re.props.obj.id': re.props.obj?.id, 're.props.obj': re.props.obj, 'thiss.props.data.id': thiss.props.data.id, thiss, re, objid, ret, 'ret.props': ret.props});\r\n                return ret;*/\r\n            // case windoww.Components.GraphElement.name:\r\n            case windoww.Components.Input.cname+\"Component\":\r\n            case windoww.Components.Select.cname+\"Component\":\r\n            case windoww.Components.TextArea.cname+\"Component\":\r\n                // todo: can i do a injector that if the user provides a ModelElement list raw <div>{this.children}</div> it wraps them in DefaultNode?\r\n                const injectProps2: InputOwnProps | SelectOwnProps | TextAreaOwnProps = {} as any;\r\n                const parentnodeid = parentComponent.props.node?.id;\r\n                injectProps2.data = re.props.data || (typeof parentComponent.props.data === \"string\" ? parentComponent.props.data : parentComponent.props.data?.id);\r\n                // !IMPORTANT! this key does not remove the responsability of adding keys to <GraphElement>s. this is assigning the key to the first returned element by component A,\r\n                // but react needs to distinguish component A from other components, and he still doesn't have a key. in fact this is useless as this component can only have 1 child\r\n                injectProps2.key = re.props.key || (parentnodeid + \"^input_\"+index);\r\n                return React.cloneElement(re, injectProps2);\r\n            case windoww.Components.GraphElementComponent.cname:\r\n            // case windoww.Components.DefaultNode.name:\r\n            case windoww.Components.DefaultNodeComponent.cname:\r\n            // case windoww.Components.Graph.name:\r\n            // case windoww.Components.GraphComponent.cname:\r\n            case \"Graph\": case \"GraphComponent\":\r\n            // case windoww.Components.Field.name:\r\n            // case windoww.Components.FieldComponent.cname:\r\n            // case windoww.Components.Vertex.name:\r\n            case EdgeComponent.cname:\r\n            case windoww.Components.VertexComponent.cname:\r\n                const injectProps: GraphElementOwnProps = {} as any;\r\n                injectProps.parentViewId = parentComponent.props.view.id || (parentComponent.props.view as any); // re.props.view ||  thiss.props.view\r\n                injectProps.parentnodeid = parentComponent.props.node?.id;\r\n                injectProps.graphid = parentComponent.props.graphid;\r\n                // const vidmap = GraphElementRaw.graphVertexID_counter;\r\n                // if (!vidmap[injectProps.graphid]) vidmap[injectProps.graphid] = {};\r\n                // const gvidmap = vidmap[injectProps.graphid];\r\n                // const validVertexIdCondition = (id: string): boolean => gvidmap_useless[id];\r\n                // todo: come butto dei sotto-vertici dentro un vertice contenitore? o dentro un sotto-grafo? senza modificare il jsx ma solo draggando? React-portals?\r\n                const dataid = (typeof re.props.data === \"string\" ? re.props.data : re.props.data?.id) || \"shapeless\";\r\n                let idbasename: string;\r\n                if (re.props.initialSize?.id) { idbasename = re.props.initialSize?.id; } else\r\n                if (re.props.nodeid) { idbasename = (injectProps.parentnodeid) + \"^\" + re.props.nodeid; } else\r\n                switch (type) {\r\n                    default:\r\n                        idbasename = injectProps.parentnodeid + \"^\" + dataid + \"N\";\r\n                        break;\r\n                    case windoww.Components.EdgePoint.cname:\r\n                        idbasename = injectProps.parentnodeid + \"^\" + (dataid || re.props.startingSize?.id || indices.join(\",\")) + \"EP\";\r\n                        break;\r\n                    case EdgeComponent.cname: case \"DamEdge\":\r\n                        let edgeProps:EdgeOwnProps = re.props;\r\n                        let edgestart_id: Pointer<DGraphElement> | Pointer<DModelElement> = (edgeProps.start as any).id || edgeProps.start;\r\n                        let edgeend_id: Pointer<DGraphElement> | Pointer<DModelElement> = (edgeProps.end as any).id || edgeProps.end;\r\n                        idbasename = injectProps.parentnodeid + \"^\" + edgestart_id + \"~\" + edgeend_id;\r\n                }\r\n                // (injectProps.parentnodeid)+\"^\"+(dataid)+indices.join(\",\");//injectProps.graphid + '^' + dataid;\r\n                // console.log(\"setting nodeid\", {injectProps, props:re.props, re});\r\n                // Log.exDev(!injectProps.graphid || !dataid, 'vertex is missing mandatory props.', {graphid: injectProps.graphid, dataid, props: re.props});\r\n                Log.exDev(!injectProps.graphid, 'vertex is missing mandatory props (graphid).', {graphid: injectProps.graphid, dataid, props: re.props});\r\n                injectProps.nodeid = idbasename; // U.increaseEndingNumber(idbasename, false, false, validVertexIdCondition);\r\n                injectProps.htmlindex = indices[indices.length - 1]; // re.props.node ? re.props.node.htmlindex : indices[indices.length - 1];\r\n                injectProps.key = re.props.key || injectProps.nodeid;\r\n                // console.log(\"cloning jsx:\", re, injectProps);\r\n                Log.ex((injectProps.nodeid === injectProps.graphid||injectProps.nodeid === injectProps.parentnodeid) && type != \"GraphComponent\", \"User manually assigned a invalid node id. please remove or change prop \\\"nodeid\\\"\", {type: (re.type as any).WrappedComponent?.cname || re.type}, {mycomponents: windoww.mycomponents, re, props:re.props});\r\n                return React.cloneElement(re, injectProps);\r\n        }}\r\n\r\n    static ReactNodeAsElement(e: React.ReactNode): React.ReactElement | null { return e && (e as ReactElement).type ? e as ReactElement : null; }\r\n\r\n    public static async deleteWithAlarm(lItem: LPointerTargetable) {\r\n        const MySwal = withReactContent(Swal);\r\n        const confirm = await MySwal.fire({\r\n            title: \"Delete \" + lItem.toString() + \"?\",\r\n            showCancelButton: true,\r\n            confirmButtonText: \"Yes\",\r\n            cancelButtonText: \"No\",\r\n            showLoaderOnConfirm: true\r\n        });\r\n        if (confirm.value === true) {\r\n            lItem.delete();\r\n        }\r\n    }\r\n    public static async info(text: string) {\r\n        const MySwal = withReactContent(Swal);\r\n        const confirm = await MySwal.fire({\r\n            title: text,\r\n            showCancelButton: false,\r\n            confirmButtonText: \"Got It\"\r\n        });\r\n    }\r\n}\r\n","import {DPointerTargetable, LPointerTargetable, RuntimeAccessible, RuntimeAccessibleClass} from \"../../joiner\";\r\n\r\n@RuntimeAccessible\r\nexport class DLog extends DPointerTargetable {\r\n    public static cname: string = \"DLog\";\r\n    static logic: typeof LPointerTargetable;\r\n    value: string;\r\n    constructor(value: string) {\r\n        super('todo' as any);\r\n        this.value = value;\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n}\r\n","import {LPointerTargetable, RuntimeAccessible} from \"../../joiner\";\r\n\r\n@RuntimeAccessible\r\nexport class LLog extends LPointerTargetable {\r\n    public static cname: string = \"LLog\";\r\n    // static structure: typeof DLog;\r\n    // static singleton: LLog;\r\n    value!: string;\r\n//    protected constructor(value: string) {super(); }\r\n}\r\n","// import {Mixin} from \"ts-mixer\";\r\nimport {isDeepStrictEqual} from \"util\";\r\nimport {\r\n    BEGIN,\r\n    Constructors,\r\n    CoordinateMode,\r\n    Dictionary,\r\n    DMap,\r\n    DModelElement,\r\n    DocString,\r\n    DPointerTargetable,\r\n    DState,\r\n    DUser,\r\n    DViewElement,\r\n    EdgeBendingMode,\r\n    END,\r\n    getWParams,\r\n    GObject,\r\n    GraphElementComponent,\r\n    GraphPoint,\r\n    GraphSize,\r\n    Info, IPoint,\r\n    Leaf,\r\n    LMap,\r\n    LModelElement,\r\n    Log,\r\n    LogicContext,\r\n    LPointerTargetable,\r\n    LViewElement,\r\n    MixOnlyFuncs,\r\n    Node,\r\n    Pack1,\r\n    PackArr,\r\n    Point,\r\n    Pointer,\r\n    Pointers,\r\n    PrimitiveType,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    SetFieldAction,\r\n    ShortAttribETypes,\r\n    Size,\r\n    store,\r\n    TargetableProxyHandler,\r\n    U, Uarr,\r\n    windoww\r\n} from \"../../joiner\";\r\nimport type {RefObject} from \"react\";\r\nimport {EdgeGapMode, InitialVertexSize, InitialVertexSizeObj} from \"../../joiner/types\";\r\nimport {labelfunc} from \"../../joiner/classes\";\r\nimport {Geom} from \"../../common/Geom\";\r\n\r\n\r\nconsole.warn('ts loading graphDataElement');\r\n\r\nlet lgraph: LGraphElement = null /* this.node */ as any;\r\n\r\n\r\n@Node\r\n@RuntimeAccessible\r\nexport class DGraphElement extends DPointerTargetable {\r\n    public static cname: string = \"DGraphElement\";\r\n    // static _super = DPointerTargetable;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    id!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>; // todo: cerca graphID e rimpiazza / adatta\r\n    model?: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    state: DMap = {} as any;\r\n    father!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    x: number = 0;\r\n    y: number = 0;\r\n    zIndex:number = 100;\r\n    w: number=300;\r\n    h: number=500;\r\n    // width: number = 300;\r\n    // height: number = 400;\r\n    view!: Pointer<DViewElement, 1, 1, LViewElement>;\r\n    favoriteNode!: boolean;\r\n\r\n\r\n    public static new(htmlindex: number, model: DGraphElement[\"model\"]|null|undefined, parentNodeID: DGraphElement[\"father\"],\r\n                      graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"]|undefined, a?: any, b?:any, ...c:any): DGraphElement {\r\n        return new Constructors(new DGraphElement('dwc')).DPointerTargetable(false, nodeID).DGraphElement(model, parentNodeID, graphID, htmlindex).end();\r\n    }\r\n\r\n}\r\n@RuntimeAccessible\r\nexport class LGraphElement<Context extends LogicContext<DGraphElement> = any, C extends Context = Context> extends LPointerTargetable {\r\n    public static cname: string = \"LGraphElement\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static getNodeId<L extends LGraphElement, D extends DGraphElement>(o:L | D | Pointer<D> | LModelElement | DModelElement | Pointer<DModelElement>): Pointer<D> {\r\n        // Log.ex(!o, \"cannot get node from undefined\", {o});\r\n        let node: any = o;\r\n        // from L to D\r\n        // let cname = (node.__raw || node).className;\r\n        // from DModelE to LGraphE\r\n        if (RuntimeAccessibleClass.extends((o as any).className, \"DModelElement\")) node = LPointerTargetable.from(o as DModelElement).node as LGraphElement;\r\n        return (typeof node === \"string\") ? node : node?.id;\r\n    }\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    __raw!: DGraphElement;\r\n    id!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    father!: LGraphElement;\r\n    graph!: LGraph; // todo: can be removed and accessed by navigating .father\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[]; // shallow, direct subelements\r\n    state!: LMap;\r\n    allSubNodes!: LGraphElement[]; // deep, nested subelements\r\n    x!: number;\r\n    y!: number;\r\n    width!: number;\r\n    height!: number\r\n\r\n    z!:number;\r\n    zIndex!: number;\r\n    __info_of_z__: Info = {type:ShortAttribETypes.EInt, txt: \"alias for zIndex\"};\r\n    __info_of_zIndex__: Info = {type:ShortAttribETypes.EInt,\r\n        txt: \"Determine the z-axis priority of the element.<br/>Higher value tende to overlap other elements.<br/>Lower value tends to be on background.\"};\r\n    zoom!: GraphPoint;\r\n    html?: Element;\r\n\r\n    // fittizi\r\n    w!:number;\r\n    h!:number;\r\n    size!: GraphSize;\r\n    position!: GraphPoint;\r\n    htmlSize!: Size; // size and position in global document coordinates.\r\n    htmlPosition!: Point;\r\n    view!: LViewElement;\r\n    component!: GraphElementComponent;\r\n    favoriteNode!: boolean;\r\n    vertex?: LVoidVertex;\r\n    __info__of__vertex: Info = {type: \"LVoidVertex\", txt: \"the foremost vertex containing this graphElement, or undefiened.\"}\r\n    __info__of__favoriteNode: Info = {type: ShortAttribETypes.EBoolean,\r\n        txt: \"<span>Indicates this is the primarly used (by default) node to refer to a modelling element that might have multiple representations.\" +\r\n            \"<br> Can be used as favorite target for edges or other.\"}\r\n\r\n    startPoint!: GraphPoint;\r\n    endPoint!: GraphPoint;\r\n    __info_of__startPoint: Info = {type: \"GraphPoint\", txt:<span>Where the outgoing edges should start their paths.\r\n            <br/>Obtained by combining anchoring point offset specified in view, before snapping to a Vertex border.\r\n            <br/>Defaults in outer coordinates.</span>};\r\n    __info_of__endPoint: Info = {type: \"GraphPoint\", txt:<span>Where the incoming edges should end their paths.\r\n            <br/>Obtained by combining anchoring point offset specified in view, before snapping to a Vertex border.\r\n            <br/>Defaults in outer coordinates.</span>};\r\n\r\n    __info_of__graph: Info = {type:\"\", txt:\"\"};\r\n    innerGraph!: LGraph;\r\n    __info_of__innnerGraph: Info = {type:\"\", txt:\"\"};\r\n    outerGraph!: LGraph;\r\n    __info_of__outerGraphGraph: Info = {type:\"\", txt:\"\"};\r\n    get_graph(context: Context): LGraph { return this.get_innerGraph(context); }\r\n\r\n    __info_of__graphAncestors: Info = {type:\"LGraph[]\",\r\n        txt:\"<span>collection of the stack of Graphs containing the current element where [0] is the most nested graph, and last is root graph.</span>\"};\r\n    graphAncestors!: LGraph[];\r\n\r\n    protected _defaultCollectionGetter(c: Context, k: keyof Context[\"data\"]): LPointerTargetable[] { return LPointerTargetable.fromPointer((c.data as any)[k]); }\r\n    protected _defaultGetter(c: Context, k: keyof Context[\"data\"]): any {\r\n        //console.log(\"default Getter\");\r\n        if (k in c.data) {\r\n            let v = (c.data as any)[k];\r\n            if (Array.isArray(v)) {\r\n                if (v.length === 0) return [];\r\n                else if (Pointers.isPointer(v[0] as any)) return this._defaultCollectionGetter(c, k);\r\n                return v;\r\n            } else return v;\r\n        }\r\n        let ret: any;\r\n        let view = this.get_view(c);\r\n        try { ret = (view as any)[k] } catch (e) { Log.ee(\"Could not find get_ property \\\"\" + k + \"\\\" in node or view.\", {c, view, k}); return undefined; }\r\n        return ret;\r\n    }\r\n\r\n    protected _defaultSetter(v: any, c: Context, k: keyof Context[\"data\"]): any {\r\n        console.log(\"default Setter\");\r\n        if (k in c.data) {\r\n            let isPointer: boolean;\r\n            if (Array.isArray(v)) {\r\n                if (v.length === 0) isPointer = true; // assumed, should not cause harm if it is not.\r\n                // it will delete remove an entry in pointedBy from all oldValue entries in the array that should not be present anyway.\r\n                // like oldVal.map( id => U.arrayRemove(LData.wrap(id).pointedBy, c.data.this_id)\r\n                else isPointer = Pointers.isPointer(v[0] as any);\r\n            } else isPointer = false;\r\n            return SetFieldAction.new(c.data.id, k as any, v, '', isPointer);\r\n        }\r\n        let view = this.get_view(c);\r\n        try { (view as any)[k] = v; } catch (e) { Log.ee(\"Could not find set_ property \\\"\" + k + \"\\\" in node or view.\", {c, v, k, view}); return false; }\r\n        return true;\r\n    }\r\n\r\n    get_graphAncestors(c: Context): LGraph[] {\r\n        let current = c.proxyObject;\r\n        let next = current.father;\r\n        let ret: LGraph[] = [];\r\n        while(next) {\r\n            if (RuntimeAccessibleClass.extends(next.className, DGraph.cname)) ret.push(next as LGraph);\r\n            if (current.id === next.id) break;\r\n            current = next;\r\n            next = next.father;\r\n        }\r\n        return ret;\r\n    }\r\n    get_outerGraph(context: Context): LGraph {\r\n        // todo: this relies on the fact that GraphVertex are not passing their own id to their childrens, but the parent graph id\r\n        return TargetableProxyHandler.wrap(context.data.graph);\r\n    }\r\n    get_vertex(context: Context): this[\"vertex\"] {\r\n        let lcurrent: LGraphElement = LPointerTargetable.fromPointer(context.data.id);\r\n        let dcurrent = lcurrent.__raw;\r\n        // iterate parents.\r\n        while(dcurrent){\r\n            switch(dcurrent.className){\r\n                case DVertex.cname:\r\n                case DVoidVertex.cname:\r\n                case DGraphVertex.cname: return (lcurrent || LPointerTargetable.fromD(dcurrent)) as LVoidVertex;\r\n                default:\r\n                    if (!dcurrent.father || dcurrent.id === dcurrent.father) return undefined;\r\n                    Log.exDev(!dcurrent.father || dcurrent.id === dcurrent.father, \"node failed to get containing vertex\", context.data, dcurrent, lcurrent);\r\n                    lcurrent = LPointerTargetable.fromPointer(dcurrent.father);\r\n                    dcurrent = lcurrent.__raw;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    get_innerGraph(context: Context): LGraph {\r\n        let lcurrent: LGraphElement = LPointerTargetable.fromPointer(context.data.father);\r\n        let dcurrent = lcurrent.__raw;\r\n\r\n        // if no parent, but it's a graph, return itself.\r\n        if (!dcurrent) {\r\n            dcurrent = context.data;\r\n            switch(dcurrent.className){\r\n                case DGraph.cname:\r\n                case DGraphVertex.cname: return (lcurrent || LPointerTargetable.fromD(dcurrent)) as LGraph;\r\n                default: return Log.exDevv(\"node failed to get containing graph\", context.data, dcurrent, lcurrent);\r\n            }\r\n        }\r\n\r\n        // if it have a parent, iterate parents.\r\n        while(true){\r\n            switch(dcurrent?.className){\r\n                case DGraph.cname:\r\n                case DGraphVertex.cname: return (lcurrent || LPointerTargetable.fromD(dcurrent)) as LGraph;\r\n                default:\r\n                    if (!dcurrent.father || dcurrent.id === dcurrent.father) {\r\n                        /*switch(dcurrent.className){\r\n                            case DGraph.name:\r\n                            case DGraphVertex.name: return (lcurrent || LPointerTargetable.fromD(dcurrent)) as LGraph;\r\n                            default: */return Log.exDevv(\"node failed to get containing graph\", context.data, dcurrent, lcurrent);\r\n                        //}\r\n                    }\r\n                    lcurrent = LPointerTargetable.fromPointer(dcurrent.father);\r\n                    dcurrent = lcurrent.__raw;\r\n            }\r\n        }\r\n    }\r\n\r\n    // set_x(val: this[\"x\"], context: Context): boolean { SetFieldAction.new(context.data.id, \"x\", val, undefined, false); return true; }\r\n    // get_x(context: Context): this[\"x\"] { return context.data.x; }\r\n    get_x(context: Context): this[\"x\"] { return this.get_size(context).x; }\r\n    set_x(val: this[\"x\"], context: Context): boolean { return this.set_size({x:val}, context); }\r\n    get_y(context: Context): this[\"y\"] { return this.get_size(context).y; }\r\n    set_y(val: this[\"y\"], context: Context): boolean { return this.set_size({y:val}, context); }\r\n\r\n    get_w(context: Context): this[\"w\"] { return this.get_size(context).w; }\r\n    set_w(val: this[\"w\"], context: Context): boolean { return this.set_size({w:val}, context); }\r\n    get_h(context: Context): this[\"h\"] { return this.get_size(context).h; }\r\n    set_h(val: this[\"h\"], context: Context): boolean { return this.set_size({h:val}, context); }\r\n\r\n    get_width(context: Context): this[\"w\"] { return this.get_w(context); }\r\n    set_width(val: this[\"w\"], context: Context): boolean { return this.set_w(val, context); }\r\n    get_height(context: Context): this[\"h\"] { return this.get_h(context); }\r\n    set_height(val: this[\"h\"], context: Context): boolean { return this.set_h(val, context); }\r\n\r\n    get_position(context: Context): this[\"position\"] { return new GraphPoint(context.data.x, context.data.y); }\r\n    set_position(val: this[\"position\"], context: Context): boolean {\r\n        BEGIN()\r\n        SetFieldAction.new(context.data.id, \"x\", val.x, undefined, false);\r\n        SetFieldAction.new(context.data.id, \"y\", val.y, undefined, false);\r\n        END()\r\n        return true; }\r\n\r\n    get_sizeold(context: Context): this[\"size\"] { return new GraphSize(context.data.x, context.data.y, context.data.w, context.data.h); }\r\n    get_component(context: Context): this[\"component\"] {\r\n        // switch(context.data.className) { case DEdgePoint.name: return GraphElementComponent.map[context.data.father]; }\r\n        return GraphElementComponent.map[context.data.id]; }\r\n    // get_view(context: Context): this[\"view\"] { return this.get_component(context).props.view; }\r\n    get_view(context: Context): this[\"view\"] {\r\n        let c = this.get_component(context);\r\n        if (c) return c.props.view;\r\n        return LPointerTargetable.fromPointer(context.data.view); }\r\n    set_view(val: Pack1<this[\"view\"]>, context: Context){\r\n        let ptr: DGraphElement[\"view\"] = Pointers.from(val as this[\"view\"]);\r\n        return SetFieldAction.new(context.data.id, \"view\", ptr, '', true);\r\n    }\r\n\r\n    outerSize!: LGraphElement[\"size\"];\r\n    __info_of__outerSize: Info = {type:\"GraphSize\", txt:\"the size of the current element relative to the first (root) graph level.\"};\r\n    innerSize!: LGraphElement[\"size\"];\r\n    __info_of__innerSize: Info = {type:\"GraphSize\", txt:\"the size of the current element relative to the last (most nested) graph level.\"};\r\n    __info_of__size: Info = {type:\"GraphSize\", txt: \"same as innerSize.\"};\r\n\r\n    get_outerSize(context: Context, canTriggerSet: boolean = true): Readonly<GraphSize> {\r\n        return this.get_innerSize(context, canTriggerSet, true);\r\n    }\r\n    get_size(context: Context, canTriggerSet: boolean = true): Readonly<GraphSize> { return this.get_innerSize(context, canTriggerSet, false); }\r\n    get_innerSize(context: Context, canTriggerSet: boolean = true, outerSize: boolean = false): Readonly<GraphSize> {\r\n        let r = this.get_innerSize_impl(context, canTriggerSet, outerSize);\r\n        return new GraphSize(r.x, r.y, r.w, r.h);\r\n    }\r\n    protected get_innerSize_impl(context: Context, canTriggerSet: boolean = true, outerSize: boolean = false): Readonly<GraphSize> {\r\n        switch(context.data.className){\r\n            default: return Log.exDevv(\"unexpected classname in get_size switch: \" + context.data.className);\r\n            case DVoidEdge.cname:\r\n            case DGraph.cname: return nosize as any;\r\n            // case DField.cname:\r\n            case DGraphElement.cname:\r\n                let graph = outerSize ? this.get_outerGraph(context) : this.get_innerGraph(context);\r\n                return graph.coord(this.get_htmlSize(context));\r\n            case DVoidVertex.cname:\r\n            case DVertex.cname:\r\n            case DEdgePoint.cname:\r\n            case DGraphVertex.cname: break;\r\n        }\r\n        // low prio todo: memoization in proxy, as long state does not change keep a collection Dictionary[object][key] = returnval. it gets emptied when state is updated.\r\n        /*console.log(\"get_size(\"+(this.props?.data as any).name+\")\", {\r\n            view:this.props.view.getSize(this.props.dataid || this.props.nodeid as string),\r\n            node:this.props.node?.size,\r\n            default: this.props.view.defaultVSize});*/\r\n        let component = this.get_component(context);\r\n        // windoww.debugg = context;\r\n        // console.log(\"edgee getsize\", {component, view:component?.props?.view, data:{...context.data}});\r\n        let view = component?.props?.view || this.get_view(context);\r\n        // (window as any).retry = ()=>view.getSize(context.data.id);\r\n        let ret: GraphSize = view.getSize(context.data.id) as any; // (this.props.dataid || this.props.nodeid as string)\r\n        // console.log(\"getSize() from view\", {ret: ret ? {...ret} : ret});\r\n        if (!ret) {\r\n            ret = new GraphSize();\r\n            ret.x = context.data.x;\r\n            ret.y = context.data.y;\r\n            ret.w = context.data.w;\r\n            ret.h = context.data.h;\r\n            let def: GraphSize | undefined;\r\n            if (undefined===(ret.x)) { if (!def) def = view.defaultVSize; ret.x = def.x;}\r\n            if (undefined===(ret.y)) { if (!def) def = view.defaultVSize; ret.y = def.y;}\r\n            if (undefined===(ret.w)) { if (!def) def = view.defaultVSize; ret.w = def.w;}\r\n            if (undefined===(ret.h)) { if (!def) def = view.defaultVSize; ret.h = def.h;}\r\n            // console.log(\"getSize() from node merged with defaultVSize\", {ret: ret ? {...ret} : ret});\r\n        }\r\n        if (context.data.className === DEdgePoint.cname) { ret = (this as any as LEdgePoint).decodePosCoords(context, ret, view); }\r\n\r\n        if ((context.data as DVoidVertex).isResized) return ret;\r\n        let html: RefObject<HTMLElement | undefined> | undefined = component?.html;\r\n        let actualSize: Partial<Size> & {w:number, h:number} = html?.current ? Size.of(html.current) : {w:0, h:0};\r\n        let updateSize: boolean = false;\r\n        if (view.adaptWidth && ret.w !== actualSize.w) {\r\n            ret.w = actualSize.w;\r\n            if (canTriggerSet) updateSize = true;\r\n            // if (canTriggerSet) this.set_size({w:actualSize.w}, context);\r\n        }\r\n        if (view.adaptHeight && ret.h !== actualSize.h) {\r\n            ret.h = actualSize.h;\r\n            if (canTriggerSet && !updateSize) updateSize = true;\r\n        }\r\n        // console.log(\"getSize() from node merged with actualSize\", {ret: {...ret}});\r\n\r\n        if (updateSize) this.set_size(ret, context);\r\n        if (outerSize) ret = this.get_outerGraph(context).translateSize(ret, this.get_innerGraph(context));\r\n        return ret;\r\n    }\r\n    // set_size(size: Partial<this[\"size\"]>, context: Context): boolean {\r\n    set_size(size: Partial<GraphSize>, c: Context): boolean {\r\n        // console.log(\"setSize(\"+(this.props?.data as any).name+\") thisss\", this);\r\n        if (!size) return false;\r\n        let view = this.get_view(c);\r\n        if (c.data.className === DEdgePoint.cname) size = (this as any as LEdgePoint).encodePosCoords(c as any, size, view);\r\n        if (view.updateSize(c.data.id, size)) return true;\r\n        BEGIN()\r\n        if (size.x !== c.data.x && size.x !== undefined) SetFieldAction.new(c.data.id, \"x\", size.x, undefined, false);\r\n        if (size.y !== c.data.y && size.y !== undefined) SetFieldAction.new(c.data.id, \"y\", size.y, undefined, false);\r\n        if (size.w !== c.data.w && size.w !== undefined) SetFieldAction.new(c.data.id, \"w\", size.w, undefined, false);\r\n        if (size.h !== c.data.h && size.h !== undefined) SetFieldAction.new(c.data.id, \"h\", size.h, undefined, false);\r\n        END()\r\n        return true; }\r\n\r\n    get_html(context: Context): this[\"html\"] { return this.get_component(context).html.current || undefined; }\r\n    // get_html(context: Context): this[\"html\"] { return $(\"[node-id='\" + context.data.id + \"']\")[0]; }\r\n    set_html(val: this[\"htmlSize\"], context: Context): boolean { return this.cannotSet(\"set_html(). html is generated through jsx. edit the view instead.\"); }\r\n\r\n    get_htmlSize(context: Context): this[\"htmlSize\"] {\r\n        let html = this.get_html(context);\r\n        return html ? Size.of(html) : new Size(0, 0, 0, 0);\r\n        /*\r\n        let graph = this.get_graph(context);\r\n        if (!html) return nosize as any;\r\n        let size = Size.of(html);\r\n        let zoom = graph.zoom;\r\n        size.x /= zoom.x;\r\n        size.y /= zoom.y;\r\n        return size;*/}\r\n    set_htmlSize(val: this[\"htmlSize\"], context: Context): boolean {\r\n        // might be useful for fixed display size/location elements that stay in place even if you move tab or change zoom. debatable if needed\r\n        this.cannotSet(\"set_htmlSize(): todo extra low priority. set GraphSize through set_size instead.\");\r\n        return true; }\r\n    get_htmlPosition(context: Context): this[\"htmlPosition\"] { return this.get_htmlSize(context).tl(); }\r\n    set_htmlPosition(val: this[\"htmlPosition\"], context: Context): boolean {\r\n        // might be useful for fixed display size/location elements that stay in place even if you move tab or change zoom. debatable if needed\r\n        this.cannotSet(\"set_htmlPosition(): todo extra low priority. set graph position through set_position instead.\");\r\n        return true; }\r\n\r\n\r\n    /* how z-index work, it's really messy.\r\n    * cannot move html position. node id depends on it, and a node moving position would need to change id.\r\n    * so i use css order.\r\n    * first order is assigned through node constructor called by parent component injectProps, according to his last index in html.\r\n    * now z-index is set in node and updated properly.\r\n    * z-index is passed to a prop, rendered as html attribute.\r\n    * css takes the attribute value and uses it in \"order\" css rule.\r\n    * problem: updating node.z doesn't trigger the parent injectprops, so he inject html index and\r\n    * the outernmost html root cannot update his attribute without refreshing the parent and recalling injectprops\r\n    * fixed: by updating it directly in GraphElement.render()\r\n    * */\r\n    get_zIndex(context: Context): this[\"zIndex\"] { return context.data.zIndex; }\r\n    set_zIndex(val: this[\"zIndex\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data.id, \"zIndex\", val, undefined, false);\r\n        return true; }\r\n    get_z(context: Context): this[\"zIndex\"] { return context.data.zIndex; }\r\n    set_z(val: this[\"zIndex\"], context: Context): boolean { return this.set_zIndex(val, context); }\r\n    /*\r\n        get_containedIn(context: Context): this[\"containedIn\"] {\r\n            return context.data.containedIn ? LPointerTargetable.fromPointer(context.data.containedIn) : undefined; }\r\n        set_containedIn(val: Pack1<this[\"containedIn\"]>, context: LogicContext<DGraphElement>): boolean {\r\n            let ptr: DGraphElement[\"containedIn\"] = Pointers.from(val) as any;\r\n            SetFieldAction.new(context.data, 'containedIn', ptr, undefined, true);\r\n            if (ptr) SetFieldAction.new(ptr as any, 'subElements+=', context.data.id);\r\n            return true; }*/\r\n\r\n    get_subElements(context: Context): this[\"subElements\"] { return LPointerTargetable.fromArr(context.data.subElements); }\r\n    set_subElements(val: PackArr<this[\"subElements\"]>, context: LogicContext<DGraphElement>): boolean {\r\n        console.log(\"isDeepStrictEqual\", {isDeepStrictEqual});\r\n        // if (isDeepStrictEqual(context.data.subElements, val)) return true;\r\n        let pointers: Pointer<DGraphElement, 0, 'N', LGraphElement> = Pointers.from(val) || [];\r\n        if (Uarr.equals(pointers, context.data.subElements, false)) return true;\r\n        SetFieldAction.new(context.data, 'subElements', pointers, '', true);\r\n        const idlookup = store.getState().idlookup;\r\n        let arrdiff = U.arrayDifference(context.data.subElements, pointers);\r\n        // old subelements\r\n        for (let oldsubelementid of arrdiff.removed) {\r\n            let subelement: DGraphElement = (oldsubelementid && idlookup[oldsubelementid]) as DGraphElement;\r\n            if (subelement.father !== context.data.id) continue;\r\n            LPointerTargetable.from(subelement).father = null as any; // todo: can this happen? è transitorio o causa vertici senza parent permanenti?\r\n        }\r\n        // new subelements\r\n        for (let newsubelementid of arrdiff.added) {\r\n            let subelement: DGraphElement = (newsubelementid && idlookup[newsubelementid]) as DGraphElement;\r\n            if (subelement.father === context.data.id) continue;\r\n            LPointerTargetable.from(subelement).father = context.data.id as any; // trigger side-action\r\n        }\r\n        return true;\r\n    }\r\n\r\n    get_isResized(context: LogicContext<DVoidVertex>): DVoidVertex[\"isResized\"] { return context.data.isResized; }\r\n    set_isResized(val: DVoidVertex[\"isResized\"], context: LogicContext<DVoidVertex>): DVoidVertex[\"isResized\"] {\r\n        return SetFieldAction.new(context.data.id, \"isResized\", val);\r\n    }\r\n\r\n    get_model(context: Context): this[\"model\"] {\r\n        const modelElementId = $('[id=\"' + context.data.id + '\"]')[0].dataset.dataid;\r\n        const lModelElement: LModelElement = LPointerTargetable.from(modelElementId as string);\r\n        return lModelElement;\r\n    }\r\n\r\n    private get_allSubNodes(context: Context, state?: DState): this[\"allSubNodes\"] {\r\n        // return context.data.packages.map(p => LPointerTargetable.from(p));\r\n        state = state || store.getState();\r\n        let tocheck: Pointer<DGraphElement>[] = context.data.subElements || [];\r\n        let checked: Dictionary<Pointer, true> = {};\r\n        checked[context.data.id] = true;\r\n        while (tocheck.length) {\r\n            let newtocheck: Pointer<DGraphElement>[] = [];\r\n            for (let ptr of tocheck) {\r\n                if (checked[ptr]) throw new Error(\"loop in GraphElements containing themselves\");\r\n                checked[ptr] = true;\r\n                let subnode: DGraphElement = DPointerTargetable.from(ptr, state);\r\n                U.arrayMergeInPlace(newtocheck, subnode?.subElements);\r\n            }\r\n            tocheck = newtocheck;\r\n        }\r\n        delete checked[context.data.id];\r\n        return LPointerTargetable.from(Object.keys(checked), state);\r\n    }\r\n\r\n\r\n    get_father(context: Context): this[\"father\"] { return LPointerTargetable.fromPointer(context.data.father); }\r\n    set_father(val: Pack1<this[\"father\"]>, context: Context): boolean {\r\n        let ptr: DGraphElement[\"father\"] = Pointers.from(val) as any;\r\n        SetFieldAction.new(context.data, 'father', ptr, undefined, true);\r\n        if (ptr) SetFieldAction.new(ptr as any, 'subElements+=', context.data.id);\r\n        return true; }\r\n\r\n    get_isSelected(context: LogicContext<DGraphElement>): this[\"isSelected\"] { return context.data.isSelected; }\r\n    set_isSelected(val: this[\"isSelected\"], context: LogicContext<DGraphElement>): boolean {\r\n        return this.cannotSet(\"graphElement.isSelected(): todo\"); }\r\n\r\n    get_state(context: LogicContext<DGraphElement>): this[\"state\"] {\r\n        let state: GObject = context.data.state;\r\n        for (let key in state) {\r\n            switch(key) {\r\n                case \"id\": break;\r\n                default: state[key] = LPointerTargetable.wrap(state[key]); break;\r\n            }\r\n        }\r\n        return state as any;\r\n    }\r\n    set_state(val: this[\"state\"], context: LogicContext<DGraphElement>): boolean {\r\n        return this.cannotSet(\"graphElement.isSelected(): todo\"); }\r\n\r\n\r\n\r\n    // for edges\r\n    public get_startPoint(c: Context|undefined, size?: GraphSize, view?: LViewElement): GraphPoint { return this.get_startEndPoint(c, size, view, true); }\r\n    public get_endPoint(c: Context|undefined, size?: GraphSize, view?: LViewElement): GraphPoint { return this.get_startEndPoint(c, size, view, false); }\r\n    private get_startEndPoint(c: Context|undefined, size?: GraphSize, view?: LViewElement, isStart:boolean=true): GraphPoint {\r\n        if (!size) {\r\n            if (c) size = this.get_size(c) as any; else size = Log.exDevv(\"invalid arguments in get_startEndPoint\", {arguments});\r\n        }\r\n        if (!view) {\r\n            // if (c) view = this.get_view(c); else view = Log.exDevv(\"invalid arguments in get_startPoint\", {arguments});\r\n            view = c && this.get_view(c) || Log.exDevv(\"invalid arguments in get_startEndPoint\", {arguments});\r\n        }\r\n        let offset: GraphPoint = (view as LViewElement)[isStart ? \"edgeStartOffset\" : \"edgeEndOffset\"];\r\n        let isPercentage: boolean = (view as LViewElement)[isStart ? \"edgeStartOffset_isPercentage\" : \"edgeEndOffset_isPercentage\"];\r\n        if (!size) size = new GraphSize(0, 0, 0, 0);\r\n        if (isPercentage) offset = new GraphPoint(offset.x/100*(size.w), offset.y/100*(size.h));\r\n        return size.tl().add(offset, false);\r\n    }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DGraphElement);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LGraphElement)\r\n\r\n\r\n@RuntimeAccessible\r\nexport class DGraph extends DGraphElement {\r\n    public static cname: string = \"DGraph\";\r\n    // static _super = DGraphElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraph;\r\n    // static logic: typeof LGraph;\r\n    // static structure: typeof DGraph;\r\n\r\n    // inherit redefine\r\n    father!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    id!: Pointer<DGraph, 1, 1, LGraph>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    state: DMap = {} as any;\r\n    // personal attributes\r\n    zoom!: GraphPoint;\r\n    graphSize!: GraphSize; // internal size of the graph. can be huge even if the sub-graph is in a small window (scroll)\r\n    sizes!: Dictionary<Pointer<DModelElement>, GraphSize>;\r\n\r\n    public static new(htmlindex: number, model: DGraph[\"model\"],\r\n                      parentNodeID?: DGraphElement[\"father\"], // immediate parent\r\n                      parentgraphID?: DGraphElement[\"graph\"], // graph containing this subgraph (redudant? could get it from father chain)\r\n                      nodeID?: DGraphElement[\"id\"] // this id\r\n    ): DGraph {\r\n        return new Constructors(new DGraph('dwc'), parentNodeID, true, DGraphElement)\r\n            .DPointerTargetable(false, nodeID || Constructors.DGraph_makeID(model))\r\n            .DGraphElement(model, parentNodeID, parentgraphID, htmlindex).DGraph().end();\r\n    }\r\n\r\n\r\n    static getNodes(dmp: import(\"../logicWrapper/LModelElement\").DModelElement[], out: {$matched: JQuery<HTMLElement>; $notMatched: JQuery<HTMLElement>; }): JQuery<HTMLElement> {\r\n        let $allnodes = $('[data-dataid]');\r\n        let matchedids: Pointer[] = (dmp || []).map(d => d.id);\r\n        let matchedidmap:Dictionary<string, boolean> = U.objectFromArrayValues(matchedids);\r\n        if (!out) out = {} as any;\r\n\r\n        let allnodesarr = [...$allnodes];\r\n        let filternode = (d: HTMLElement) => {\r\n            if (!d?.dataset?.dataid) return false;\r\n            let id: string = ''+d?.dataset?.dataid;\r\n            return matchedidmap[id]; };\r\n        out.$matched = $(allnodesarr.filter(filternode));\r\n        out.$notMatched = $(allnodesarr.filter((n) => !filternode(n)));\r\n        console.error(\"getnodes\", {dmp, out, matchedidmap, matchedids, allnodesarr});\r\n        return out.$matched;\r\n        // throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n}\r\nvar nosize = {x:0, y:0, w:0, h:0, nosize:true};\r\n@RuntimeAccessible\r\nexport class LGraph<Context extends LogicContext<DGraph> = any, D extends DGraph = any> extends LGraphElement {\r\n    public static cname: string = \"LGraph\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraph;\r\n    // static logic: typeof LGraph;\r\n    // static structure: typeof DGraph;\r\n\r\n    // inherit redefine\r\n    __raw!: DGraph;\r\n    id!: Pointer<DGraph, 1, 1, LGraph>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    state!: LMap;\r\n    // personal attributes\r\n    zoom!: GraphPoint;\r\n    graphSize!: GraphSize; // size internal to the graph, while \"size\" is instead external size of the vertex holding the graph in GraphVertexes\r\n    // protected sizes!: Dictionary<Pointer<DModelElement>, GraphSize>;\r\n\r\n\r\n    // get_sizes(context: Context): D[\"sizes\"] { return context.data.sizes; }\r\n    //set_sizes(val: D[\"sizes\"], context: Context): boolean { return SetFieldAction.new(context.data.id, \"sizes\", val); }\r\n\r\n    get_graphSize(context: LogicContext<DGraph>):  Readonly<GraphSize> { return context.data.graphSize; }\r\n    get_zoom(context: Context): GraphPoint {\r\n        const zoom: GraphPoint = context.data.zoom;\r\n        // (zoom as any).debug = {rawgraph: context.data.__raw, zoomx: context.data.zoom.x, zoomy: context.data.zoom.y}\r\n        return context.data.zoom; }\r\n\r\n    toGraphSize(...a:Parameters<this[\"coord\"]>): ReturnType<this[\"coord\"]>{ return this.wrongAccessMessage(\"toGraphSize\"); }\r\n    coord(htmlSize: Size): GraphSize { return this.wrongAccessMessage(\"toGraphSize\"); }\r\n    get_coord(context: Context): (htmlSize: Size) => GraphSize {\r\n        return (htmlSize: Size)=> {\r\n            let size: Size = this.get_htmlSize(context);\r\n            let zoom: GraphPoint = this.get_zoom(context);\r\n            return new GraphSize((htmlSize.x - size.x) / zoom.x, (htmlSize.y - size.y) / zoom.y, htmlSize.w/zoom.x, htmlSize.h/zoom.y);\r\n        }\r\n    }\r\n    // get_htmlSize(context: Context): Size { }\r\n    __info_of__translateSize: Info = {type:\"function(GraphSize, Graph) --> GraphSize\",\r\n        txt:\"Translate the position of an element from his coordinates to the coordinate system of another graph.\\n\" +\r\n            \"The other graph must be an ancestor containing the current Graph calling this function.\"}\r\n    translateSize<T extends GraphSize|GraphPoint>(ret: T, innerGraph: LGraph): T { return this.wrongAccessMessage(\"translateSize()\"); }\r\n    get_translateSize<T extends GraphSize|GraphPoint>(c: Context): ((size: T, innerGraph: LGraph) => T) {\r\n        return (size: T, innerGraph: LGraph): T => {\r\n            innerGraph = LPointerTargetable.wrap(innerGraph) as LGraph;\r\n            let ret: T = (size.hasOwnProperty(\"w\") ? new GraphSize(size.x, size.y, (size as GraphSize).w, (size as GraphSize).h) : new GraphPoint(size.x, size.y)) as T;\r\n            Log.ex(!innerGraph, \"translateSize() graph parameter is invalid: \"+innerGraph, innerGraph, c);\r\n            let ancestors: LGraph[] = [innerGraph, ...innerGraph.graphAncestors]\r\n            Log.ex(ancestors.indexOf(c.proxyObject) !== -1, \"translateSize() graph parameter is invalid: it must be a graph containing the current one.\", innerGraph, c);\r\n            for (let g of ancestors) ret.add(g.size.tl(), false);\r\n            // console.log(\"translateSize\", {c, thiss:c.proxyObject, ancestors, ancestorSizes: ancestors.map(a=> a.size.tl()), size, ret});\r\n            return ret; }\r\n    }\r\n    contains(elem: LGraphElement): boolean{ return this.wrongAccessMessage(\"contains()\"); }\r\n    get_contains(c: Context): ((elem: LGraphElement)=> boolean) {\r\n        return (elem: LGraphElement): boolean => {\r\n            let current = elem;\r\n            let next = elem.father;\r\n            let targetid = c.proxyObject.id;\r\n            if (current.id !== targetid) return true;\r\n            while(next && current.id !== next.id) {\r\n                current = next;\r\n                next = next.father;\r\n                if (current.id !== targetid) return true;\r\n            }\r\n            return false;\r\n        }}\r\n}\r\nRuntimeAccessibleClass.set_extend(DGraphElement, DGraph);\r\nRuntimeAccessibleClass.set_extend(LGraphElement, LGraph);\r\n// export const defaultVSize: GraphSize = new GraphSize(0, 0, 300, 160); // useless, now it's in view.DefaultVSize\r\n// export const defaultEPSize: GraphSize = new GraphSize(0, 0, 15, 15); // useless, now it's in view.DefaultVSize\r\n\r\n@RuntimeAccessible\r\nexport class DVoidVertex extends DGraphElement {\r\n    public static cname: string = \"DVoidVertex\";\r\n    // static _super = DGraphElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVoidVertex;\r\n    // static logic: typeof LVoidVertex;\r\n    // static structure: typeof DVoidVertex;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DVoidVertex, 1, 1, LVoidVertex>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    state: DMap = {} as any;\r\n    zoom!: GraphPoint;\r\n    // personal attributes\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    isResized!: boolean;\r\n    // size?: GraphSize; // virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n\r\n    public static new(htmlindex: number, model: DGraphElement[\"model\"], parentNodeID: DGraphElement[\"father\"], graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"],\r\n                      size?: InitialVertexSize): DVoidVertex {\r\n        return new Constructors(new DVoidVertex('dwc'))\r\n            .DPointerTargetable(false, nodeID)\r\n            .DGraphElement(model, parentNodeID, graphID, htmlindex).DVoidVertex(size).end();\r\n    }\r\n\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LVoidVertex<Context extends LogicContext<DVoidVertex> = any, C extends Context = Context> extends LGraphElement {// <D extends DVoidVertex = any>\r\n    public static cname: string = \"LVoidVertex\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVoidVertex;\r\n    // static logic: typeof LVoidVertex;\r\n    // static structure: typeof DVoidVertex;\r\n\r\n    // inherit redefine\r\n    __raw!: DVoidVertex;\r\n    id!: Pointer<DVoidVertex, 1, 1, LVoidVertex>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    state!: LMap;\r\n    zoom!: GraphPoint;\r\n    isResized!: boolean;\r\n\r\n    // personal attributes\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    size!: GraphSize; // virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n    __info_of__size = {type: \"?GraphSize\", txt: \"Size of the vertex, if null it means is utilizing the defaultSize from view. recommended to read component.getSize() instead of this.\"};\r\n\r\n    get_isResized(context: LogicContext<DVoidVertex>): DVoidVertex[\"isResized\"] { return context.data.isResized; }\r\n    set_isResized(val: DVoidVertex[\"isResized\"], context: LogicContext<DVoidVertex>): DVoidVertex[\"isResized\"] {\r\n        return SetFieldAction.new(context.data.id, \"isResized\", val);\r\n    }\r\n    /*\r\n        // todo: devo settare che il primo parametro delle funzioni che iniziano con set_ non può essere un logicContext\r\n        set_size(val: GraphSize, context: LogicContext<DVoidVertex>): boolean {\r\n            // todo: graphvertex should use this, but  calls graphelement.set_size instead\r\n            // SetFieldAction.new(context.data, 'size', val, Action.SubType.vertexSize);\r\n            if (!val) { return true; } //  val = defaultVSize; }\r\n            //console.trace('setsize:', {context, val});\r\n            if (context.data.x !== val.x) SetFieldAction.new(context.data, 'x', val.x);\r\n            if (context.data.y !== val.y) SetFieldAction.new(context.data, 'y', val.y);\r\n            if (context.data.w !== val.w) SetFieldAction.new(context.data, 'w', val.w);\r\n            if (context.data.h !== val.h) SetFieldAction.new(context.data, 'h', val.h);\r\n            val = new GraphSize(val.x, val.y, val.w, val.h);\r\n            // (context.proxy as unknown as LGraphElement).graph.graphSize\r\n            // update graph boundary too\r\n            const graph: LGraph = this.get_graph(context); // (context.proxyObject as this).get_graph(context);\r\n            const gsize = graph.graphSize;\r\n            //console.log('setsize2, graph:', {context, val, gsize, graph});\r\n            val.boundary(gsize);\r\n            if (val.equals(gsize)) return true;\r\n            graph.graphSize = val;\r\n            return true;\r\n        }*/\r\n\r\n    get_isSelected(context: LogicContext<DVoidVertex>): GObject {\r\n        return DPointerTargetable.mapWrap(context.data.isSelected, context.data, 'idlookup.' + context.data.id + '.isSelected', []);\r\n    }\r\n\r\n\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DGraphElement, DVoidVertex);\r\nRuntimeAccessibleClass.set_extend(LGraphElement, LVoidVertex);\r\n@RuntimeAccessible\r\nexport class DEdgePoint extends DVoidVertex { // DVoidVertex\r\n    public static cname: string = \"DEdgePoint\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LEdgePoint;\r\n    // static logic: typeof LEdgePoint;\r\n    // static structure: typeof DEdgePoint;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DEdgePoint, 1, 1, LEdgePoint>;\r\n    father!: Pointer<DVoidEdge, 1, 1, LVoidEdge>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>; // todo: if null gets model from this.father (edge)?\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    zoom!: GraphPoint;\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    size?: GraphSize; //／／ virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n    // personal attributes\r\n    __isDEdgePoint!: true;\r\n\r\n    public static new(htmlindex: number, model: DEdgePoint[\"model\"] | undefined, parentNodeID: DEdgePoint[\"father\"], graphID?: DEdgePoint[\"graph\"], nodeID?: DGraphElement[\"id\"],\r\n                      size?: InitialVertexSize): DEdgePoint {\r\n        return new Constructors(new DEdgePoint('dwc'), parentNodeID, true)\r\n            .DPointerTargetable(false, nodeID)\r\n            .DGraphElement(undefined, parentNodeID, graphID, htmlindex)\r\n            .DVoidVertex(size).DEdgePoint().end();\r\n    }\r\n\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LEdgePoint<Context extends LogicContext<DEdgePoint> = any, C extends Context = Context> extends LVoidVertex {\r\n    public static cname: string = \"LEdgePoint\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LEdgePoint;\r\n    // static logic: typeof LEdgePoint;\r\n    // static structure: typeof DEdgePoint;\r\n\r\n    // inherit redefine\r\n    father!: LVoidEdge;\r\n    // __raw!: DEdgePoint;\r\n    id!: Pointer<DEdgePoint, 1, 1, LEdgePoint>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    zoom!: GraphPoint;\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    size!: GraphSize; // virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n    // personal attributes\r\n    __isLEdgePoint!: true;\r\n    edge!: LVoidEdge; // returns container edge\r\n    __info_of__edge: Info = {type:\"?LEdge\", txt:\"returns the containing edge if called on an EdgePoint, \\\"this\\\" if called on an edge, undefined otherwise.\"}\r\n\r\n    public get_edge(c: Context): LVoidEdge { return c.proxyObject.father; }\r\n    public set_edge(v: Pack1<LVoidEdge>, c: Context): boolean { return this.set_father(v as any, c); }\r\n\r\n    // from x,y as coords, to x%,y% as % of ((1-val)%*startpt) + ((val)%*endpt)\r\n    public decodePosCoords<T extends Partial<GraphSize> | Partial<GraphPoint>>(c: Context, size: T&any, view: LViewElement, sp0?: GraphPoint, ep0?: GraphPoint): T {\r\n        if (!view) view = this.get_view(c);\r\n        let edgePointCoordMode = view.edgePointCoordMode;\r\n        if (edgePointCoordMode === CoordinateMode.absolute) return size;\r\n        let le: LVoidEdge = c&&c.proxyObject.father;\r\n        // console.log(\"decodepos:\", {le, sp0, lesp:le?.startPoint});\r\n        let sp: GraphPoint = sp0||le.startPoint;\r\n        let ep: GraphPoint = ep0||le.endPoint;\r\n        let ret: any = ((\"w\" in size || \"h\" in size) ? new GraphSize() : new GraphPoint()); // GObject<Partial<GraphSize>>;\r\n        switch (edgePointCoordMode) {\r\n            default: return Log.exDevv(\"translatePosCoords() invalid coordinate mode\", {mode:edgePointCoordMode, view});\r\n            // case CoordinateMode.absolute: return size;\r\n            case CoordinateMode.relativePercent:\r\n                //maybe do: dampening factor on relative % offset? is it possible?\r\n\r\n                // let s = this.getBasicSize(c);\r\n                // MATH:\r\n                // size.x = sp.x*x% + ep.x*(1-x%)\r\n                // size.x = sp.x*x% + ep.x - ep.x*x%\r\n                // size.x - ep.x= (sp.x - ep.x)*x%\r\n                // (size.x - ep.x) / (sp.x - ep.x) = x% // actually i inverted <sp, ep> in first equation, so reverse them in result too.\r\n                if (size.x !== undefined) ret.x = (1 - size.x) * sp.x + (size.x) * ep.x;\r\n                if (size.y !== undefined) ret.y = (1 - size.y) * sp.y + (size.y) * ep.y;\r\n                break;\r\n            case CoordinateMode.relativeOffset:\r\n            case CoordinateMode.relativeOffsetStart:\r\n            case CoordinateMode.relativeOffsetEnd:\r\n                let useStart: boolean;\r\n                let useEnd: boolean;\r\n                switch (edgePointCoordMode) {\r\n                    default:\r\n                    case CoordinateMode.relativeOffset: useStart = true; useEnd = true; break;\r\n                    case CoordinateMode.relativeOffsetStart: useStart = true; useEnd = false; break;\r\n                    case CoordinateMode.relativeOffsetEnd: useStart = false; useEnd = true; break;\r\n                }\r\n                // offset = sp - size\r\n                // size = offset - sp\r\n                // in reverse: actualsize = offset, size=offset\r\n                Log.exDev(size.x&&!Array.isArray(size.x) || size.y&&!Array.isArray(size.y),\r\n                    \"decoding relative offset require an array size coordinate system. x=[x1, x2] --> x\", {size});\r\n                let offsetsp = useStart ? new GraphPoint(size.x[0] + sp.x, size.y[0] + sp.y) : new GraphPoint();\r\n                let offsetep = useEnd ? new GraphPoint(size.x[1] + ep.x, size.y[1] + ep.y) : new GraphPoint();\r\n                // if the start and endpoint of the edge didn't move, offsetsp = offsetep.\r\n                // if they moved, those 2 are discordant --> i pick middle\r\n                offsetsp.add(offsetep, false);\r\n                if (useStart && useEnd) offsetsp.divide(2, false);\r\n                if (size.x !== undefined) ret.x = offsetsp.x;\r\n                if (size.y !== undefined) ret.y = offsetsp.y;\r\n                break;\r\n        }\r\n        if (size.x === undefined) delete ret.x;\r\n        if (size.y === undefined) delete ret.y;\r\n        if ((size as any).w === undefined) delete ret.w; else ret.w = size.w;\r\n        if ((size as any).h === undefined) delete ret.h; else ret.h = size.h;\r\n        // console.log(\"decode coords\", {size, sp, ep, ret});\r\n\r\n        return ret;\r\n    }\r\n\r\n    public encodePosCoords<T extends Partial<GraphSize> | Partial<GraphPoint>>(c: Context, size: T, view: LViewElement, sp0?: GraphPoint, ep0?: GraphPoint): T {\r\n        if (!view) view = this.get_view(c);\r\n        let edgePointCoordMode = view.edgePointCoordMode;\r\n        if (edgePointCoordMode === CoordinateMode.absolute) return size;\r\n        let le: LVoidEdge = c&&c.proxyObject.father;\r\n        let sp: GraphPoint = sp0 || le.startPoint;//todo: delete sp0, ep0 parameters after testing\r\n        let ep: GraphPoint = ep0 || le.endPoint;\r\n        let ret: any = ((\"w\" in size || \"h\" in size) ? new GraphSize() : new GraphPoint()); // GObject<Partial<GraphSize>>;\r\n        switch (edgePointCoordMode) {\r\n            default: return Log.exDevv(\"translatePosCoords() invalid coordinate mode\", {mode:edgePointCoordMode, view});\r\n            // case CoordinateMode.absolute: return size;\r\n            case CoordinateMode.relativePercent:\r\n                // let s = this.getBasicSize(c);\r\n                // MATH:\r\n                // size.x = sp.x*x% + ep.x*(1-x%)\r\n                // size.x = sp.x*x% + ep.x - ep.x*x%\r\n                // size.x - ep.x= (sp.x - ep.x)*x%\r\n                // (size.x - ep.x) / (sp.x - ep.x) = x% // actually i inverted <sp, ep> in first equation, so reverse them in result too.\r\n                if (size.x !== undefined) ret.x = (size.x - sp.x) / (ep.x - sp.x);\r\n                if (size.y !== undefined) ret.y = (size.y - sp.y) / (ep.y - sp.y);\r\n                break;\r\n            case CoordinateMode.relativeOffset:\r\n            case CoordinateMode.relativeOffsetStart:\r\n            case CoordinateMode.relativeOffsetEnd:\r\n                let useStart: boolean;\r\n                let useEnd: boolean;\r\n                switch (edgePointCoordMode) {\r\n                    default:\r\n                    case CoordinateMode.relativeOffset: useStart = true; useEnd = true; break;\r\n                    case CoordinateMode.relativeOffsetStart: useStart = true; useEnd = false; break;\r\n                    case CoordinateMode.relativeOffsetEnd: useStart = false; useEnd = true; break;\r\n                }\r\n                if (size.x) ret.x = [useStart ? size.x - sp.x : -1, useEnd ? size.x - ep.x : -1];\r\n                if (size.y) ret.y = [useStart ? size.y - sp.y : -1, useEnd ? size.y - ep.y : -1];\r\n                /*\r\n                if (size.x) ret.x = [sp.x - size.x, ep.x - size.x];\r\n                if (size.y) ret.y = [sp.y - size.y, ep.y - size.y];*/\r\n                break;\r\n        }\r\n        if (size.x === undefined) delete ret.x;\r\n        if (size.y === undefined) delete ret.y;\r\n        if ((size as any).w === undefined) delete ret.w; else ret.w = (size as any).w;\r\n        if ((size as any).h === undefined) delete ret.h; else ret.h = (size as any).h;\r\n        // console.log(\"encode coorde\", {size, sp, ep, ret});\r\n        return ret;\r\n    }\r\n\r\n\r\n    public get_delete(context: Context): () => void {\r\n        // careful: pointedBy might be broken due to comment x984 (search it)\r\n        return super.get_delete(context);\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DVoidVertex, DEdgePoint);\r\nRuntimeAccessibleClass.set_extend(LVoidVertex, LEdgePoint);\r\n@RuntimeAccessible\r\nexport class DVertex extends DGraphElement { // DVoidVertex\r\n    public static cname: string = \"DVertex\";\r\n    // static _super = DVoidVertex;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVertex;\r\n    // static logic: typeof LVertex;\r\n    // static structure: typeof DVertex;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DVertex, 1, 1, LVertex>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    zoom!: GraphPoint;\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    isResized!: boolean;\r\n    // size!: GraphSize; // virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n    // personal attributes\r\n    __isDVertex!: true;\r\n\r\n    public static new(htmlindex: number, model: DGraphElement[\"model\"], parentNodeID: DGraphElement[\"father\"],\r\n                      graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"], size?: GraphSize): DVertex {\r\n        return new Constructors(new DVertex('dwc')).DPointerTargetable(false, nodeID)\r\n            .DGraphElement(model, parentNodeID, graphID, htmlindex)\r\n            .DVoidVertex(size).DVertex().end();\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LVertex<Context extends LogicContext<any> = any, D = DVertex> extends LVoidVertex {\r\n    public static cname: string = \"LVertex\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVertex;\r\n    // static logic: typeof LVertex;\r\n    // static structure: typeof DVertex;\r\n\r\n    // inherit redefine\r\n    __raw!: DVertex;\r\n    id!: Pointer<DVertex, 1, 1, LVertex>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    zoom!: GraphPoint;\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    size!: GraphSize; // virtual, gets extracted from this. x and y are stored directly here as it extends GraphSize\r\n    isResized!: boolean;\r\n    // personal attributes\r\n    __isLVertex!: true;\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DGraphElement, DVertex);\r\nRuntimeAccessibleClass.set_extend(LGraphElement, LVertex);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DGraphVertex extends DGraphElement { // MixOnlyFuncs(DGraph, DVertex)\r\n    public static cname: string = \"DGraphVertex\";\r\n    // static _super1 = DGraph;\r\n    // static _super2 = DVertex;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphVertex;\r\n    // static logic: typeof LGraphVertex;\r\n    // static structure: typeof DGraphVertex;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DGraphVertex, 1, 1>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    // from graph\r\n    zoom!: GraphPoint;\r\n    graphSize!: GraphSize; // internal size of the graph. can be huge even if the sub-graph is in a small window (scroll)\r\n\r\n    // from VoidVertex\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    isResized!: boolean;\r\n    // size!: GraphSize; // virtual\r\n    // from graph\r\n    sizes!: Dictionary<Pointer<DModelElement>, GraphSize>;\r\n\r\n    // personal attributes\r\n    __isDVertex!: true;\r\n    __isDGraph!: true;\r\n    __isDGraphVertex!: true;\r\n\r\n    public static new(htmlindex: number, model: DGraph[\"model\"], parentNodeID: DGraphElement[\"father\"],\r\n                      graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"], size?: GraphSize): DGraphVertex {\r\n        return new Constructors(new DGraphVertex('dwc')).DPointerTargetable(false, nodeID).DGraphElement(model, parentNodeID, graphID, htmlindex)\r\n            .DVoidVertex(size).DVertex().DGraph().end();\r\n    }\r\n\r\n\r\n    /*\r\n        static init_constructor(thiss: DGraphVertex, isUser: boolean = false, nodeID: string | undefined, graphID: string | undefined, model: Pointer<DModel>): void {\r\n            DGraph.init_constructor(thiss, isUser, nodeID, graphID, model);\r\n    //isUser: boolean = false, nodeID: string | undefined, graphID: string, model?: Pointer<DModel>\r\n            DVertex.init_constructor(thiss, isUser, nodeID, graphID as string, model);\r\n            thiss.className = this.name;\r\n        }*/\r\n}\r\nclass LG extends LGraph{}\r\nclass LV extends LVertex{}\r\n@RuntimeAccessible\r\nexport class LGraphVertex<Context extends LogicContext<any> = any, D extends DGraphVertex = any> extends MixOnlyFuncs(LG, LV) { // MixOnlyFuncs(LGraph, LVertex)\r\n    public static cname: string = \"LGraphVertex\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphVertex;\r\n    // static logic: typeof LGraphVertex;\r\n    // static structure: typeof DGraphVertex;\r\n\r\n    // inherit redefine\r\n    __raw!: DGraphVertex;\r\n    id!: Pointer<DGraphVertex, 1, 1>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn?: LGraphElement;\r\n    ///////////////////////////////////////// subElements!: LGraphElement[];\r\n    // from graph\r\n    zoom!: GraphPoint;\r\n    graphSize!: GraphSize; // internal size of the graph. can be huge even if the sub-graph is in a small window (scroll)\r\n\r\n    // from VoidVertex\r\n    x!: number;\r\n    y!: number;\r\n    w!: number;\r\n    h!: number;\r\n    isResized!: boolean;\r\n    size!: GraphSize; // virtual\r\n    protected sizes!: Dictionary<Pointer<DModelElement>, GraphSize>;\r\n\r\n\r\n    // personal attributes\r\n    __isLVertex!: true;\r\n    __isLGraph!: true;\r\n    __isLGraphVertex!: true;\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DGraph, DGraphVertex);\r\nRuntimeAccessibleClass.set_extend(DVertex, DGraphVertex);\r\nRuntimeAccessibleClass.set_extend(LGraph, LGraphVertex);\r\nRuntimeAccessibleClass.set_extend(LVertex, LGraphVertex);\r\n@RuntimeAccessible\r\nexport class DVoidEdge extends DGraphElement {\r\n    public static cname: string = \"DVoidEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVoidEdge;\r\n    // static logic: typeof LVoidEdge;\r\n    // static structure: typeof DVoidEdge;\r\n    id!: Pointer<DVoidEdge, 1, 1, LVoidEdge>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n\r\n    // personal attributes\r\n    start!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    end!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    __isDVoidEdge!: true;\r\n\r\n    midPoints!: InitialVertexSize[]; // the logic part which instructs to generate the midnodes\r\n    midnodes!: Pointer<DEdgePoint, 1, 1, LEdgePoint>[]; // using subelements instead most of times\r\n\r\n    longestLabel!: PrimitiveType | labelfunc;\r\n    labels!: PrimitiveType[] | labelfunc[];\r\n\r\n    public static new(htmlindex: number, model: DGraph[\"model\"]|null|undefined, parentNodeID: DGraphElement[\"father\"], graphID: DGraphElement[\"graph\"],\r\n                      nodeID: DGraphElement[\"id\"]|undefined, start: DGraphElement[\"id\"], end: DGraphElement[\"id\"],\r\n                      longestLabel: DEdge[\"longestLabel\"], labels: DEdge[\"labels\"]): DEdge {\r\n        return new Constructors(new DEdge('dwc')).DPointerTargetable(false, nodeID)\r\n            .DGraphElement(model, parentNodeID, graphID, htmlindex)\r\n            .DVoidEdge(start, end, longestLabel, labels).end();\r\n    }\r\n}\r\n/*\r\n@RuntimeAccessible\r\nexport class MidPoint{\r\n    readonly id: string; // not really a pointer, it's not on store.\r\n    x?: number; y?: number;\r\n    readonly w?: number; // if it's modified it's not ever here (initial size) but on DEdgePoint that is a Node.\r\n    readonly h?: number;/*\r\n    constructor2(x: number=5, y: number=5, w: number=5, h: number=5) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.w = w;\r\n        this.h = h;\r\n    }* /\r\nconstructor(id: string, w: number=5, h: number=5) {\r\n    this.id = id;\r\n    this.w = w;\r\n    this.h = h;\r\n}\r\n}*/\r\n@RuntimeAccessible\r\nexport class EdgeSegment{\r\n    public static cname: string = \"EdgeSegment\";\r\n    index: number;\r\n    prev: EdgeSegment | undefined;\r\n    start: segmentmaker;\r\n    bezier: segmentmaker[];\r\n    end: segmentmaker;\r\n    length!: number;\r\n    d!: string;\r\n    dpart!: string; //  a segment of the whole path\r\n    m!: number; // m coefficient of the line between start and end.\r\n    rad!: number; // for head and tails: radian angle of the segment.\r\n    radLabels!: number; // for labels: it flips the angle when it's < PI/2 so the text is never upside down\r\n\r\n    isLongest!: boolean;\r\n    label!: PrimitiveType | JSX.Element | undefined;\r\n    svgLetter: EdgeBendingMode;\r\n    /*constructor(label: PrimitiveType|undefined, length: number, startp: GraphPoint, endp: GraphPoint, start: LGraphElement, end: LGraphElement,\r\n                bezierpts: GraphPoint[], mid: LGraphElement[],\r\n                svgLetter: EdgeBendingMode, index: number, fillMode: MidNodeHandling) {\r\n        this.label = label;\r\n        this.length = length;\r\n        this.length = length;\r\n        this.startp = startp;\r\n        this.bezierp = bezierpts;\r\n        this.endp = endp;\r\n        this.start = start;\r\n        this.end = end;\r\n        this.mid = mid;\r\n    }*/\r\n    constructor(start: segmentmaker, mid: segmentmaker[], end: segmentmaker,\r\n                svgLetter: EdgeBendingMode, gapMode: EdgeGapMode,\r\n                index: number, prevSegment: EdgeSegment | undefined){\r\n        // console.log(\"segmentmaker:\", arguments, ((start.ge?.model as any)?.name)+\" ---> \" + ((end.ge?.model as any)?.name));\r\n        this.start = start;\r\n        this.bezier = mid;\r\n        this.end = end;\r\n        this.index = index;\r\n        this.prev = prevSegment;\r\n        //this.segments = segments;\r\n        // the idea: forbid all T and S or transform them in C, Q by calculating and manually adding their mirrored bezier pts\r\n        if (svgLetter[1]) svgLetter = (svgLetter[0]) as any;\r\n        if (svgLetter === EdgeBendingMode.Bezier_quadratic_mirrored) {\r\n            this.addBezierPoint();\r\n            this.svgLetter = EdgeBendingMode.Bezier_quadratic;\r\n        } else\r\n        if (svgLetter === EdgeBendingMode.Bezier_cubic_mirrored) {\r\n            this.addBezierPoint();\r\n            this.svgLetter = EdgeBendingMode.Bezier_cubic;\r\n        }\r\n        else this.svgLetter = svgLetter;\r\n\r\n        // fix if amount of bezier pts is invalid for current letter\r\n        switch (this.svgLetter) {\r\n            case EdgeBendingMode.Line:\r\n            case EdgeBendingMode.Bezier_quadratic:\r\n                if (this.bezier.length >= 1) break;\r\n                else this.svgLetter = EdgeBendingMode.Line;\r\n                break;\r\n            case EdgeBendingMode.Bezier_cubic:\r\n                if (this.bezier.length >= 2) break;\r\n                else if (this.bezier.length >= 1) this.svgLetter = EdgeBendingMode.Bezier_quadratic;\r\n                else this.svgLetter = EdgeBendingMode.Line;\r\n                break;\r\n            case EdgeBendingMode.Elliptical_arc:\r\n                if (this.bezier.length >= 3) break;\r\n                else this.svgLetter = EdgeBendingMode.Line; // straight to end ignoring midpoints that are NOT coordinates when using elliptical arc.\r\n                break;\r\n            default:\r\n            case EdgeBendingMode.Bezier_quadratic_mirrored as string:\r\n            case EdgeBendingMode.Bezier_cubic_mirrored as string: // translated to Q or C by adding mirrored bezier points explicitly\r\n            case EdgeBendingMode.Bezier_QT:\r\n            case EdgeBendingMode.Bezier_CS: // translated to Q or C by sending the right letter to each segment\r\n                Log.exDevv(\"this svg letter should not appear here\", this.svgLetter);\r\n                break;\r\n        }\r\n    }\r\n    addBezierPoint(): void {\r\n        let prev: EdgeSegment | undefined = this.prev;\r\n        if (!prev) return;\r\n        let prevedgemakerbezier: segmentmaker = (prev.bezier[prev.bezier.length-1] || prev.start);\r\n        let mirroredBezier: segmentmaker = {...prevedgemakerbezier, pt: EdgeSegment.invertLastBezierPt(prevedgemakerbezier.pt, prev.end.pt)};\r\n        this.bezier = [mirroredBezier, ...this.bezier];\r\n        // always only 1 assumed pt both in cubic and quadratic.\r\n        // let next: this | undefined = this.segments[this.index+1];\r\n        // EdgeSegment.invertLastBezierPt((next.mid[1] || next.end).pt, next.start.pt);\r\n    }\r\n\r\n    makeD(index: number, gapMode: EdgeGapMode): string {\r\n        this.m = GraphPoint.getM(this.start.pt, this.end.pt);\r\n        this.rad = Geom.mToRad(this.m, this.start.pt, this.end.pt);\r\n        this.radLabels = Math.atan(this.m);\r\n\r\n        let svgLetter = this.svgLetter; // caller makes sure to pass right letter and resolve \"CS\" mixed letters. // this.bendingModeToLetter(bendingMode, index);\r\n        // caller sends inverted pts as normal coords\r\n        // let invertedBezPt = lastSegment && EdgeSegment.invertLastBezierPt(lastSegment.midp[lastSegment.mid.length-1] || lastSegment.startp, lastSegment.endp);\r\n        switch (this.svgLetter.length) {\r\n            case 2:\r\n                return Log.exDevv(\"mixed letters are not allowed and should have been resolved to single svg letters before here, found:\" + svgLetter);\r\n            /*return Log.exDevv(\"dev problem to fix:\\n\" +\r\n            \"the mirrored mode requires the first one to have explicit non-mirrored mode?? like M, C a1 a2 a3, S a1, S a1, S a1\\n\" +\r\n            \"So all segments with mixed modes needs to extract the last bezier point (penultimate coordinate) from previous segments, mirror it and insert in midp[0]\");*/\r\n            case 1:\r\n                let bezierpts = [...this.bezier.map( b => b.pt), this.end.pt];\r\n                let finalpart = svgLetter + \" \" + bezierpts.map((p)=> p.x + \" \" + p.y).join(\", \");\r\n                this.dpart = \"M \" + this.start.pt.x + \" \" + this.start.pt.y + \", \" + finalpart;\r\n                //midp = [this.startp, ...this.midp];\r\n                // d = M sp X mp2 ep // X = custom letter\r\n                // dpart = T sp X mp2 ep // S = S if X = C,\r\n                // sp is the startingpoint from the prev node, which might be != from endpoint of last node if last node have w>0 && h>0\r\n                // so i'm \"filling\" the gap with a T, or L arc wich can use only 1 parameter (they are the only 1-parameter arcs)\r\n                let startletter: string;\r\n                if (this.prev && this.prev.end.pt.equals(this.start.pt)) gapMode = EdgeGapMode.average; // if the 2 points coincide, i use any 1 of the gapmodes that are continuous\r\n                switch (gapMode){\r\n                    case EdgeGapMode.center:\r\n                    case EdgeGapMode.average:\r\n                        // continuous gap modes. they only differ in how the \"joining\" point is found, but not in how they behave after that.\r\n                        /*\r\n                        if (index === 0) {\r\n                             startletter = \"M \";\r\n                         }\r\n                         else {\r\n                             switch (svgLetter) {\r\n                                 case SvgLetter.A: case SvgLetter.C: case SvgLetter.S: case SvgLetter.Q: case SvgLetter.T: default:\r\n                                     startletter = SvgLetter.T + \" \"; break;\r\n                                 case SvgLetter.L: case SvgLetter.M:\r\n                                     startletter = SvgLetter.L + \" \"; break;\r\n                             }\r\n                         }*/\r\n                        if (index) {\r\n                            this.d = finalpart;\r\n                        }\r\n                        else { this.d = this.dpart; }\r\n                        break;\r\n                    case EdgeGapMode.gap:\r\n                    case EdgeGapMode.autoFill:\r\n                    case EdgeGapMode.lineFill:\r\n                    case EdgeGapMode.arcFill:\r\n                        // the filling itself is done by another segment (solving svg letter and simulating i=0), so i treat it as a gap.\r\n                        this.d = this.dpart;\r\n                        break;\r\n                    default:\r\n                        Log.exDevv(\"unexpected EdgeGapMode:\" + gapMode, {gapMode});\r\n                }\r\n                break;\r\n            default: return Log.exDevv(\"unexpected bending mode length:\" + this.svgLetter + \" or fillMode: \" + gapMode, {bendingMode: this.svgLetter, index, gapMode});\r\n        }\r\n\r\n        //using\r\n        /*\r\n        88\r\n\r\n        // d should not have M set (except for segments[0]\r\n        // dpart have M abd beed to add explicit points for \"mirroring\" and transforming bezier quadratic mirrored in bezier quadratic normal etc.\r\n        //88 problem: the mirrored mode requires the first one to have explicit nonmirrored mode?? like M, C a1 a2 a3, S a1, S a1, S a1 .... ?\r\n        in any case the % letter part is wrong because it needs to subtract first element used for M*/\r\n        return this.d;\r\n    }\r\n\r\n    static invertLastBezierPt(bezier: GraphPoint, end: GraphPoint): GraphPoint{\r\n        // vector = bezier - end\r\n        // end + vector = bezier\r\n        // end - vector = inverted bezier? = 2*end-bezier\r\n        let vector = bezier.subtract(end, true);\r\n        return end.subtract(vector, true);\r\n    }\r\n\r\n    calcLength(): void {\r\n        this.length = this.start.pt.distanceFromPoint(this.end.pt);\r\n    }\r\n}\r\nexport enum SvgLetter{ \"L\"=\"L\" , \"M\"=\"M\", \"S\"=\"S\", \"C\"=\"C\", \"Q\"=\"Q\", \"A\"=\"A\", \"T\"=\"T\"}\r\nexport class EdgeFillSegment extends EdgeSegment{\r\n    public static cname: string = \"EdgeFillSegment\";\r\n    makeD(index: number, gapMode: EdgeGapMode): string {\r\n        if (gapMode === EdgeGapMode.autoFill) { gapMode = this.svgLetter === EdgeBendingMode.Line ? EdgeGapMode.lineFill : EdgeGapMode.arcFill; }\r\n        switch (gapMode) {\r\n            case EdgeGapMode.center:\r\n            case EdgeGapMode.average:\r\n            case EdgeGapMode.gap:\r\n                return \"\"; // should not have filler arcs\r\n            default:\r\n            case EdgeGapMode.autoFill as any:\r\n            case EdgeGapMode.lineFill:\r\n                this.bezier = [];\r\n                this.svgLetter = EdgeBendingMode.Line;\r\n                return super.makeD(index, gapMode);\r\n            case EdgeGapMode.arcFill:\r\n                this.svgLetter = this.svgLetter[0] as EdgeBendingMode;\r\n                if (this.svgLetter === \"Q\") this.bezier = this.bezier.length ? [this.bezier[0]] : [];\r\n                return super.makeD(index, gapMode);\r\n        }\r\n    }\r\n}\r\n\r\n\r\ntype segmentmaker = {size: GraphSize, view: LViewElement, ge: LGraphElement, pt: GraphPoint};\r\n@RuntimeAccessible\r\nexport class LVoidEdge<Context extends LogicContext<DVoidEdge> = any, D extends DEdge = DEdge> extends LGraphElement {\r\n    public static cname: string = \"LVoidEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LVoidEdge;\r\n    // static logic: typeof LVoidEdge;\r\n    // static structure: typeof DVoidEdge;\r\n    __raw!: DVoidEdge;\r\n    id!: Pointer<DVoidEdge, 1, 1, LVoidEdge>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn?: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    start!: LGraphElement;\r\n    end!: LGraphElement;\r\n    __isLVoidEdge!: true;\r\n    midPoints!: InitialVertexSize[]; // the logic part which instructs to generate the midnodes\r\n    midnodes!: LEdgePoint[];\r\n    edge!: LVoidEdge; // returns self. useful to get edge from edgePoints without triggering error if you are already on edge.\r\n    __info_of__edge: Info = {type:\"?LEdge\", txt:\"returns this if called on an edge, the containing edge if called on an EdgePoint, undefined otherwise.\"}\r\n\r\n/*\r\nreplaced by startPoint\r\n    edgeStart!: GraphPoint;\r\n    edgeStart_inner!: GraphPoint;\r\n    edgeStart_outer!: GraphPoint;\r\n    __info_of__edgeStart: Info = {type: \"GraphPoint\", txt: \"Same as edgeStart_outer.\"}\r\n    __info_of__edgeStart_outer: Info = {type: \"GraphPoint\",\r\n     txt: \"Where the edge should start his path, in coordinates relative at the root Graph.\r\n     <br>Computed by combining the anchor offset option in View and the size of the starting node.\"}\r\n    __info_of__edgeStart_inner: Info = {type: \"GraphPoint\",\r\n     txt: \"Where the edge should start his path, in coordinates relative at the most nested Graph.\r\n     <br>Computed by combining the anchor offset option in View and the size of the starting node.\"}\r\n    edgeEnd!: GraphPoint;\r\n    edgeEnd_inner!: GraphPoint;\r\n    edgeEnd_outer!: GraphPoint;\r\n    __info_of__edgeEnd: Info = {type: \"GraphPoint\", txt: \"Same as edgeEnd_outer.\"}\r\n    __info_of__edgeEnd_outer: Info = {type: \"GraphPoint\",\r\n     txt: \"Where the edge should end his path, in coordinates relative at the root Graph.\r\n     <br>Computed by combining the anchor offset option in View and the size of the starting node.\"}\r\n    __info_of__edgeEnd_inner: Info = {type: \"GraphPoint\",\r\n     txt: \"Where the edge should end his path, in coordinates relative at the most nested Graph.\r\n     <br>Computed by combining the anchor offset option in View and the size of the starting node.\"}\r\n*/\r\n\r\n\r\n//    label!: PrimitiveType; should never be read change their documentation in write only. their values is \"read\" in this.segments\r\n//    longestLabel!: PrimitiveType;\r\n//    labels!: PrimitiveType[];\r\n    allNodes!: [LGraphElement, ...Array<LEdgePoint>, LGraphElement]\r\n\r\n\r\n    /*    ___info_of__longestLabel: Info = {readType: \"PrimitiveType\", writeType:\"PrimitiveType | \" +\r\n                \"(e:this, curr: LGraphElement, next: LGraphElement, curr_index: number, allNodes: LGraphElement[]) => PrimitiveType)\", txt: <span>Label assigned to the longest path segment.</span>}\r\n        ___info_of__label: Info = {type: \"\", txt: <span>Alias for longestLabel</span>};\r\n        ___info_of__labels: Info = {type: \"type of label or Array<type of label>\", txt: <span>Instructions to label to multiple or all path segments in an edge</span>};\r\n    */\r\n    ___info_of__allNodes: Info = {type: \"[LGraphElement, ...Array<LEdgePoint>, LGraphElement]\", txt: <span>first element is this.start. then all this.midnodes. this.end as last element</span>};\r\n\r\n\r\n    // get_label(c: Context): this[\"label\"] { return this.get_longestLabel(c); }\r\n    // get_longestLabel(c: Context): this[\"label\"] { return this.get_label_impl(c.data, c.proxyObject); }\r\n    public headPos_impl(c: Context, isHead: boolean, headSize0?: GraphPoint, segment0?: EdgeSegment, zoom0?: GraphPoint): GraphSize & {rad: number} {\r\n        let segment: EdgeSegment = segment0 || this.get_segments(c).segments[0];\r\n        // let v: LViewElement = this.get_view(c);\r\n        let tmp: any = headSize0 || (isHead ? this.get_view(c).edgeHeadSize : this.get_view(c).edgeTailSize);\r\n        if (!tmp || tmp.x === 0 || tmp.y === 0) {\r\n            // head or tail missing\r\n            tmp = new GraphSize(0, 0, 0, 0);\r\n            tmp.rad = 0;\r\n            return tmp;\r\n        }\r\n        let zoom: GraphPoint = zoom0 || this.get_graph(c).zoom;\r\n        let headPos: GraphSize & {rad: number} = (new GraphSize(0, 0, tmp.x, tmp.y) as any); //.multiply({w:zoom.x, h:zoom.y});\r\n        let useBezierPoints = true;\r\n        let start: GraphPoint, end: GraphPoint;\r\n        let m: number;\r\n        if (useBezierPoints) {\r\n            if (isHead) {\r\n                start = segment.end.pt;\r\n                end = (segment.bezier[segment.bezier.length - 1] || segment.start).pt;\r\n            } else {\r\n                start = segment.start.pt;\r\n                end = (segment.bezier[0] || segment.end).pt;\r\n            }\r\n            m = GraphPoint.getM(start, end);\r\n        } else {\r\n            if (isHead) { start = segment.end.pt; end = segment.start.pt; }\r\n            else { start = segment.start.pt; end = segment.end.pt; }\r\n            m = segment.m;\r\n        }\r\n        // first find the center of where it should be positioned\r\n        // let center: GraphPoint;\r\n        // let distance: number = Math.sqrt(headPos.w*headPos.w + headPos.h*headPos.h);\r\n        // let isVertical = m >=1 ;\r\n        let x4headsize = new GraphSize(start.x - headPos.w, start.y - headPos.h, headPos.w*2, headPos.h*2);\r\n        // first intersection is segment origin. second is found with the box containing all possible edgeHead positions that touch the startPoint\r\n        // (doing x4 his shape and placing 4 \"rectangles\" all around startPoint) to cover all possible segment directions.\r\n        // or finding first direction (vertical if m >1, horizontal if m<0) and vector direction and intersecting with only the \"correct\" placed edgeHead rectangle.\r\n        // then the intersection will likely not fall on the extreme angle of EdgeHead and i can re-center edgeHead\r\n        // so that first and second intersections are equal spaced with the center segment\r\n        let secondIntersection: GraphPoint | undefined;\r\n        let segmentDistance = start.distanceFromPoint(end);\r\n        if (segmentDistance <= Math.sqrt(headPos.w**2 + headPos.h**2)){\r\n            let safeDistance = Math.max(headPos.w, headPos.h)*5;\r\n            end = new GraphPoint( end.y + safeDistance, end.y + m * safeDistance); // move the point away so it doesn't intersect anymore. i just need direction\r\n            // too small to fit edgeHead, i simply put it centered on the whole segment\r\n            // secondIntersection = end;\r\n        }\r\n        secondIntersection = GraphSize.closestIntersection(x4headsize, start, end, undefined);\r\n        if (!secondIntersection) return Log.exx(\"failed to intersect edge head\", {x4headsize, segment, headPos, c, start, end, useBezierPoints});\r\n        tmp = secondIntersection.add(start, false).divide(2); // center of edgehead\r\n        headPos.x = tmp.x - headPos.w / 2; // tl corner\r\n        headPos.y = tmp.y - headPos.h / 2; // tl corner\r\n        headPos.rad = Geom.mToRad(m, start, end);\r\n        /*\r\n        devo trovare la distanza tra il centro dell'egeHead e il punto di inizio in termini assoluti, così tramite M trovo distanza in x e y. o trovarla in altro modo\r\n        if (segment.m === Number.POSITIVE_INFINITY || segment.m === Number.NEGATIVE_INFINITY) {\r\n            center = segment.start.pt.add({x:0, y: distance}, true); }\r\n        else { center = segment.start.pt.add({x:segment.m*headPos.w/2, y:segment.m*headPos.h/2\r\n         this is wrong, cannot be the same for x and y, i should invert the line equation for x?}, true); }\r\n        headPos.x = center.x - headPos.w / 2;\r\n        headPos.y = center.y - headPos.h / 2;*/\r\n        // console.log(\"head intersected\", {headPos, secondIntersection, x4headsize, segment, c, start, end, useBezierPoints});\r\n\r\n        return headPos;\r\n    }\r\n\r\n    public headPos(headSize0?: GraphPoint, segment0?: EdgeSegment, zoom0?: GraphPoint): GraphSize & {rad: number} {\r\n        return this.wrongAccessMessage(\"This is not headPos() implementation. it is just for typings. use the getter\"); }\r\n    public tailPos(headSize0?: GraphPoint, segment0?: EdgeSegment, zoom0?: GraphPoint): GraphSize & {rad: number} {\r\n        return this.wrongAccessMessage(\"This is not tailPos() implementation. it is just for typings. use the getter\"); }\r\n    protected get_headPos(c: Context): this[\"headPos\"] {\r\n        return (headSize?: GraphPoint, segment?: EdgeSegment, zoom?: GraphPoint) => this.headPos_impl(c, true, headSize, segment, zoom); }\r\n    protected get_tailPos(c: Context): this[\"tailPos\"] {\r\n        return (headSize?: GraphPoint, segment?: EdgeSegment, zoom?: GraphPoint) => this.headPos_impl(c, false, headSize, segment, zoom); }\r\n    protected get_allNodes(c: Context): this[\"allNodes\"] { return [this.get_start(c), ...this.get_midnodes(c), this.get_end(c)]; }\r\n\r\n    protected get_edge(c: Context): this{ return c.proxyObject as this; }\r\n    protected set_edge(v: any, c: Context): false { return this.cannotSet(\"edge field, on an edge element\"); }\r\n    protected get_midPoints(c: Context):this[\"midPoints\"] { return c.data.midPoints; }\r\n    public addMidPoint(v: this[\"midPoints\"][0]): boolean { return this.wrongAccessMessage(\"addMidPoint\"); }\r\n    protected get_addMidPoint(c: Context): (v: this[\"midPoints\"][0]) => boolean { return (v:this[\"midPoints\"][0]) => this.impl_addMidPoints(v, c); }\r\n    protected set_midPoints(val: this[\"midPoints\"], c: Context): boolean {\r\n        return SetFieldAction.new(c.data.id, \"midPoints\", val, undefined, false);\r\n    }\r\n    protected impl_addMidPoints(val: this[\"midPoints\"][0], c: Context): boolean {\r\n        return SetFieldAction.new(c.data.id, \"midPoints\", val, '+=', false);\r\n    }\r\n    protected get_label_impl(c: Context, segment: EdgeSegment, nodes: this[\"allNodes\"], segments: EdgeSegment[]): PrimitiveType | undefined {\r\n        let key: \"longestLabel\" | \"labels\" = segment.isLongest ? \"longestLabel\" : \"labels\"; // : keyof this\r\n        // if (isLongestSegment) return this.get_longestLabel_impl(d, l, nodes, index):\r\n        const d = c.data;\r\n        const l = c.proxyObject;\r\n        let labelmaker: any = d[key]; // orArr<PrimitiveType | JSX | function>\r\n        let labelmakerfunc: labelfunc = labelmaker as any;\r\n        // let lastSeg = segments[i-1];\r\n        switch (typeof labelmaker) {//nb{}[]<>\r\n            case \"number\":\r\n            case \"undefined\":\r\n            case \"boolean\":\r\n            case \"string\": return labelmaker;\r\n            // case \"function\": return nodes.map( (o, i) => d.labels(l, nodes, i)).slice(0, nodes.length-1);\r\n            case \"function\": return labelmakerfunc(l, segment, nodes, segments);\r\n            default: break;\r\n            case \"object\":\r\n                if (labelmaker === null) return null;\r\n                if (!Array.isArray(labelmaker)) break;\r\n                if (typeof labelmaker[0] === \"function\") return (labelmaker[segment.index % labelmaker.length] as labelfunc)(l, segment, nodes, segments);\r\n                return (labelmaker as PrimitiveType[])[segment.index % labelmaker.length];\r\n        }\r\n        Log.exx(\"edge labels invalid type, must be a primitive value, a function or an array of such.\", {labelmaker, key, d});\r\n        return undefined;\r\n    }/*\r\n    private get_label_impl_old(d: DVoidEdge, l: LVoidEdge, nodes:this[\"allNodes\"], index: number, longestlabelindex?: number): PrimitiveType {\r\n        if (d.longestLabel !== undefined && index === longestlabelindex) return this.get_longestLabel_impl(d, l, nodes, index);\r\n        switch (typeof d.labels) {//nb{}[]<>\r\n            case \"number\":\r\n            case \"undefined\":\r\n            case \"boolean\":\r\n            case \"string\": return d.labels;\r\n            // case \"function\": return nodes.map( (o, i) => d.labels(l, nodes, i)).slice(0, nodes.length-1);\r\n            case \"function\": return d.labels(l, nodes[index], nodes[index+1], index, nodes);\r\n            default: break;\r\n            case \"object\": if (!Array.isArray(d.labels)) break;\r\n            if (typeof d.labels[0] === \"function\") return (d.labels as any)[index % d.labels.length](l, nodes[index], nodes[index+1], index, nodes);\r\n            return (d.labels as PrimitiveType[])[index % d.labels.length];\r\n        }\r\n        Log.exx(\"edge labels invalid type, must be a primitive value, a function or an array of such.\", d.labels);\r\n    }*/\r\n\r\n    __info_of__startPoint: Info = {type: \"GraphPoint\", txt:<span>startPoint of this.start (element originating the edge). Defaults in outer coordinates.</span>};\r\n    __info_of__endPoint: Info = {type: \"GraphPoint\", txt:<span>endPoint of this.end (element originating the edge). Defaults in outer coordinates.</span>};\r\n    public get_startPoint(context: Context): GraphPoint{ return this.get_startPoint_Outer(context); }\r\n    public get_endPoint(context: Context): GraphPoint{ return this.get_endPoint_Outer(context); }\r\n    public get_startPoint_Outer(c: Context): GraphPoint{\r\n        // console.log(\"get_edgeStart_Outer\", {out:this.get_outerGraph(c), pos:this.get_startPoint_inner(c), inner:this.get_start(c).innerGraph});\r\n        return this.get_outerGraph(c).translateSize(this.get_startPoint_inner(c), this.get_start(c).innerGraph);\r\n    }\r\n    public get_endPoint_Outer(c: Context): GraphPoint{\r\n        // console.log(\"get_edgeEnd_Outer\", {out:this.get_outerGraph(c), pos:this.get_endPoint_inner(c), inner:this.get_end(c).innerGraph});\r\n        return this.get_outerGraph(c).translateSize(this.get_endPoint_inner(c), this.get_end(c).innerGraph);\r\n    }\r\n\r\n    public get_startPoint_inner(c: Context): GraphPoint{ return this.get_edgeStartEnd_inner(c, true); }\r\n    public get_endPoint_inner(c: Context): GraphPoint{ return this.get_edgeStartEnd_inner(c, false); }\r\n    private get_edgeStartEnd_inner(c: Context, isStart: boolean): GraphPoint{ return isStart ? this.get_start(c).startPoint : this.get_end(c).endPoint; }\r\n    segments!: {all: EdgeSegment[], segments: EdgeSegment[], fillers: EdgeSegment[], head: GraphSize&{rad:number}, tail: GraphSize&{rad:number}};\r\n    segments_inner!: {all: EdgeSegment[], segments: EdgeSegment[], fillers: EdgeSegment[], head: GraphSize&{rad:number}, tail: GraphSize&{rad:number}};\r\n    segments_outer!: {all: EdgeSegment[], segments: EdgeSegment[], fillers: EdgeSegment[], head: GraphSize&{rad:number}, tail: GraphSize&{rad:number}};\r\n    __info_of__segments: Info = {type: \"{all:T, segments:T, fillers:T, head: GraphSize&{rad:number}, tail: as head} where T is EdgeSegment\",\r\n        txt:<span>Collection of segments connecting in order vertex and EdgePoint without intersecting their area, aimed to be rendered in svg path.\r\n            <br/>fillers are arcs generated by view.edgeGapMode being autofill, arcfill or linefill.\r\n            <br/>length of this.segments array is Math.ceil(allNodes.length / svg_letter_size) specified on view.\r\n            <br/>\"head\" and \"tail\" are the position and angle of eventual edge decorators. Refer to this.headPos documentation.</span>}\r\n\r\n    private svgLetterSize(s: string, addM: boolean = true, doublingMidPoints: boolean = true): {first:number, others: number} {\r\n        let ret: {first:number, others: number};\r\n        switch (s) {\r\n            default: ret = Log.exDevv(\"unexpected svg path letter: \\\"\" + s + \"\\\"\", s); break;\r\n            case EdgeBendingMode.Line:\r\n            case EdgeBendingMode.Bezier_quadratic_mirrored: ret = {first:1, others:1}; break;\r\n            case EdgeBendingMode.Bezier_quadratic:\r\n            case EdgeBendingMode.Bezier_cubic_mirrored: ret = {first:2, others:2}; break;\r\n            case EdgeBendingMode.Bezier_cubic: ret = {first:3, others:3}; break;\r\n            case EdgeBendingMode.Elliptical_arc: ret = {first:4, others:4}; break;\r\n\r\n            case EdgeBendingMode.Bezier_QT: ret = {first:2, others:1}; break;\r\n            case EdgeBendingMode.Bezier_CS: ret = {first:3, others:2}; break;\r\n        }\r\n\r\n        // account for the fact that every midpoint is listed twice: at anchor start and anchor end.\r\n        if (doublingMidPoints) {\r\n            // removing last point (first is already excluded because addM didn't trigger yet)\r\n            // , the remaining are midpoints to double. then i add it back\r\n            ret.first = (ret.first - 1) * 2 + 1;\r\n            ret.others = (ret.others - 1) * 2 + 1;\r\n        }\r\n\r\n        // account for the first M letter\r\n        //    (if the segment is not mode.gap or first, M coord still exist in segment but are ignored)\r\n        if (addM) {\r\n            ret.first += 1;\r\n            ret.others += 1;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    private get_points_impl(allNodes: LGraphElement[], outer: boolean): segmentmaker[] {\r\n        function getAnchorOffset(size: GraphSize, offset: GraphPoint, isPercentage: boolean) {\r\n            if (!size) size = new GraphSize(0, 0, 0, 0);\r\n            if (isPercentage) offset = new GraphPoint(offset.x/100*(size.w), offset.y/100*(size.h));\r\n            return size.tl().add(offset, false);\r\n        }\r\n        const all: segmentmaker[] = allNodes.flatMap((ge, i) => {\r\n            let base: segmentmaker = {view: ge.view, size: outer ? ge.outerSize : ge.innerSize, ge, pt: null as any};\r\n            let rets: segmentmaker | undefined;// = base as any;\r\n            let rete: segmentmaker | undefined;// = {...base} as any;\r\n            if (i !== 0){\r\n                rete = {...base};\r\n                rete.pt = (LEdgePoint.singleton as LEdgePoint).get_endPoint(undefined as any, rete.size, rete.view);\r\n                rete.pt = getAnchorOffset(rete.size, rete.view.edgeStartOffset, rete.view.edgeStartOffset_isPercentage);\r\n            }\r\n            if (i !== allNodes.length - 1){\r\n                rets = {...base};\r\n                rets.pt = (LEdgePoint.singleton as LEdgePoint).get_startPoint(undefined as any, rets.size, rets.view);\r\n                rets.pt = getAnchorOffset(rets.size, rets.view.edgeStartOffset, rets.view.edgeStartOffset_isPercentage);\r\n            }\r\n            // ret.pt = ge.startPoint\r\n            return rets && rete ? [rete, rets] : (rets ? [rets] : [rete as segmentmaker]); }\r\n        );\r\n        return all;\r\n    }\r\n    private get_points(allNodes: LGraphElement[], outer: boolean = false): segmentmaker[]{ return this.get_points_impl(allNodes, outer); }\r\n    private get_points_outer(allNodes: LGraphElement[]): segmentmaker[]{ return this.get_points_impl(allNodes, true); }\r\n    private get_points_inner(allNodes: LGraphElement[]): segmentmaker[]{ return this.get_points_impl(allNodes, false); }\r\n    public d!: string;\r\n    public __info_of__d: Info = {type: ShortAttribETypes.EString, txt:\"the full suggested path of SVG path \\\"d\\\" attribute, merging all segments.\"}\r\n    public get_d(c: Context) {\r\n        return this.get_segments(c).all.map(s => s.d).join(\" \");\r\n    }/*\r\n    private get_fillingSegments(c: Context): Partial<this[\"segments\"]> {\r\n        return this.get_segments(c).fillers;\r\n    }*/\r\n\r\n\r\n    public get_segments(c:Context): this[\"segments\"] { return this.get_segments_outer(c); }\r\n    public get_segments_outer(c:Context): this[\"segments\"] { return this.get_segments_impl(c, true); }\r\n    public get_segments_inner(c: Context): this[\"segments\"] { return this.get_segments_impl(c, false); }\r\n    private get_segments_impl(c: Context, outer: boolean): this[\"segments\"] {\r\n        let l = c.proxyObject;\r\n        let v = this.get_view(c);\r\n        let allNodes = l.allNodes;\r\n        windoww.edge = l;\r\n        let all: segmentmaker[] = this.get_points(allNodes, outer);\r\n        //const all: {size: GraphSize, view: LViewElement, ge: LGraphElement}[] = allNodes.map((ge) => { return { view: ge.view, size: ge.size, ge}});\r\n        let ret: EdgeSegment[] = [];\r\n        let bm: EdgeBendingMode = v.bendingMode;\r\n        let gapMode: EdgeGapMode = v.edgeGapMode;\r\n        console.log(\"vbm\", {bm, v, vraw:v.__raw});\r\n        let segmentSize = this.svgLetterSize(bm, false, true);\r\n        let increase: number = segmentSize.first;\r\n        let segment: EdgeSegment | undefined;\r\n        /// grouping points according to SvgLetter\r\n        for (let i = 0; i < all.length - 1; ) {\r\n            // let start = all[i], end = all[i+increase];\r\n            let start: segmentmaker = all[i];\r\n            let endindex = (i+increase < all.length - 1) ? i+increase : all.length - 1;\r\n            let mid: segmentmaker[] = all.slice(i+1, endindex).filter( (e, i)=> i % 2 === 0);\r\n            let end: segmentmaker = all[endindex];\r\n            // makes sure the edge actually reaches his target even if there is an invalid amount of midnodes fot the current EdgeBendingMode\r\n            if (i === endindex && segment) start = segment.end;\r\n            // segment = this.get_segmentv3(start, mid, end, getSvgLetter(i), i, segment, all);\r\n            segment = new EdgeSegment(start, mid, end, bm, gapMode, i, segment);\r\n            // segment = this.get_segment(start.ge, start.size, start.view, end.ge, end.size, end.view, cut, v.bendingMode, mid, ret[ret.length -1], fillMode, segment);\r\n            ret.push(segment);\r\n            i+= increase+1; // because increase index is already inserted at the end of prev segment\r\n            if (increase !== segmentSize.others) increase = segmentSize.others;\r\n            // if (longestLabel !== undefined && longest < s.length) { longest = s.length; longestindex = i; } todo: move to after snapping to borders\r\n        }\r\n        let fillSegments: EdgeSegment[] = [];\r\n        this.snapSegmentsToNodeBorders(c, v, ret, fillSegments);\r\n        let longestLabel = c.data.longestLabel;\r\n        this.setLabels(c, ret, allNodes, longestLabel);\r\n        // console.log(\"getSegments() labeled:\", {main:ret, fillSegments});\r\n        let rett: this[\"segments\"] = {all: [...ret, ...fillSegments], segments: ret, fillers: fillSegments} as any;\r\n        for (let i = 0; i < rett.all.length; i++) {\r\n            let s = rett.all[i];\r\n            s.makeD(i, gapMode);\r\n        }\r\n        let zoom = new GraphPoint(1, 1);\r\n        rett.head = this.headPos_impl(c, true, v.edgeHeadSize, rett.segments[rett.segments.length - 1], zoom);\r\n        rett.tail = this.headPos_impl(c, false, v.edgeTailSize, rett.segments[0], zoom);\r\n        return rett;\r\n    }\r\n    private setLabels(c: Context, segments: EdgeSegment[], allNodes: this[\"allNodes\"], longestLabel: D[\"longestLabel\"]): void {\r\n        // find longest segment\r\n        let longestindex = -1;\r\n        let longest = 0;\r\n        for (let i = 0; i < segments.length; i++) {\r\n            let s = segments[i];\r\n            s.calcLength();\r\n            if (longestLabel !== undefined && longest < s.length) { longest = s.length; longestindex = i; }\r\n        }\r\n        if (longestindex>=0) segments[longestindex].isLongest = true;\r\n        // apply labels\r\n        for (let s of segments) s.label = this.get_label_impl(c, s, allNodes, segments);\r\n    }\r\n\r\n    private snapSegmentsToNodeBorders(c: Context, v: LViewElement, ret: EdgeSegment[], fillSegments: EdgeSegment[]){\r\n        // snap segment start and end to a node border\r\n        let canCutStart: boolean = v.edgeStartStopAtBoundaries,\r\n            canCutEnd: boolean = v.edgeEndStopAtBoundaries;\r\n        let grid: GraphPoint | undefined = undefined;\r\n        // let fillSegments: EdgeSegment[] = [];\r\n        let gapMode: EdgeGapMode = v.edgeGapMode;\r\n        let bm: EdgeBendingMode = v.bendingMode;\r\n\r\n\r\n        let ci: GraphPoint | undefined;\r\n        // cut i === 0 is cut regardless of gapmode.\r\n        if (canCutStart) {\r\n            ci = GraphSize.closestIntersection(ret[0].start.size, ret[0].start.pt, (ret[0].bezier[0] || ret[0].end).pt, grid);\r\n            if (ci)  ret[0].start.pt = ci;\r\n            /*\r\n            ret[0].start.pt =\r\n                GraphSize.closestIntersection(ret[0].start.size, ret[0].start.pt, (ret[0].bezier[0] || ret[0].end).pt, grid) as any\r\n                || Geom.closestPoint(ret[0].start.size, ret[0].start.pt);*/\r\n        }\r\n\r\n        // cut middle segments maybe\r\n        let prev: EdgeSegment;\r\n        let curr: EdgeSegment = ret[0];\r\n        if (canCutStart || canCutEnd) // do the for below\r\n            for (let i = 1; i < ret.length; i++){\r\n                prev = ret[i-1];\r\n                curr = ret[i];\r\n                let doStartCut: boolean, doEndCut: boolean;\r\n                switch(gapMode){\r\n                    case EdgeGapMode.arcFill:\r\n                    case EdgeGapMode.lineFill:\r\n                    case EdgeGapMode.autoFill:\r\n                        // same as gap, but will insert 1 more segment to fill the hole\r\n                        doStartCut = true;\r\n                        doEndCut = true;\r\n                        if (prev.end.pt.equals(curr.start.pt)) break;\r\n                        fillSegments.push(new EdgeFillSegment(\r\n                            prev.end,\r\n                            [\r\n                                {...prev.end, pt: EdgeSegment.invertLastBezierPt(prev.end.pt, (prev.bezier[prev.bezier.length-1] || prev.start).pt)},\r\n                                {...curr.start, pt: EdgeSegment.invertLastBezierPt(curr.start.pt, (curr.bezier[0] || curr.end).pt)}\r\n                            ],\r\n                            curr.start,\r\n                            bm, gapMode, 0, undefined));\r\n                            /*\r\n                            fillSegments.push(new FillEdgeSegment( // M <start_gap> C <bez1> <bez2> <end_gap>\r\n                               // <start_gap> = end of last seg (start of gap) <end_gap> = first of curr seg (end of gap)\r\n                            prev.end.pt,\r\n                            EdgeSegment.invertLastBezierPt(prev.end.pt, prev.bezier[prev.bezier.length-1].pt || prev.start.pt),\r\n                            EdgeSegment.invertLastBezierPt(curr.start.pt, curr.bezier[0].pt || curr.end.pt),\r\n                            curr.start.pt)\r\n                            */\r\n                        break;\r\n                    case EdgeGapMode.gap:\r\n                        // just snap to vertex edge         prevSegment.endp and ret.startp\r\n                        doStartCut = true;\r\n                        doEndCut = true;\r\n                        break;\r\n                    // average: todo: maybe rename in join (merges start-end at closest pt to both (avg), then snap on edge)\r\n                    case EdgeGapMode.average:\r\n                        // first move to average of the 2 points in the gap, then snap to edge\r\n                        doEndCut = true; doStartCut = true;\r\n                        // indipendent from cutStart, cutEnd.\r\n                        // they merge if just 1 of cutting sides are true. (and if they are both false we don't even enter the for loop)\r\n                        curr.start.pt.add(prev.end.pt, false).divide(2, false);\r\n                        prev.end.pt = curr.start.pt.duplicate() // intentionally not the same pt because during snap to edge they can temporarly diverge.again,\r\n                        break;\r\n                    // center: first move it to center of edgePoint/node, then snap to edge.\r\n                    // this mode might be as well deleted, it can be specified with anchor points\r\n                    case EdgeGapMode.center:\r\n                        doEndCut = true; doStartCut = true;\r\n                        curr.start.pt = curr.start.size.tl().add(curr.start.size.br(), false).divide(2, false);\r\n                        prev.end.pt = curr.start.pt.duplicate(); // intentionally not the same pt because during snap to edge they can diverge.again,\r\n                        break;\r\n                    default:\r\n                        return Log.exDevv(\"unexpected EdgeGapMode:\" + gapMode);\r\n                }\r\n                if (canCutStart && doStartCut){\r\n                    let extpt: GraphPoint = (curr.bezier[0] || curr.end).pt;\r\n                    ci = GraphSize.closestIntersection(curr.start.size, curr.start.pt, extpt, grid);\r\n                    if (ci) curr.start.pt = ci;// || Geom.closestPoint(curr.start.size, curr.start.pt);\r\n                    //if (gapMode === EdgeGapMode.average && prev) { prev.end.pt = curr.start.pt.add(prev.end.pt, false).divide(2, false); }\r\n                }\r\n                if (canCutEnd && doEndCut && prev){\r\n                    let prevpt: GraphPoint = (prev.bezier[prev.bezier.length-1] || prev.start).pt;\r\n                    ci = GraphSize.closestIntersection(prev.end.size, prev.end.pt, prevpt, grid);\r\n                    if (ci) prev.end.pt = ci;// || Geom.closestPoint(prev.end.size, prev.end.pt);\r\n                    // if average: first do average between start anchor points non-snapped. then i snap both,\r\n                    // then i do average again, and since it might snap out, i get closestPoint to EdgePoint size\r\n                    if (gapMode === EdgeGapMode.average) prev.end.pt = curr.start.pt =\r\n                        Geom.closestPoint(curr.start.size, curr.start.pt.add(prev.end.pt, false).divide(2, false));\r\n                }\r\n            }\r\n        // cut end of last segment regardless of gapMode\r\n        if (canCutEnd) {\r\n            let prevendpt = curr.end.pt;\r\n            ci = GraphSize.closestIntersection(curr.end.size, curr.end.pt, (curr.bezier[curr.bezier.length-1] || curr.start).pt, grid);\r\n            if (ci) curr.end.pt = ci; //|| Geom.closestPoint(prev.end.size, prev.end.pt);\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    get_edgeEnd(context: Context){ return this.get_edgeEnd_outer(context); }\r\n    get_edgeEnd_outer(c: Context){\r\n        // return this.get_outerGraph(c).translateSize(this.get_edgeEnd_inner(c), this.get_innerGraph(c));\r\n        return this.get_outerGraph(c).translateSize(this.get_edgeEnd_inner(c), this.get_end(c).innerGraph);\r\n    }\r\n    get_edgeEnd_inner(c: Context){\r\n        return this.get_edgeStartEnd_inner(c, false);\r\n        // return context.proxyObject.end?.size || new GraphPoint(0, 0);\r\n    }\r\n\r\n\r\n    protected get_midnodes(context: Context): this[\"midnodes\"] {\r\n        // return LPointerTargetable.wrapAll(context.data.midnodes);\r\n        return LPointerTargetable.wrapAll(context.data.subElements);\r\n    }\r\n    protected set_midnodes(val: D[\"midnodes\"], context: Context): boolean {\r\n        return SetFieldAction.new(context.data.id, \"midnodes\", val, '', true);\r\n    }\r\n    protected get_start(context: Context): this[\"start\"] { return LPointerTargetable.from(context.data.start); }\r\n    protected get_end(context: Context): this[\"end\"] { return LPointerTargetable.from(context.data.end); }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DGraphElement, DVoidEdge);\r\nRuntimeAccessibleClass.set_extend(LGraphElement, LVoidEdge);\r\n@RuntimeAccessible\r\nexport class DEdge extends DVoidEdge { // DVoidEdge\r\n    public static cname: string = \"DEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    id!: Pointer<DEdge, 1, 1, LEdge>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    state: DMap = {} as any;\r\n    start!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    end!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    __isDEdge!: true;\r\n    __isDVoidEdge!: true;\r\n    midnodes!: Pointer<DEdgePoint, 1, 1, LEdgePoint>[];\r\n\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LEdge<Context extends LogicContext<DEdge> = any, D extends DEdge = DEdge> extends LVoidEdge {\r\n    public static cname: string = \"LEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    __raw!: DEdge;\r\n    id!: Pointer<DEdge, 1, 1, LEdge>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn!: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    state!: LMap;\r\n    start!: LGraphElement;\r\n    end!: LGraphElement;\r\n    midnodes!: LEdgePoint[];\r\n    __isLEdge!: true;\r\n    __isLVoidEdge!: true;\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DVoidEdge, DEdge);\r\nRuntimeAccessibleClass.set_extend(LVoidEdge, LEdge);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DExtEdge extends DEdge { // etends DEdge\r\n    public static cname: string = \"DExtEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    id!: Pointer<DExtEdge, 1, 1, LExtEdge>;\r\n    graph!: Pointer<DGraph, 1, 1, LGraph>;\r\n    model!: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // containedIn!: Pointer<DGraphElement, 0, 1, LGraphElement>;\r\n    subElements!: Pointer<DGraphElement, 0, 'N', LGraphElement>;\r\n    state: DMap = {} as any;\r\n    start!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    end!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    __isDExtEdge!: true;\r\n    __isDEdge!: true;\r\n    __isDVoidEdge!: true;\r\n    /*\r\n        public static new(model: DGraph[\"model\"], parentNodeID: DGraphElement[\"father\"], graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"], size?: GraphSize): DExtEdge {\r\n            return new Constructors(new DExtEdge('dwc')).DPointerTargetable().DGraphElement(model, parentNodeID, graphID, nodeID)\r\n                .DVoidEdge().DEdge().DExtEdge().end();\r\n        }*/\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LExtEdge extends LEdge{\r\n    public static cname: string = \"LExtEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LGraphElement;\r\n    // static logic: typeof LGraphElement;\r\n    // static structure: typeof DGraphElement;\r\n    __raw!: DExtEdge;\r\n    id!: Pointer<DExtEdge, 1, 1, LExtEdge>;\r\n    graph!: LGraph;\r\n    model?: LModelElement;\r\n    isSelected!: Dictionary<DocString<Pointer<DUser>>, boolean>;\r\n    // containedIn!: LGraphElement;\r\n    subElements!: LGraphElement[];\r\n    state!: LMap;\r\n    start!: LGraphElement;\r\n    end!: LGraphElement;\r\n    __isLExtEdge!: true;\r\n    __isLEdge!: true;\r\n    __isLVoidEdge!: true;\r\n}\r\nRuntimeAccessibleClass.set_extend(DEdge, DExtEdge);\r\nRuntimeAccessibleClass.set_extend(LEdge, LExtEdge);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DRefEdge extends DEdge { // extends DEdge\r\n    public static cname: string = \"DRefEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    start!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    end!: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    __isDRefEdge!: true;\r\n    /*\r\n        public static new(model: DGraph[\"model\"], parentNodeID: DGraphElement[\"father\"], graphID: DGraphElement[\"graph\"], nodeID?: DGraphElement[\"id\"]): DRefEdge {\r\n            return new Constructors(new DRefEdge('dwc')).DPointerTargetable().DGraphElement(model, parentNodeID, graphID, nodeID)\r\n                .DVoidEdge().DEdge().DRefEdge().end();\r\n        }*/\r\n\r\n}\r\n@RuntimeAccessible\r\nexport class LRefEdge extends LEdge {\r\n    public static cname: string = \"LRefEdge\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // __raw!: DRefEdge;\r\n    start!: LGraphElement;\r\n    end!: LGraphElement;\r\n    __isLRefEdge!: true;\r\n}\r\nRuntimeAccessibleClass.set_extend(DEdge, DRefEdge);\r\nRuntimeAccessibleClass.set_extend(LEdge, LRefEdge);\r\n// for edges without a modelling element\r\n\r\n\r\n/*\r\n\r\nlet a = `DExtEdge, DRefEdge, DVoidEdge, LGraphVertex, LRefEdge, LEdgePoint, DVoidVertex, DGraphVertex, DEdgePoint,\r\n DVertex, DEdge, LVertex, LGraph, DGraph, LVoidVertex, LVoidEdge, LEdge, LGraphElement, LExtEdge, DGraphElement`;\r\n  // // ... get from export in index.ts\r\na = a.replaceAll(',,', \",\")\r\nlet aa = a.split(\",\").map(a => a.trim().substring(1));\r\n\r\nfunction onlyUnique(value, index, self) { return self.indexOf(value) === index; }\r\n\r\naa = aa.filter(onlyUnique).filter( a=> !!a)\r\nlet r = aa.filter(onlyUnique).filter( a=> !!a).map( a=> `export type W${a} = getWParams<L${a}, D${a}>;`).join('\\n')\r\ndocument.body.innerText = r;\r\n*/\r\nexport type WExtEdge = getWParams<LExtEdge, DExtEdge>;\r\nexport type WRefEdge = getWParams<LRefEdge, DRefEdge>;\r\nexport type WVoidEdge = getWParams<LVoidEdge, DVoidEdge>;\r\nexport type WGraphVertex = any; // getWParams<LGraphVertex, DGraphVertex>;\r\nexport type WEdgePoint = getWParams<LEdgePoint, DEdgePoint>;\r\nexport type WVoidVertex = getWParams<LVoidVertex, DVoidVertex>;\r\nexport type WVertex = getWParams<LVertex, DVertex>;\r\nexport type WEdge = getWParams<LEdge, DEdge>;\r\nexport type WGraph = getWParams<LGraph, DGraph>;\r\nexport type WGraphElement = getWParams<LGraphElement, DGraphElement>;\r\n\r\nconsole.warn('ts loading graphDataElement');\r\n","import {\r\n    Constructor,\r\n    Constructors,\r\n    DPointerTargetable, DViewElement, GraphSize,\r\n    LPointerTargetable, LViewElement,\r\n    Pointer,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass\r\n} from \"../../joiner\";\r\n\r\n\r\n@RuntimeAccessible\r\nexport class DViewPoint extends DViewElement {\r\n    public static cname: string = \"DViewPoint\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n\r\n    id!: Pointer<DViewPoint, 1, 1, LViewPoint>;\r\n    name!: string;\r\n\r\n\r\n    public static new(name: string, jsxString: string, defaultVSize?: GraphSize, usageDeclarations: string = '', constants: string = '',\r\n                      preRenderFunc: string = '', appliableToClasses: string[] = [], oclApplyCondition: string = '', priority: number = 1 , persist: boolean = false): DViewElement {\r\n        return new Constructors(new DViewPoint('dwc'), undefined, persist, undefined).DPointerTargetable()\r\n            .DViewElement(name, jsxString, defaultVSize, usageDeclarations, constants,\r\n                preRenderFunc, appliableToClasses, oclApplyCondition, priority).DViewPoint().end();\r\n    }\r\n    public static new2(name: string, jsxString: string, callback?: (d:DViewElement)=>void, persist: boolean = true): DViewElement {\r\n        return new Constructors(new DViewElement('dwc'), undefined, persist, undefined)\r\n            .DPointerTargetable().DViewElement(name, jsxString).DViewPoint().end(callback);\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LViewPoint extends LViewElement {\r\n    public static cname: string = \"LViewPoint\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    //public __raw!: DViewPoint;\r\n    id!: Pointer<DViewPoint, 1, 1, LViewPoint>;\r\n    name!: string;\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewPoint);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewPoint);\r\n","import {\r\n    Constructors,\r\n    CoordinateMode,\r\n    CreateElementAction,\r\n    DAttribute,\r\n    DClass,\r\n    DClassifier,\r\n    DEdgePoint,\r\n    DEnumerator,\r\n    DEnumLiteral,\r\n    DExtEdge,\r\n    DGraph,\r\n    DGraphElement,\r\n    DGraphVertex,\r\n    Dictionary,\r\n    DLog,\r\n    DModel,\r\n    DModelElement,\r\n    DObject,\r\n    DOperation,\r\n    DPackage,\r\n    DParameter,\r\n    DPointerTargetable,\r\n    DRefEdge,\r\n    DReference,\r\n    DUser,\r\n    DValue,\r\n    DVertex,\r\n    DViewElement,\r\n    DViewPoint,\r\n    DVoidEdge,\r\n    EdgeBendingMode,\r\n    EdgeHead,\r\n    GObject,\r\n    GraphPoint,\r\n    GraphSize,\r\n    LAttribute,\r\n    LClass,\r\n    LClassifier,\r\n    LEdgePoint,\r\n    LEnumerator,\r\n    LEnumLiteral,\r\n    LExtEdge,\r\n    LGraph,\r\n    LGraphElement,\r\n    LGraphVertex,\r\n    LLog,\r\n    LModel,\r\n    LModelElement,\r\n    LObject,\r\n    LogicContext,\r\n    LOperation,\r\n    LPackage,\r\n    LParameter,\r\n    LPointerTargetable,\r\n    LRefEdge,\r\n    LReference,\r\n    LUser,\r\n    LValue,\r\n    LVertex,\r\n    LViewElement,\r\n    LViewPoint,\r\n    Pointer,\r\n    Pointers,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    SetRootFieldAction,\r\n    ShortAttribETypes,\r\n    store,\r\n} from '../joiner';\r\n\r\nimport React from \"react\";\r\nimport {DV} from \"../common/DV\";\r\nimport LeaderLine from \"leader-line-new\";\r\n\r\nconsole.warn('ts loading store');\r\n\r\n// @RuntimeAccessible\r\n// NB: le voci che iniziano con '_' sono personali e non condivise\r\n\r\n\r\nexport interface EdgeOptions{\r\n    id: number,\r\n    options: LeaderLine.Options,\r\n    source: string,\r\n    target: string\r\n}\r\n\r\n// export const statehistory_obsoleteidea: {past: IStore[], current: IStore, future: IStore[]} = { past:[], current: null, future:[] } as any;\r\nexport const statehistory: {\r\n        [userpointer:Pointer<DUser>]: {undoable:GObject<\"delta\">[], redoable: GObject<\"delta\">[]}\r\n} & {\r\n    globalcanundostate: boolean // set to true at first user click }\r\n} = { globalcanundostate: false} as any;\r\nstatehistory[DUser.current] = {undoable:[], redoable:[]}; // todo: make it able to combine last 2 changes with a keystroke. reapeat N times to combine N actions. let it \"redo\" multiple times, it's like recording a macro.\r\n\r\n(window as any).statehistory = statehistory;\r\n@RuntimeAccessible\r\nexport class DState extends DPointerTargetable{\r\n    public static cname: string = \"DState\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static new(): DState {\r\n        return new Constructors(new DState('dwc'), undefined, false, undefined).DPointerTargetable().DState().end();\r\n    }\r\n\r\n    debug: boolean = true;\r\n    logs: Pointer<DLog, 0, 'N', LLog> = [];\r\n    models: Pointer<DModel, 0, 'N'> = []; // Pointer<DModel, 0, 'N'>[] = [];\r\n    currentUser!: DUser;\r\n\r\n    viewelements: Pointer<DViewElement, 0, 'N', LViewElement> = [];\r\n    stackViews: Pointer<DViewElement, 0, 'N', LViewElement> = [];\r\n\r\n    // users: Dictionary<DocString<Pointer<DUser>>, UserState> = {};\r\n    // collaborators: UserState[];\r\n    idlookup: Record<Pointer<DPointerTargetable, 1, 1>, DPointerTargetable> = {};\r\n\r\n    //// DClass section to fill\r\n    graphs: Pointer<DGraph, 0, 'N', LGraph> = [];\r\n    voidvertexs: Pointer<DGraphVertex, 0, 'N', LGraphVertex> = [];\r\n    vertexs: Pointer<DVertex, 0, 'N', LVertex> = [];\r\n    graphvertexs: Pointer<DGraphVertex, 0, 'N', LGraphVertex> = [];\r\n\r\n    edgepoints: Pointer<DEdgePoint, 0, 'N', LEdgePoint> = [];\r\n    //my addon\r\n    extEdges: Pointer<DExtEdge, 0, \"N\", LExtEdge> = [];\r\n    refEdges: Pointer<DRefEdge, 0, \"N\", LRefEdge> = [];\r\n\r\n    classifiers: Pointer<DClassifier, 0, 'N', LClassifier> = [];\r\n    enumerators: Pointer<DEnumerator, 0, 'N', LEnumerator> = [];\r\n    packages: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    primitiveTypes: Pointer<DClass, 0, \"N\", LClass> = [];\r\n    attributes: Pointer<DAttribute, 0, \"N\", LAttribute> = [];\r\n    enumliterals: Pointer<DEnumLiteral, 0, \"N\", LEnumLiteral> = [];\r\n    references: Pointer<DReference, 0, \"N\", LReference> = [];\r\n    classs: Pointer<DClass, 0, \"N\", LClass> = [];\r\n    operations: Pointer<DOperation, 0, \"N\", LOperation> = [];\r\n    parameters: Pointer<DParameter, 0, \"N\", LParameter> = [];\r\n    returnTypes: Pointer<DClass, 0, \"N\", LClass> = [];\r\n    /// DClass section end\r\n\r\n    isEdgePending: { user: Pointer<DUser, 1, 1, LUser>, source: Pointer<DClass, 1, 1, LClass> } = {\r\n        user: '',\r\n        source: ''\r\n    };\r\n\r\n    contextMenu: { display: boolean, x: number, y: number } = {display: false, x: 0, y: 0};\r\n\r\n    //dragging: {random: number, id: string} = { random: 0, id: \"\" }; fix\r\n    edges: EdgeOptions[] = [];  // delete\r\n\r\n    deleted: string[] = [];\r\n\r\n    objects: Pointer<DObject, 0, 'N', LObject> = [];\r\n    values: Pointer<DValue, 0, 'N', LValue> = [];\r\n\r\n    // private, non-shared fields\r\n    _lastSelected?: {\r\n        node: Pointer<DGraphElement, 1, 1>,\r\n        view: Pointer<DViewElement, 1, 1>,\r\n        modelElement: Pointer<DModelElement, 0, 1> // if a node is clicked: a node and a view are present, a modelElement might be. a node can exist without a modelElement counterpart.\r\n    };\r\n    users!: Pointer<DUser, 1, 'N', LUser>;\r\n\r\n    viewpoint: Pointer<DViewPoint, 1, 1, LViewPoint> = '';\r\n    viewpoints: Pointer<DViewPoint, 0, 'N', LViewPoint> = [];\r\n\r\n    m2models: Pointer<DModel, 0, 'N', LModel> = [];\r\n    m1models: Pointer<DModel, 0, 'N', LModel> = [];\r\n\r\n    room: string = '';\r\n    isCleaning: boolean = false;    // check if a room is being cleaned\r\n\r\n    selected: Dictionary<Pointer<DUser>, Pointer<DModelElement, 0, 1, LModelElement>> = {};\r\n    iot: null|boolean = null;\r\n    topics: string[] = [];\r\n\r\n    memorec: GObject[]|null = null;\r\n\r\n\r\n    static fakeinit(store?: DState): void {\r\n        // const graphDefaultViews: DViewElement[] = makeDefaultGraphViews();\r\n        // for (let graphDefaultView of graphDefaultViews) { CreateElementAction.new(graphDefaultView); }\r\n\r\n        const viewpoint = DViewPoint.new('Default', '');\r\n        viewpoint.id = 'Pointer_DefaultViewPoint';\r\n        CreateElementAction.new(viewpoint);\r\n        SetRootFieldAction.new('viewpoint', viewpoint.id, '', true);\r\n\r\n        const views: DViewElement[] = makeDefaultGraphViews();\r\n        for (let view of views) {\r\n            view.id = 'Pointer_View' + view.name;\r\n            view.viewpoint = 'Pointer_DefaultViewPoint';\r\n            CreateElementAction.new(view);\r\n        }\r\n\r\n        for (let primitiveType of Object.values(ShortAttribETypes)) {\r\n            let dPrimitiveType;\r\n            if (primitiveType === ShortAttribETypes.void) continue; // or make void too without primitiveType = true, but with returnType = true?\r\n            else {\r\n                dPrimitiveType = DClass.new(primitiveType, false, false, true, false, '', undefined, false);\r\n                dPrimitiveType.id = 'Pointer_' + dPrimitiveType.name.toUpperCase();\r\n                CreateElementAction.new(dPrimitiveType);\r\n            }\r\n            SetRootFieldAction.new('primitiveTypes', dPrimitiveType.id, '+=', true);\r\n        }\r\n\r\n        /*\r\n        const returnTypes = [\"void\", \"undefined\", \"null\"]; // rimosso undefined dovrebbe essere come void (in ShortAttribEtypes, null è ritornato solo dalle funzioni che normalmente ritornano qualche DObject, quindi tipizzato con quel DObject\r\n        for (let returnType of returnTypes) {\r\n            const dReturnType = DClass.new(returnType);\r\n            CreateElementAction.new(dReturnType);\r\n            SetRootFieldAction.new(\"returnTypes\", dReturnType.id, '+=', true);\r\n        }\r\n        */\r\n\r\n    }\r\n}\r\n\r\nfunction makeDefaultGraphViews(): DViewElement[] {\r\n\r\n    let modelView: DViewElement = DViewElement.new('Model', DV.modelView(), undefined, '', '', '', [DModel.cname]);\r\n    // modelView.draggable = false; modelView.resizable = false; already guaranteed by <Graph />\r\n\r\n    let packageView: DViewElement = DViewElement.new('Package', DV.packageView(), undefined, '', '', '', [DPackage.cname]);\r\n    packageView.defaultVSize = new GraphSize(0, 0, 400, 500);\r\n    packageView.preRenderFunc = \"() => { return {pname: this.data.name+\\\"pre\\\"}; }\"\r\n\r\n    let classView: DViewElement = DViewElement.new('Class', DV.classView(), undefined, '', '', '', [DClass.cname]);\r\n    classView.adaptWidth = true;\r\n    classView.adaptHeight = true;\r\n\r\n    let enumView: DViewElement = DViewElement.new('Enum', DV.enumeratorView(), undefined, '', '', '', [DEnumerator.cname]);\r\n    enumView.adaptWidth = true;\r\n    enumView.adaptHeight = true;\r\n\r\n    let attributeView: DViewElement = DViewElement.new('Attribute', DV.attributeView(), undefined, '', '', '', [DAttribute.cname]);\r\n    // attributeView.zIndex = 0;\r\n    let referenceView: DViewElement = DViewElement.new('Reference', DV.referenceView(), undefined, '', '', '', [DReference.cname]);\r\n    // referenceView.zIndex = 10;\r\n\r\n    let operationView: DViewElement = DViewElement.new('Operation', DV.operationView(), undefined, '', '', '', [DOperation.cname]);\r\n\r\n    let literalView: DViewElement = DViewElement.new('Literal', DV.literalView(), undefined, '', '', '', [DEnumLiteral.cname]);\r\n\r\n    let objectView: DViewElement = DViewElement.new('Object', DV.objectView(), undefined, '', '', '', [DObject.cname]);\r\n    objectView.adaptWidth = true;\r\n    objectView.adaptHeight = true;\r\n    let voidView: DViewElement = DViewElement.new('Void', DV.voidView(), undefined, '', '', '', [DObject.cname]);\r\n    voidView.appliableToClasses=[\"VoidVertex\"];\r\n    voidView.explicitApplicationPriority=2;\r\n    voidView.adaptWidth = true;\r\n    voidView.adaptHeight = true;\r\n\r\n    let edgePointView: DViewElement = DViewElement.new('EdgePoint', DV.edgePointView(), new GraphSize(0, 0, 30, 30), '', '', '', []);\r\n    let edgePointViewSVG: DViewElement = DViewElement.new('EdgePointSVG', DV.edgePointViewSVG(), new GraphSize(0, 0, 10, 10), '', '', '', []);\r\n    edgePointView.edgePointCoordMode = CoordinateMode.relativePercent;\r\n\r\n    let edgeViews: DViewElement[] = [];\r\n    let size0: GraphPoint = new GraphPoint(0, 0), size1: GraphPoint = new GraphPoint(20, 20), size2: GraphPoint = new GraphPoint(20, 20); // todo: riportalo in 40,20\r\n    let edgePreRenderFunc: string = `()=>({\r\n            segments: this.edge.segments,\r\n            strokeColor: \"gray\",\r\n            strokeWidth: \"2px\",\r\n            strokeColorHover: \"black\",\r\n            strokeColorLong: \"red\",\r\n            strokeLengthLimit: 300,\r\n            strokeWidthHover: \"4px\",\r\n        })`;\r\n    function makeEdgeView(name: string, type: EdgeHead, headSize: GraphPoint | undefined, tailSize: GraphPoint | undefined, dashing: boolean): DViewElement{\r\n        let ev = DViewElement.new2(\"Edge\"+name, DV.edgeView(type,\r\n                headSize ? DV.svgHeadTail(\"Head\", type) : \"\", tailSize ? DV.svgHeadTail(\"Tail\", type) : \"\", dashing ? \"10.5,9,0,0\" : undefined),\r\n            (v: DViewElement) => {\r\n                v.explicitApplicationPriority = 2;\r\n                v.bendingMode = EdgeBendingMode.Line;\r\n                v.appliableToClasses = [DVoidEdge.cname];\r\n                v.edgeHeadSize = headSize || size0;\r\n                v.edgeTailSize = tailSize || size0;\r\n                v.preRenderFunc = edgePreRenderFunc;\r\n        }, false);\r\n        edgeViews.push(ev);\r\n        return ev;\r\n    }\r\n\r\n    makeEdgeView(\"Association\", EdgeHead.reference,             size1,   undefined,  false);\r\n    makeEdgeView(\"Dependency\",  EdgeHead.reference,             size1,   undefined,  true);\r\n    makeEdgeView(\"Inheritance\", EdgeHead.extend,                size1,   undefined,  false);\r\n    makeEdgeView(\"Dependency\",  EdgeHead.extend,                size1,   undefined,  true);\r\n    makeEdgeView(\"Aggregation\", EdgeHead.aggregation,   undefined,      size2,      false);\r\n    makeEdgeView(\"Composition\", EdgeHead.composition,   undefined,      size2,      false);\r\n\r\n    // edgeView.forceNodeType=\"Edge\"\r\n\r\n    /*\r\n    for (let ev of edgeViews){\r\n        ev.explicitApplicationPriority = 2;\r\n        ev.bendingMode = EdgeBendingMode.Line;\r\n        ev.subViews = [edgePointView.id];\r\n    }*/\r\n    // nb: Error is not a view, just jsx. transform it in a view so users can edit it\r\n\r\n    let valueView: DViewElement = DViewElement.new('Value', DV.valueView(), undefined, '', '', '', [DValue.cname]);\r\n\r\n    const defaultPackage: DViewElement = DViewElement.new('DefaultPackage', DV.defaultPackage());\r\n    defaultPackage.query = `context DPackage inv: self.name = 'todo default pkg'`;\r\n\r\n    return [modelView, packageView, classView, enumView, attributeView, referenceView, operationView, literalView, objectView, valueView, defaultPackage, voidView, ...edgeViews, edgePointView, edgePointViewSVG];\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class ViewPointState extends DPointerTargetable{\r\n    public static cname: string = \"ViewPointState\";\r\n    name: string = '';\r\n}\r\n\r\n// todo: ogni entità ha: dati (store), logica con operazioni, dati di presentazione, ...?\r\n\r\n@RuntimeAccessible\r\nexport class ModelStore {\r\n    public static cname: string = \"ModelStore\";\r\n    private _meta!: ModelStore | string; // todo: credo sia un Pointer? roba vecchia. oldcomment: // string memorizzata nello store, logicamente si comporta come una reference perchè usi la stringa per recuperare un modelstore (il tipo modelstore è di documentazione)\r\n    instances!: (ModelStore | string)[];\r\n\r\n    // getter e setter senza proxy\r\n    get meta(): ModelStore | string {\r\n        return this._meta;\r\n    }\r\n\r\n    set meta(value: ModelStore | string) {\r\n        this._meta = value;\r\n    }\r\n}\r\n\r\n\r\n\r\n@RuntimeAccessible\r\nexport class LState<Context extends LogicContext<DState> = any, C extends Context = Context, D extends DState = DState> extends LPointerTargetable {\r\n    public static cname: string = \"LState\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DPointerTargetable & DState;\r\n    public static structure: typeof DPointerTargetable;\r\n    public static singleton: LPointerTargetable;\r\n    // return type is wrong, but have to extend the static method of RuntimeAccessibleClass which is completely different and returns a class constructor.\r\n    static get<T2 extends typeof RuntimeAccessibleClass & { logic?: typeof LPointerTargetable | undefined; }>(): T2 & LState { return LState.wrap(store.getState() as any) as any; }\r\n    contextMenu!: {display: boolean, x: number, y: number};\r\n    currentUser!: LUser;\r\n    debug!: boolean;\r\n    room!: string;\r\n    _lastSelected?: {modelElement?: LModelElement, node?: LGraphElement, view?: LViewElement};\r\n    idlookup!:Dictionary<Pointer, DPointerTargetable>;\r\n\r\n    get_contextMenu(c: Context): this[\"contextMenu\"] { return c.data.contextMenu; }\r\n    get_currentUser(c: Context): this[\"currentUser\"] { return LState.wrap(c.data.currentUser) as LUser; }\r\n    get_debug(c: Context): this[\"debug\"] { return c.data.debug; }\r\n    get_room(c: Context): this[\"room\"] { return c.data.room; }\r\n    get_idlookup(c: Context): this[\"idlookup\"] { return c.data.idlookup; }\r\n    get__lastSelected(c: Context): this[\"_lastSelected\"] {\r\n        let ls = c.data._lastSelected;\r\n        return ls && {modelElement: LState.wrap(ls.modelElement), node: LState.wrap(ls.node), view: LState.wrap(ls.view)}; }\r\n\r\n    _defaultCollectionGetter(c: Context, k: keyof DState): LPointerTargetable[] { return LPointerTargetable.fromPointer(c.data[k] as any); }\r\n    _defaultGetter(c: Context, k: keyof DState) {\r\n        //console.log(\"default Getter\");\r\n        let v = c.data[k];\r\n        if (Array.isArray(v)) {\r\n            if (v.length === 0) return [];\r\n            else if (Pointers.isPointer(v[0] as any)) return this._defaultCollectionGetter(c, k);\r\n            return v;\r\n        }\r\n        return v;\r\n    }\r\n}\r\n\r\n// console.error(\"dpt\" +DPointerTargetable, DPointerTargetable);\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DState);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LState);\r\n\r\n","import type {U as UType} from '../../joiner';\r\nimport {\r\n    Action,\r\n    CompositeAction,\r\n    CreateElementAction,\r\n    DeleteElementAction,\r\n    Dictionary,\r\n    DocString,\r\n    DPointerTargetable,\r\n    DState,\r\n    Log,\r\n    MyError,\r\n    ParsedAction,\r\n    Pointer,\r\n    RuntimeAccessibleClass,\r\n    SetFieldAction,\r\n    SetRootFieldAction,\r\n    LPointerTargetable,\r\n    store,\r\n    getPath,\r\n    Selectors,\r\n    PointedBy,\r\n    PendingPointedByPaths,\r\n    statehistory, DUser, GObject\r\n} from \"../../joiner\";\r\nimport React from \"react\";\r\nimport {CombineHistoryAction, LoadAction, RedoAction, UndoAction} from \"../action/action\";\r\nimport {Firebase} from \"../../firebase\";\r\nimport TreeModel from 'tree-model';\r\n\r\nlet windoww = window as any;\r\nlet U: typeof UType = windoww.U;\r\n\r\n\r\nfunction deepCopyButOnlyFollowingPath(oldStateDoNotModify: DState, action: ParsedAction, prevAction: ParsedAction, newVal: any): DState {\r\n    let newRoot: DState = {...oldStateDoNotModify} as DState;\r\n    let current: any = newRoot;\r\n    if (!action.path?.length) throw new MyError(\"path length must be at least 1\", {action});\r\n    let gotChanged: boolean = false; // dovrebbe cambiare sempre, se non cambia non lancio neanche l'azione e non faccio la shallow copy, ma non si sa mai, così posso evitare un render se succede l' \"insuccedibile\"\r\n    let alreadyPastDivergencePoint = false; // true dal momento in cui il path dell'azione attuale e della azione precedente divergono, false fino al sotto-segmento in cui combaciano\r\n    // console.log('deepCopyButOnlyFollowingPath', arguments);\r\n    for (let i = 0; i < action.pathArray.length; i++) {\r\n        let key = action.pathArray[i].trim();\r\n        let prevActionPathKey = prevAction?.pathArray[i];\r\n        // middle execution: not on final loop\r\n        // console.log('deepCopyButOnlyFollowingPath', {current, i, imax:action.pathArray.length, key, gotChanged, alreadyPastDivergencePoint});\r\n        if (i !== action.pathArray.length - 1) {\r\n            if (alreadyPastDivergencePoint || key !== prevActionPathKey) {\r\n                // se l'oggetto è stato già duplicato in una azione composita, non lo duplico 2 volte.\r\n                alreadyPastDivergencePoint = true;\r\n                current[key] = Array.isArray(current[key]) ? [...current[key]] : {...current[key]};\r\n                current[key].clonedCounter = 1 + (current[key].clonedCounter || 0);\r\n            }\r\n            current = current[key];\r\n            continue; }\r\n\r\n        // perform final assignment\r\n        if (i >= action.pathArray.length - 1) {\r\n            let isArrayAppend = false;\r\n            let isArrayRemove = false;\r\n            // console.log('isarrayappend?', {endswith: U.endsWith(key, ['+=', '[]', '-1']), key, action, i});\r\n            // console.log('isarraydelete?', {endswith: U.endsWith(key, ['-='])});\r\n            if (U.endsWith(key, ['+=', '[]'])) {\r\n                key = key.substr(0, key.length - 2).trim();\r\n                isArrayAppend = true; }\r\n            if (U.endsWith(key, ['-='])) {\r\n                key = key.substr(0, key.length - 2).trim();\r\n                isArrayRemove = true; }\r\n\r\n            let oldValue: any;\r\n            let unpointedElement: DPointerTargetable | undefined;\r\n            // perform final assignment\r\n            if (isArrayAppend) {\r\n                gotChanged = true;\r\n                if (!Array.isArray(current[key])) { current[key] = []; }\r\n                oldValue = [...current[key]];\r\n                current[key] = [...current[key]];\r\n                current[key].push(newVal);\r\n                unpointedElement = undefined;\r\n                if (action.isPointer) { newRoot = PointedBy.add(newVal as Pointer, action, newRoot, \"+=\"); }\r\n            } else\r\n            if (isArrayRemove){\r\n                if (!Array.isArray(current[key])) { current[key] = []; }\r\n                oldValue = [...current[key]];\r\n                let index = U.isNumber(newVal) ? +newVal : -1;\r\n                if (index === -1) index = current[key].length - 1;\r\n                gotChanged = index >=0 && index < current[key].length;\r\n                if (gotChanged){\r\n                    current[key] = [...current[key]];\r\n                    let removedval = current[key].splice(index, 1); // in-place edit\r\n                    if (action.isPointer) { newRoot = PointedBy.remove(removedval as Pointer, action, newRoot, '-='); }\r\n\r\n                    /// a.pointsto = [x, y, z]; a.pointsto = [x, z]       --->    remove a from y.pointedby\r\n                    /*\r\n                    const elementsThatChangedIndex: DPointerTargetable[] = current[key].slice(index);\r\n                    todo: problema: se ho [dobj1, dobj2]... e li swappo, cambia un indice nel percorso \"pointedby\" e non me ne accorgo mai e un oggetto risulta \"pointedby\" da oggetti che non lo puntano o non esistono più a quell'indice\r\n                    for (let j = 0; j < elementsThatChangedIndex.length; j++) {\r\n                        let newindex = index + j - 1;\r\n                        let oldFullpathTrimmed = action.pathArray.join('.');\r\n                        se realizzi \"pointedby\" qui è to do: remove old paths and re-add them with updated index\r\n                    }*/\r\n                    //unpointedElement = newRoot.idlookup[oldValue];\r\n                }\r\n            }\r\n            else if (current[key] !== newVal) {\r\n                // todo: caso in cui setto manualmente classes.1 = pointer; // the latest element is array and not DPointerTargetable, so might need to buffer upper level in the tree? or instead of \"current\" keep an array of sub-objects encountered navigating the path in state.\r\n                oldValue = current[key];\r\n                gotChanged = true;\r\n                unpointedElement = newRoot.idlookup[oldValue];\r\n                // NB: se elimino un oggetto che contiene array di puntatori, o resetto l'array di puntatori kinda like store.arr= [ptr1, ptr2, ...]; store.arr = [];\r\n                // i puntati dall'array hanno i loro pointedBY non aggiornati, non voglio fare un deep check di tutto l'oggetto a cercare puntatori per efficienza.\r\n                if (newVal === undefined) delete current[key];\r\n                else current[key] = newVal;\r\n\r\n                if (action.isPointer) {\r\n                    if (Array.isArray(action.value)) {\r\n                        let oldpointerdestinations: Pointer[] = oldValue;\r\n                        let difference = U.arrayDifference(oldpointerdestinations, current[key]); // : {added: Pointer[], removed: Pointer[], starting: Pointer[], final: Pointer[]}\r\n                        for (let rem of difference.removed) { newRoot = PointedBy.remove(rem as Pointer, action, newRoot); }\r\n                        for (let add of difference.added) { newRoot = PointedBy.add(add as Pointer, action, newRoot); }\r\n                        // a.pointsto = [a, b, c];  a.pointsto = [a, b, x];    ------>     c.pointedby.remove(a) & x.pointedby.add(a)\r\n                        // idlookup.somelongid.pointsto = [...b];\r\n                    }\r\n                    else {\r\n                        // a.pointsto = b;  a.pointsto = c;    ------>     b.pointedby.remove(a)\r\n                        newRoot = PointedBy.remove(oldValue as Pointer, action, newRoot);\r\n                        newRoot = PointedBy.add(current[key] as Pointer, action, newRoot);\r\n                    }\r\n                }\r\n            } else {\r\n                gotChanged = false;\r\n                // value not changed\r\n            }\r\n\r\n            let fullpathTrimmed = action.pathArray.join('.');\r\n            /*if (unpointedElement) {\r\n                if (isArrayAppend || isArrayAppend) fullpathTrimmed.substr(0, fullpathTrimmed.length - 2);\r\n                U.arrayRemoveAll(unpointedElement.pointedBy, fullpathTrimmed); // todo: se faccio una insert in mezzo ad un array devo aggiustare tutti i path di pointedby...\r\n            }\r\n            let newlyPointedElement = newRoot.idlookup[newVal];\r\n            if (newlyPointedElement) {\r\n                U.ArrayAdd(newlyPointedElement.pointedBy, fullpathTrimmed);\r\n            }*/\r\n            // console.log('deepCopyButOnlyFollowingPath final', {current, i, imax:action.pathArray.length, key, isArrayAppend, gotChanged, alreadyPastDivergencePoint});\r\n            break;\r\n        }\r\n        Log.exDevv('should not reach here: reducer');\r\n    }\r\n    return gotChanged ? newRoot : oldStateDoNotModify;\r\n}\r\n\r\n\r\n// const pendingPointedByPaths: {from: DocString<\"Path in store\">, field: DocString<\"keyof object found in from path\">, to: Pointer}[] = [];\r\nfunction CompositeActionReducer(oldState: DState, actionBatch: CompositeAction): DState {\r\n    // per via di thunk se arrivo qui lo stato cambia sicuro in mono-client non synchro (non ri-assegno valori equivalenti)\r\n    // todo: ma se arrivano in ordine sbagliato da altri client? posso permetterlo?\r\n    let actions: ParsedAction[];\r\n    if (actionBatch.actions) actions = Action.parse(actionBatch.actions);\r\n    else actions = [Action.parse(actionBatch)]; // else-case is if it's a single action and not an actual compositeaction\r\n    if (PendingPointedByPaths.all.length) actions.push(...PendingPointedByPaths.getSolveableActions(oldState)); //.all.map( p=> p.resolve() ) );\r\n\r\n    Action.possibleInconsistencies = {};\r\n\r\n    // estraggo le azioni derivate\r\n    let derivedActions: ParsedAction[] = [];\r\n    for (let action of actions) {\r\n        switch (action.type){\r\n            default: break;\r\n            case LoadAction.type: return action.value;\r\n            case CreateElementAction.type:\r\n                const elem: DPointerTargetable = action.value;\r\n\r\n                if (oldState.idlookup[elem.id]) {\r\n                console.error(\"rejected CreateElementAction, roolback occurring:\", {action, elem:{...elem},\r\n                    preexistingValue: {...oldState.idlookup[elem.id]}, isEqual: elem === oldState.idlookup[elem.id] });\r\n                    return oldState;\r\n                    /*\r\n                    action.value = \"An element with that id already existed.\";\r\n                    action.path = action.field = \"CreateActionRejected\";\r\n                    action.className = SetRootFieldAction.name;\r\n                    action.type = SetRootFieldAction.type;\r\n                    action.pathArray = [action.path]; //a\r\n                    action.isPointer = false;\r\n                    // just to log it in undo-redo action list and have a feedback*/\r\n                    break;\r\n                }\r\n                elem.className = elem.className || (elem.constructor as typeof RuntimeAccessibleClass).cname || elem.constructor.name;\r\n                let statefoldername = elem.className.substring(1).toLowerCase() + 's';\r\n                derivedActions.push(\r\n                    Action.parse(SetRootFieldAction.create(statefoldername, elem.id,'[]', true)));\r\n                if (!Array.isArray(elem.pointedBy)) elem.pointedBy = [];\r\n                elem.pointedBy.push(PointedBy.new(statefoldername));\r\n                /*if (false && action.isPointer) {\r\n                    if (Array.isArray(action.value)) {\r\n                        const ptr: Pointer[] = action.value;\r\n                        // todo but replaced by side actions in execution of the main action instead of triggering derived actions\r\n                    }\r\n                    else {\r\n                        const ptr: Pointer = action.value;\r\n                        const target: DPointerTargetable | null = oldState.idlookup[ptr];\r\n                        let pendingPointedBy = PendingPointedByPaths.new(action, oldState);\r\n                        if (!target) PendingPointedByPaths.new(action, oldState).saveForLater(); // {from: action.path, field: action.field, to: target});\r\n                        // @ts-ignore\r\n                        else derivedActions.push(pendingPointedBy.resolve());\r\n                        // a -> x\r\n                        // a -> y     unset x.pointedby(a)\r\n                    }\r\n                }*/\r\n                break;\r\n        }\r\n    }\r\n    // console.error({U, Umip:U.arrayMergeInPlace, WU: windoww.U, WUmip: windoww.U.arrayMergeInPlace});\r\n    actions = U.arrayMergeInPlace<ParsedAction>(actions, derivedActions);\r\n\r\n    // ordino i path con segmenti comuni\r\n    actions = actions.sort( (a1, a2) => U.stringCompare(a1.path, a2.path));\r\n\r\n    // destrutturo solo i nodi intermedi e solo la prima volta che li incontro (richiede le azioni ordinate in base al path)\r\n    let newState = oldState;\r\n    for (let i = 0; i < actions.length; i++) {\r\n        const prevAction: ParsedAction = actions[i-1];\r\n        const action: ParsedAction = actions[i];\r\n        const actiontype = action.type.indexOf('@@') === 0 ? 'redux' : action.type;\r\n        console.log('executing action:', {a:action, t:actiontype, field: action.field, v:action.value}); //, count: ++action.executionCount});\r\n\r\n        switch (actiontype) {\r\n            /*\r\n            case '@@redux/INIT6.x.f.d.r.e':\r\n            case '@@redux/INITm.f.1.s.o.g':\r\n            case '@@redux/INIT5.t.4.v.d.o':\r\n            case '@@redux/INITy.a.d.r.l.a':\r\n            case '@@redux/INIT4.2.q.u.z.k':\r\n            case '@@redux/INITj.8.e.g.y.p':\r\n            case '@@redux/INITp.k.q.g.z.w':\r\n            case '@@redux/INITq.c.u.w.f.e': ... etc*/\r\n            default:\r\n                if (action.type.indexOf('@@redux/') === 0) break;\r\n                return Log.exDevv('unexpected action type:', action.type);\r\n            case CreateElementAction.type:\r\n            case SetRootFieldAction.type:\r\n            case DeleteElementAction.type:\r\n            case SetFieldAction.type:\r\n                newState = deepCopyButOnlyFollowingPath(newState, action, prevAction, action.value);\r\n                break;\r\n        }\r\n\r\n        // and that's all, the reducer is really simple as actions are really simple.\r\n    }\r\n\r\n    // effetti collaterali, aggiornamento di ridondanze\r\n    newState = updateRedundancies_OBSOLETE(newState, oldState, Action.possibleInconsistencies);\r\n    return newState;\r\n}\r\n\r\nfunction updateRedundancies_OBSOLETE(state: DState, oldState:DState, possibleInconsistencies: Dictionary<DocString<'subtype'>, (Pointer | DPointerTargetable)[]>): DState {\r\n    for (let subType in possibleInconsistencies)\r\n    switch (subType) {\r\n        default: break;\r\n        case Action.SubType.vertexSubElements:/*\r\n            risolto triggrerando più azioni da LGraphElement setter\r\n            let dvertexid: Pointer, newdvertex: DGraphElement, olddvertex: DGraphElement;\r\n            for (newdvertex of possibleInconsistencies[subType] as DGraphElement[]){\r\n                const olddvertex: DGraphElement = oldState.idlookup[newdvertex.id] as DGraphElement;\r\n                const notContainedAnymoreOut: Pointer<DGraphElement> = [];\r\n                const newlyInsertedOut: Pointer<DGraphElement>[] = [];\r\n                U.arraySymmetricDifference(olddvertex.subElements, newdvertex.subElements, notContainedAnymoreOut, newlyInsertedOut);\r\n                for (let geid of notContainedAnymoreOut) {\r\n                    const oldge = oldState.idlookup[geid] as DGraphElement;\r\n                    const newge = state.idlookup[geid] as DGraphElement;\r\n                    if (oldge.containedIn === newge.containedIn) continue;\r\n                }\r\n                for (let geid of notContainedAnymoreOut) {\r\n                    const ge = idlookup[geid] as DGraphElement;\r\n                    if (ge.containedIn === context.data.id) set container = context.data.id\r\n                    meglio se sti 2 cicli li fai nel reducer perchè  potrebbe esserci una azione pending che setta il parent = someotherid e qui faccio partire una azione che setta il parent a null, \"annullando\" una azione pending non ancora eseguita\r\n                }\r\n            }\r\n            break;*/\r\n    }\r\n    // if state is updated shallow copy state before returning it\r\n    return state;\r\n}\r\n\r\nlet initialState: DState = null as any;\r\nlet storeLoaded: boolean = false;\r\n\r\nexport function reducer(oldState: DState = initialState, action: Action): DState {\r\n    const ret = _reducer(oldState, action);\r\n    if(ret === oldState) return oldState;\r\n    if(!oldState?.room) return ret;\r\n    // action.sender === DUser.current\r\n    const ignoredFields = ['contextMenu', '_lastSelected', 'isCleaning'];\r\n    if(action.token === DUser.token && !ignoredFields.includes(action.field)) {\r\n        console.log('FB: Sending Action:' + action.id + ' from ' + action.token);\r\n        const parsedAction: JSON = JSON.parse(JSON.stringify(action));\r\n        Firebase.addAction(ret.room, parsedAction).then();\r\n    }\r\n    return ret;\r\n\r\n}\r\n\r\nexport function _reducer/*<S extends StateNoFunc, A extends Action>*/(oldState: DState = initialState, action: Action): DState{\r\n    let times: number;\r\n    let state: DState;\r\n    switch(action.type) {\r\n        case UndoAction.type:\r\n            times = action.value;\r\n            state = oldState;\r\n            Log.exDev(times<=0, \"undo must be positive\", action);\r\n            while (times--) {\r\n                state = undo(state, statehistory[DUser.current].undoable.pop());\r\n            }\r\n            return state;\r\n\r\n        case RedoAction.type:\r\n            times = action.value;\r\n            state = oldState;\r\n            Log.exDev(times<=0, \"redo must be positive\", action);\r\n            while (times--) {\r\n                state = undo(state, statehistory[DUser.current].redoable.pop(), false);\r\n            }\r\n            return state;\r\n        // case CombineHistoryAction.type: return combineHistory(oldState); break;\r\n        // todo: se al posto di \"annullare l'undo\" memorizzo l'azione e la rieseguo, posso ripetere l'ultimo passo N volte e questa azione diventa utile per combinare passi e ripetere blocchi di azioni assieme\r\n        default:\r\n            let ret = doreducer(oldState, action);\r\n            if (ret === oldState) return ret;\r\n            statehistory[DUser.current].redoable = [];\r\n            let delta =  U.objectDelta(ret, oldState);\r\n            if (!filterundoableactions(delta)) return ret;\r\n            // console.log(\"setting undoable action:\", {ret, oldState0:{...oldState}, oldState, delta});\r\n            if (oldState !== null) statehistory[DUser.current].undoable.push(delta);\r\n            return ret;\r\n    }\r\n}\r\n\r\nfunction filterundoableactions(delta: Partial<DState>): boolean {\r\n    if (!statehistory.globalcanundostate) return false;\r\n    if (Object.keys(delta).length === 1 && \"dragging\" in delta) return false;\r\n    if (Object.keys(delta).length === 1 && \"_lastSelected\" in delta) return false;\r\n    if (Object.keys(delta).length === 1 && \"contextMenu\" in delta) return false;\r\n    return true;\r\n}\r\nfunction undo(state: DState, delta: GObject | undefined, isundo = true): DState {\r\n    if (!delta) return state;\r\n    let undonestate: DState = {...state} as DState;\r\n    //   controlla se vengono shallow-copied solo e tutti gli oggetti nested lungo la catena del percorso delle modifiche\r\n    //   es: root.a.b.c=3 + root.a.b.d=3 = 4+1 modifiche, 5 shallow copies including the root\r\n    undorecursive(delta, undonestate);\r\n    if (isundo) statehistory[DUser.current].redoable.push( U.objectDelta(undonestate, state) ); // reverses from undo to redo and viceversa swapping arguments, so the target result after appliying the delta changes\r\n    else statehistory[DUser.current].undoable.push( U.objectDelta(undonestate, state) ); // redo is \"undoing an undo\", reversing his changes just like an undo reverses an ordinary action changes.\r\n    return undonestate;\r\n}\r\n\r\nfunction undorecursive(deltalevel: GObject, statelevel: GObject): void {\r\n    // statelevel = {...statelevel}; not working if i do it here, just a new var. first time copy id done in caller func undo(). recursive copies are done before recursive step\r\n    for (let key in deltalevel) {\r\n        let delta = deltalevel[key];\r\n        console.log(\"undoing\", {delta, key, deltalevel, statelevel})\r\n        if (key.indexOf(\"_-\") === 0) { delete statelevel[key.substring(2)]; continue; }\r\n        if (typeof delta === \"object\") {\r\n        // if (U.isObject(delta, false, false, true)) {\r\n            statelevel[key] = {...statelevel[key]};\r\n            undorecursive(deltalevel[key], statelevel[key]); }\r\n        else { statelevel[key] = delta; }\r\n    }\r\n}\r\n\r\nfunction doreducer/*<S extends StateNoFunc, A extends Action>*/(oldState: DState = initialState, action: Action): DState{\r\n    if (!oldState) { oldState = initialState = DState.new(); }\r\n    let ca: CompositeAction;\r\n    // console.log('external REDUCER', {action, CEtype:CreateElementAction.type});\r\n    if (!storeLoaded) {\r\n        // new SetRootFieldAction('forceinit', true);\r\n        storeLoaded = true;\r\n    }\r\n    if (!(oldState as any).forceinit) {\r\n        // afterStoreLoad();\r\n        // new SetRootFieldAction('forceinit', true);\r\n    } //  setTimeout(afterStoreLoad, 1);\r\n    switch (action.type) {\r\n        case CompositeAction.type: ca = action as CompositeAction; break;\r\n        case LoadAction.type:\r\n        default:\r\n            if (action.type.indexOf('@@redux/') === 0) {\r\n                //storeLoaded = true;\r\n                return oldState;\r\n            }\r\n            ca = new CompositeAction([action], false);\r\n            break;\r\n    }\r\n    let ret = CompositeActionReducer(oldState, ca);\r\n    /*if (state.current !== ret) {\r\n        state.current = ret;\r\n        state.past.push(ret);\r\n    }*/\r\n    return ret;\r\n}\r\nfunction setSubclasses(dict:Dictionary<string, typeof RuntimeAccessibleClass>){\r\n\r\n    let tree = new TreeModel({\r\n        childrenPropertyName: \"subclasses\"\r\n    });\r\n    for (let key in dict){\r\n        let constructor = dict[key];\r\n        if(!constructor.hasOwnProperty(\"subclasses\")) constructor.subclasses = [];\r\n    }\r\n    RuntimeAccessibleClass.extendTree = (tree as any).safe_parse(RuntimeAccessibleClass);\r\n\r\n}\r\nwindoww.TreeModel = TreeModel;\r\nfunction buildLSingletons(alld: Dictionary<string, typeof DPointerTargetable>, alll: Dictionary<string, typeof LPointerTargetable>) {\r\n    for (let dname in alld) {\r\n        switch (dname) {\r\n            case \"DeleteElementAction\": continue;\r\n            case \"DV\": continue;\r\n            case \"Debug\": continue;\r\n            default: break;\r\n        }\r\n        if ((dname[1] || \"\").toLowerCase() === dname[1]) continue; // if second letter is lowercase, it's not a \"D\" class\r\n        let tagless = dname.substring(1);\r\n        let d = alld[dname];\r\n        let l = alll['L'+tagless];\r\n        d.logic = l;\r\n        if (!l) console.error('lllllllll', l, d);\r\n        // @ts-ignore\r\n        d.singleton = new l('dwc');\r\n        d.structure = d;\r\n\r\n        l.logic = d.logic;\r\n        l.singleton = d.singleton;\r\n        l.structure = d.structure;\r\n\r\n        // if (!d.subclasses) d.subclasses = [];\r\n        // @ts-ignore\r\n        // for (let sc of d.subclasses) { if (!sc[\"_extends\"]) sc[\"_extends\"] = [];  sc[\"_extends\"].push(d); }\r\n    }\r\n}\r\n\r\nexport function jodelInit() {\r\n    RuntimeAccessibleClass.fixStatics();\r\n\r\n    let dClasses: string[] = RuntimeAccessibleClass.getAllNames().filter( rc => rc[0] === 'D');\r\n    let lClasses: string[] = RuntimeAccessibleClass.getAllNames().filter( rc => rc[0] === 'L');\r\n    let dClassesmap: Dictionary<string, typeof DPointerTargetable> = dClasses.reduce((acc: any,curr)=> (acc[curr] = RuntimeAccessibleClass.get(curr), acc),{});\r\n    let lClassesmap: Dictionary<string, typeof LPointerTargetable> = lClasses.reduce((acc: any,curr)=> (acc[curr] = RuntimeAccessibleClass.get(curr), acc),{});\r\n    buildLSingletons(dClassesmap, lClassesmap);\r\n    setSubclasses(dClassesmap);\r\n    setSubclasses(lClassesmap);\r\n\r\n\r\n    windoww.defaultContext = {$: windoww.$, getPath, React: React, Selectors, ...RuntimeAccessibleClass.getAllClassesDictionary(), ...windoww.Components};\r\n    // windoww.React = React;\r\n\r\n    /*for (let dclassname of dClasses) {\r\n        const dclass = RuntimeAccessibleClass.get(dclassname) as typeof DPointerTargetable;\r\n        const lclass = RuntimeAccessibleClass.get('L' + dclassname.substr(1)) as typeof LPointerTargetable;\r\n        dclass.logic = lclass;\r\n        console.log('EXecute on read set singletons:', {dclass, lclass});\r\n        if (!lclass) continue;\r\n        lclass.singleton = new lclass();\r\n        lclass.structure = dclass;\r\n    }*/\r\n\r\n    DState.fakeinit();\r\n//    setTimeout( () => createOrOpenModelTab('m3'), 1);\r\n    // GraphDragHandler.init();\r\n\r\n}\r\n\r\n// ideally launched before component render, verify it. maybe move the callback to <App> component mounting\r\nfunction afterStoreLoad() {\r\n    jodelInit();\r\n}\r\n","import {createStore, Store} from \"redux\";\r\nimport {Action, DState, reducer, windoww} from \"../joiner\";\r\n\r\ninterface StateExt{}\r\nexport let store: Store<DState & StateExt, Action> = createStore(reducer);\r\n\r\nwindoww.store = store;\r\nwindoww.s = store.getState;\r\n\r\n// console.log('store:', {store, wstore: windoww.store, state: U.cloneObj(store.getState())});\r\n","// @ts-nocheck\r\nimport { RuntimeAccessible } from \"../joiner\";\r\n\r\n@RuntimeAccessible\r\nexport class Debug {\r\n    public static cname: string = \"Debug\";\r\n    // counts how many times each node is rendered in a component.\r\n    static getComponentMap(){\r\n        let nodes = Object.values(window.GraphElementComponent.all).map(a=>a.props.node).filter(a=>!!a);\r\n        let nodeids = [...new Set(nodes.map(a=>a.id).filter(a=>!!a))]\r\n        let allids = {};\r\n        for (let o of nodeids) allids[o] = 0;\r\n        for (let n of nodes) allids[n?.id]++;\r\n        allids.nodes = nodeids;\r\n        allids.components = Object.values(window.GraphElementComponent.all);\r\n        return allids; }\r\n    static timeoutTasks(){}\r\n    static largeTimeoutTasks(){\r\n        window.model = window.LPointerTargetable.wrap(s().model?.[0]);\r\n    }\r\n\r\n}\r\n\r\nsetTimeout(Debug.timeoutTasks, 500);\r\nsetTimeout(Debug.largeTimeoutTasks, 5000);\r\nwindow.Debug = Debug;\r\n","import {OclEngine} from \"@stekoe/ocl.js\"\r\nimport {Constructor, GObject, RuntimeAccessible, RuntimeAccessibleClass} from \"../joiner\";\r\nimport {OclResult} from \"@stekoe/ocl.js/dist/components/OclResult\";\r\n\r\nlet windoww = window as any;\r\n\r\nexport class Company {\r\n    static all: Company[] = [];\r\n    constructor(public name: string ='cname', public employee: Persona[]=[], public manager: Persona|null = null) { Company.all.push(this); }\r\n}\r\nexport class Persona {\r\n    static all: Persona[] = [];\r\n    constructor(public name: string='pname', public age: number=18, public isUnemployed: boolean=true){ Persona.all.push(this) }\r\n}\r\n\r\nexport class OCL{\r\n    public static evaluate<T extends GObject>(obj0: T, constructor: Constructor<T>, oclexp: string, typeused: Constructor[]=[], oclEngine?: OclEngine): OclResult {\r\n        if (!oclEngine) {\r\n            oclEngine = OclEngine.create();\r\n            var oclResult = null;\r\n            // let objexp = //\"context Object inv: self.age > 0\" +\r\n            if (!oclexp) oclexp = \"context Persona inv: self.age>0\";\r\n\r\n\r\n            const typeregister: GObject = {};\r\n            typeregister[(constructor as any as typeof RuntimeAccessibleClass).cname || constructor.name] = constructor;\r\n            for (let type of typeused) { typeregister[(type as any as typeof RuntimeAccessibleClass).cname || type.name] = type; }\r\n            oclEngine.registerTypes(typeregister);\r\n            oclEngine.addOclExpression(oclexp);\r\n        }\r\n\r\n        let obj: GObject = obj0;\r\n        if (!obj) {\r\n            obj = new Persona();\r\n            obj.age = -55;\r\n            obj.name = {notEmpty: () => { console.log('innerfunc'); return true} };\r\n            obj.f = (a:any) => { console.error('called a', a); return a>0};\r\n            obj.name0= '';\r\n//obj.$$typeof = Persona;\r\n\r\n            obj.__asArray = true;\r\n        }\r\n        // as you set classname in runtimeaccessible you must set this typeName\r\n        // obj.typeName = constructor.name || constructor;\r\n// obj = getPath;\r\n// obj.constructor = Persona;\r\n        oclResult = oclEngine.evaluate(obj);\r\n        return oclResult;\r\n    }\r\n\r\n    public static filter<T extends GObject>(keepIndex: boolean, returnType: 'ocl' | 'bool' | 'src', obj0: T[], oclexp: string, typeused: Constructor[]=[]) {\r\n        var oclEngine = OclEngine.create();\r\n        var oclResult = null;\r\n        const typeregister: GObject = {};\r\n        for (let type of typeused) { typeregister[(type as any as typeof RuntimeAccessibleClass).cname || type.name] = type; }\r\n        oclEngine.registerTypes(typeregister);\r\n        if (!oclexp) oclexp = \"context Persona inv: self.age>0\";\r\n        oclEngine.addOclExpression(oclexp);\r\n\r\n        let obj: GObject[] = obj0;\r\n        let ret: ((OclResult | boolean) | (GObject | null))[] = [];\r\n\r\n        for (let i = 0; i < obj.length; i++) {\r\n            let res: OclResult | null;\r\n            try { res = oclEngine.evaluate(obj[i]); }\r\n            catch(e) { console.error('failed to evalute object:', {e}); res = null; }\r\n            if (returnType === 'ocl') {\r\n                ret[i] = res;\r\n                continue; }\r\n            let bool = res && res.getEvaluatedContexts().length > 0 && res.getResult();\r\n            if (returnType === 'bool') ret[i] = bool;\r\n            else ret[i] = bool ? obj[i] : null;\r\n        }\r\n\r\n        if (!keepIndex) {\r\n            ret = (ret).filter((r:any) => !!r) as any;\r\n        }\r\n\r\n        return ret;\r\n    }\r\n}\r\nwindoww.OCL = OCL;\r\nconst oclEngine = OclEngine.create();\r\n\r\n\r\n/*\r\n\r\nlet p = new Persona();\r\np.age = 0;\r\nlet p2 = new Persona();\r\np2.age = 1;\r\nlet p3 = new Persona();\r\np3.age = -5;\r\nlet pp = [p, p2, p3];\r\nOCL.filter(true, 'ocl', pp, undefined, \"context Persona inv: self.age>0\")\r\n\r\n\r\n///\r\n\r\nOCL.filter(true, 'src', Selectors.getAll(DClass, undefined, undefined, true), \"context DClass inv: self.abstract\")\r\n/// works\r\nlet pp = Selectors.getAll(DClass, undefined, undefined, true);\r\nOCL.filter(true, 'src', Selectors.getAll(DClass, undefined, undefined, true), \"context DClass inv: self.name = \\\"class_2\\\"\")\r\n\r\n* */\r\n\r\noclEngine.addOclExpression(`\r\n    -- No one should work that long...\r\n    context Company inv:\r\n        self.employee->forAll(p : Person | p.age <= 65 )\r\n\r\n    -- If a company has a manager, \r\n    -- the company has at least one employee.\r\n    context Company\r\n        inv: self.manager.isUnemployed = false\r\n        inv: self.employee->notEmpty()\r\n`);\r\n\r\nlet company = new Company();\r\ncompany.employee.push(new Persona());\r\n\r\nconst oclResult = oclEngine.evaluate(company);\r\n\r\n\r\n\r\nwindoww.Person = Persona;\r\nwindoww.Company = Company;\r\nwindoww.oclEngine = oclEngine;\r\n\r\nconsole.log('tests:', '\\n' +\r\n    'oclEngine.addOclExpression(`\\n' +\r\n    '    -- No one should work that long...\\n' +\r\n    '    context Company inv:\\n' +\r\n    '        self.employee->forAll(p : Person | p.age <= 65 )\\n' +\r\n    '\\n' +\r\n    '    -- If a company has a manager, \\n' +\r\n    '    -- the company has at least one employee.\\n' +\r\n    '    context Company\\n' +\r\n    '        inv: self.manager.isUnemployed = false\\n' +\r\n    '        inv: self.employee->notEmpty()\\n' +\r\n    '`);\\n' +\r\n    '\\n' +\r\n    'const customTypes = {\\n' +\r\n    '  \"Person\": Person, \"Company\": Company \\n' +\r\n    '}\\n' +\r\n    '\\n' +\r\n    'oclEngine.registerTypes(customTypes);' +\r\n    'let company = new Company();\\n' +\r\n    'let employee = new Person();\\n' +\r\n    'let parent = new Person();\\n' +\r\n    'let child = new Person();\\n' +\r\n    'child.parents = [parent];\\n' +\r\n    'parent.parents = [parent];\\n' +\r\n    'employee.age = 70;\\n' +\r\n    'company.employee.push(employee);\\n' +\r\n    '\\n' +\r\n    'console.log(\\'evaluate company\\', oclEngine.evaluate(company));\\n' +\r\n    '\\n' +\r\n    '\\n' +\r\n    '// parentchild test\\n' +\r\n    'let oclEnginep = OclEngine.create();\\n' +\r\n    'oclEnginep.addOclExpression(`\\n' +\r\n    '    context Person\\n' +\r\n    '        inv: self.parents->forAll(p | p <> self)\\n' +\r\n    '`)\\n' +\r\n    'console.log(\\'evaluate parent\\', oclEnginep.evaluate(parent));\\n' +\r\n    'console.log(\\'evaluate child\\', oclEnginep.evaluate(child));\\n');\r\n","import {jodelInit, windoww} from \"../joiner\";\r\nimport * as Componentss from '../joiner/components';\r\n\r\n\r\n/*\r\nlet pairs = [\r\n    [DAnnotation, LAnnotation],\r\n    [DModelElement, LModelElement],\r\n    [DAttribute, LAttribute],\r\n    [DClass, LClass],\r\n    [DClassifier, LClassifier],\r\n    [DEnumerator, LEnumerator],\r\n    [DEnumLiteral, LEnumLiteral],\r\n    [DModel, LModel],\r\n    [DObject, LObject],\r\n    [DOperation, LOperation],\r\n    [DPackage, LPackage],\r\n    [DParameter, LParameter],\r\n    [DReference, LReference],\r\n    [DStructuralFeature, LStructuralFeature],\r\n    [DValue, LValue],\r\n    [DModelElementTransientProperties, LModelElementTransientProperties],\r\n    [DViewTransientProperties, LViewTransientProperties],\r\n    [DViewPrivateTransientProperties, LViewPrivateTransientProperties],\r\n    [DViewElement, LViewElement],\r\n    [DVoidVertex, LVoidVertex]\r\n    // [DMap, LMap],\r\n];\r\n*/\r\n\r\n/*for (let pair of pairs as any[]) {\r\n    pair[0].logic = pair[1];\r\n    pair[1].singleton = new pair[1]();\r\n    pair[1].structure = pair[0];\r\n    windoww[pair[0].name] = pair[0];\r\n    windoww[pair[1].name] = pair[1];\r\n}*/\r\n\r\n/*\r\nDAnnotation.logic = LAnnotation;\r\nLAnnotation.singleton = new LAnnotation();\r\n\r\nDModelElement.logic = LModelElement;\r\nLModelElement.singleton = new LModelElement();\r\nDAttribute.logic = LAttribute;\r\nLAttribute.singleton = new LAttribute();\r\nDClass.logic = LClass;\r\nDClassifier.logic = LClassifier;\r\nDEnumerator.logic = LEnumerator;\r\nDEnumLiteral.logic = LEnumLiteral;\r\nDModel.logic = LModel;\r\nDOBject.logic = LObject;\r\nDOperation.logic = LOperation;\r\nDPackage.logic = LPackage;\r\nDParameter.logic = LParameter;\r\nDReference.logic = LReference;\r\nDStructuralFeature.logic = LStructuralFeature;\r\nDValue.logic = LValue;\r\nDModelElementTransientProperties.logic = LModelElementTransientProperties;\r\n\r\nLClass.singleton = new LClass();\r\nLClassifier.singleton = new LClassifier();\r\nLEnumerator.singleton = new LEnumerator();\r\nLEnumLiteral.singleton = new LEnumLiteral();\r\nLOperation.singleton = new LOperation();\r\nLPackage.singleton = new LPackage();\r\nLParameter.singleton = new LParameter();\r\nLReference.singleton = new LReference();\r\nLStructuralFeature.singleton = new LStructuralFeature();\r\nLValue.singleton = new LValue();\r\nLModel.singleton = new LModel();\r\nLObject.singleton = new LObject();\r\nLModelElementTransientProperties.singleton = new LModelElementTransientProperties();\r\n*/\r\nexport const fakeExport = {}; // just to import-execute this file\r\n// DState.fakeinit();\r\n// Symbol.prototype.toString = function(): string { alert('symbol to string'); return String(this); }\r\n\r\nlet Components = Componentss;\r\n/*\r\nComponents.map(C=> {\r\n    if (typeof C === 'object') return\r\n})\r\nfor (let Comp of Components) {\r\n\r\n}*/\r\nlet wComponents = {...Components}\r\nfor (let key in wComponents) {\r\n    let index = key.indexOf(\"Component\")\r\n    if (index === -1) continue;\r\n    let newkey = key.substring(0, index);\r\n    if ((Components as any)[newkey]) continue;\r\n    (wComponents as any)[newkey] = (Components as any)[key];\r\n}\r\n\r\n// (Components as any)[\"input\"] = Components[\"InputComponent\"];\r\nwindoww.Components = wComponents;\r\n\r\n\r\nfunction afterStoreLoad() {\r\n    jodelInit();\r\n}\r\n\r\n// afterStoreLoad();\r\n// setTimeout( afterStoreLoad, 0);\r\n","import * as jsxtt from 'jsx-transform/lib/jsx.js';\r\nimport $$ from 'jquery';\r\nimport {ReactNode} from \"react\";\r\nimport * as _pr_json2xml from '../common/libraries/prj_json2xml.js';\r\nimport * as _pr_xml2json from '../common/libraries/prj_xml2json.js';\r\n// true imports for this file (should all be import type\r\nimport type {DocString, GObject as GObjectt} from './types';\r\nimport type {U as UType} from \"../common/U\";\r\nimport type {Selectors as SelType} from \"../redux/selectors/selectors\";\r\n\r\nexport type {Constructor, AbstractConstructor} from \"../joiner/types\";\r\nexport type {ValueDetail, SetValueAtPoisitionInfoType} from \"../model/logicWrapper/LModelElement\";\r\nvar windoww = (window as any);\r\nwindoww.windoww = windoww;\r\n\r\n\r\n// console.error('iiiiiiiiiiiiiiii 0');\r\n\r\nwindoww.$ = $$;\r\nexport const $: JQueryStatic = $$;\r\nexport const prjson2xml = _pr_json2xml;\r\nexport const prxml2json = _pr_xml2json;\r\nwindoww.prjson2xml = prjson2xml;\r\nwindoww.prxml2json = prxml2json;\r\n\r\n// import types\r\n//import {$s, GraphPoint, GraphSize, IPoint, ISize, Log, Point, Size, U} from \"../common/U\";\r\n\r\n// nb: export type è un export \"finto\" che esiste solo in compilazione per fare capire a typescript i tipi. permette export di alias con nomi diversi (l'export normale no)\r\nexport type {GetPath} from './proxy';\r\n\r\nexport type {Subtract, Class, Empty, Json, GObject, bool, Dictionary, Proxyfied, Temporary, RawObject, NotFoundv,\r\n    NotFound, DocString, nbool, nnumber, nstring, Nullable, TODO, UnixTimestamp, UObject, IsActually,\r\n    Function, Function2, InOutParam,\r\n    unArr, orArr, PrimitiveType, CClass, NonEmptyString, Overlap, Info\r\n} from \"./types\";\r\nexport type {Pointer, PtrString, getWParams, WUser, WtoD, WtoL, DtoW, LtoW, LtoD, DtoL, PackArr, Pack, Pack1 } from \"./classes\";\r\n\r\nexport type { WAnnotation, WNamedElement, WFactory_useless_, WClass, WAttribute, WClassifier, WDataType, WMap, WModel,\r\n    WModelElement, WEnumerator, WObject, WPackage, WOperation, WValue, WParameter, WReference, WTypedElement, WEnumLiteral, WStructuralFeature,\r\n} from \"../model/logicWrapper/LModelElement\";\r\nexport type {WEdge, WEdgePoint, WExtEdge, WGraph, WRefEdge, WGraphElement, WVoidEdge, WGraphVertex, WVertex, WVoidVertex, EdgeSegment, EdgeFillSegment} from \"../model/dataStructure/GraphDataElements\";\r\n\r\nexport {windoww} from './types';\r\nexport {GraphElementStatee, GraphElementDispatchProps, GraphElementReduxStateProps, GraphElementOwnProps, EdgeStateProps, EdgeOwnProps} from \"../graph/graphElement/sharedTypes/sharedTypes\";\r\nexport {EdgeBendingMode} from \"./types\";\r\nexport {Constructors, JsType, RuntimeAccessibleClass, DPointerTargetable,\r\n    LPointerTargetable, WPointerTargetable, MyError, RuntimeAccessible,\r\n    Obsolete, Leaf, Node, Abstract, Instantiable, MixOnlyFuncs,\r\n    LUser, DUser, Pointers, PointedBy, PendingPointedByPaths, CoordinateMode, EdgeHead} from \"./classes\";\r\n\r\n// export type {Pointer} from './typeconverter';\r\nexport {getPath, TargetableProxyHandler, MyProxyHandler, MapProxyHandler, LogicContext, MapLogicContext} from './proxy';\r\n// console.error('iiiiiiiiiiiiiiii 3');\r\n// import independent generic modules (only dependent from types and RuntimeAccessible\r\n\r\nexport {Uarr,  DDate, ParseNumberOrBooleanOptions, myFileReader,\r\n    Keystrokes, ShortAttribETypes, AttribETypes, FileReadTypeEnum, FocusHistoryEntry, SelectorOutput, U as UU, ShortAttribSuperTypes,\r\n    } from \"../common/U\";\r\nexport {DV} from '../common/DV';\r\nexport {Size, GraphSize, GraphPoint, IPoint, ISize, Point} from \"../common/Geom\";\r\nexport { CSSRuleSorted, CSSParser, TagNames } from \"../common/Uhtml\";\r\n// export {Log as Logg, Size, GraphSize, GraphPoint, IPoint, ISize, Point} from \"../common/Log\";\r\nexport const Log = windoww.Log;\r\nexport {UX} from \"../common/UX\";\r\nexport var U = windoww.U as typeof UType;\r\nexport {DLog} from \"../model/classes/D\";\r\nexport {LLog} from \"../model/classes/L\";\r\n// console.error('iiiiiiiiiiiiiiii 4');\r\n\r\nexport {EcoreParser} from \"../api/data\";\r\n// import domain-specific classes\r\n\r\n\r\nexport {\r\n    DModelElement,\r\n    LModelElement,\r\n    DModel, LModel,\r\n    DValue, LValue,\r\n    DNamedElement, LNamedElement,\r\n    DObject, LObject,\r\n    DEnumerator, LEnumerator,\r\n    DEnumLiteral, LEnumLiteral,\r\n    DAttribute, LAttribute,\r\n    DReference, LReference,\r\n    DStructuralFeature, LStructuralFeature,\r\n    DClassifier, LClassifier,\r\n    DDataType, LDataType,\r\n    DClass, LClass,\r\n    DParameter, LParameter,\r\n    DOperation, LOperation,\r\n    DPackage, LPackage,\r\n    DTypedElement, LTypedElement,\r\n    DAnnotation, LAnnotation,\r\n    EJavaObject,\r\n    DFactory_useless_, LFactory_useless_, DMap, LMap\r\n} from \"../model/logicWrapper/LModelElement\";\r\n\r\n// console.error('joiner here 3');\r\n/*\r\nexport {\r\n    LModelElement,\r\n    LAnnotation,\r\n    LAttribute,\r\n    LClass,\r\n    LClassifier,\r\n    LEnumerator,\r\n    LEnumLiteral, LModel,\r\n    LObject, LOperation,\r\n    LPackage, LParameter, LReference,\r\n    LStructuralFeature, LDataType, LTypedElement, LNamedElement, // DMap, LMap,\r\n    LValue,\r\n} from \"../model/logicWrapper/LModelElement\";*/\r\nexport {DExtEdge, DRefEdge, DVoidEdge, LGraphVertex, LRefEdge, LEdgePoint, DVoidVertex, DGraphVertex, DEdgePoint, DVertex, DEdge, LVertex, LGraph, DGraph, LVoidVertex, LVoidEdge, LEdge, LGraphElement, LExtEdge, DGraphElement} from \"../model/dataStructure/GraphDataElements\";\r\n\r\n\r\n\r\n// export {GraphDragHandler} from \"../graph/vertex/GraphDragHandler\";\r\n\r\n// console.error('iiiiiiiiiiiiiiii 11', windoww.DViewElement);\r\nexport type {WViewElement, WViewTransientProperties} from \"../view/viewElement/view\";\r\nexport {DViewTransientProperties, LViewTransientProperties, LViewElement, DViewElement} from \"../view/viewElement/view\";\r\nexport {DViewPoint, LViewPoint} from \"../view/viewPoint/viewpoint\";\r\n// console.error('iiiiiiiiiiiiiiii 12', windoww.DViewElement);\r\n\r\nexport {Action, CreateElementAction, DeleteElementAction, SetFieldAction, SetRootFieldAction, CompositeAction, ParsedAction, LoadAction, CombineHistoryAction, RedoAction, UndoAction, TRANSACTION, BEGIN, ABORT, END} from \"../redux/action/action\";\r\nexport {DState, LState, ModelStore, ViewPointState, statehistory} from \"../redux/store\";\r\nexport {Selectors as Selectorss} from \"../redux/selectors/selectors\";\r\nexport var Selectors = windoww.Selectors as (GObjectt & typeof SelType);\r\nexport {reducer, jodelInit} from \"../redux/reducer/reducer\";\r\nexport {store} from \"../redux/createStore\";\r\nexport {Debug} from \"../debugtools/debug\";\r\n\r\nexport {OCL} from \"../ocl/ocl\";\r\n\r\n\r\n\r\n\r\nclass JSXT_TYPE{\r\n    fromString(str: string, options?:\r\n        {   factory: string,\r\n            spreadFn?:Function,\r\n            unknownTagPattern?:string,\r\n            passUnknownTagsToFactory?:boolean,\r\n            unknownTagsAsString?:boolean,\r\n            arrayChildren?:boolean\r\n        }): DocString<ReactNode, 'compiled code as string, like React.CreateElement(...)'> { return ''; }\r\n    fromFile(path: string, options?:\r\n        {   factory: string,\r\n            spreadFn?:Function,\r\n            unknownTagPattern?:string,\r\n            passUnknownTagsToFactory?:boolean,\r\n            unknownTagsAsString?:boolean,\r\n            arrayChildren?:boolean\r\n        }): DocString<ReactNode, 'compiled code as string, like React.CreateElement(...)'> { return ''; }\r\n    browserifyTransform(...params: any): any {}\r\n    visitor: unknown = null;\r\n}\r\n\r\nexport const JSXT = jsxtt as any as JSXT_TYPE/*as {\r\n    fromString: (str: string, options?:\r\n        {   factory: string,\r\n            spreadFn?:Function,\r\n            unknownTagPattern?:string,\r\n            passUnknownTagsToFactory?:boolean,\r\n            unknownTagsAsString?:boolean,\r\n            arrayChildren?:boolean\r\n        }) =>string,\r\n    fromFile: (path: string, options?:\r\n        {   factory: string,\r\n            spreadFn?:Function,\r\n            unknownTagPattern?:string,\r\n            passUnknownTagsToFactory?:boolean,\r\n            unknownTagsAsString?:boolean,\r\n            arrayChildren?:boolean\r\n        }) =>string,\r\n    browserifyTransform: unknown | Function,\r\n    visitor: unknown\r\n}*/\r\n\r\n\r\n\r\nexport type Event = JQuery.Event;\r\nexport type EventBase = JQuery.EventBase;\r\nexport type EventHandlerBase<T1, T2> = JQuery.EventHandlerBase<T1, T2>;\r\nexport type MouseEventBase = JQuery.MouseEventBase;\r\nexport type MouseUpEvent = JQuery.MouseUpEvent;\r\nexport type ChangeEvent = JQuery.ChangeEvent;\r\nexport type ContextMenuEvent = JQuery.ContextMenuEvent;\r\nexport type ClickEvent = JQuery.ClickEvent;\r\nexport type MouseDownEvent = JQuery.MouseDownEvent;\r\nexport type BlurEvent = JQuery.BlurEvent;\r\nexport type KeyDownEvent = JQuery.KeyDownEvent;\r\nexport type KeyPressEvent = JQuery.KeyPressEvent;\r\nexport type DoubleClickEvent = JQuery.DoubleClickEvent;\r\nexport type DragEndEvent = JQuery.DragEndEvent;\r\nexport type DragEnterEvent = JQuery.DragEnterEvent;\r\nexport type DragEvent = JQuery.DragEvent;\r\nexport type DragExitEvent = JQuery.DragExitEvent;\r\nexport type DragLeaveEvent = JQuery.DragLeaveEvent;\r\nexport type DragOverEvent = JQuery.DragOverEvent;\r\nexport type DragStartEvent = JQuery.DragStartEvent;\r\nexport type DropEvent = JQuery.DropEvent;\r\nexport type FocusEvent = JQuery.FocusEvent;\r\nexport type FocusInEvent = JQuery.FocusInEvent;\r\nexport type FocusOutEvent = JQuery.FocusOutEvent;\r\nexport type FocusEventBase = JQuery.FocusEventBase;\r\n\r\n// todo: continua\r\n\r\n\r\n// window (NB: most of them should be replaced by RuntimeAccessibleClass)\r\nlet w: any = window;/*\r\nw.$ = $;\r\nw.Log = Log;\r\nw.U = U;\r\nw.Size = Size;\r\nw.ISize = ISize;\r\nw.GraphSize = GraphSize;\r\nw.Point = Point;\r\nw.IPoint = IPoint;\r\nw.GraphPoint = GraphPoint;\r\nw.$s = $s;\r\n*/\r\nexport {\r\n    TextArea, Select, Input, Image, Edge, DamEdge,\r\n    GraphsContainerComponent,\r\n    Overlap as OverlapComponent,\r\n    GraphsContainer,\r\n    GraphElement,\r\n    Vertex, VoidVertex, EdgePoint,\r\n    Graph, GraphVertex,\r\n    Field,\r\n    DefaultNode,\r\n    GraphElementComponent,\r\n    VertexComponent,\r\n    DefaultNodeComponent,\r\n    // DockLayoutComponent,\r\n    ColorScheme, Edges,\r\n    EdgeComponent,\r\n    DataOutputComponent, LoggerComponent\r\n} from './components'\r\n\r\n//export {createOrOpenModelTab} from \"../components/abstract/DockLayoutComponent\"; // needs to be after docklayoutcomponent or to split the file\r\nexport {fakeExport} from './ExecuteOnRead';\r\nconsole.info('joiner loaded');\r\nclass Joiner{\r\n    // just to help the file search\r\n}\r\n\r\n","import React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport {U,\r\n    DState, DPointerTargetable, DViewElement, GObject, LPointerTargetable, LViewElement, Pointer} from \"../../../joiner\";\r\n\r\n\r\nfunction OclEditorComponent(props: AllProps) {\r\n    const view = props.view;\r\n    const readOnly = U.getDefaultViewsID().includes(view.id);\r\n\r\n    const change = (value: string|undefined) => {\r\n        if (value !== undefined) view.query = value;\r\n    }\r\n\r\n    return <div style={{height: '5em'}}>\r\n        <label className={'ms-1'}>OCL Editor</label>\r\n        <Editor className={'mx-1'} onChange={change} options={{readOnly: readOnly}}\r\n                defaultLanguage={'js'} value={view.query} />\r\n    </div>;\r\n}\r\ninterface OwnProps { viewid: Pointer<DViewElement, 1, 1, LViewElement>; }\r\ninterface StateProps { view: LViewElement }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.view = LViewElement.fromPointer(ownProps.viewid);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const OclEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(OclEditorComponent);\r\n\r\nexport const OclEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <OclEditorConnected {...{...props, children}} />;\r\n}\r\n\r\nOclEditorComponent.cname = \"OclEditorComponent\";\r\nOclEditorConnected.cname = \"OclEditorConnected\";\r\nOclEditor.cname = \"OclEditor\";\r\nexport default OclEditor;\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 133;","import type {\r\n    DAttribute,\r\n    DClass,\r\n    DGraph,\r\n    DClassifier,\r\n    DEnumerator,\r\n    DGraphElement,\r\n    DRefEdge,\r\n    DVoidVertex,\r\n    GObject,\r\n    DState,\r\n    LClass,\r\n    LEnumerator,\r\n    LGraphElement,\r\n    LOperation,\r\n    LPackage,\r\n    LRefEdge,\r\n    LViewElement,\r\n    LVoidVertex,\r\n    Pointer,\r\n} from \"../../joiner\";\r\nimport {\r\n    AbstractConstructor,\r\n    Constructor,\r\n    LModelElement,\r\n    DModel, LModel,\r\n    DModelElement, DNamedElement, DObject,\r\n    DPointerTargetable, DValue,\r\n    DViewElement, LNamedElement, LObject,\r\n    Log,\r\n    LPointerTargetable, LValue,\r\n    MyProxyHandler, OCL,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    store,\r\n    U, windoww, Pointers, DViewPoint, LViewPoint, Dictionary, DUser\r\n} from \"../../joiner\";\r\nimport {EdgeOptions} from \"../store\";\r\n\r\nenum ViewEClassMatch { // this acts as a multiplier for explicit priority\r\n    MISMATCH = 0,\r\n    IMPLICIT_MATCH = 1,\r\n    INHERITANCE_MATCH = 2,\r\n    EXACT_MATCH = 3,\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class Selectors{\r\n    public static cname: string = \"Selectors\";\r\n\r\n    static getSelected(): Dictionary<Pointer<DUser>, Pointer<DModelElement, 0, 1, LModelElement>> {\r\n        const state = store.getState();\r\n        return state.selected;\r\n    }\r\n\r\n    static getRoom(): string {\r\n        const state = store.getState();\r\n        return state.room;\r\n    }\r\n\r\n    static getActiveModel(): null|LModel {\r\n        let metamodel: null|LModel;\r\n        let state: DState & GObject = store.getState();\r\n        const selected = state._lastSelected?.modelElement;\r\n        if(selected) {\r\n            const me = LModelElement.fromPointer(selected)\r\n            metamodel = (me) ? me.model : null;\r\n        } else metamodel = null;\r\n        return metamodel;\r\n    }\r\n\r\n    public static getLastSelectedModel<RET extends {m1?:LModel, m2?:LModel, model?:LModel, element?:LModelElement}>(state?: DState): RET {\r\n        state = state || store.getState();\r\n        let me = state._lastSelected?.modelElement;\r\n        if (!me) return {} as RET;\r\n        let ret: RET = {element: LPointerTargetable.fromPointer(me, state)} as RET;\r\n        ret.model = ret.element!.model\r\n        if (ret.model.isMetamodel) ret.m2 = ret.model;\r\n        else {\r\n            ret.m1 = ret.model;\r\n            ret.m2 = ret.m1.instanceof;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    static getAllViewElements(): DViewElement[] {\r\n        // return Object.values(store.getState().idlookup).filter(v => v.className === DViewElement.name) as DViewElement[];\r\n        let state: DState & GObject = store.getState();\r\n        const ptrs: Pointer<DViewElement, 0, 'N'> = Object.values((state).viewelements);\r\n        let views: DViewElement[] = ptrs.map<DViewElement>( (ptr) => state.idlookup[ptr] as DViewElement);\r\n        return views;\r\n    }\r\n    //Giordano: start\r\n\r\n    public static getViewpoints() : LViewPoint[] {\r\n        const state: DState & GObject = store.getState();\r\n        return LViewPoint.fromPointer(state.viewpoints);\r\n    }\r\n    public static getViewpoint() : LViewPoint  {\r\n        const state: DState & GObject = store.getState();\r\n        return LViewPoint.fromPointer(state.viewpoint);\r\n    }\r\n\r\n    public static getObjects(): LObject[] {\r\n        let state: DState & GObject = store.getState();\r\n        const ptrs: Pointer<DObject, 0, 'N'> = Object.values((state).objects);\r\n        const dObjects: DObject[] = ptrs.map<DObject>( (ptr) => state.idlookup[ptr] as DObject);\r\n        const lObjects: LObject[] = [];\r\n        for(let dObject of dObjects) {\r\n            lObjects.push(LObject.fromPointer(dObject.id));\r\n        }\r\n        return lObjects;\r\n    }\r\n    public static getValues(): LValue[] {\r\n        let state: DState & GObject = store.getState();\r\n        const ptrs: Pointer<DValue, 0, 'N'> = Object.values((state).values);\r\n        const dValues: DValue[] = ptrs.map<DValue>( (ptr) => state.idlookup[ptr] as DValue);\r\n        const lValues: LValue[] = [];\r\n        for(let dValue of dValues) {\r\n            if(dValue?.id) {\r\n                lValues.push(LValue.fromPointer(dValue.id));\r\n            }\r\n        }\r\n        return lValues;\r\n    }\r\n\r\n    public static getDeleted(): string [] {\r\n        const state: DState & GObject = store.getState();\r\n        return state.deleted;\r\n    }\r\n\r\n    public static getState(): any {\r\n        const state: DState & GObject = store.getState();\r\n        return state;\r\n    }\r\n\r\n    static removeEdge(id: number): EdgeOptions[] {\r\n        const state: DState & GObject = store.getState();\r\n        const edges: EdgeOptions[] = [];\r\n        for(let edge of state.edges) {\r\n            if(edge.id !== id) {\r\n                edges.push(edge);\r\n            }\r\n        }\r\n        return edges;\r\n    }\r\n\r\n    static getAllPrimitiveTypes(): DClassifier[] {\r\n        let state: DState & GObject = store.getState();\r\n        const ptrs: Pointer<DClassifier, 0, 'N'> = Object.values((state).primitiveTypes);\r\n        const classifiers: DClassifier[] = ptrs.map<DClassifier>( (ptr) => state.idlookup[ptr] as DClassifier);\r\n        return classifiers;\r\n    }\r\n    static getFirstPrimitiveTypes(): DClassifier {\r\n        return Selectors.getAllPrimitiveTypes()[0];\r\n    }\r\n    static getRefEdges(): DRefEdge[] {\r\n        const state: DState & GObject = store.getState();\r\n        const pointers: Pointer<DRefEdge, 0, 'N', LRefEdge> = Object.values((state).refEdges);\r\n        const dRefEdges: DRefEdge[] = pointers.map<DRefEdge>( (ptr) => state.idlookup[ptr] as DRefEdge);\r\n        return dRefEdges;\r\n    }\r\n    static getField(field: string): string[] {\r\n        let state: DState & GObject = store.getState();\r\n        const pointers: Pointer<DModelElement, 0, 'N'> = Object.values((state)[field]);\r\n        return pointers;\r\n    }\r\n\r\n    static getAllAttributes(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).attributes);\r\n    }\r\n    static getAllEnumLiterals(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).enumliterals);\r\n    }\r\n    static getAllReferences(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).references);\r\n    }\r\n    static getAllReferenceEdges(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).refEdges);\r\n    }\r\n    static getAllClasses(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).classs);\r\n    }\r\n    static getReturnTypes(): LClass[] {\r\n        const state: DState = store.getState();\r\n        return LPointerTargetable.from(Object.values((state).returnTypes));\r\n    }\r\n\r\n    static getAllClassesWithoutPrimitive(): string[] {\r\n        // this solution does not look good. what if a primitive type is inserted at runtime in between?\r\n        // coould reach the same goal by taking all Classes of a model (m2), excluding classes from other models (types are classes from m3 model)\r\n        const state: DState = store.getState();\r\n        const classList: string[] = Object.values((state).classs);\r\n        classList.splice(0, Selectors.getAllPrimitiveTypes().length);\r\n        /* todo: need to change it in something like this once cross-references between models and instances are implemented\r\n        const m2: LModel;\r\n        m2.isInstanceOf = m3 as LModel;\r\n        m2.isInstanceOf.classes;*/\r\n\r\n        return classList;\r\n    }\r\n\r\n    static getAllEnumerators(flag = false): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).enumerators);\r\n    }\r\n    static getAllPackages(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).packages);\r\n    }\r\n\r\n    static getAllParameters(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).parameters);\r\n    }\r\n    static getAllOperations(): string[] {\r\n        const state: DState = store.getState();\r\n        return Object.values((state).operations);\r\n    }\r\n\r\n    static getDElement<T extends DModelElement>(pointer: string): T {\r\n        const state: DState & GObject = store.getState();\r\n        const dElement: T = state.idlookup[pointer] as T;\r\n        return dElement;\r\n    }\r\n\r\n    static getAllMetamodels(): LModel[] {\r\n        const state: DState = store.getState();\r\n        const dModels = Object.values((state).m2models);\r\n        return LModel.fromPointer(dModels);\r\n    }\r\n\r\n    static getAllModels(): LModel[] {\r\n        const state: DState = store.getState();\r\n        const dModels = Object.values((state).m1models);\r\n        return LModel.fromPointer(dModels);\r\n    }\r\n\r\n    //Giordano: end\r\n\r\n    static getVertex<W extends boolean = true, RP extends boolean = true>(wrap?: W /* = true */, resolvePointers?: RP /**/):\r\n        W extends false ? (RP extends false ? Pointer<DVoidVertex, 1, 1, LVoidVertex>[] : DVoidVertex[]) : LVoidVertex[] {\r\n        const state: DState = store.getState();\r\n        let ptrs: Pointer<DVoidVertex>[] = [];\r\n\r\n        U.ArrayMerge0(false, ptrs,\r\n            // Object.values(state.graphs || {}),\r\n            Object.values(state.voidvertexs || {}),\r\n            Object.values(state.vertexs || {}),\r\n            Object.values(state.graphvertexs || {}),\r\n            Object.values(state.edgepoints || {}));\r\n\r\n        console.log('selector getvertex: ', {ptrs, g: Object.values(state.graphs || {}), vv:Object.values(state.voidvertexs || {}), v:Object.values(state.vertexs || {}), gv:Object.values(state.graphvertexs || {}), ep:Object.values(state.edgepoints || {})});\r\n        if (wrap === undefined || wrap === true) return ptrs.map( p => DPointerTargetable.wrap(p)) as any[];\r\n        if (resolvePointers === undefined || resolvePointers === true) return ptrs.map( r => state.idlookup[r]) as any[];\r\n        return ptrs as any[];\r\n    }\r\n\r\n    static getAll<D extends DPointerTargetable, L extends LPointerTargetable, DT extends typeof DPointerTargetable = typeof DPointerTargetable,\r\n        W extends undefined | true | false = false, RP extends undefined | true | false = true, RET = W extends false ? (RP extends false ? Pointer<D, 1, 1, L> : D) : L>\r\n        (Classe?: DT, condition?: (e:RET) => boolean, state?: DState, resolvePointers?: RP /**/, wrap?: W /* = true */): RET[] {\r\n        if (!state) state = store.getState();\r\n        let GClass = (Classe as GObject) || {name:\"idlookup\"};\r\n        const className: string = (GClass?.staticClassName || GClass.cname).toLowerCase();\r\n        const allIdByClassName: Pointer<D, 1, 1, L>[]\r\n            = (state as GObject)[className]\r\n            || (state as GObject)[className.substr(1)]\r\n            || (state as GObject)[className + 's']\r\n            || (state as GObject)[className.substr(1) + 's'];\r\n        Log.exDev(!allIdByClassName, 'cannot find store key:', {state, className, Classe});\r\n        let allDByClassName: D[] | null = null;\r\n        let allLByClassName: L[] | null = null;\r\n        if (resolvePointers || wrap) {\r\n            allDByClassName = allIdByClassName.map( (e) => (state as DState).idlookup[e] ) as D[];\r\n            if (wrap) {\r\n                allLByClassName = allDByClassName.map( e => DPointerTargetable.wrap(e)) as any as L[];\r\n            }\r\n        }\r\n        let ret: RET[] = (resolvePointers || wrap ? (wrap ? allLByClassName : allDByClassName) : allIdByClassName) as any[] as RET[];\r\n        if (!Array.isArray(ret)) ret = Object.values(ret).filter(e => e instanceof Object) as RET[];\r\n        if (condition) return ret.filter( e => condition(e));\r\n        return ret;\r\n    }\r\n/*\r\n    static getModels(condition?: (m: DModel) => boolean): DModel[] {\r\n        /*\r\n        const className: Pointer<DPointerTargetable, 1, 1> = DViewElement.name.substr(1).toLowerCase() + 's';\r\n        const allByClassName: DPointerTargetable[] = state[className as string];\r\n        let models: DModel[] = state[className as string].map((mid) => state.idlookup[mid as string]) as DModel[];\r\n        if (condition) models = models.filter(condition);\r\n        return models; * /\r\n        return Selectors.getAll(DModel, undefined, undefined, resolvePointers, wrap); }*/\r\n\r\n    static getModel(name: string, caseSensitive: boolean = false, wrap: boolean = false): DModel | LModel | null {\r\n        if (!caseSensitive) name = name.toLowerCase();\r\n        let ret = Selectors.getAll<DModel, LModel>(DModel, (d) => (caseSensitive ? d.name : d.name.toLowerCase()) === name, undefined, true, wrap as any)[0];\r\n        return ret;\r\n    }\r\n\r\n    static getByName(classe: typeof DPointerTargetable, name: string, caseSensitive: boolean = false, wrap: boolean = false): DPointerTargetable | LPointerTargetable | null {\r\n        return Selectors.getByField(classe, 'name', name, caseSensitive, wrap); }\r\n\r\n    static getByField(classe: typeof DPointerTargetable, field: string, value: string, caseSensitive: boolean = false, wrap: boolean = false): DPointerTargetable | LPointerTargetable | null {\r\n        if (!caseSensitive) value = value.toLowerCase();\r\n        let condition = (d: any) => {\r\n            let ret = (caseSensitive ? d[field] : d[field]?.toLowerCase()) === value;\r\n            console.log('filtering getall by field:', {d, dfield:d[field], value, ret});\r\n            return ret;\r\n        }\r\n        let ret = Selectors.getAll(classe, condition, undefined, true, wrap as any)[0];\r\n        return ret; }\r\n\r\n    static getViews(condition?: (m: DModel) => boolean): DViewElement[] { return Selectors.getAll(DViewElement); }\r\n\r\n\r\n\r\n    private static queryJS(model: LModel, query: string): LPointerTargetable[] {\r\n        try {\r\n            return eval(query);\r\n        } catch (e) { return []; }\r\n    }\r\n    /*static getCurrentView(data: LModelElement): DViewElement {\r\n        Log.exDevv('todo');\r\n        return undefined as any;\r\n    }*/\r\n\r\n\r\n    // 2 = explicit exact match (===), 1 = matches a subclass, 0 = implicit match (any *), -1 = not matches\r\n    private static matchesOclCondition(v: DViewElement, data: DModelElement | LModelElement): ViewEClassMatch.MISMATCH | ViewEClassMatch.IMPLICIT_MATCH | ViewEClassMatch.EXACT_MATCH {\r\n        if (!v.query) return ViewEClassMatch.IMPLICIT_MATCH;\r\n        const query = v.query;\r\n        const viewpoint = Selectors.getViewpoint();\r\n        if(v.viewpoint !== viewpoint.id) { return ViewEClassMatch.IMPLICIT_MATCH; }\r\n        let constructors: Constructor[] = RuntimeAccessibleClass.getAllClasses() as (Constructor|AbstractConstructor)[] as Constructor[];\r\n        try {\r\n            const flag = OCL.filter(false, \"src\", [data], query, constructors);\r\n            if(flag.length > 0) return ViewEClassMatch.EXACT_MATCH;\r\n            else return ViewEClassMatch.MISMATCH;\r\n        } catch (e) { console.error('invalid ocl query'); }\r\n        return ViewEClassMatch.MISMATCH;\r\n    }\r\n\r\n\r\n    private static matchesMetaClassTarget(v: DViewElement, data: DModelElement | DGraphElement): ViewEClassMatch {\r\n        if (!v.appliableToClasses || !v.appliableToClasses.length) return ViewEClassMatch.IMPLICIT_MATCH;\r\n        if (!data) return ViewEClassMatch.MISMATCH;\r\n        let ThisClass: typeof DPointerTargetable = RuntimeAccessibleClass.get(data?.className);\r\n        Log.exDev(!ThisClass, 'unable to find class type:', {v, data}); // todo: v = view appliable to DModel, data = proxy<LModel>\r\n        let gotSubclassMatch: boolean = false;\r\n        for (let classtarget of v.appliableToClasses) {\r\n            const ClassTarget: typeof DPointerTargetable = RuntimeAccessibleClass.get(classtarget);\r\n            if (ThisClass === ClassTarget) return ViewEClassMatch.EXACT_MATCH; // explicit exact match\r\n            if (!gotSubclassMatch && U.classIsExtending(ThisClass, ClassTarget)) gotSubclassMatch = true; // explicit subclass match\r\n            if (gotSubclassMatch) return ViewEClassMatch.INHERITANCE_MATCH;\r\n        }\r\n        return ViewEClassMatch.MISMATCH;\r\n }\r\n\r\n    private static isOfSubclass(data: DPointerTargetable, classTarget: string | typeof DPointerTargetable, acceptEquality: boolean = false): boolean {\r\n        let ThisClass: typeof DPointerTargetable = RuntimeAccessibleClass.get(data.className);\r\n        Log.exDev(!ThisClass, 'isOfSubclass() unable to find class type:', {data});\r\n        const ClassTarget: typeof DPointerTargetable = typeof classTarget === \"string\"? RuntimeAccessibleClass.get(classTarget) : classTarget;\r\n        if (ThisClass === ClassTarget) return acceptEquality;\r\n        return U.classIsExtending(ThisClass, ClassTarget);\r\n    }\r\n\r\n\r\n\r\n    private static scoreView(v1: DViewElement, data: LModelElement | undefined, node: DGraphElement | undefined, graph: LGraphElement, sameViewPointViews: Pointer<DViewElement, 1, 1>[] = []): number {\r\n        let datascore: number = 1;\r\n        let nodescore: number = 1;\r\n        if (data) {// 1° priority: matching by EClass type\r\n            let v1MatchingEClassScore: ViewEClassMatch = this.matchesMetaClassTarget(v1, data?.__raw);\r\n            // Log.l('score view:', {v1, data, v1MatchingEClassScore});\r\n            if (v1MatchingEClassScore === ViewEClassMatch.MISMATCH) return ViewEClassMatch.MISMATCH;\r\n            // 2° priority: by ocl condition matching\r\n            let v1OclScore = Selectors.matchesOclCondition(v1, data);\r\n            if (v1OclScore === ViewEClassMatch.MISMATCH) return ViewEClassMatch.MISMATCH;\r\n            // 3° priority by sub-view\r\n            let v1SubViewScore = Selectors.matchesOclCondition(v1, data);\r\n            if (v1SubViewScore === ViewEClassMatch.MISMATCH) return ViewEClassMatch.MISMATCH;\r\n            // second priority: matching by viewpoint / subViews\r\n            datascore = (v1MatchingEClassScore * v1OclScore * v1SubViewScore);\r\n        }\r\n        if (node){\r\n            // 1° priority: matching by DGraphElement type\r\n            let v1MatchingEClassScore: ViewEClassMatch = this.matchesMetaClassTarget(v1, node);\r\n            nodescore = 1; // todo: ocl by node position or other node info\r\n        }\r\n        return datascore * nodescore * v1.explicitApplicationPriority;\r\n    }\r\n\r\n\r\n    static getAppliedViews(data: LModelElement|undefined, hisnode: DGraphElement | undefined, graph: LGraphElement,\r\n                           selectedViewId: Pointer<DViewElement, 0, 1, LViewElement>, parentViewId: Pointer<DViewElement, 0, 1, LViewElement>): Scored<DViewElement>[] {\r\n        const state : DState = store.getState();\r\n        const allViews: DViewElement[] = [...Selectors.getAllViewElements()];\r\n        const selectedView: DViewElement | null = null; // selectedViewId ? state.idlookup[selectedViewId] as DViewElement : null;\r\n        const parentView: DViewElement | null = parentViewId ? state.idlookup[parentViewId] as DViewElement : null;\r\n        const sameViewPointSubViews: Pointer<DViewElement, 1, 1>[] = parentView ? parentView.subViews : []; // a viewpoint is a simple view that is targeting a model\r\n        if (selectedView) U.arrayRemoveAll(allViews, selectedView);\r\n        let sortedPriority: Scored<DViewElement>[] = allViews.map(\r\n            // v => new Scored<DViewElement>(Selectors.scoreView(v, data as any as DModelElement, hisnode, graph, sameViewPointSubViews), v)) as Scored<DViewElement>[];\r\n            (v) => {\r\n                return new Scored<DViewElement>(Selectors.scoreView(v, data, hisnode, graph, sameViewPointSubViews), v);}\r\n        ) as Scored<DViewElement>[];\r\n        sortedPriority.sort( (e1, e2) => e2.score - e1.score);\r\n        // todo: prioritize views \"children\" of the view of the graph, so they will display differnet views for the same element in different graphs\r\n        // then sort by  view selector matching: on classtype (eattribute, eoperation, eclass...), on values, upperbound...\r\n        if (selectedView) sortedPriority = [new Scored<DViewElement>('manually assigned' as any, selectedView), ...sortedPriority];\r\n        // sortedPriority = sortedPriority.map( s=> s.element) as any] : sortedPriority.map( s=> s.element) as any;\r\n\r\n        // Log.exDevv('viewscores', {data, sp:sortedPriority});\r\n        return sortedPriority;\r\n    }\r\n\r\n    static getAllMP(state?: DState): DModelElement[] {\r\n        if (!state) state = store.getState();\r\n        let allD: DPointerTargetable[] = Object.values(state.idlookup);\r\n        return allD.filter( (d: DPointerTargetable) => U.isObject(d) && Selectors.isOfSubclass(d, DModelElement)) as DModelElement[]; }\r\n\r\n    static toObject<D extends DPointerTargetable>(ptrs: Pointer<D>[], state?: DState):D[] {\r\n        if (!state) state = store.getState();\r\n        return ptrs.map(p => (state as DState).idlookup[p]) as D[]; }\r\n\r\n    static wrap<D extends DPointerTargetable, L extends LPointerTargetable>(arr: (Pointer<D, 1, 1, L> | D)[], state?: DState): L[] {\r\n        if (!arr.length) return [];\r\n        if (!state) state = store.getState();\r\n        let objarr: D[];\r\n        if (typeof arr[0] === \"string\") { objarr = Selectors.toObject(arr as string[], state); }\r\n        else objarr = arr as D[];\r\n        return objarr.map(p => RuntimeAccessibleClass.wrap(p)) as L[]; }\r\n\r\n    static unwrap<D extends DPointerTargetable, L extends LPointerTargetable>(arr:L[]): D[] { return arr.map( (a)=> a.__raw) as any[]; }\r\n    static getSubNodeElements(forGraph: Pointer<DGraph, 1, 1>, asPointers: boolean = false, wrap: boolean = false): Pointer<DGraphElement>[] | DGraphElement[] | LGraphElement[] {\r\n        const state : DState = store.getState();\r\n        const g: DGraph = state.idlookup[forGraph] as DGraph;\r\n        if (asPointers) return g.subElements;\r\n        const subelements: DGraphElement[] = g.subElements.map( geid => state.idlookup[geid]) as DGraphElement[];\r\n        if (wrap) return subelements.map<LGraphElement>( (ge) => MyProxyHandler.wrap(ge));\r\n        return subelements; }\r\n\r\n\r\n\r\n\r\n    //// giordano part\r\n\r\n\r\n\r\n    public static getAllPackageClasses(id: string): LClass[] {\r\n        const data = MyProxyHandler.wrap(id) as GObject;\r\n        let lPackage : LPackage | undefined;\r\n        const classes: LClass[] = [];\r\n        if (data.className === \"DReference\") {\r\n            const lClass: LClass = MyProxyHandler.wrap(data.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if (data.className === \"DParameter\") {\r\n            const lOperation: LOperation = MyProxyHandler.wrap(data.father);\r\n            const lClass: LClass = MyProxyHandler.wrap(lOperation.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if (data.className === \"DOperation\") {\r\n            const lClass: LClass = MyProxyHandler.wrap(data.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if (lPackage) {\r\n            for(let classifier of lPackage.classifiers) {\r\n                const lClassifier: LClass | LEnumerator = MyProxyHandler.wrap(classifier);\r\n                if(lClassifier.className === \"DClass\") classes.push(lClassifier as LClass);\r\n            }\r\n        }\r\n        return classes;\r\n    }\r\n    public static getAllPackageEnumerators(id: string): LEnumerator[] {\r\n        const data = MyProxyHandler.wrap(id) as GObject;\r\n        let lPackage : LPackage | undefined;\r\n        const enumerators: LEnumerator[] = [];\r\n        if(data.className === \"DAttribute\") {\r\n            const lClass: LClass = MyProxyHandler.wrap(data.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if(data.className === \"DParameter\") {\r\n            const lOperation: LOperation = MyProxyHandler.wrap(data.father);\r\n            const lClass: LClass = MyProxyHandler.wrap(lOperation.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if(data.className === \"DOperation\") {\r\n            const lClass: LClass = MyProxyHandler.wrap(data.father);\r\n            lPackage = MyProxyHandler.wrap(lClass.father);\r\n        }\r\n        if(lPackage) {\r\n            for(let classifier of lPackage.classifiers) {\r\n                const lClassifier: LClass | LEnumerator = MyProxyHandler.wrap(classifier);\r\n                if(lClassifier.className === \"DEnumerator\") enumerators.push(lClassifier as LEnumerator);\r\n            }\r\n        }\r\n        return enumerators;\r\n    }\r\n}\r\n\r\nclass Scored<T extends GObject> {\r\n    constructor(public score: number, public element: T) {}\r\n}\r\n","import {\r\n    Json,\r\n    Log,\r\n\r\n\r\n    DModelElement,\r\n    LModelElement,\r\n    DModel,\r\n    LModel,\r\n    DValue,\r\n    LValue,\r\n    DNamedElement,\r\n    LNamedElement,\r\n    DObject,\r\n    LObject,\r\n    DEnumerator,\r\n    LEnumerator,\r\n    DEnumLiteral,\r\n    LEnumLiteral,\r\n    DAttribute,\r\n    LAttribute,\r\n    DReference,\r\n    LReference,\r\n    DStructuralFeature,\r\n    LStructuralFeature,\r\n    DClassifier,\r\n    LClassifier,\r\n    DDataType,\r\n    LDataType,\r\n    DClass,\r\n    LClass,\r\n    DParameter,\r\n    LParameter,\r\n    DOperation,\r\n    LOperation,\r\n    DPackage,\r\n    LPackage,\r\n    DTypedElement,\r\n    LTypedElement,\r\n    DAnnotation,\r\n    LAnnotation,\r\n    EJavaObject,\r\n    DMap,\r\n    LMap,\r\n    DFactory_useless_,\r\n    LFactory_useless_,\r\n    AttribETypes,\r\n    U,\r\n    Pointer,\r\n    CreateElementAction,\r\n    Selectors,\r\n    GObject,\r\n    Dictionary,\r\n    PointedBy,\r\n    LPointerTargetable,\r\n    windoww,\r\n    SetRootFieldAction,\r\n    Constructors,\r\n    DocString,\r\n    store,\r\n    SetFieldAction,\r\n    Pointers,\r\n    DPointerTargetable\r\n\r\n} from \"../joiner\";\r\n\r\ntype RET<T = boolean> = T | Promise<T>;\r\ntype Ret = RET;\r\n\r\nclass SavePack{\r\n    model: string;\r\n    vertexpos: string;\r\n    view: string;\r\n    constructor(model: string='', vertexpos: string='', view:string='') {\r\n        this.model = model;\r\n        this.vertexpos = vertexpos;\r\n        this.view = view;\r\n    }\r\n}\r\n\r\ntype JsonSavePack = {[key in keyof SavePack]: Json | null }\r\n\r\n\r\nexport abstract class IStorage{\r\n    static get():IStorage { return Log.exx(\"IStorage.get (static) should be overridden\"); }\r\n    public prefix: string;\r\n    public autosave: boolean;\r\n    constructor(prefix: string, autosave: boolean) {\r\n        this.prefix = prefix;\r\n        this.autosave = autosave;\r\n    }\r\n\r\n\r\n    public del(key: string | number): boolean{\r\n        let isOverwrite = this.get(key) !== null;\r\n        this.set(key, '');\r\n        return isOverwrite; }\r\n    public abstract set(key: string | number, val: string | any): RET;\r\n    get<T extends boolean>(key: string | number, parse: T = false as any): T extends false ? null | string : null | any{ return Log.exx(\"IStorage.get should be overridden\"); }\r\n\r\n    protected serialize(val: any): string { // serialize\r\n        try { return JSON.stringify(val); } catch(e){ return \"\"+val; }\r\n    }\r\n    protected deserialize(val: string): any{ // de-serialize\r\n        try { return JSON.parse(val); } catch(e){ return val; }\r\n    }\r\n    protected set0(val: any): string { return this.serialize(val); }\r\n    protected get0(val: any): string { return this.deserialize(val); }\r\n    protected parse(val: any): string { return this.deserialize(val); }\r\n}\r\n\r\nexport class LocalStorage extends IStorage{\r\n    public static get():LocalStorage {return new LocalStorage(\"_j\", true); }\r\n    private constructor (prefix: string, autosave: boolean) { super(prefix, autosave); }\r\n\r\n    private static KeyList= {lastOpenedModel: \"lastOpenedModel\",lastOpenedView: \"lastOpenedView\",lastOpenedPosition: \"lastOpenedPosition\",}\r\n\r\n\r\n    get<T extends boolean>(key: string | number, parse: T = false as any): T extends false ? null | string : null | any{\r\n        let val = localStorage.getItem(this.prefix+key);\r\n        return parse ? this.parse(val) : val;\r\n    }\r\n\r\n    set(key?: string | number, val?: string | any): boolean {\r\n        val = this.serialize(val);\r\n        // let isOverwrite = localStorage.getItem(this.prefix+key);\r\n        localStorage.set(this.prefix+key, val);\r\n        return true;\r\n    }\r\n\r\n\r\n    public getLastOpened(modelNumber: 1 | 2): SavePack {\r\n        let modelname = \"m\" + modelNumber + \"_\";\r\n        const ret: SavePack = new SavePack();\r\n        ret.model = this.get(modelname + LocalStorage.KeyList.lastOpenedModel, false) || '';\r\n        ret.view = this.get(modelNumber + LocalStorage.KeyList.lastOpenedView, false) || '';\r\n        ret.vertexpos = this.get(modelNumber + LocalStorage.KeyList.lastOpenedPosition, false) || '';\r\n        return ret; }\r\n\r\n    public deleteLastOpened(modelNumber: 1 | 2): void { this.setLastOpened(modelNumber, '', '', ''); }\r\n\r\n    public setLastOpened(modelNumber: 1 | 2, model: string = '', view: string = '', vertex: string = ''): void {\r\n        let modelname = \"m\" + modelNumber + \"_\";\r\n        if (model) this.set(modelname + LocalStorage.KeyList.lastOpenedModel, model);\r\n        else this.del(modelname +  LocalStorage.KeyList.lastOpenedModel);\r\n        if (view) this.set(modelname + LocalStorage.KeyList.lastOpenedView, view);\r\n        else this.del(modelname +  LocalStorage.KeyList.lastOpenedView);\r\n        if (vertex) this.set(modelname + LocalStorage.KeyList.lastOpenedPosition, vertex);\r\n        else this.del(modelname +  LocalStorage.KeyList.lastOpenedPosition); }\r\n\r\n\r\n}\r\n\r\nexport class EcoreParser{\r\n    static supportedEcoreVersions = [\"http://www.eclipse.org/emf/2002/Ecore\"];\r\n    static prefix:string = '@';\r\n\r\n    static parse(ecorejson: GObject | string | null, isMetamodel: boolean, filename: string | undefined, persist: boolean = true): DModelElement[]{\r\n        if (!ecorejson) return [];\r\n        let parsedjson: GObject;\r\n        if (typeof ecorejson === \"string\") try { parsedjson = JSON.parse(ecorejson); } catch(e) { windoww.temp = ecorejson; Log.exx(\"error while parsing json:\", e, ecorejson.substring(0, 1000)); throw e; }\r\n        else parsedjson = ecorejson;\r\n\r\n        console.log(\"root parse\", ecorejson);\r\n\r\n        isMetamodel = !!parsedjson[ECoreRoot.ecoreEPackage];\r\n\r\n        Constructors.pause();\r\n            let parsedElements: DModelElement[] = isMetamodel ? EcoreParser.parseM2Model(parsedjson, filename) : EcoreParser.parseM1Model(parsedjson, undefined, filename);\r\n            console.warn(\"parse.result D\", parsedElements);\r\n            this.LinkAllNamesToIDs(parsedElements);\r\n            this.fixNamingConflicts(parsedElements);\r\n        Constructors.resume();\r\n        if (persist) {\r\n            CreateElementAction.newBatch(parsedElements);\r\n        }\r\n        // update m1 object pointers (need them to be persistent to navigate .fathers and get ecore pointer strings using LObject)\r\n        setTimeout(() => this.fixObjectPointers(parsedElements), 1);\r\n\r\n        windoww.tmpparse = () => LPointerTargetable.wrapAll(parsedElements);\r\n\r\n        this.tempfix_untilopennewtabisdone(parsedElements, isMetamodel);\r\n\r\n        console.log('parsedElem', parsedElements)\r\n        return parsedElements;\r\n    }\r\n\r\n    private static fixObjectPointers(parsedElements: DModelElement[]): void {\r\n        let dobjects: DObject[] = parsedElements.filter(e=>e.className === DObject.cname) as any[];\r\n        let values: DValue[] = parsedElements.filter(e=>e.className === DValue.cname) as any[];\r\n        let lobjects: LObject[] = LPointerTargetable.fromArr(dobjects);\r\n        let m1pointermap: Dictionary<string, LObject> = { }; //    \"//@rootrefname.index@/refname.index/@....etc\"\r\n        for (let o of lobjects){ m1pointermap[o.ecorePointer()] = o; }\r\n        for (let v of values) {\r\n            if (v.isMirage) continue;\r\n            let modified = false;\r\n            let newvalues = v.values.map((e) => {\r\n                if (!m1pointermap[e as any]) return e;\r\n                modified = true;\r\n                console.log(\"m1 pointer resolved:\", {from:e, to:m1pointermap[e as any].id});\r\n                return m1pointermap[e as any].id;\r\n            });\r\n            if (!modified) continue;\r\n            let lv: LValue = LPointerTargetable.from(v);\r\n            lv.values = newvalues;\r\n        }\r\n\r\n    }\r\n    private static tempfix_untilopennewtabisdone(parsedElements: DModelElement[], isMetamodel: boolean) {\r\n        // replaces current model with parsed model. this needs to be removed to open a new tab later on.\r\n        let model: DModel = null as any;\r\n        for (let elem of parsedElements) { if (elem.className === DModel.cname) { model = elem as any; break; } }\r\n        SetRootFieldAction.new(isMetamodel ? \"m2models\" : \"m1models\", model.id, '+=', false); // it is pointer but no need to update pointedby's this time\r\n    }\r\n\r\n    // resolve eCore pointers to Jodel pointers and set the PointedBy\r\n    private static LinkAllNamesToIDs(parsedElements: DModelElement[]): void {\r\n        // todo: è post-parse che legga i nomi e assegni gli id aggiustando le references e extends settati by name. trova i campi temporanei cercando i @ts-ignore\r\n        // update mref, attribute, parameter type\r\n        // update operation exception\r\n        // replace those names with id's\r\n\r\n        let idMap: Dictionary<Pointer, DModelElement> = {};\r\n        let nameMap: Dictionary<string, DModelElement> = {};\r\n        let replacePrimitiveMap: Dictionary<string, DClassifier> = {};\r\n        let d_Estring: DClassifier = Selectors.getAllPrimitiveTypes()[0];\r\n        replacePrimitiveMap[AttribETypes.EString] = d_Estring;\r\n        // todo: do the same for all other primitives\r\n\r\n        // let longprefixlength = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore'.length;\r\n        const typeprefix = \"#//\";\r\n        for (let shortkey in AttribETypes){\r\n            let longkey: string = (AttribETypes as GObject)[shortkey];\r\n            // fallback for missing type instead of crash\r\n            if (!replacePrimitiveMap[longkey]) replacePrimitiveMap[longkey] = d_Estring;\r\n\r\n            // allow shortcuts to work too\r\n            replacePrimitiveMap[typeprefix + shortkey] = replacePrimitiveMap[longkey];\r\n\r\n        }\r\n\r\n\r\n        for (let ecorename in replacePrimitiveMap) {\r\n            idMap[replacePrimitiveMap[ecorename].id] = replacePrimitiveMap[ecorename];\r\n        }\r\n\r\n        // let prereplace = (name: string) => name.replaceAll(\"#//\", \"\");\r\n        let replaceRules = [\"extends\", /*\"extendedBy\",*/ \"exceptions\", \"type\", \"values\"];\r\n        let dobj: GObject & DModelElement;\r\n\r\n        for (dobj of parsedElements) {\r\n            if (dobj.name) { nameMap[dobj.name] = dobj; nameMap[typeprefix + dobj.name] = dobj;}\r\n            idMap[dobj.id] = dobj;\r\n        }\r\n\r\n        for (let replacekey of replaceRules){\r\n            for (dobj of parsedElements) {\r\n                let valtmp: string | string[] = dobj[replacekey] as string | string[];\r\n                if (valtmp === undefined) continue; // for missing properties in a d-object like looking for extends on a dmodel.\r\n                let values: string[]\r\n                let isArray = Array.isArray(valtmp);\r\n                if (isArray) {\r\n                    values = valtmp as string[];\r\n                    dobj[replacekey] = [];\r\n                }\r\n                else {\r\n                    values = [valtmp as string];\r\n                }\r\n                for (let value of values) {\r\n                    if (!value) continue;\r\n                    // console.log(\"fixalltypes\", {replacekey, dobj, value, values});\r\n                    let target: DModelElement = replacePrimitiveMap[value];\r\n                    if (!target) target = nameMap[value];\r\n                    // if (Pointers.isPointer(value)) { target = value;  if it happen to be a pointer it's a mistake in parser }\r\n                    // (value.indexOf(\"#//\") == 0) && console.log(\"attempt to replace primitive type to his id\", {target, dobj, replacekey, value, replacePrimitiveMap, nameMap, idMap, parsedElements});\r\n\r\n                    if (replacekey === \"extends\") {\r\n                        if (!target) continue;\r\n                        Log.ex(target.className !== DClass.cname, \"found a class attempting to extend an object that is not a class\", {target, dobj, replacePrimitiveMap, nameMap, idMap});\r\n                        (target as DClass).extendedBy.push((dobj as DClass).id);\r\n                    }\r\n                    Log.ex(!target, \"LinkAllNames() can't find type target:\", {value, nameMap, replacePrimitiveMap, dobj, replacekey});\r\n                    if (isArray) dobj[replacekey].push(target.id);\r\n                    else dobj[replacekey] = target.id;\r\n                }\r\n            }\r\n        }\r\n\r\n        let idlookup: Dictionary<string, DModelElement> = store.getState().idlookup as any;\r\n\r\n        // fix from ordinals to Pointer<DEnumLiteral>\r\n        function DfromPtr<T extends DPointerTargetable>(id: Pointer<T>|null|undefined): T{ return !id ? undefined as any : (idMap[id] || idlookup[id]); }\r\n        function getLiteral(id: Pointer<DEnumerator>, ordinal: number): DEnumLiteral { return LPointerTargetable.fromD(DfromPtr(id))?.ordinals[ordinal]?.__raw; }\r\n        for (let elem of parsedElements) {\r\n            if (elem.className !== DValue.cname) continue;\r\n            let dval: DValue = elem as DValue;\r\n            let meta: DAttribute | DReference = DfromPtr(dval.instanceof as Pointer<DAttribute|DReference>);\r\n            if (!meta) continue;\r\n            let type: DEnumerator = DfromPtr(meta.type) as DEnumerator;\r\n            if (!type || type.className !== DEnumLiteral.cname) continue;\r\n            let mapper = (v: unknown): Pointer<DEnumLiteral> => {\r\n                if (typeof v !== \"number\") { Log.e(\"found non-numeric value in a literal value.\", v, dval); return v as any; }\r\n                let l = getLiteral(type.id, v);\r\n                return l ? l.id : v as any;\r\n            }\r\n            dval.values = dval.values.map( mapper );\r\n        }\r\n\r\n        // finally: set all pointedby\r\n        for (let ptrkey of PointedBy.list) for(dobj of parsedElements) {\r\n            let valtmp: string | string[] = dobj[ptrkey] as string | string[];\r\n            let values: string[];\r\n            if (Array.isArray(valtmp)) {\r\n                values = valtmp as string[];\r\n            }\r\n            else {\r\n                if (valtmp === undefined) values = [];\r\n                // if (valtmp === \"modeltmp\") { dobj[ptrkey] = null; values = []; } // because model.father is null, but i want to error check others and let them crash if missing father\r\n                else values = [valtmp as string];\r\n            }\r\n            console.log(\"fixalltypes[]\", {ptrkey, valtmp, dobj, values});\r\n            for (let value of values) {\r\n                if (!value) continue;\r\n                // errore: per operazione.type l'import mi restituisce puntatore a oggetto stringa, ma non è tra gli oggetti parsed\r\n                let target: DModelElement = idMap[value];\r\n                if (target) {\r\n                    target.pointedBy.push(PointedBy.new(\"idlookup.\" + dobj.id + \".\" + ptrkey));\r\n                } else {\r\n                    target = idlookup[value];\r\n                    console.log(\"fixalltypes\", {ptrkey, valtmp, dobj, value, values, target, idMap});\r\n                    if (!target) throw new Error(\"target undefined\");\r\n                    SetFieldAction.new(target, \"pointedBy\", PointedBy.new(\"idlookup.\" + dobj.id + \".\" + ptrkey),'+=', false);\r\n                }\r\n            }\r\n        }\r\n        // update superclasses\r\n        this.updateSuperClasses(parsedElements);\r\n    }\r\n\r\n    private static todoGetPrimitiveTypenope(type: AttribETypes.EString | string): Pointer<DClass, 1, 1, LClass> {\r\n        // akready fixed in LinkAllNamesToID\r\n        return 'todoGetPrimitiveType from parser';\r\n    }\r\n\r\n    private static updateSuperClasses(parsedElements: DModelElement[]): void {\r\n        // todo:3\r\n\r\n    }\r\n    private static fixNamingConflicts(parsedElements: DModelElement[]): void {\r\n        // todo:4 final\r\n    }\r\n\r\n    static parseM2Model(json: Json, filename: string | undefined): DModelElement[] {\r\n        let generated: DModelElement[] = [];\r\n        if (!json) { json = {}; }\r\n        let modelname = json[ECoreNamed.namee] as string;\r\n        if (!modelname && filename) {\r\n            let pos = filename.indexOf(\".\");\r\n            modelname = pos === -1 ? filename : filename.substring(0, pos); }\r\n        let dObject: DModel = DModel.new( modelname || \"imported_metamodel_1\", undefined, true, true);\r\n        console.log(\"made model\", json);\r\n        generated.push(dObject); // dObject.father = 'modeltmp' as any;\r\n        /// *** specific  *** ///\r\n        const children = EcoreParser.getChildren(json);\r\n        const annotations = EcoreParser.getAnnotations(json);\r\n        // dObject.name = json[ECoreNamed.namee] as string || \"imported_metamodel_1\";\r\n        console.log(\"made model 2\", children, annotations);\r\n        for (let child of annotations) {\r\n            EcoreParser.parseDAnnotation(dObject, child, generated);\r\n        }\r\n        console.log(\"made annotations\");\r\n        for (let child of children) {\r\n            EcoreParser.parseDPackage(dObject, child, generated);\r\n        }\r\n        console.log(\"made packages\");\r\n        return generated;\r\n    }\r\n\r\n    static parseM1Model(json: Json, meta?: LModel, filename?: string): DModelElement[] {\r\n        let generated: DModelElement[] = [];\r\n        if (!json) { json = {}; }\r\n        /// *** specific  *** ///\r\n        // this.parseDObject(json, dObject, DModel,undefined, generated);\r\n        let allmodels: DModel[];\r\n        if (!meta && filename) {\r\n            allmodels = Selectors.getAll(DModel);\r\n            allmodels = allmodels.filter( (m) => m.name === filename);\r\n            meta = LPointerTargetable.fromD(allmodels[0]);\r\n        } else allmodels = [];\r\n\r\n        let xmlns =  EcoreParser.XMLinlineMarker + \"xmlns:\";\r\n        let ns: string | undefined = undefined as any;\r\n        function findns(key: string): false | string {\r\n            let pos = key.indexOf(\":\");\r\n            if (pos <= 0) return false;\r\n            return ns = key.substring(0, pos); // through namespace before the name of the root objects;\r\n            // additional method: through xmlns key\r\n            // if (key.indexOf(xmlns)) continue; // \"-xmlns:org.eclipse.example.modelname\": \"https://org/eclipse/example/modelname\",\r\n            // ns = key.substring(xmlns.length); break;\r\n        }\r\n        outerloop: for (let key0 in json) { // ns can be at most in sublevel 3, this is annoying but i need it at beginning of parsing\r\n            if (findns(key0)) break;\r\n            let val0 = json[key0];\r\n            if (typeof val0 === \"object\") for (let key1 in val0) {\r\n                if (findns(key0)) break outerloop;\r\n            }\r\n        }\r\n        if (ns && !meta) {\r\n            let allpkgs: LPackage[] = Selectors.getAll(DPackage, undefined, undefined, true, true);\r\n            let matchpkg: LPackage[] = allpkgs.filter( (d) => d.uri === ns);\r\n            meta = matchpkg[0]?.model;\r\n            // Log.exDev(!meta, \"metamodel not found: \", {ns, json, filename, allmodels, allpkgs, matchpkg}) // todo: after tests remove this check and allow shapeless models.\r\n        }\r\n\r\n        let modelname = '';\r\n        if (!modelname && filename) {\r\n            let pos = filename.indexOf(\".\");\r\n            modelname = (pos === -1 ? filename : filename.substring(0, pos)); }\r\n        let dObject: DModel = DModel.new( modelname || \"imported_model_1\", meta?.id, false, true);\r\n        console.log(\"made model\", json);\r\n        generated.push(dObject);\r\n\r\n        for (let key in json) {\r\n            switch(key) {\r\n                case ECoreObject.xmi_version: // this is only on roots\r\n                    Log.ex(json[key] !== \"2.0\",\"The only supported ecore version is \\\"2.0\\\", found instead: \\\"\"+json[key] +\"\\\"\");\r\n                    break;\r\n                // case ECoreObject.xmlnsecore:\r\n                case ECoreObject.xmlns_xmi:\r\n                    let expected = \"http://www.omg.org/XMI\";\r\n                    Log.ex(json[key] !== expected,\"Unexpected XMI schema. Should be \\\"\"+expected+\"\\\", found instead: \\\"\"+json[key] +\"\\\"\");\r\n                    break;\r\n                default: // a feature name\r\n                    let val = json[key];\r\n                    if (!val) continue;\r\n                    if (key.indexOf(xmlns) === 0) continue; // \"-xmlns:org.eclipse.example.modelname\": \"https://org/eclipse/example/modelname\",\r\n                    if (key[0] === EcoreParser.XMLinlineMarker) key = key.substring(EcoreParser.XMLinlineMarker.length);\r\n\r\n                    const namespacedclass: string = key;\r\n                    const mmclass: LClass | undefined = meta && meta.getClassByNameSpace(namespacedclass);\r\n                    if (!mmclass) console.log(\"failed to get mmclass\", {meta, key, mmclass})\r\n                    const roots_for_this_metaclass: Json[] = Array.isArray(val) ? val : [val]; // there might be N roots of class A, M of type B...\r\n                    for(let rootjson of roots_for_this_metaclass) {\r\n                        // DObject.new(mmclass.id, dObject.id, DModel, undefined, true)\r\n                        EcoreParser.parseDObject(rootjson, dObject, DModel, mmclass, generated);\r\n                    }\r\n            }\r\n        }\r\n        return generated;\r\n    }\r\n    /*\r\n    {\r\n      \"org.eclipse.example.bowling:League\": { <-- :classroot\r\n        \"-xmlns:xmi\": \"http://www.omg.org/XMI\",\r\n        \"-xmlns:org.eclipse.example.bowling\": \"https://org/eclipse/example/bowling\",\r\n        \"-xmi:version\": \"2.0\",\r\n        \"Players\": [\r\n          { \"-name\": \"tizio\" },\r\n          { \"-name\": \"asd\" }\r\n        ]\r\n      }\r\n    }\r\n    */\r\n\r\n\r\n    /// In Ecore parsing when you find a value list, it is possible to recover only the type for the meta-feature,<br>\r\n    /// but an array of Mammals might have some Whales, Pigs, etc mixed in. and you have to get the correct subclass for each\r\n    static getobjectmetaclass(json: Json, metaSuperClass: LClass): LClass {\r\n        return metaSuperClass; // todo: comment this and execute below\r\n        let subclasses: LClass[] | [] = !metaSuperClass ? [] : [metaSuperClass];\r\n        let subclasseshapes: Dictionary<Pointer<DClass>, {l: LClass } & Dictionary<DocString<\"feature name\">,  LTypedElement[\"type\"]/*feature type*/>> = {}\r\n        for (let sc of subclasses) {\r\n            subclasseshapes[sc.id] = {l: sc};\r\n            let row = subclasseshapes[sc.id];\r\n            for (let feat of sc.children) {\r\n                let lfeat: LTypedElement = feat as any;\r\n                let dfeat: DTypedElement = lfeat.__raw as any;\r\n                if (!dfeat.name || !dfeat.type) continue;\r\n                row[dfeat.name] = lfeat.type;\r\n            }\r\n        }\r\n        return this.findBestMatch(subclasseshapes, json);\r\n    }\r\n    static findBestMatch(\r\n        m2classes: Dictionary<Pointer<DClass>,  {l: LClass } & Dictionary<DocString<\"feature name\">, LTypedElement[\"type\"]>>,\r\n        json: Dictionary<DocString<\"feature name\">, any/*actual val instead of type*/>): LClass{\r\n        throw new Error(\"todo\");\r\n        return null as any;\r\n    }\r\n    static parseDObject(json: Json, parent: DModel | DValue, parentType: typeof DModel | typeof DValue, meta: LClass | undefined, generated: DModelElement[]): DModelElement[]{\r\n        if (!json) { json = {}; }\r\n        meta = meta && this.getobjectmetaclass(json, meta);\r\n        // let dObject: DObject = DObject.new(meta?.id, parent.id, parentType, json[\"name\"] as string || \"obj_1\");\r\n        // let data: Partial<DObject> = {};\r\n        let dObject: DObject = DObject.new(meta?.id, parent.id, parentType, json[\"name\"] as string || \"obj_1\");\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) {\r\n            if (parentType === DModel) (parent as DModel).objects.push(dObject.id);\r\n            else (parent as DValue).values.push(dObject.id);\r\n        }\r\n        console.log(\"made dobject\", {json, dObject, meta, metaname: meta?.name});\r\n        /// *** specific  *** ///\r\n        for (let key in json) {\r\n            switch(key) {\r\n                case ECoreObject.xmi_version: // this is only on roots\r\n                    Log.ex(json[key] !== \"2.0\",\"The only supported ecore version is \\\"2.0\\\", found instead: \\\"\"+json[key] +\"\\\"\");\r\n                    break;\r\n                // case ECoreObject.xmlnsecore:\r\n                case ECoreObject.xmlns_xmi:\r\n                    let expected = \"http://www.omg.org/XMI\";\r\n                    Log.ex(json[key] !== expected,\"Unexpected XMI schema. Should be \\\"\"+expected+\"\\\", found instead: \\\"\"+json[key] +\"\\\"\");\r\n                    break;\r\n                default: // a feature name\r\n                    let val = json[key];\r\n                    if (!val) continue;\r\n                    if (key[0] === EcoreParser.XMLinlineMarker) key = key.substring(1);\r\n                    if (key.indexOf(\"xmlns:\") === 0) continue; // \"-xmlns:org.eclipse.example.modelname\": \"https://org/eclipse/example/modelname\",\r\n                    let metafeature: LAttribute | LReference | undefined = meta && (meta as any)[\"@\"+key];\r\n                    console.log(\"feature meta\", {json, dObject, key, val, metafeature, classmeta: meta});\r\n                    let values: any[];\r\n                    if (Array.isArray(val)) values = val;\r\n                    else if (val as unknown === undefined) values = [];\r\n                    else values = [val];\r\n                    EcoreParser.parseDValue(key, values, dObject/*father*/, metafeature/*meta*/, generated);\r\n                    // DValue.new(key, metafeature?.id, values, dObject, true, false);\r\n            }\r\n        }\r\n        return generated;\r\n    }\r\n\r\n    private static parseDValue(name:string | undefined, jsonvalues: any[], parent: DObject, meta: LAttribute | LReference | undefined, generated: DModelElement[]): DModelElement[] {\r\n        if (!jsonvalues) { jsonvalues = []; }\r\n        // let dObject: DObject = DObject.new(meta?.id, parent.id, parentType, json[\"name\"] as string || \"obj_1\");\r\n        console.log(\"DValue.new(meta ? undefined : name, meta?.id, jsonvalues, parent.id, true, false)\")\r\n        console.log(\"DValue.new(\", meta ? undefined : name, \",\",meta?.id, \",\",jsonvalues, \",\",parent.id);\r\n        let dValue: DValue = DValue.new(meta ? undefined : name, meta?.id, [], parent.id, true, false);\r\n        generated.push(dValue); dValue.father = parent.id;\r\n        parent.features.push(dValue.id);\r\n        console.log(\"made dValue\", {jsonvalues, dValue, meta, metaname: meta?.name});\r\n        if (meta && meta.className === DAttribute.cname) { dValue.values = jsonvalues; return generated; }\r\n\r\n        for (let v of jsonvalues) {\r\n            if (typeof v !== \"object\") { dValue.values.push(v); continue; }\r\n            // let subdObject: DObject = DObject.new((meta as LReference)?.type.id, parent.id, DValue, undefined);\r\n            // generated.push(subdObject);\r\n            EcoreParser.parseDObject(v, dValue, DValue, (meta as LReference)?.type, generated);\r\n        }\r\n        return generated;\r\n    }\r\n\r\n    static parseDAnnotation(parent: DModelElement, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        let dObject: DAnnotation = DAnnotation.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        dObject.father = parent.id;\r\n        if (parent) parent.annotations.push(dObject.id);\r\n\r\n        /// *** specific  *** ///\r\n        let key: string;\r\n        for (key in json){\r\n            const value = json[key];\r\n            switch (key) { //todo\r\n                default: Log.exx('unexpected field in EAnnotation:  ' + key + ' => |' + value + '|'); break;\r\n                case ECoreAnnotation.details: break;\r\n                case ECoreAnnotation.references: break;\r\n                case ECoreAnnotation.source: break;\r\n            }\r\n        }\r\n        // annotation.referencesStr = this.read(json, ECoreAnnotation.source, '#/');\r\n        // annotation.name = this.read(json, ECoreAnnotation.name, 'EAnnotation_1');\r\n        // const details: Json[] = this.getDetails(json);\r\n        // for (let i = 0; i < details.length; i++) { new EAnnotationDetail(this, details[i]); }\r\n        return generated; }\r\n\r\n    static parseDPackage(parent: DModel, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n\r\n        console.warn(\"parseDPackage.children\", childs, generated);\r\n        let dObject: DPackage = DPackage.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.packages.push(dObject.id);\r\n\r\n        let version = (json[EcoreParser.prefix+\"xmlns:ecore\"] || '') as string;\r\n        // model.xmi = json[EcoreParser.prefix+\"xmlns:xmi\"]; // http://www.omg.org/XMI\r\n        // model.xsi = json[EcoreParser.prefix+\"xmlns:xsi\"]; // http://www.w3.org/2001/XMLSchema-instance\r\n\r\n        console.log(json);\r\n        Log.ex(!EcoreParser.supportedEcoreVersions.includes(version), \"unsupported ecore version, must be one of:\" + EcoreParser.supportedEcoreVersions + \" found instead: \"+version);\r\n\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'defaultPackage');\r\n        /// *** specific start *** ///\r\n        dObject.uri = this.read(json, ECorePackage.nsURI, null);\r\n        dObject.prefix = this.read(json, ECorePackage.nsPrefix, null);\r\n        // if (!parent.uri) parent.uri = dObject.uri;\r\n        // if (!parent.prefix) parent.prefix = dObject.prefix; // namespace\r\n        for (let child of childs) {\r\n            switch (child[ECoreClass.xsitype]) {\r\n                default: Log.exx('unexpected xsitype:', child[ECoreClass.xsitype], ' found in jsonfragment:', child, ', in json:', json, ' package:', dObject); break;\r\n                case 'ecore:EClass': this.parseDClass(dObject, child, generated); break;\r\n                case 'ecore:EEnum': this.parseDEnum(dObject, child, generated); break;\r\n            }\r\n        }\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDClass(parent: DPackage, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        let dObject: DClass = DClass.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.classifiers.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'Class_1');\r\n        /// *** specific start *** ///\r\n        for (let key in json) {\r\n            switch (key) {\r\n                default: Log.exx('unexpected field in parseDClass() |' + key + '|', json); break;\r\n                case ECoreClass.instanceTypeName:\r\n                case ECoreClass.eSuperTypes:\r\n                case ECoreClass.xsitype:\r\n                case ECoreClass.eOperations:\r\n                case ECoreClass.eStructuralFeatures:\r\n                case ECoreClass.abstract:\r\n                case ECoreClass.interface:\r\n                case ECoreClass.namee: break; } }\r\n        dObject.instanceClassName = this.read(json, ECoreClass.instanceTypeName, '');\r\n        dObject.interface = this.read(json, ECoreClass.interface, 'false') === 'true';\r\n        dObject.abstract = this.read(json, ECoreClass.abstract, 'false') === 'true';\r\n        let tmps: string = this.read(json, ECoreClass.eSuperTypes, '');\r\n        dObject.extends = tmps.split(' ');\r\n        const features: Json[] = this.getChildren(json);\r\n        const functions: Json[] = this.getChildren(json, false, true);\r\n        for (let child of functions) {\r\n            this.parseDOperation(dObject, json, generated);\r\n        }\r\n        for (let child of features) {\r\n            const xsiType = this.read(child, ECoreAttribute.xsitype);\r\n            switch (xsiType) {\r\n                default: Log.exx( 'unexpected xsi:type: ', xsiType, ' in feature:', child); break;\r\n                case 'ecore:EAttribute':\r\n                    this.parseDAttribute(dObject, child, generated); break;\r\n                case 'ecore:EReference':\r\n                    this.parseDReference(dObject, child, generated); break;\r\n            }\r\n        }\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDEnum(parent: DPackage, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DEnumerator = DEnumerator.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.classifiers.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'Enum_1');\r\n        /// *** specific start *** ///\r\n        for (let key in json) {\r\n            const value = json[key];\r\n            switch (key) {\r\n                default: Log.exx('Enum.parse() unexpected key:', key, 'in json:', json); break;\r\n                case ECoreEnum.xsitype: case ECoreNamed.namee: break;\r\n                case ECoreEnum.eLiterals: break;\r\n                case ECoreEnum.serializable: dObject.serializable = value === 'true'; break;\r\n                case ECoreEnum.instanceTypeName: dObject.instanceClassName = value + ''; break;\r\n            }\r\n        }\r\n        for (let child of childs) {\r\n            this.parseDEnumLiteral(dObject, child, generated);\r\n        }\r\n\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n\r\n\r\n    static parseDEnumLiteral(parent: DEnumerator, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DEnumLiteral = DEnumLiteral.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.literals.push(dObject.id);\r\n        /// *** specific start *** ///\r\n        dObject.value = +this.read(json, EcoreLiteral.value, Number.NEGATIVE_INFINITY);//vv4\r\n        dObject.literal = this.read(json, EcoreLiteral.literal, '');\r\n        dObject.name = this.read(json, ECoreNamed.namee,  dObject.literal || 'literal_1');\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDAttribute(parent: DClass, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DAttribute = DAttribute.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.attributes.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'attr_1');\r\n        /// *** specific start *** ///\r\n        dObject.lowerBound = +this.read(json, ECoreAttribute.lowerbound, 0);\r\n        dObject.upperBound = +this.read(json, ECoreAttribute.upperbound, 1);\r\n        dObject.type = this.read(json, ECoreAttribute.eType, AttribETypes.EString);\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDReference(parent: DClass, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DReference = DReference.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.references.push(dObject.id);\r\n        dObject.name = this.read(json, ECorePackage.namee, 'Ref_1');\r\n        /// *** specific start *** ///\r\n        dObject.containment = U.fromBoolString(this.read(json, ECoreReference.containment, false), false);\r\n        dObject.lowerBound = +this.read(json, ECoreAttribute.lowerbound, 0);\r\n        dObject.upperBound = +this.read(json, ECoreAttribute.upperbound, 1);\r\n\r\n        dObject.type = this.read(json, ECoreReference.eType, this.getEcoreTypeName(parent));\r\n\r\n        console.log(\"attempting to parse dref\", {dObject, json, parent, typekey:  ECoreReference.eType})\r\n\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDParameter(parent: DOperation, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DParameter = DParameter.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.parameters.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'arg1');\r\n        /// *** specific start *** ///\r\n        dObject.lowerBound = +this.read(json, ECoreAttribute.lowerbound, 0);\r\n        dObject.upperBound = +this.read(json, ECoreAttribute.upperbound, 1);\r\n        dObject.type = this.read(json, ECoreAttribute.eType, AttribETypes.EString);\r\n        dObject.ordered = U.fromBoolString(this.read(json, ECoreOperation.ordered, 'false'), false);\r\n        dObject.unique = U.fromBoolString(this.read(json, ECoreOperation.unique, 'false'), false);\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n    static parseDOperation(parent: DClass, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DOperation = DOperation.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.operations.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, 'operation_1');\r\n        /// *** specific start *** ///\r\n        dObject.lowerBound = +this.read(json, ECoreAttribute.lowerbound, 1);\r\n        dObject.upperBound = +this.read(json, ECoreAttribute.upperbound, 1);\r\n        dObject.type = this.read(json, ECoreAttribute.eType, AttribETypes.EString);\r\n        dObject.exceptions = [this.read(json, ECoreOperation.eexceptions, '')];\r\n        dObject.ordered = U.fromBoolString(this.read(json, ECoreOperation.ordered, 'false'));\r\n        dObject.unique = U.fromBoolString(this.read(json, ECoreOperation.unique, 'false'));\r\n        dObject.visibility = AccessModifier.package;\r\n        for (let child of childs) {\r\n            this.parseDParameter(dObject, json, generated);\r\n        }\r\n        /// *** specific end *** ///\r\n        return generated; }\r\n\r\n\r\n    /*\r\n    static parseTEMPLATE(parent: DSomething, json: Json, generated: DModelElement[]): DModelElement[] {\r\n        if (!generated) generated = [];\r\n        if (!json) { json = {}; }\r\n        const childs = this.getChildren(json);\r\n        let dObject: DSomething = DSomething.new();\r\n        generated.push(dObject); dObject.father = parent.id;\r\n        if (parent) parent.CHILDCOLLECTION.push(dObject.id);\r\n        dObject.name = this.read(json, ECoreNamed.namee, defaultNameTODO);\r\n        /// *** specific start *** ///\r\n        for (let child of childs) {\r\n            this.parseDSOMETHING(dObject, json, generated);\r\n        }\r\n        /// *** specific end *** ///\r\n        return generated; }*/\r\n\r\n\r\n\r\n\r\n\r\n    /////////////////////////////////// generic\r\n    static XMLinlineMarker: string = '@';\r\n    static classTypePrefix: string = '#//'\r\n    private static getAnnotations(thiss: Json): Json[] {\r\n        const ret: any = thiss[ECorePackage.eAnnotations];\r\n        if (!ret || $.isEmptyObject(ret)) { return []; }\r\n        if (Array.isArray(ret)) { return ret; } else { return [ret]; } }\r\n\r\n    private static getDetails(thiss: Json): Json[] {\r\n        const ret: any = thiss[ECoreAnnotation.details];\r\n        if (!ret || $.isEmptyObject(ret)) { return []; }\r\n        if (Array.isArray(ret)) { return ret; } else { return [ret]; } }\r\n\r\n    private static getChildren(thiss: Json, throwError: boolean = false, functions: boolean = false): Json[] {\r\n        if (!thiss && !throwError) { return []; }\r\n        const mod = thiss[ECoreRoot.ecoreEPackage];\r\n        const pkg = thiss[ECorePackage.eClassifiers];\r\n        const cla = thiss[functions ? ECoreClass.eOperations : ECoreClass.eStructuralFeatures];\r\n        const fun = thiss[ECoreOperation.eParameters];\r\n        const lit = thiss[ECoreEnum.eLiterals];\r\n\r\n        const ret: any = mod || pkg || cla || fun || lit;\r\n        /*if ( ret === undefined || ret === null ) {\r\n          if (thiss['@name'] !== undefined) { ret = thiss; } // if it's the root with only 1 child arrayless\r\n        }*/\r\n        Log.ex( throwError && !ret, 'getChildren() Failed: ', thiss, ret);\r\n        // console.log('ret = ', ret, ' === ', {}, ' ? ', ($.isEmptyObject(ret) ? [] : [ret]));\r\n        if (!ret || $.isEmptyObject(ret)) { return []; }\r\n        if (Array.isArray(ret)) { return ret; } else { return [ret]; }\r\n    }\r\n\r\n    private static read(json: Json, field: string, valueIfNotFound: any = 'read<T>()CanThrowError'): string {\r\n        let ret: any = json ? json[field] : null;\r\n        if (ret !== null && ret !== undefined && field.indexOf(this.XMLinlineMarker) !== -1) {\r\n            Log.ex(U.isObject(ret, false, false, true), 'inline value |' + field + '| must be primitive.', ret);\r\n            ret = U.multiReplaceAll('' + ret, ['&amp;', '&#38;', '&quot;'], ['&', '\\'', '\"']);\r\n        }\r\n        if ((ret === null || ret === undefined)) {\r\n            Log.ex(valueIfNotFound === 'read<T>()CanThrowError', 'this.read<',  '> failed: field[' + field + '], json: ', json);\r\n            return valueIfNotFound; }\r\n        return ret; }\r\n\r\n    static write(json: Json, field: string, val: string | any[]): string | any[] {\r\n        if (val !== null && field.indexOf(EcoreParser.XMLinlineMarker) !== -1) {\r\n            Log.ex(val !== '' + val, 'inline value |' + field + '| must be a string.', val);\r\n            val = U.multiReplaceAll(val as string, ['&', '\\'', '\"'], ['&amp;', '&#38;', '&quot;']);\r\n        }\r\n        else Log.ex(val !== '' + val || !U.isObject(val, true), 'primitive values should be inserted only inline in the xml:', field, val);\r\n        json[field] = val;\r\n        return val; }\r\n\r\n    private static getEcoreTypeName(parent: DClassifier): string {\r\n        if (parent.className === DEnumerator.cname || parent.className === DClass.cname) return this.classTypePrefix + this.name;\r\n        // return Type.classTypePrefix + parent.parent.name; problem: need L-object to navigate\r\n        return Log.ex(\"getEcoreTypeName failed\", parent);\r\n    }\r\n\r\n}\r\n\r\nexport enum AccessModifier {\r\n    public = 'public',\r\n    private = 'private',\r\n    protected = 'protected',\r\n    internal = 'internal',\r\n    package = 'package',\r\n    protectedinternal = 'protected internal',\r\n    protectedprivate = 'protected private', }\r\n\r\nexport class ECoreRoot {\r\n    static ecoreEPackage: string;\r\n}\r\n\r\nexport class ECoreAnnotation {\r\n    static source: string;\r\n    static references: string;\r\n    static details: string;}\r\nexport class ECoreNamed {\r\n    static namee: string; }\r\n\r\nexport class ECoreDetail {\r\n    static key: string;\r\n    static value: string; }\r\n\r\nexport class ECorePackage {\r\n    static eAnnotations: string;\r\n    static eClassifiers: string;\r\n    static xmlnsxmi: string;\r\n    static xmlnsxsi: string;\r\n    static xmiversion: string;\r\n    static xmlnsecore: string;\r\n    static nsURI: string;\r\n    static nsPrefix: string;\r\n    static namee: string;\r\n}\r\n\r\n\r\nexport class ECoreClass {\r\n    static eAnnotations: string;\r\n    static eStructuralFeatures: string;\r\n    static xsitype: string;\r\n    static namee: string;\r\n    static eOperations: string;\r\n    static instanceTypeName: string;\r\n    static eSuperTypes: string;\r\n    static abstract: string;\r\n    static interface: string;\r\n\r\n    // static defaultValue = EcoreParser.XMLinlineMarker + 'defaultValue';  // visualizzato in ecore ma mai salvato dentro il file. inutilizzato\r\n    // nelle classi, assume il valore di \"[name] = [NumericValue]\" senza le [] negli enum.\r\n}\r\n\r\nexport class ECoreEnum {\r\n    static eAnnotations: string;\r\n    static xsitype: string;\r\n    static namee: string;\r\n    static instanceTypeName: string;\r\n    static serializable: string;\r\n    static eLiterals: string;\r\n}\r\n\r\nexport class EcoreLiteral {\r\n    static eAnnotations: string;\r\n    static namee: string;\r\n    static value: string;\r\n    static literal: string;\r\n}\r\n\r\n\r\nexport class ECoreReference {\r\n    static eAnnotations: string;\r\n    static xsitype: string;\r\n    static eType: string;\r\n    static containment: string;\r\n    static upperbound: string;\r\n    static lowerbound: string;\r\n    static namee: string; }\r\n\r\nexport class ECoreAttribute {\r\n    static eAnnotations: string;\r\n    static xsitype: string;\r\n    static eType: string;\r\n    static namee: string;\r\n    static lowerbound: string;\r\n    static upperbound: string;\r\n}\r\n\r\nexport class ECoreOperation {\r\n    static eAnnotations: string;\r\n    static eType: string;\r\n    static eexceptions: string;\r\n    static upperBound: string;\r\n    static lowerBound: string;\r\n    static unique: string;\r\n    static ordered: string;\r\n    static namee: string;\r\n    static eParameters: string; }\r\n\r\nexport class ECoreParameter {\r\n    static eAnnotations: string;\r\n    static namee: string;\r\n    static ordered: string;\r\n    static unique: string;\r\n    static lowerBound: string;\r\n    static upperBound: string;\r\n    static eType: string;\r\n}\r\n\r\nexport class ECoreObject{\r\n    static xmlns_xmi: string;\r\n    static xmlns_uri: never; // \"-xmlns:org.eclipse.example.modelname\": \"https://org/eclipse/example/modelname\", <b>key is dynamic</b>\r\n    static xmi_version: string;\r\n}\r\nexport class XMIModel {\r\n    static type: string;\r\n    static namee: string; }\r\n\r\n\r\n///////////////\r\n\r\nECoreRoot.ecoreEPackage = 'ecore:EPackage';\r\nECoreNamed.namee = EcoreParser.XMLinlineMarker + 'name';\r\n\r\nECorePackage.eAnnotations = ECoreClass.eAnnotations = ECoreEnum.eAnnotations = EcoreLiteral.eAnnotations =\r\n    ECoreReference.eAnnotations = ECoreAttribute.eAnnotations = ECoreOperation.eAnnotations = ECoreParameter.eAnnotations = 'eAnnotations';\r\n\r\nECoreAnnotation.source = EcoreParser.XMLinlineMarker + 'source';\r\nECoreAnnotation.references = EcoreParser.XMLinlineMarker + 'references'; // \"#/\" for target = package.\r\nECoreAnnotation.details = 'details'; // arr\r\nECoreDetail.key = EcoreParser.XMLinlineMarker + 'key'; // can have spaces\r\nECoreDetail.value = EcoreParser.XMLinlineMarker + 'value';\r\n\r\nECorePackage.eClassifiers = 'eClassifiers';\r\nECorePackage.xmlnsxmi = EcoreParser.XMLinlineMarker + 'xmlns:xmi'; // typical value: http://www.omg.org/XMI\r\nECorePackage.xmlnsxsi = EcoreParser.XMLinlineMarker + 'xmlns:xsi'; // typical value: http://www.w3.org/2001/XMLSchema-instance\r\nECorePackage.xmiversion = EcoreParser.XMLinlineMarker + 'xmi:version'; // typical value: \"2.0\"\r\nECorePackage.xmlnsecore = EcoreParser.XMLinlineMarker + 'xmlns:ecore';\r\nECorePackage.nsURI = EcoreParser.XMLinlineMarker + 'nsURI'; // typical value: \"http://org/eclipse/example/modelname\"\r\nECorePackage.nsPrefix = EcoreParser.XMLinlineMarker + 'nsPrefix'; // typical value: org.eclipse.example.modelname\r\nECorePackage.namee = EcoreParser.XMLinlineMarker + 'name';\r\n\r\nECoreClass.eStructuralFeatures = 'eStructuralFeatures';\r\nECoreClass.eOperations = 'eOperations';\r\nECoreClass.xsitype = EcoreParser.XMLinlineMarker + 'xsi:type'; // \"ecore:EClass\"\r\nECoreClass.namee = ECorePackage.namee;\r\nECoreClass.eSuperTypes = EcoreParser.XMLinlineMarker + 'eSuperTypes'; // space separated: \"#name1 #name2\"...\r\nECoreClass.instanceTypeName = EcoreParser.XMLinlineMarker + 'instanceTypeName';  // raw str\r\nECoreClass.instanceTypeName = EcoreParser.XMLinlineMarker + 'instanceTypeName';\r\nECoreClass.abstract = EcoreParser.XMLinlineMarker + 'abstract'; // bool\r\nECoreClass.interface = EcoreParser.XMLinlineMarker + 'interface'; // bool\r\n\r\nECoreEnum.instanceTypeName = ECoreClass.instanceTypeName;\r\nECoreEnum.serializable = 'serializable'; // \"false\", \"true\"\r\nECoreEnum.xsitype = ECoreClass.xsitype; // \"ecore:EEnum\"\r\nECoreEnum.eLiterals = 'eLiterals';\r\nECoreEnum.namee = ECorePackage.namee;\r\n\r\nEcoreLiteral.literal = 'literal';\r\nEcoreLiteral.namee = ECorePackage.namee;\r\nEcoreLiteral.value = 'value'; // any integer (-inf, +inf), not null. limiti = a type int 32 bit? vv4\r\n\r\nECoreReference.xsitype = EcoreParser.XMLinlineMarker + 'xsi:type'; // \"ecore:EReference\"\r\nECoreReference.eType = EcoreParser.XMLinlineMarker + 'eType'; // \"#//Player\"\r\nECoreReference.containment = EcoreParser.XMLinlineMarker + 'containment'; // \"true\"\r\nECoreReference.upperbound = EcoreParser.XMLinlineMarker + 'upperBound'; // \"@1\"\r\nECoreReference.lowerbound = EcoreParser.XMLinlineMarker + 'lowerBound'; // does even exists?\r\nECoreReference.namee = EcoreParser.XMLinlineMarker + 'name';\r\n\r\nECoreAttribute.xsitype = EcoreParser.XMLinlineMarker + 'xsi:type'; // \"ecore:EAttribute\",\r\nECoreAttribute.eType = EcoreParser.XMLinlineMarker + 'eType'; // \"ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString\"\r\nECoreAttribute.namee = EcoreParser.XMLinlineMarker + 'name';\r\nECoreAttribute.lowerbound = EcoreParser.XMLinlineMarker + 'lowerBound';\r\nECoreAttribute.upperbound = EcoreParser.XMLinlineMarker + 'upperBound';\r\n\r\n\r\nECoreOperation.eParameters = 'eParameters';\r\nECoreOperation.namee = EcoreParser.XMLinlineMarker + 'name'; // \"EExceptionNameCustom\",\r\nECoreOperation.ordered = EcoreParser.XMLinlineMarker + 'ordered'; // \"false\",\r\nECoreOperation.unique = EcoreParser.XMLinlineMarker + 'unique'; // \"false\",\r\nECoreOperation.lowerBound = EcoreParser.XMLinlineMarker + 'lowerBound'; // \"5\", ma che senso ha su una funzione?? è il return?\r\nECoreOperation.upperBound = EcoreParser.XMLinlineMarker + 'upperBound';\r\nECoreOperation.eType = EcoreParser.XMLinlineMarker + 'eType'; // \"#//Classname\",\r\nECoreOperation.eexceptions = EcoreParser.XMLinlineMarker + 'eExceptions';\r\n// \"#//ClassnameException1 #//ClassNameException2 (also custom classes) ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt\r\n\r\nECoreParameter.namee = EcoreParser.XMLinlineMarker + 'name';\r\nECoreParameter.ordered = EcoreParser.XMLinlineMarker + 'ordered'; // \"false\";\r\nECoreParameter.unique = EcoreParser.XMLinlineMarker + 'unique'; // \"false\"\r\nECoreParameter.lowerBound = EcoreParser.XMLinlineMarker + 'lowerBound'; // \"1\"\r\nECoreParameter.upperBound = EcoreParser.XMLinlineMarker + 'upperBound'; // \"2\"\r\nECoreParameter.eType = EcoreParser.XMLinlineMarker + 'eType'; // \"ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EDoubl\r\n\r\nECoreObject.xmlns_xmi = EcoreParser.XMLinlineMarker + 'xmlns:xmi'; // \"http://www.omg.org/XMI\"\r\n// ECoreObject.xmlns_uri = EcoreParser.XMLinlineMarker + 'xmlns:org.eclipse.example.modelname'; // \"https://org/eclipse/example/modelname\"\r\nECoreObject.xmi_version = EcoreParser.XMLinlineMarker + 'xmi:version'; // \"2.0\"\r\n\r\nXMIModel.type = EcoreParser.XMLinlineMarker + 'type';\r\nXMIModel.namee = EcoreParser.XMLinlineMarker + 'name';\r\n\r\n","import type { LVoidVertex } from \"../../joiner\";\r\nimport {\r\n    BEGIN,\r\n    Constructor,\r\n    Constructors,\r\n    CreateElementAction,\r\n    DEdge, DeleteElementAction,\r\n    Dictionary,\r\n    DPointerTargetable,\r\n    DtoL,\r\n    END,\r\n    getWParams,\r\n    GObject,\r\n    DState,\r\n    Leaf,\r\n    LEdge,\r\n    LGraphElement,\r\n    Log,\r\n    LogicContext,\r\n    LPointerTargetable,\r\n    Node,\r\n    Pack,\r\n    Pack1,\r\n    PackArr,\r\n    PointedBy,\r\n    Pointer,\r\n    Pointers,\r\n    RuntimeAccessible,\r\n    Abstract,\r\n    Instantiable,\r\n    RuntimeAccessibleClass,\r\n    Selectors,\r\n    SetFieldAction,\r\n    SetRootFieldAction,\r\n    ShortAttribETypes,\r\n    ShortAttribSuperTypes,\r\n    store,\r\n    TargetableProxyHandler,\r\n    U,\r\n    unArr,\r\n    WPointerTargetable, DUser, DocString, GraphSize} from \"../../joiner\";\r\nimport {Info, Json, ObjectWithoutPointers, orArr, PrimitiveType} from \"../../joiner/types\";\r\n\r\nimport {\r\n    AccessModifier,\r\n    ECoreAnnotation,\r\n    ECoreAttribute,\r\n    ECoreClass,\r\n    ECoreEnum,\r\n    EcoreLiteral,\r\n    ECoreOperation,\r\n    ECorePackage,\r\n    EcoreParser,\r\n    ECoreReference,\r\n    ECoreRoot\r\n} from \"../../api/data\";\r\n\r\n\r\n@Node\r\n@RuntimeAccessible\r\nexport class DModelElement extends DPointerTargetable {\r\n    public static cname: string = \"DModelElement\";\r\n    // static _super = DPointerTargetable;\r\n    // static logic: typeof LModelElement;\r\n    // static structure: typeof DModelElement;\r\n    // static singleton: LModelElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n\r\n    id!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n\r\n    public static new(): DModelElement {\r\n        Log.exx(\"DModelElement is abstract, cannot instantiate\");\r\n        return null as any;\r\n        //return new Constructors(new DModelElement('dwc')).DPointerTargetable().DModelElement().end();\r\n    }\r\n}\r\n\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DAnnotationDetail extends DPointerTargetable {\r\n    public static cname: string = \"DAnnotationDetail\";\r\n    // todo\r\n}\r\n\r\n/*\r\ntype Pack1<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L>, R = {D:D, L:L, P:P} > = P|D|L\r\ntype PackArr<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = (ARR)[];\r\ntype Pack<D extends DPointerTargetable, L extends LPointerTargetable = DtoL<D>, P extends Pointer<D, 0, 1, L> = Pointer<D, 0, 1, L> , ARR = Pack1<D>> = ARR | (ARR)[];*/\r\n\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LModelElement<Context extends LogicContext<DModelElement> = any, D extends DModelElement = DModelElement> extends LPointerTargetable {\r\n    public static cname: string = \"LModelElement\";\r\n    // extends Mixin(DModelElement0, LPointerTargetable)\r\n    // static logic: typeof LModelElement;\r\n    // static structure: typeof DModelElement;\r\n    // static singleton: LModelElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    /*static ResolvePointer = resolvePointerFunction;\r\n    private static ResolvePointers? = resolvePointersFunction;\r\n    private resolvePointer<T extends DPointerTargetable = DPointerTargetable, LB extends number = 0, UB extends number = 0, RET extends LPointerTargetable = LPointerTargetable>(ptr: Pointer<T, LB, UB, RET>): RET | null {\r\n        return LModelElement.ResolvePointer(ptr); }\r\n    private resolvePointers<T extends DPointerTargetable = DPointerTargetable, LB extends number = 0, RET extends LPointerTargetable = LPointerTargetable>(ptr: Pointer<T, LB, 'N', RET>)\r\n        : (RET | null)[] { return resolvePointersFunction(ptr); }\r\n    */\r\n    public __raw!: DModelElement;\r\n    id!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    parent!: LModelElement[];\r\n    father!: LModelElement; // annotations can be children of everything. except them fathers are: Model, Package, Classifier(class+enum), Operation\r\n\r\n    private __info_of__father = {type: \"LModelElement\", txt:\"<a href=\\\"https://github.com/DamianoNaraku/jodel-react/wiki/LModelElement\\\"><span>The element containing this object.</span></a>\"};\r\n    public fatherList!: LModelElement[]; // chain of fathers going up recursively\r\n    annotations!: LAnnotation[];\r\n    children!: (LPackage | LClassifier | LTypedElement | LAnnotation | LObject | LValue)[];\r\n    __info_of_children__: Info = {type: \"LModelElement[]\", txt: <div>Merging of all the subelement collections (attributes, references, parameters...) except annotations</div>}\r\n    nodes!: LGraphElement[];\r\n    node!: LGraphElement | undefined;\r\n\r\n    // utilities to go up in the tree (singular names)\r\n    model!: LModel; // utility, follow father chain until get a Model parent or null\r\n    package!: LPackage | null;\r\n    class!: LClass | null;\r\n    enum!: LEnumerator | null;\r\n    operation!: LOperation | null;\r\n    subNodes!: LGraphElement[] | null;\r\n\r\n\r\n    property!: keyof DModelElement;\r\n    containers!: LNamedElement[]; // list of fathers until the model is reached.\r\n\r\n    public generateEcoreJson(loopDetectionloopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        throw new Error(\"cannot be called directly, should trigger getter. this is only for correct signature\");\r\n    }\r\n\r\n    private get_generateEcoreJson(context: Context): (loopdetectionobj: Dictionary<Pointer, DModelElement>) => Json {\r\n        return (loopdetectionobj) => this.generateEcoreJson_impl(context, loopdetectionobj);\r\n    }\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj?: Dictionary<Pointer, DModelElement>): Json {\r\n        return Log.exDevv(\"generateEcoreJson() should be overridden\", context);\r\n    }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall(((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate() class is abstract\");\r\n    }\r\n\r\n    public addAnnotation(source?: DAnnotation[\"source\"], details?: DAnnotation[\"details\"]): DAnnotation {\r\n        return this.cannotCall(\"addAnnotation\");\r\n    }\r\n\r\n    protected get_addAnnotation(context: Context): this[\"addAnnotation\"] {\r\n        return (source?: DAnnotation[\"source\"], details?: DAnnotation[\"details\"]) => DAnnotation.new(source, details, context.data.id, true);\r\n    }\r\n\r\n    protected set_containers(): boolean {\r\n        return this.cannotSet('containers');\r\n    }\r\n\r\n    protected get_containers(context: Context): LModelElement[\"containers\"] {\r\n        let thiss: LModelElement = context.proxyObject;\r\n        const ret: LModelElement[] = [thiss];\r\n        while (true) {\r\n            thiss = thiss.father;\r\n            if (!thiss) break;\r\n            ret.push(thiss);\r\n        }\r\n        return ret as LNamedElement[];\r\n    }\r\n\r\n\r\n    protected get_namespace(context: Context): string {\r\n        throw new Error(\"?? get namespace ?? todo\");\r\n        return \"\";\r\n    }\r\n\r\n    protected get_subNodes(context: LogicContext<LClass>, includingthis: boolean = false): LGraphElement[] {\r\n        const lclass: LClass = context.proxyObject as any;\r\n        let $class = $('[data-dataid=\"' + context.data.id + '\"]');\r\n        let $subnodes = $class.find('[data-nodeid]');\r\n\r\n        function mapfunc(this: HTMLElement) {\r\n            return this.dataset.nodeid;\r\n        }\r\n\r\n        let nodehtmlarr: HTMLElement[] = $subnodes.toArray();\r\n        if (includingthis) nodehtmlarr.push($class[0]);\r\n        let nodeidarr: string[] = nodehtmlarr.map((html: HTMLElement) => html.dataset.nodeid) as string[];\r\n        let state = store.getState();\r\n        let dnodes = nodeidarr.map(id => state.idlookup[id]).filter((d) => !!d);\r\n        return dnodes.map(d => LPointerTargetable.wrap(d)) as any;\r\n    }\r\n\r\n\r\n    // name -> redux (es. DClass -> classs)\r\n    protected get_property(context: Context): this[\"property\"] {\r\n        return (context.data.className.substring(1) + \"s\").toLowerCase() as any;\r\n    }\r\n\r\n    protected targetRemoved(context: Context, field: keyof DPointerTargetable): void {\r\n        context.proxyObject.delete();\r\n    }\r\n\r\n\r\n    protected get_fatherList(context: Context): LModelElement[] {\r\n        let ret: LModelElement[] = [context.proxyObject];\r\n        let loopdetection: Dictionary<Pointer, boolean> = {};\r\n        loopdetection[context.data.id] = true;\r\n        let current = this.get_father(context);\r\n        while (current) {\r\n            if (loopdetection[current.id]) { console.error(\"found loop\", {loopdetection, ret, current}); return ret; }\r\n            loopdetection[current.id] = true;\r\n            ret.push(current);\r\n            current = current.father;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public superDelete(): void {\r\n    }\r\n\r\n    protected get_superDelete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const father = data.father.__raw;\r\n        const fatherFieldName = U.getFatherFieldToDelete(data);\r\n        const reduxFieldName = U.getReduxFieldToDelete(data);\r\n        const ret = () => {\r\n            if (fatherFieldName) {\r\n                const fatherField: Pointer<DModelElement, 0, 'N', LModelElement> = father[fatherFieldName] as Pointer<DModelElement, 0, 'N', LModelElement>;\r\n                SetFieldAction.new(father, fatherFieldName, fatherField.indexOf(data.id), '-=', true);\r\n            }\r\n            if (reduxFieldName) {\r\n                const state = Selectors.getState();\r\n                const reduxField: Pointer<DModelElement, 0, 'N', LModelElement> = state[reduxFieldName];\r\n                SetRootFieldAction.new(reduxFieldName, reduxField.indexOf(data.id), '-=', true);\r\n            }\r\n            if(data.children) { for(let child of data.children) { child.delete(); } }\r\n            const selected = Selectors.getState()._lastSelected?.modelElement;\r\n            if(selected && selected === data.id) SetRootFieldAction.new('_lastSelected', {}, '', false);\r\n            DeleteElementAction.new(data.id);\r\n        };\r\n        return ret;\r\n    }\r\n\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const ret = () => {\r\n            context.proxyObject.superDelete();\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\r\n    // @ts-ignore\r\n    private get_until_parent<D extends Constructor, L extends DtoL<InstanceType<D>>>(l: LModelElement, d: DModelElement, father: D): L | null {\r\n        while (true) {\r\n            // console.log('get_until_parent', {l, d, father}, {dname: d.className, fname: father.name});\r\n            if (d.className === (father.name || father.name)) return l as L;\r\n            l = l.father;\r\n            let oldd = d;\r\n            d = l?.__raw;\r\n            if (oldd === d || !l) return null; // reached end of father chain (a model) without finding the desired parent.\r\n        }\r\n    }\r\n\r\n    protected get_nodes(context: Context): this[\"nodes\"] {\r\n        const nodes: LGraphElement[] = [];\r\n        const nodeElements = $('[data-dataid=\"' + context.data.id + '\"]');\r\n        for (let nodeElement of nodeElements) {\r\n            const nodeId = nodeElement.id;\r\n            if (nodeId) {\r\n                const lNode: LGraphElement | undefined = LPointerTargetable.wrap(nodeId);\r\n                if (lNode) nodes.push(lNode);\r\n            }\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    protected get_node(context: Context): this[\"node\"] {\r\n        const nodes = context.proxyObject.nodes;\r\n        return nodes.filter( n => n.favoriteNode)[0] || nodes[0];\r\n    }\r\n\r\n    /*\r\n    protected get_nodes(context: Context): this[\"nodes\"] {\r\n        return context.data.nodes.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_nodes(val: PackArr<this[\"nodes\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'nodes', list);\r\n        return true;\r\n    }\r\n    */\r\n\r\n    protected get_model(context: Context): LModel {\r\n        return this.get_until_parent(context.proxyObject, context.data, DModel) as LModel;\r\n    }\r\n\r\n    protected get_package(context: Context): LPackage {\r\n        return this.get_until_parent(context.proxyObject, context.data, DPackage) as LPackage;\r\n    }\r\n\r\n    protected get_class(context: Context): LClass | null {\r\n        return this.get_until_parent(context.proxyObject, context.data, DClass);\r\n    } // todo: might be better for pergormance to erase this universal method and add implementations to every single L-class counting the correct amount of \"father\" navigations for each ( attrib to package? use attrib.father.father)\r\n    protected get_operation(context: Context): LOperation | null {\r\n        return this.get_until_parent(context.proxyObject, context.data, DOperation);\r\n    }\r\n\r\n    protected get_enum(context: Context): LEnumerator | null {\r\n        return this.get_until_parent(context.proxyObject, context.data, DEnumerator);\r\n    }\r\n\r\n    protected get_father(context: Context): LModelElement {\r\n        return LPointerTargetable.from(context.data.father);\r\n    }\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DPackage | DClassifier | DEnumerator | DEnumLiteral | DParameter | DStructuralFeature | DOperation | DObject | DValue, 1, 'N'> { // LPackage | LClassifier | LTypedElement | LAnnotation | LEnumLiteral | LParameter | LStructuralFeature | LOperation\r\n        return context.data.annotations ? [...context.data.annotations] : [];\r\n    }\r\n\r\n    protected get_children(context: Context): this[\"children\"] {\r\n        // return this.get_children_idlist(context).map(e => LPointerTargetable.from(e));\r\n        return LPointerTargetable.from(this.get_children_idlist(context));\r\n    }\r\n\r\n    protected set_children(a: never, context: Context): boolean {\r\n        return Log.exx('children is a derived read-only collection', this);\r\n    }\r\n\r\n\r\n    add_parent(val: Pack<this[\"parent\"]>, logicContext: Context): boolean { // todo: when will be used?\r\n        const ptr = Pointers.from(val);\r\n        return SetFieldAction.new(logicContext.data, 'parent', ptr, '+=', true); // todo: need to update children of the old and new parents\r\n    }\r\n\r\n    protected remove_parent(logicContext: Context): boolean { // todo: perchè senza bersaglio? perchè sempre elimina tutti?\r\n        return SetFieldAction.new(logicContext.data, 'parent', [], '', true);\r\n    }\r\n\r\n    protected get_parent(context: Context): this[\"parent\"] {\r\n        return LPointerTargetable.from(context.data.id);\r\n    }\r\n\r\n    protected set_parent(val: Pack<LAnnotation>, context: Context): boolean { // val: Pack<DModelElement>\r\n        const ptrs = Pointers.from(val);\r\n        SetFieldAction.new(context.data, 'father', ptrs?.[0] || ptrs, '', true);\r\n        return SetFieldAction.new(context.data, 'parent', ptrs, '', true);\r\n    }\r\n\r\n    add_annotation(val: Pack<this[\"annotations\"]>, context: Context): boolean {\r\n        const ptrs = Pointers.from(val);\r\n        return SetFieldAction.new(context.data, 'annotations', ptrs, '+=', true);\r\n    }\r\n\r\n    remove_annotation(val: Pack<this[\"annotations\"]>, context: Context): boolean { // todo: when this will be ever used? this should be triggered by LObject but only get_ / set_ and delete of whole elements should be triggerable.\r\n        //todo: remove as any\r\n        const ptrs: Pointer<DAnnotation, 1, 'N', LAnnotation> = Pointers.from(val) as any;\r\n        let indexes = ptrs.map(ptr => context.data.annotations.indexOf(ptr)).filter(p => p >= 0);\r\n        return SetFieldAction.new(context.data, 'annotations', indexes, '-=', true);\r\n    }\r\n\r\n    protected get_annotations(context: Context): this[\"annotations\"] {\r\n        return LPointerTargetable.fromPointer(context.data.annotations);\r\n    }\r\n\r\n    protected set_annotations(val: Pack<LAnnotation>, context: Context): boolean {\r\n        //  if (!Array.isArray(val)) val = [val];\r\n        //         val = val.map( v => (v instanceof LAnnotation ? v.id : ( Pointers.filterValid(v) ? v : null ))) as Pointer<DAnnotation>[];\r\n        const ptrs = Pointers.from(val);\r\n        SetFieldAction.new(context.data, 'annotations', ptrs, '', true);\r\n        return true;\r\n    }\r\n\r\n    protected get_addChild(context: Context): (type: string, ...params: any[]) => DModelElement { // just for add new, not for add pre-existing.\r\n        console.log(\"addchild\", context, this);\r\n        return (type, ...args: any) => {\r\n            let ret: undefined | ((...params: any[]) => DModelElement);\r\n            switch ((type || '').toLowerCase()) {\r\n                default:\r\n                    Log.ee('cannot find children type requested to add:', {type: (type || '').toLowerCase(), context});\r\n                    ret = () => undefined as any;\r\n                    break;\r\n                case \"attribute\":\r\n                    ret = this.get_class(context)?.addAttribute;\r\n                    break;\r\n                case \"class\":\r\n                    let current = context.proxyObject;\r\n                    ret = this.get_package(context)?.addClass;\r\n                    //ret = (this as any).get_addClass(context as any);\r\n                    break;\r\n                case \"package\":\r\n                    ret = (this.get_package(context) || this.get_model(context))?.addPackage;\r\n                    break;\r\n                case \"reference\":\r\n                    ret = this.get_class(context)?.addReference;\r\n                    break;\r\n                case \"enumerator\":\r\n                    ret = this.get_package(context)?.addEnumerator;\r\n                    break;\r\n                case \"literal\":\r\n                    ret = this.get_enum(context)?.addLiteral;\r\n                    break;\r\n                case \"operation\":\r\n                    ret = this.get_class(context)?.addOperation;\r\n                    break;\r\n                case \"parameter\":\r\n                    ret = this.get_operation(context)?.addParameter;\r\n                    break;\r\n                //case \"exception\": ret = ((exception: Pack1<LClassifier>) => { let rett = this.get_addException(context as any); rett(exception); }) as any; break;\r\n                case \"exception\":\r\n                    ret = (this as any).get_addException(context as any);\r\n                    break;\r\n            }\r\n            return ret ? ret(...args) : null as any;\r\n        }\r\n    }\r\n\r\n    /*\r\n        protected get_addPackage(context: Context): (() => void) {\r\n            let ret = () => {};\r\n            switch (context.data?.className) {\r\n                default: break;\r\n                case \"DModel\": ret = () => LModelElement.addPackage(context.data as DModel); break;\r\n                case \"DPackage\": ret = () => LModelElement.addSubPackage(context.data as DPackage); break;\r\n            }\r\n            ret();\r\n            return ret;\r\n        }\r\n\r\n        private static addPackage(dModel: DModel): void {\r\n            const lModel: LModel = LModelElement.from(dModel);\r\n            let name = 'package_' + 0;\r\n            let childrenNames: (string)[] = lModel.packages.map( p => p.name);\r\n            name = U.increaseEndingNumber(name, false, false, (newName) => childrenNames.indexOf(newName) >= 0)\r\n            const dPackage = DPackage.new(name);\r\n            CreateElementAction.new(dPackage);\r\n            let wModel = WPointerTargetable.fromD(dModel);\r\n            wModel.packages = [...dModel.packages, dPackage];\r\n        }\r\n\r\n        private static addSubPackage_obsolete(dPackage: never): void {\r\n            const lPackage: LPackage = LPackage.from(dPackage);\r\n            let name = 'subpackage_' + 0;\r\n            let childrenNames: (string)[] = lPackage.children.map( p => (p as LPackage).name);\r\n            name = U.increaseEndingNumber(name, false, false, (newName) => childrenNames.indexOf(newName) >= 0)\r\n            const dSubPackage = DPackage.new(name);\r\n            CreateElementAction.new(dSubPackage);\r\n            let wPackage = WPointerTargetable.fromD(dPackage);\r\n            wPackage.subpackages = [...dPackage.subpackages, dSubPackage];\r\n        }*/\r\n\r\n    protected get_addException(context: Context): () => void {\r\n        let ret = () => {\r\n        };\r\n        const dOperation: DOperation | null = (context.data?.className === \"DOperation\") ? context.data as DOperation : null;\r\n        if (dOperation) {\r\n            const dClass = DPointerTargetable.from(dOperation.father);\r\n            ret = () => {\r\n                SetFieldAction.new(dOperation, \"exceptions\", dClass.id, '+=', true);\r\n            }\r\n        }\r\n        ret();\r\n        return ret;\r\n    }\r\n\r\n    // activated by user in JSX\r\n    // todo: this.wrongAccessMessage(\"addClass\");\r\n    protected cannotCall(name: string, ...params: string[]): any {\r\n        Log.exDevv(name + ' should never be called directly, but should trigger get_' + name + '(' + params.join(', ') + '), this is only a signature for type checking.');\r\n    }\r\n\r\n    public addClass(): void {\r\n        this.cannotCall('addClass');\r\n    }\r\n\r\n    public addAttribute(): void {\r\n        this.cannotCall('addAttribute');\r\n    }\r\n\r\n    public addReference(): void {\r\n        this.cannotCall('addReference');\r\n    }\r\n\r\n    public addEnumerator(): void {\r\n        this.cannotCall('addEnumerator');\r\n    }\r\n\r\n    public addParameter(): void {\r\n        this.cannotCall('addParameter');\r\n    }\r\n\r\n    // chiedere al prof: cosa può lanciato come eccezione: se tutte le classi o se solo quelle che estendono Exception\r\n    public addException(exception?: DClassifier): () => void {\r\n        throw this.wrongAccessMessage(\"AddException\");\r\n    }\r\n\r\n    public addChild(type: string): DModelElement { return this.cannotCall(\"addChild\", type); }\r\n\r\n}\r\n\r\n/*function isValidPointer<T extends DPointerTargetable = DModelElement, LB extends number = 0, UB extends number = 1, RET extends LPointerTargetable = LModelElement>\r\n(p: Pointer<T, LB, UB, RET>, constraintType?: typeof DPointerTargetable): boolean {\r\n    const pointerval: RET | null = LModelElement.ResolvePointer(p);\r\n    if (!pointerval) return false;\r\n    if (!constraintType) return true;\r\n    return (pointerval instanceof constraintType); }*/\r\n\r\n/* todo:\r\nnel proxy aggiungi regola di default, se prendi qualcosa che inizia con \"set_X\" esplicitamente (dovrebbe farlo solo il dev)\r\nrichiama _set_X(context, ...params)     <---- nuova funzione set di default, anche this.x = x richiama _set_x\r\n\r\nil dev specifica set_x come public di sola firma senza implementazione (throw exception) e senza context\r\nil dev specifica _set_x come implementazione private\r\n\r\nper la get esiste solo _get_x, non \"get_x\"\r\n\r\n todo2: aggiungi readonly a tutti i campi L per non sbagliarsi e fare in modo che il dev usi sempre i \"set_\" che sono correttamente tipizzati\r\n*\r\n* */\r\n\r\n/*todo:\r\n* for every feature X: typed L, in CLASS_L0 with a side effects when they are edited (like need to update other data for consistency)\r\n*\r\n* dev will use this\r\n* protected set_X(val: D | L | Pointer<D> ) { throw new Error(\"set_X should never be executed, the proxy should redirect to get_set_X.\"); }\r\n* protected get_set_X( val: D | L | Pointer<D>, otherparams, ContextD>) { throw new Error(\"set_X should never be executed, the proxy should redirect to get_set_X.\"); }\r\n*\r\n*\r\n* */\r\n// @RuntimeAccessible export class _WModelElement extends LModelElement { }\r\n// export type WModelElement = DModelElement | LModelElement | _WModelElement;\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DModelElement);\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, LModelElement);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DAnnotation extends DModelElement { // extends Mixin(DAnnotation0, DModelElement)\r\n    public static cname: string = \"DAnnotation\";\r\n    // static singleton: LAnnotation;\r\n    // static logic: typeof LAnnotation;\r\n    // static structure: typeof DAnnotation;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // inherit redefine\r\n    id!: Pointer<DAnnotation, 1, 1, LAnnotation>;\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    // personal\r\n    source!: string;\r\n    details!: DAnnotationDetail[];//Dictionary<string, string>;\r\n\r\n    public static new(source?: DAnnotation[\"source\"], details?: DAnnotation[\"details\"], father?: Pointer, persist: boolean = true): DAnnotation {\r\n        // if (!name) name = this.defaultname(\"annotation \", father);\r\n        return new Constructors(new DAnnotation('dwc'), father, persist, undefined).DPointerTargetable().DModelElement().DAnnotation(source, details).end();\r\n    }\r\n}\r\n\r\n@Node\r\n@RuntimeAccessible\r\nexport class LAnnotation<Context extends LogicContext<DAnnotation> = any, D extends DAnnotation = DAnnotation> extends LModelElement {\r\n    public static cname: string = \"LAnnotation\";\r\n    // Mixin(DAnnotation0, LModelElement)\r\n    // @ts-ignore\r\n    __namee!: \"LAnnotation\" = \"LAnnotation\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DAnnotation;\r\n    id!: Pointer<DAnnotation, 1, 1, LAnnotation>;\r\n    // static singleton: LAnnotation;\r\n    // static logic: typeof LAnnotation;\r\n    // static structure: typeof DAnnotation;\r\n\r\n    // inherit redefine\r\n    parent!: LModelElement[];\r\n    father!: LModelElement;\r\n    annotations!: LAnnotation[];\r\n    // personal\r\n    source!: string;\r\n    details!: LAnnotationDetail[];// Dictionary<string, string> = {};\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        EcoreParser.write(json, ECoreAnnotation.source, context.data.source);\r\n        // EcoreParser.write(json, ECoreAnnotation.references, context.proxyObject.referencesStr);\r\n        EcoreParser.write(json, ECoreAnnotation.details, context.proxyObject.details.map(d => d.generateEcoreJson(loopDetectionObj)));\r\n        return json;\r\n    }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall(((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\");\r\n    }\r\n\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de = context.proxyObject.father.addAnnotation(context.data.source, (deep ? context.proxyObject.details.map(ldet => ldet.duplicate().__raw) : context.data.details));\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WAnnotation = le as any;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            END()\r\n            return le;\r\n        }\r\n    }\r\n\r\n    protected get_source(context: Context): this[\"source\"] {\r\n        return context.data.source;\r\n    }\r\n\r\n    protected set_source(val: this[\"source\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'source', val, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected get_details(context: Context): this[\"details\"] {\r\n        return TargetableProxyHandler.wrapAll(context.data.details);\r\n    }\r\n\r\n    protected set_details(val: this[\"details\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'details', val);\r\n        return true;\r\n    }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DModelElement, DAnnotation);\r\nRuntimeAccessibleClass.set_extend(LModelElement, LAnnotation);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class LAnnotationDetail<Context extends LogicContext<DAnnotationDetail> = any> extends LModelElement { // todo\r\n    public static cname: string = \"LAnnotationDetail\";\r\n    father!: LAnnotation;\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        // loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        // if (context.data.name !== null) EcoreParser.write(json, ECoreDetail.key, context.data.name);\r\n        // if (context.data.value !== null) EcoreParser.write(json, ECoreDetail.value, context.data.value);\r\n        return json;\r\n    }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall(((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\");\r\n    }\r\n\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        Log.exDevv(\"LAnnotationDetail.getDuplicate(): todo\");\r\n        return () => this;\r\n        // return (deep: boolean = false) => (context.proxyObject as LAnnotationDetail).father.addAnnotationDetail( {...context.data._subMaps})\r\n    }\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DModelElement, DAnnotationDetail);\r\nRuntimeAccessibleClass.set_extend(LModelElement, LAnnotationDetail);\r\n@Node\r\n@RuntimeAccessible\r\nexport class DNamedElement extends DPointerTargetable { // Mixin(DNamedElement0, DAnnotation)\r\n    public static cname: string = \"DNamedElement\";\r\n    // static _super = DAnnotation;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LNamedElement;\r\n    // static logic: typeof LNamedElement;\r\n    // static structure: typeof DNamedElement;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DNamedElement, 1, 1, LNamedElement>;\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    // personal\r\n    name!: string;\r\n\r\n    public static new(name?: DNamedElement[\"name\"]): DNamedElement {\r\n        Log.exx(\"DNamedElement is abstract, cannot instantiate\");\r\n        return null as any;\r\n        // return new Constructors(new DNamedElement('dwc')).DPointerTargetable().DModelElement().DNamedElement(name).end();\r\n    }\r\n\r\n}\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LNamedElement<Context extends LogicContext<DNamedElement> = any> extends LModelElement { // Mixin(DNamedElement0, DAnnotation)\r\n    public static cname: string = \"LNamedElement\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // public __raw!: DNamedElement;\r\n    id!: Pointer<DNamedElement, 1, 1, LNamedElement>;\r\n    // static singleton: LNamedElement;\r\n    // static logic: typeof LNamedElement;\r\n    // static structure: typeof DNamedElement;\r\n\r\n    // inherit redefine\r\n    parent!: LModelElement[];\r\n    father!: LModelElement;\r\n    annotations!: LAnnotation[];\r\n    // personal\r\n    name!: string;\r\n    namespace!: string;\r\n    fullname!: string;\r\n\r\n    protected set_containers(): boolean {\r\n        return this.cannotSet('containers');\r\n    }\r\n\r\n    protected get_containers(context: Context): LNamedElement[\"containers\"] {\r\n        let thiss: LNamedElement = context.proxyObject;\r\n        const ret: LNamedElement[] = [thiss];\r\n        while (true) {\r\n            thiss = thiss.father as LNamedElement;\r\n            if (!thiss) break;\r\n            ret.push(thiss);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    // protected get_namespace(context: Context): string { throw new Error(\"?? get namespace ?? todo\"); return \"\"; }\r\n\r\n    protected get_fullname(context: Context): this[\"fullname\"] {\r\n        const containers = this.get_containers(context);\r\n        let fullname: string = containers.reverse().slice(1, containers.length).map(c => c.name).join('.');\r\n        return fullname;\r\n    }\r\n\r\n\r\n    protected get_name(context: Context): this[\"name\"] {\r\n        return context.data.name;\r\n    }\r\n\r\n    protected set_name(val: this[\"name\"], context: Context): boolean {\r\n        let name = val;\r\n        const father = context.proxyObject.father;\r\n        if (father) {\r\n            const check = father.children.filter((child) => {\r\n                return (DNamedElement.fromPointer(child.id) as DNamedElement).name === name\r\n            });\r\n            if (check.length > 0) {\r\n                U.alert('error', 'Cannot rename the selected element since this name is already taken.');\r\n                return true\r\n            }\r\n        }\r\n        SetFieldAction.new(context.data, 'name', name, '', false);\r\n        return true;\r\n\r\n        /*\r\n        // this autofix removes spaces with _\r\n        if (val.match(/\\s/)) val = this._autofix_name(val, context);\r\n        // todo: validate if operation can be completed or need autocorrection, then either return false (invalid parameter cannot complete) or send newVal at redux\r\n        const fixedVal: string = val;\r\n        SetFieldAction.new(context.data, 'name', fixedVal, '', false);\r\n        return true;\r\n        */\r\n    }\r\n\r\n    protected _autofix_name(val: string, context: Context): string {\r\n        // NB: NON fare autofix di univocità nome tra i children o qualsiasi cosa dipendente dal contesto, questo potrebbe essere valido in alcuni modelli e invalido in altri e modificare un oggetto condiviso.\r\n        return val.replaceAll(/\\s/g, '_');\r\n    }\r\n\r\n    protected get_autofix_name(val: string, context: Context): (val: string) => string {\r\n        return (val: string) => this._autofix_name(val, context);\r\n    }\r\n\r\n    public autofix_name(val: string): string {\r\n        return this.wrongAccessMessage(\"autofix_name\");\r\n    }\r\n}\r\n\r\n// @RuntimeAccessible export class _WNamedElement extends _WModelElement { }\r\n// export type WNamedElement = DNamedElement | LNamedElement | _WNamedElement;\r\nRuntimeAccessibleClass.set_extend(DModelElement, DNamedElement);\r\nRuntimeAccessibleClass.set_extend(LModelElement, LNamedElement);\r\n@RuntimeAccessible\r\nexport class DTypedElement extends DPointerTargetable { // Mixin(DTypedElement0, DNamedElement)\r\n    public static cname: string = \"DTypedElement\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LTypedElement;\r\n    // static logic: typeof LTypedElement;\r\n    // static structure: typeof DTypedElement;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DTypedElement, 1, 1, LTypedElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    name!: string;\r\n    instances!: Pointer<DValue, 0, 'N', LValue>;\r\n    // personal\r\n    type!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean; // ?\r\n    required!: boolean; // ?\r\n\r\n\r\n    public static new(name?: DNamedElement[\"name\"], type?: DTypedElement[\"type\"], father?: Pointer, persist: boolean = true): DTypedElement {\r\n        Log.exx(\"DTypedElement is abstract, cannot instantiate\");\r\n        return null as any;\r\n        //return new Constructors(new DTypedElement('dwc'), father, persist, undefined).DPointerTargetable().DModelElement().DNamedElement(name).DTypedElement(type).end();\r\n    }\r\n}\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LTypedElement<Context extends LogicContext<DTypedElement> = any> extends LNamedElement { // extends Mixin(DTypedElement0, LNamedElement)\r\n    public static cname: string = \"LTypedElement\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DTypedElement;\r\n    id!: Pointer<DTypedElement, 1, 1, LTypedElement>;\r\n    // static singleton: LTypedElement;\r\n    // static logic: typeof LTypedElement;\r\n    // static structure: typeof DTypedElement;\r\n\r\n    // inherit redefine\r\n    parent!: LModelElement[];\r\n    father!: LModelElement;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    instances!: LValue[];\r\n    // personal\r\n    type!: LClassifier;\r\n\r\n    primitiveType?: LClass;\r\n    classType?: LClass;\r\n    enumType?: LEnumerator;\r\n\r\n    ordered!: boolean;\r\n    unique!: boolean;\r\n    lowerBound!: number;\r\n    upperBound!: number;\r\n    many!: boolean;\r\n    required!: boolean;\r\n\r\n\r\n    protected get_classType(context: Context): this[\"classType\"] {\r\n        let type = this.get_type(context);\r\n        return type.isClass ? type as LClass : undefined;\r\n    }\r\n\r\n    protected get_enumType(context: Context): this[\"enumType\"] {\r\n        let type = this.get_type(context);\r\n        return type.isEnum ? type as LEnumerator : undefined;\r\n    }\r\n\r\n    protected get_primitiveType(context: Context): this[\"primitiveType\"] {\r\n        let type = this.get_type(context);\r\n        return type.isPrimitive ? type as LClass : undefined;\r\n    }\r\n\r\n    protected get_type(context: Context): this[\"type\"] {\r\n        return LPointerTargetable.from(context.data.type);\r\n    }\r\n\r\n    protected set_type(val: Pack1<this[\"type\"]>, context: Context): boolean {\r\n        const data = context.data;\r\n        let instances: LValue[] = context.proxyObject.instances;\r\n        SetFieldAction.new(context.data, 'type', Pointers.from(val), \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_ordered(context: Context): this[\"ordered\"] {\r\n        return context.data.ordered;\r\n    }\r\n\r\n    protected set_ordered(val: this[\"ordered\"], logicContext: Context): boolean {\r\n        return SetFieldAction.new(logicContext.data, 'ordered', val);\r\n    }\r\n\r\n    protected get_unique(context: Context): this[\"unique\"] {\r\n        return context.data.unique;\r\n    }\r\n\r\n    protected set_unique(val: this[\"unique\"], logicContext: Context): boolean {\r\n        return SetFieldAction.new(logicContext.data, 'unique', val);\r\n    }\r\n\r\n    protected get_lowerBound(context: Context): this[\"lowerBound\"] {\r\n        return context.data.lowerBound;\r\n    }\r\n\r\n    protected set_lowerBound(val: this[\"lowerBound\"], context: Context): boolean {\r\n        val = +val;\r\n        if (isNaN(val)) val = 0;\r\n        else val = Math.max(0, val);\r\n        SetFieldAction.new(context.data, 'lowerBound', val);\r\n        if (context.data.upperBound !=-1 && val > context.data.upperBound) SetFieldAction.new(context.data, 'upperBound', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_upperBound(context: Context): this[\"upperBound\"] {\r\n        return context.data.upperBound;\r\n    }\r\n\r\n    protected set_upperBound(val: this[\"upperBound\"], context: Context): boolean {\r\n        val = +val;\r\n        if (isNaN(val)) val = -1;\r\n        else val = Math.max(-1, val);\r\n        SetFieldAction.new(context.data, 'upperBound', val);\r\n        if (val !== -1 && val < context.data.lowerBound) SetFieldAction.new(context.data, 'lowerBound', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_many(context: Context): this[\"many\"] {\r\n        return context.data.many;\r\n    }\r\n\r\n    protected set_many(val: this[\"many\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'many', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_required(context: Context): this[\"required\"] {\r\n        return context.data.required;\r\n    }\r\n\r\n    protected set_required(val: this[\"required\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'required', val);\r\n        return true;\r\n    }\r\n\r\n    public typeToEcoreString(): string {\r\n        return this.cannotCall(\"typeToEcoreString\");\r\n    }\r\n\r\n    protected get_typeToEcoreString(context: Context): () => string {\r\n        // if (context.data.classType) return EcoreParser.classTypePrefix + context.proxyObject.classType.name;\r\n        // if (context.data.enumType) return EcoreParser.classTypePrefix + context.proxyObject.enumType.name;\r\n        // if (context.data.primitiveType) return context.proxyObject.primitiveType.long;\r\n        return () => context.proxyObject.type.typeEcoreString;\r\n    }\r\n\r\n    public typeToShortString(): string {\r\n        return this.cannotCall(\"typeToShortString\");\r\n    }\r\n\r\n    protected get_typeToShortString(context: Context): () => string {\r\n        // if (context.data.classType) return '' + context.data.classType.name;\r\n        // if (context.data.enumType) return '' + context.data.enumType.name;\r\n        // if (context.data.primitiveType) return '' + context.data.primitiveType.getName();\r\n        return () => context.proxyObject.type.typeString;\r\n    }\r\n\r\n    canOverride(context: Context, other: LTypedElement): boolean {\r\n        // i primitivi identici sono compatibili\r\n        if (context.data.type === other.type.id) return true;\r\n        let t1 = context.proxyObject.type;\r\n        let t2 = other.type;\r\n        // se entrambi primitivi\r\n        if (context.proxyObject.primitiveType && other.primitiveType) {\r\n            ShortAttribSuperTypes[t1.name as ShortAttribETypes].includes(other.name as ShortAttribETypes);\r\n        }\r\n        if (context.proxyObject.enumType) return t1 === t2; // only if they are same enumerator\r\n        // now assumed to be class type\r\n        if (other.classType === other.classType) return true;\r\n        return (context.proxyObject.classType as LClass).isExtending(other.classType as LClass);\r\n    }\r\n\r\n}\r\n\r\n// @RuntimeAccessible export class _WTypedElement extends _WNamedElement { }\r\n// export type WTypedElement = DTypedElement | LTypedElement | _WTypedElement;\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DTypedElement);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LTypedElement);\r\n@RuntimeAccessible\r\nexport /*abstract*/\r\nclass DClassifier extends DPointerTargetable { // extends DNamedElement\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LClassifier;\r\n    // static logic: typeof LClassifier;\r\n    // static structure: typeof DClassifier;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    parent: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    father!: Pointer<DPackage, 1, 1, LPackage>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    // personal\r\n    instanceClassName!: string;\r\n    // instanceClass: EJavaClass // ?\r\n    defaultValue!: Pointer<DObject, 1, 1, LObject>[] | string[];\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n\r\n    public static new(name?: DNamedElement[\"name\"], father?: Pointer, persist: boolean = true): DClassifier {\r\n        Log.exx(\"DClassifier is abstract, cannot instantiate\");\r\n        return null as any;\r\n        // return new Constructors(new DClassifier('dwc'), father, persist, undefined).DPointerTargetable().DModelElement().DNamedElement(name).DClassifier().end();\r\n    }\r\n}\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LClassifier<Context extends LogicContext<DClassifier> = any> extends LNamedElement { // extends DNamedElement\r\n    public static cname: string = \"LClassifier\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DClassifier;\r\n    id!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    // static singleton: LClassifier;\r\n    // static logic: typeof LClassifier;\r\n    // static structure: typeof DClassifier;\r\n\r\n    // inherit redefine\r\n    parent!: LPackage[];\r\n    father!: LPackage;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    // personal\r\n    instanceClassName!: string;\r\n    // instanceClass: EJavaClass // ?\r\n    defaultValue!: LObject[] | string[];\r\n    isPrimitive!: boolean;\r\n    isClass!: boolean;\r\n    isEnum!: boolean;\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n\r\n    protected get_instanceClassName(context: Context): this[\"instanceClassName\"] {\r\n        return context.data.instanceClassName;\r\n    }\r\n\r\n    protected set_instanceClassName(val: this[\"instanceClassName\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'instanceClassName', val, \"\", false);\r\n        return true;\r\n    }\r\n\r\n    protected set_isPrimitive(val: this[\"isPrimitive\"], context: Context): boolean {\r\n        return this.cannotSet(\"isPrimitive\");\r\n    }\r\n\r\n    protected set_isClass(val: this[\"isClass\"], context: Context): boolean {\r\n        return this.cannotSet(\"isClass\");\r\n    }\r\n\r\n    protected set_isEnum(val: this[\"isEnum\"], context: Context): boolean {\r\n        return this.cannotSet(\"isEnum\");\r\n    }\r\n\r\n    protected get_isPrimitive(context: Context): this[\"isPrimitive\"] {\r\n        return !!((context.data as DClass).isPrimitive as unknown);\r\n    }\r\n\r\n    protected get_isClass(context: Context): this[\"isClass\"] {\r\n        return (context.data as DClass).isPrimitive ? false : context.data.className === DClass.cname;\r\n    }\r\n\r\n    protected get_isEnum(context: Context): this[\"isEnum\"] {\r\n        return context.data.className === DEnumerator.cname;\r\n    }\r\n\r\n    protected set_defaultValue(val: this[\"defaultValue\"] | DClassifier[\"defaultValue\"], context: Context): boolean {\r\n        if (typeof val !== \"object\" && !Pointers.isPointer(val)) {\r\n            // primitive default value for enums\r\n            SetFieldAction.new(context.data, 'defaultValue', val, \"\", false);\r\n        } else {\r\n            SetFieldAction.new(context.data, 'defaultValue', Pointers.from(val as Pointer[]) || [], \"\", true);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    typeEcoreString!: string;\r\n    typeString!: string;\r\n\r\n    private get_typeEcoreString(context: Context) {\r\n        return EcoreParser.classTypePrefix + context.data.name;\r\n    }\r\n\r\n    private get_typeString(context: Context) {\r\n        return context.data.name;\r\n    }\r\n}\r\n\r\n// @RuntimeAccessible export class _WClassifier extends _WNamedElement { }\r\n// export type WClassifier = DClassifier | LClassifier | _WClassifier;\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DClassifier);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LClassifier);\r\n@RuntimeAccessible\r\nexport class DPackage extends DPointerTargetable { // extends DNamedElement\r\n    public static cname: string = \"DPackage\";\r\n    // static _super = DNamedElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LPackage;\r\n    // static logic: typeof LPackage;\r\n    // static structure: typeof DPackage;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DPackage, 1, 1, LPackage>;\r\n    parent: Pointer<DPackage | DModel, 0, 'N', LPackage | LModel> = [];\r\n    father!: Pointer<DPackage | DModel, 1, 1, LPackage | LModel>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    // personal\r\n    classifiers: Pointer<DClassifier, 0, 'N', LClassifier> = [];\r\n    subpackages: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    uri!: string;\r\n    prefix!: string;\r\n\r\n    public static new(name?: DNamedElement[\"name\"], uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"], father?: Pointer, persist: boolean = true, fatherType?: Constructor): DPackage {\r\n        let dmodel: DModel | undefined;\r\n        if (!name) {\r\n            dmodel = father && DPointerTargetable.from(father);\r\n            name = this.defaultname(\"pkg_\", dmodel);\r\n        }\r\n        /*if (!uri) {\r\n            dmodel = dmodel || father && DPointerTargetable.from(father);\r\n            uri = ('org.jodel-react.') + (dmodel?.name || \"username\"); // (DPointerTargetable.from(DUser.current)).name) todo: when DUser is done\r\n        }*/\r\n        return new Constructors(new DPackage('dwc'), father, persist, fatherType).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DPackage(uri, prefix).end();\r\n    }/*\r\n    static new15(setter: (d: DPackage) => void, father: DPackage[\"father\"], fatherType: Constructor, name?: string): DPackage {\r\n        if (!name) name = this.defaultname(\"pkg_\", father);\r\n        return new Constructors(new DPackage('dwc'), father, true, fatherType).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DPackage().end(setter);\r\n    }*/\r\n    static new2(setter: Partial<ObjectWithoutPointers<DPackage>>, father: DPackage[\"father\"], fatherType: Constructor, name?: string): DPackage {\r\n        if (!name) name = this.defaultname(\"pkg_\", father);\r\n        return new Constructors(new DPackage('dwc'), father, true, fatherType).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DPackage().end((d)=> { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class LPackage<Context extends LogicContext<DPackage> = any, C extends Context = Context, D extends DPackage = DPackage> extends LNamedElement { // extends DNamedElement\r\n    public static cname: string = \"LPackage\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DPackage;\r\n    id!: Pointer<DPackage, 1, 1, LPackage>;\r\n    // static singleton: LPackage;\r\n    // static logic: typeof LPackage;\r\n    // static structure: typeof DPackage;\r\n    // inherit redefine\r\n    parent!: (LPackage| LModel)[];  // ype 'LPackage' is missing the following properties from type 'LModelElement': get_set_parent, set_parent\r\n    father!: LPackage | LModel;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    // personal\r\n    classifiers!: LClassifier[];\r\n    subpackages!: LPackage[];\r\n    uri!: string;\r\n    prefix: string = '';\r\n    // derived\r\n    classes!: LClass[];\r\n    enums!: LEnumerator[];\r\n    enumerators!: LEnumerator[];\r\n\r\n    // utilities to go down in the tree (plural names)\r\n    allSubPackages!: LPackage[];\r\n    allSubEnums!: LEnumerator[];\r\n    allSubClasses!: LClass[];\r\n    operations!: LOperation[];\r\n    parameters!: LParameter[];\r\n    exceptions!: LClassifier[];\r\n    attributes!: LAttribute[];\r\n    references!: LReference[];\r\n    literals!: LEnumLiteral[];\r\n\r\n    protected generateEcoreJson_impltemplate(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: GObject = {};\r\n        return json; }\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const model: GObject = {};\r\n        const d = context.data;\r\n        let classarr = context.proxyObject.classes.map( c => c.generateEcoreJson(loopDetectionObj));\r\n        let enumarr = context.proxyObject.enums.map(e => e.generateEcoreJson(loopDetectionObj));\r\n        const classifiers: Json[] = Array.prototype.concat.call(classarr, enumarr);\r\n        model[ECorePackage.xmiversion] = '2.0';\r\n        model[ECorePackage.xmlnsxmi] = 'http://www.omg.org/XMI';\r\n        model[ECorePackage.xmlnsxsi] = 'http://www.w3.org/2001/XMLSchema-instance';\r\n        model[ECorePackage.xmlnsecore] = 'http://www.eclipse.org/emf/2002/Ecore';\r\n        model[ECorePackage.namee] = d.name;\r\n        model[ECorePackage.nsURI] = d.uri;\r\n        model[ECorePackage.nsPrefix] = d.prefix;//getModelRoot().namespace();\r\n        model[ECorePackage.eClassifiers] = classifiers;\r\n        return model; }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addPackage(context.data.name, context.data.uri, context.data.prefix) as D;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WPackage = le as any;\r\n            we.subpackages = deep ? context.proxyObject.subpackages.map( lchild => lchild.duplicate(deep).id) : context.data.subpackages;\r\n            we.classifiers = deep ? context.proxyObject.classifiers.map( lchild => lchild.duplicate(deep).id) : context.data.classifiers;\r\n            we.annotations = deep ? context.proxyObject.annotations.map( lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            END()\r\n            return le;\r\n        }\r\n    }\r\n\r\n    public addPackage(name?: D[\"name\"], uri?: D[\"uri\"], prefix?: D[\"prefix\"]): DPackage { return this.cannotCall(\"addPackage\"); }\r\n    protected get_addPackage(context: Context): this[\"addPackage\"] {\r\n        return (name?: D[\"name\"], uri?: D[\"uri\"], prefix?: D[\"prefix\"]) => {\r\n            const me = DPackage.new(name, uri, prefix, context.data.id, true, DPackage);\r\n            return me;\r\n        }\r\n    }\r\n\r\n    public addClass(name?: DClass[\"name\"], isInterface?: DClass[\"interface\"], isAbstract?: DClass[\"abstract\"], isPrimitive?: DClass[\"isPrimitive\"],\r\n                    isPartial?: DClass[\"partial\"], partialDefaultName?: DClass[\"partialdefaultname\"]): DClass {\r\n        return this.cannotCall(\"addClass\"); }\r\n    protected get_addClass(context: Context): this[\"addClass\"] {\r\n        return (name?: DClass[\"name\"], isInterface?: DClass[\"interface\"], isAbstract?: DClass[\"abstract\"], isPrimitive?: DClass[\"isPrimitive\"],\r\n                isPartial?: DClass[\"partial\"], partialDefaultName?: DClass[\"partialdefaultname\"]\r\n        ) => DClass.new(name, isInterface, isAbstract, isPrimitive, isPartial, partialDefaultName, context.data.id, true); }\r\n\r\n    public addEnum(...p:Parameters<this[\"addEnumerator\"]>): DEnumerator { return this.addEnumerator(...p); }\r\n    protected get_addEnum(context: Context): this[\"addEnumerator\"] { return this.get_addEnumerator(context); }\r\n    public addEnumerator(name?: DEnumerator[\"name\"]): DEnumerator { return this.cannotCall(\"addEnumerator\"); }\r\n    protected get_addEnumerator(context: Context): this[\"addEnumerator\"] {\r\n        return (name?: DEnumerator[\"name\"]) => DEnumerator.new(name, context.data.id, true); }\r\n\r\n    protected get_classes(context: Context): LClass[] {\r\n        let classifiers = DPointerTargetable.fromPointer(context.data.classifiers as Pointer<DClassifier, 1, 1, LClassifier>[]);\r\n        let enumerators = classifiers.filter(dc => dc?.className === DClass.cname ) as DClass[];\r\n        return LPointerTargetable.from(enumerators.map(e=> e.id)); }\r\n    protected get_enums(context: Context): LEnumerator[] { return this.get_enumerators(context); }\r\n    protected get_enumerators(context: Context): LEnumerator[] {\r\n        let classifiers = DPointerTargetable.fromPointer(context.data.classifiers as Pointer<DClassifier, 1, 1, LClassifier>[]);\r\n        let enumerators = classifiers.filter(dc => dc?.className === DEnumerator.cname ) as DEnumerator[];\r\n        return LPointerTargetable.from(enumerators.map(e=> e.id)); }\r\n\r\n    private get_allSubClasses(context: Context): LClass[] {\r\n        const s: DState = store.getState();\r\n        return this.get_allSubPackages(context, s).flatMap(p => p.classes || []); }\r\n    private get_allSubEnums(context: Context): LEnumerator[] { return this.get_allSubEnumerators(context); }\r\n    private get_allSubEnumerators(context: Context): LEnumerator[] {\r\n        const s: DState = store.getState();\r\n        return this.get_allSubPackages(context, s).flatMap(p => (p.enums || []));\r\n    }\r\n\r\n    private get_allSubPackages(context: Context, state?: DState): LPackage[] {\r\n        // return context.data.packages.map(p => LPointerTargetable.from(p));\r\n        state = state || store.getState();\r\n        let tocheck: Pointer<DPackage>[] = context.data.subpackages || [];\r\n        let checked: Dictionary<Pointer, true> = {};\r\n        checked[context.data.id] = true;\r\n        while (tocheck.length) {\r\n            let newtocheck: Pointer<DPackage>[] = [];\r\n            for (let ptr of tocheck) {\r\n                if (checked[ptr]) throw new Error(\"loop in packages containing themselves\");\r\n                checked[ptr] = true;\r\n                let dpackage: DPackage = DPointerTargetable.from(ptr, state);\r\n                U.arrayMergeInPlace(newtocheck, dpackage?.subpackages);\r\n            }\r\n            tocheck = newtocheck;\r\n        }\r\n        return LPointerTargetable.from(Object.keys(checked), state);\r\n    }\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DPackage | DClassifier, 1, 'N'> {\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | DPackage | DClassifier, 1, 'N'>, ...context.data.subpackages, ...context.data.classifiers]; }\r\n\r\n    protected get_classifiers(context: Context): this[\"classifiers\"] {\r\n        return context.data.classifiers.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_classifiers(val: PackArr<this[\"classifiers\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.classifiers;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'classifiers', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_subpackages(context: Context): this[\"subpackages\"] {\r\n        return context.data.subpackages.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_subpackages(val: PackArr<this[\"subpackages\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.subpackages;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'subpackages', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_uri(context: Context): this[\"uri\"] {\r\n        if (context.data.uri) return context.data.uri + \".\" + context.data.name;\r\n        return ('org.jodel-react.') + (context.proxyObject.model?.name || \"username\") + \".\" + context.data.name;\r\n    }\r\n    protected set_uri(val: this[\"uri\"], context: Context): boolean {\r\n        val = val || '';\r\n        let pos = val.lastIndexOf(context.data.name);\r\n        if (pos) val = val.substring(0, pos - 1); // removes final name and dot, to keep the name part dinamically added in the getter.\r\n        SetFieldAction.new(context.data, 'uri', val, \"\", false);\r\n        return true;\r\n    }\r\n    protected get_prefix(context: Context): this[\"uri\"] { return context.data.prefix; }\r\n    protected set_prefix(val: this[\"prefix\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'prefix', val, \"\", false);\r\n        return true;\r\n    }\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const l = context.proxyObject;\r\n        const ret = () => {\r\n            let canBeDeleted = true;\r\n            for(let me of l.classes) {\r\n                if(!canBeDeleted) break;\r\n                canBeDeleted = me.instances.length === 0;\r\n            }\r\n            if(canBeDeleted) {\r\n                // super.delete(context);\r\n                l.superDelete();\r\n            }\r\n            else { U.alert('error', 'Cannot delete the selected package since there are instances.'); }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n}\r\n// @RuntimeAccessible export class _WPackage extends _WNamedElement { }\r\n// export type WPackage = DPackage | LPackage | _WPackage;\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DPackage);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LPackage);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DOperation extends DPointerTargetable { // extends DTypedElement\r\n    public static cname: string = \"DOperation\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LOperation;\r\n    // static logic: typeof LOperation;\r\n    // static structure: typeof DOperation;\r\n\r\n    // inherit redefine\r\n    instances!: never[];\r\n    id!: Pointer<DOperation, 1, 1, LObject>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    parent: Pointer<DClass, 0, 'N', LClass> = [];\r\n    father!: Pointer<DClass, 1, 1, LClass>;\r\n    name!: string;\r\n    type!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    // personal\r\n    exceptions: Pointer<DClassifier, 0, 'N', LClassifier> = [];\r\n    parameters: Pointer<DParameter, 0, 'N', LParameter> = [];\r\n    visibility: AccessModifier = AccessModifier.private;\r\n    implementation!: string;\r\n\r\n    public static new(name?: DNamedElement[\"name\"], type?: DOperation[\"type\"], exceptions: DOperation[\"exceptions\"] = [], father?: DOperation[\"father\"], persist: boolean = true): DOperation {\r\n        if (!name) name = this.defaultname(\"fx_\", father);\r\n        if (!type) type = father;\r\n        return new Constructors(new DOperation('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DOperation(exceptions).end();\r\n    }\r\n\r\n    static new2(setter: Partial<ObjectWithoutPointers<DOperation>>, father: DOperation[\"father\"], type?: DOperation[\"type\"], name?: string): DOperation {\r\n        if (!name) name = this.defaultname((name || \"fx_\"), father);\r\n        if (!type) type = father;\r\n        return new Constructors(new DOperation('dwc'), father, true).DPointerTargetable().DModelElement().DTypedElement(type)\r\n            .DNamedElement(name).DTypedElement(type).DOperation().end((d)=> { Object.assign(d, setter); });\r\n    }\r\n\r\n}\r\n\r\n@Node\r\n@RuntimeAccessible\r\nexport class LOperation<Context extends LogicContext<DOperation> = any, C extends Context = Context, D extends DOperation = DOperation>  extends LTypedElement { // extends DTypedElement\r\n    public static cname: string = \"LOperation\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DOperation;\r\n    id!: Pointer<DOperation, 1, 1, LOperation>;\r\n    // static singleton: LOperation;\r\n    // static logic: typeof LOperation;\r\n    // static structure: typeof DOperation;\r\n\r\n    // inherit redefine\r\n    instances!: never[];\r\n    annotations!: LAnnotation[];\r\n    parent!: LClass[];\r\n    father!: LClass;\r\n    name!: string;\r\n    namespace!: string;\r\n    type!: LClassifier;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    // personal\r\n    implementation!: string;\r\n    signatureImplementation!: string; // (param1 /*type*/, param2 = value, ...) => /*return type*/\r\n    exceptions!: LClassifier[];\r\n    parameters!: LParameter[];\r\n    visibility!: AccessModifier;\r\n\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        json[ECoreOperation.eParameters] = context.proxyObject.parameters.map( par => par.generateEcoreJson(loopDetectionObj));\r\n        EcoreParser.write(json, ECoreOperation.namee, context.data.name);\r\n        EcoreParser.write(json, ECoreOperation.eType, context.proxyObject.type.typeEcoreString);\r\n        EcoreParser.write(json, ECoreOperation.lowerBound, '' + context.data.lowerBound);\r\n        EcoreParser.write(json, ECoreOperation.upperBound, '' + context.data.upperBound);\r\n        EcoreParser.write(json, ECoreOperation.eexceptions, context.proxyObject.exceptions.map( (l: LClassifier) => l.typeEcoreString).join(' ')); // todo: not really sure it's this format\r\n        EcoreParser.write(json, ECoreOperation.ordered, '' + context.data.ordered);\r\n        EcoreParser.write(json, ECoreOperation.unique, '' + context.data.unique);\r\n        return json; }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addOperation(context.data.name, context.data.type) as D;\r\n            de.many = context.data.many;\r\n            de.lowerBound = context.data.lowerBound;\r\n            de.upperBound = context.data.upperBound;\r\n            de.ordered = context.data.ordered;\r\n            de.required = context.data.required;\r\n            de.unique = context.data.unique;\r\n            de.visibility = context.data.visibility;\r\n            de.exceptions = context.data.exceptions;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WOperation = le as any;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            we.parameters = deep ? context.proxyObject.parameters.map(lchild => lchild.duplicate(deep).id) : context.data.parameters;\r\n            we.exceptions = context.data.exceptions;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n    public addParameter(name?: DParameter[\"name\"], type?: DParameter[\"type\"]): DParameter { return this.cannotCall(\"addParameter\"); }\r\n    protected get_addParameter(context: Context): this[\"addParameter\"] {\r\n        return (name?: DParameter[\"name\"], type?: DParameter[\"type\"]) => DParameter.new(name, type, context.data.id, true); }\r\n\r\n    public execute(thiss: LObject, ...params: any): any { return this.cannotCall(\"execute\"); }\r\n    protected get_execute(context: Context): ((thiss: LObject, ...params: any[])=>any) {\r\n        return (thiss: LObject, ...params: any) => {\r\n            let func: Function = eval(this.get_signatureImplementation(context, true) + \" {\\n\"+ context.data.implementation + \"\\n}\");\r\n            func.apply(thiss, params);\r\n        };\r\n    }\r\n    public set_implementation(val: this[\"implementation\"], context: Context): boolean { return SetFieldAction.new(context.data.id, \"implementation\", val, undefined, false); }\r\n    public get_implementation(context: Context): this[\"implementation\"] { return context.data.implementation; }\r\n    public set_signatureImplementation(val: this[\"signatureImplementation\"], context: Context): boolean { return this.cannotSet(\"signatureImplementation\"); }\r\n    public get_signatureImplementation(context: Context, typedComments: boolean = true): this[\"signatureImplementation\"] {\r\n        let operation = context.proxyObject;\r\n        let typedcommentpre = typedComments ? \"/* :\" : ': ' ;\r\n        let typedcommentpost = typedComments ? \" */\" : '';\r\n        return \"(\" +\r\n            operation.parameters.map(\r\n                (p) => p.name + (p.defaultValue !== undefined ? \"=\" + p.defaultValue : typedcommentpre + p.typeToShortString() + typedcommentpost)\r\n            ).join(\", \")\r\n            + \") => \" +typedcommentpre.replace(\":\", \"\") + operation.type + typedcommentpost;\r\n    }\r\n    public get_signature(context: Context): this[\"signatureImplementation\"] { return this.get_signatureImplementation(context, false); }\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DClassifier | DParameter, 1, 'N'> {\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | DParameter | DClassifier, 1, 'N'>, ...context.data.exceptions, ...context.data.parameters]; }\r\n\r\n    protected get_exceptions(context: Context): this[\"exceptions\"] {\r\n        return context.data.exceptions.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_exceptions(val: PackArr<this[\"exceptions\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'exceptions', list, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_parameters(context: Context): this[\"parameters\"] {\r\n        return context.data.parameters.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_parameters(val: PackArr<this[\"parameters\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.parameters;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'parameters', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    // protected get_type(context: Context): this[\"type\"] { return context.proxyObject.parameters[0].type; }\r\n    // protected set_type(val: Pack1<this[\"type\"]>, context: Context): this[\"type\"] { return super.set_type(val, context); }\r\n\r\n    _mark(b: boolean, superchildren: LOperation, override: string) {\r\n\r\n    }\r\n\r\n    _canOverride(superchildren: LOperation) {\r\n        return undefined;\r\n    }\r\n\r\n    _canPolymorph(superchildren: LOperation) {\r\n        return undefined;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DTypedElement, DOperation);\r\nRuntimeAccessibleClass.set_extend(LTypedElement, LOperation);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DParameter extends DPointerTargetable { // extends DTypedElement\r\n    public static cname: string = \"DParameter\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LParameter;\r\n    // static logic: typeof LParameter;\r\n    // static structure: typeof DParameter;\r\n\r\n    // inherit redefine\r\n    instances!: never[];\r\n    id!: Pointer<DParameter, 1, 1, LParameter>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    parent: Pointer<DOperation, 0, 'N', LOperation> = [];\r\n    father!: Pointer<DOperation, 1, 1, LOperation>;\r\n    name!: string;\r\n    type!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    defaultValue!: any;\r\n    // personal\r\n\r\n    public static new(name?: DNamedElement[\"name\"], type?: DTypedElement[\"type\"], father?: Pointer, persist: boolean = true): DParameter {\r\n        if (!type) type = LPointerTargetable.from(Selectors.getFirstPrimitiveTypes()).id; // default type as string\r\n        if (!name) name = this.defaultname(\"arg\", father);\r\n        return new Constructors(new DParameter('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DParameter().end();\r\n    }\r\n\r\n    static new2(setter: Partial<ObjectWithoutPointers<DParameter>>, father: DParameter[\"father\"], type?: DParameter[\"type\"], name?: DParameter[\"name\"]): DParameter {\r\n        if (!name) name = this.defaultname((name || \"arg\"), father);\r\n        return new Constructors(new DParameter('dwc'), father, true).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).end((d) => { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class LParameter<Context extends LogicContext<DParameter> = any, C extends Context = Context, D extends DParameter = DParameter>  extends LTypedElement { // extends DTypedElement\r\n    public static cname: string = \"LParameter\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DParameter;\r\n    id!: Pointer<DParameter, 1, 1, LParameter>;\r\n    // static singleton: LParameter;\r\n    // static logic: typeof LParameter;\r\n    // static structure: typeof DParameter;\r\n\r\n    // inherit redefine\r\n    instances!: never[];\r\n    annotations!: LAnnotation[];\r\n    parent!: LOperation[];\r\n    father!: LOperation;\r\n    name!: string;\r\n    namespace!: string;\r\n    type!: LClassifier;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    // personal\r\n    defaultValue!: any;\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        const l = context.proxyObject;\r\n        const d = context.data;\r\n        EcoreParser.write(json, ECoreOperation.lowerBound, '' + d.lowerBound);\r\n        EcoreParser.write(json, ECoreOperation.upperBound, '' + d.upperBound);\r\n        EcoreParser.write(json, ECoreOperation.ordered, '' + d.ordered);\r\n        EcoreParser.write(json, ECoreOperation.unique, '' + d.unique);\r\n        EcoreParser.write(json, ECoreOperation.eType, '' + l.type.typeEcoreString);\r\n        return json; }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addParameter(context.data.name, context.data.type) as D;\r\n            de.many = context.data.many;\r\n            de.lowerBound = context.data.lowerBound;\r\n            de.upperBound = context.data.upperBound;\r\n            de.ordered = context.data.ordered;\r\n            de.required = context.data.required;\r\n            de.unique = context.data.unique;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WParameter = le as any;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n    /*\r\n        protected get_delete(context: LogicContext<DParameter>): () => void {\r\n            let ret = () => {};\r\n            const dParameter: DParameter = context.data;\r\n            const dOperation: DOperation = Selectors.getDElement<DOperation>(dParameter.father);\r\n            if (dOperation.parameters.indexOf(dParameter.id) !== 0) {\r\n                const dClassifier: DClassifier | undefined = Selectors.getDElement<DClass>(dParameter.type as string); //first parameter is return type so his type is undefined\r\n                ret = () => {\r\n                    SetFieldAction.new(dOperation,\"parameters\", U.removeFromList(dOperation.parameters, dParameter.id), '', true);\r\n                    if (dClassifier) {\r\n                        // SetFieldAction.new(dClassifier, \"pointedBy\", U.removeFromList(dClassifier.pointedBy, dParameter.id));\r\n                    }\r\n                    // SetRootFieldAction.new(\"parameters\", U.removeFromList(Selectors.getAllParameters(), dParameter.id), '', true);\r\n                    new DeleteElementAction(dParameter);\r\n                }\r\n            } else {\r\n                // when deleting return type (null = void)\r\n                ret = () => {\r\n                    SetFieldAction.new(dParameter, \"type\", null as any); // while reworking .delete(): null = void, questo setta void e deve essere tenuto come azione diversa dal default delete\r\n                };\r\n            }\r\n            ret();\r\n            return ret;\r\n        }\r\n        */\r\n}\r\nRuntimeAccessibleClass.set_extend(DTypedElement, DParameter);\r\nRuntimeAccessibleClass.set_extend(LTypedElement, LParameter);\r\n@RuntimeAccessible\r\nexport class DClass extends DPointerTargetable { // extends DClassifier\r\n    public static cname: string = \"DClass\";\r\n    // static _super = DClassifier;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LClass;\r\n    // static logic: typeof LClass;\r\n    // static structure: typeof DClass;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    id!: Pointer<DClass, 1, 1, LClass>;\r\n    instanceClassName!: string;\r\n    parent: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    father!: Pointer<DPackage, 1, 1, LPackage>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    defaultValue!: Pointer<DObject, 1, 1, LObject>[];\r\n    // personal\r\n    // isSuperTypeOf(someClass: DClassifier): boolean { return todoret; }\r\n    // getEstructuralFeatureByID(featureID: number): DStructuralFeature { return todoret; }\r\n    // getEstructuralFeature(featureName: string): DStructuralFeature { return todoret; }\r\n    abstract: boolean = false;\r\n    interface: boolean = false;\r\n    instances: Pointer<DObject, 0, 'N', LObject> = [];\r\n    operations: Pointer<DOperation, 0, 'N', LOperation> = [];\r\n    features: Pointer<DStructuralFeature, 0, 'N', LStructuralFeature> = [];\r\n    references: Pointer<DReference, 0, 'N', LReference> = [];\r\n    attributes: Pointer<DAttribute, 0, 'N', LAttribute> = [];\r\n    referencedBy: Pointer<DReference, 0, 'N', LReference> = [];\r\n    extends: Pointer<DClass, 0, 'N', LClass> = [];\r\n    extendedBy: Pointer<DClass, 0, 'N', LClass> = [];\r\n\r\n    // mia aggiunta:\r\n    isPrimitive!: boolean;\r\n    implements: Pointer<DClass, 0, 'N', LClass> = [];\r\n    implementedBy: Pointer<DClass, 0, 'N', LClass> = [];\r\n    partial!: boolean;\r\n    partialdefaultname!: string;\r\n\r\n    // for m1:\r\n    // hideExcessFeatures: boolean = true; // isn't it like partial?? // old comment: se attivo questo e creo una DClass di sistema senza nessuna feature e di nome Object, ho creato lo schema di un oggetto schema-less a cui tutti sono conformi\r\n\r\n    public static new(name?: DNamedElement[\"name\"], isInterface: DClass[\"interface\"] = false, isAbstract: DClass[\"abstract\"] = false, isPrimitive: DClass[\"isPrimitive\"] = false, partial?: DClass[\"partial\"],\r\n                      partialDefaultName?: DClass[\"partialdefaultname\"], father?: Pointer, persist: boolean = true): DClass {\r\n        if (!name) name = this.defaultname(\"concept \", father);\r\n        return new Constructors(new DClass('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DClassifier().DClass(isInterface, isAbstract, isPrimitive, partial, partialDefaultName).end();\r\n    }\r\n\r\n    static new2(setter: Partial<ObjectWithoutPointers<DClass>>, father: DClass[\"father\"], name?: DClass[\"name\"]): DClass {\r\n        if (!name) name = this.defaultname((name || \"concept \"), father);\r\n        return new Constructors(new DClass('dwc'), father, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DClassifier().DClass().end((d) => { Object.assign(d, setter); });\r\n    }\r\n\r\n}\r\n\r\n@Instantiable // (LObject)\r\n@Node\r\n@RuntimeAccessible\r\nexport class LClass<D extends DClass = DClass, Context extends LogicContext<DClass> = any, C extends Context = Context>  extends LClassifier{ // extends DClassifier\r\n    public static cname: string = \"LClass\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DClass;\r\n    id!: Pointer<DClass, 1, 1, LClass>;\r\n    // static singleton: LClass;\r\n    // static logic: typeof LClass;\r\n    // static structure: typeof DClass;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    instanceClassName!: string;\r\n    parent!: LPackage[];\r\n    father!: LPackage;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    defaultValue!: LObject[];\r\n    // personal\r\n    // isSuperTypeOf(someClass: DClassifier): boolean { return todoret; }\r\n    // getEstructuralFeatureByID(featureID: number): DStructuralFeature { return todoret; }\r\n    // getEstructuralFeature(featureName: string): DStructuralFeature { return todoret; }\r\n    abstract!: boolean;\r\n    interface!: boolean;\r\n    instances!: LObject[];\r\n    operations!: LOperation[];\r\n    features!: LStructuralFeature[];\r\n    references!: LReference[];\r\n    attributes!: LAttribute[];\r\n    referencedBy!: LReference[];\r\n    extends!: LClass[];\r\n    __info_of__extends: Info = {type:\"LClass[]\", txt: \"classes directly extended by this. check also: \\\"superclasses\\\".\"}\r\n    extendsChain!: LClass[];  // list of all super classes (father, father of father, ...)  todo: isn't this the same as \"superclasses\" ? check implementation differeces, eventually remove one.\r\n    extendedBy!: LClass[];\r\n    nodes!: LGraphElement[]; // ipotesi, non so se tenerlo\r\n\r\n    // fittizi:\r\n    public superclasses!: LClass[];\r\n    __info_of__superclasses: Info = {type:\"LClass[]\", txt: \"all classes directly and indirectly extended by this. same as check also: \\\"extends\\\".\"}\r\n    public allSubClasses!: LClass[];\r\n\r\n    partial!: boolean;\r\n    partialdefaultname!: string;\r\n    isPrimitive!: boolean;\r\n    isClass!: boolean; // false if it's primitive type\r\n    isEnum!: false;\r\n    implements: Pointer<DClass, 0, 'N', LClass> = [];  //todo: interface\r\n    implementedBy: Pointer<DClass, 0, 'N', LClass> = [];\r\n\r\n    ownAttributes!: LAttribute[];\r\n    ownReferences!: LReference[];\r\n    ownOperations!: LOperation[];\r\n    ownChildren!: (LStructuralFeature|LOperation)[];\r\n\r\n    inheritedAttributes!: LAttribute[];\r\n    inheritedReferences!: LReference[];\r\n    inheritedOperations!: LOperation[];\r\n    inheritedChildren!: (LStructuralFeature|LOperation)[];\r\n\r\n    allAttributes!: LAttribute[];\r\n    allReferences!: LReference[];\r\n    allOperations!: LOperation[];\r\n    allChildren!: (LStructuralFeature|LOperation)[];\r\n\r\n\r\n\r\n    // utilities to go down in the tree (plural names)\r\n    exceptions!: LClassifier[] | null;\r\n    parameters!: LParameter[] | null;\r\n    // [`@${string}`]: LModelElement; todo: try to put it\r\n\r\n    protected get_ownAttributes(context: Context): this['ownAttributes'] {\r\n        return LAttribute.fromPointer(context.data.attributes);\r\n    }\r\n    protected get_ownReferences(context: Context): this['ownReferences'] {\r\n        return LReference.fromPointer(context.data.references);\r\n    }\r\n    protected get_ownOperations(context: Context): this['ownOperations'] {\r\n        return LOperation.fromPointer(context.data.operations);\r\n    }\r\n    protected get_ownChildren(context: Context): this['ownChildren'] {\r\n        return U.arrayMergeInPlace<any>(this.get_ownAttributes(context), this.get_ownReferences(context),\r\n            this.get_ownOperations(context));\r\n    }\r\n\r\n    private get_extendsChain(context: Context): this['extendsChain'] {\r\n        let targets: LClass[] = LClass.fromArr(context.data.extends);\r\n        let alreadyParsed: Dictionary<Pointer, LClass> = {};\r\n        while(targets.length) {\r\n            let nextTargets = [];\r\n            for(let target of targets){\r\n                if(alreadyParsed[target.id]) continue;\r\n                alreadyParsed[target.id] = target;\r\n                for(let father of target.extends) nextTargets.push(father);\r\n            }\r\n            targets = nextTargets;\r\n        }\r\n        return [...new Set<LClass>(Object.values(alreadyParsed))];\r\n    }\r\n\r\n    protected get_inheritedAttributes(context: Context): this['inheritedAttributes'] {\r\n        return this.get_extendsChain(context).flatMap((superClass) => superClass.ownAttributes);\r\n    }\r\n    protected get_inheritedReferences(context: Context): this['inheritedReferences'] {\r\n        return this.get_extendsChain(context).flatMap((superClass) => superClass.ownReferences);\r\n    }\r\n    protected get_inheritedOperations(context: Context): this['inheritedOperations'] {\r\n        return this.get_extendsChain(context).flatMap((superClass) => superClass.ownOperations);\r\n    }\r\n    protected get_inheritedChildren(context: Context): this['inheritedChildren'] {\r\n        return U.arrayMergeInPlace<any>(this.get_inheritedAttributes(context), this.get_inheritedReferences(context),\r\n            this.get_inheritedOperations(context));\r\n    }\r\n\r\n    protected get_allAttributes(context: Context): this['allAttributes'] {\r\n        return U.arrayMergeInPlace<any>(this.get_ownAttributes(context), this.get_inheritedAttributes(context));\r\n    }\r\n    protected get_allReferences(context: Context): this['allReferences'] {\r\n        return U.arrayMergeInPlace<any>(this.get_ownReferences(context), this.get_inheritedReferences(context));\r\n    }\r\n    protected get_allOperations(context: Context): this['allOperations'] {\r\n        return U.arrayMergeInPlace<any>(this.get_ownOperations(context), this.get_inheritedOperations(context));\r\n    }\r\n    protected get_allChildren(context: Context): this['allChildren'] {\r\n        return U.arrayMergeInPlace<any>(this.get_ownChildren(context), this.get_inheritedChildren(context));\r\n    }\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: GObject = {};\r\n        const featurearr: Json[] = [];\r\n        const operationsarr: Json[] = [];\r\n        let supertypesstr = [];\r\n        const d = context.data;\r\n        const l = context.proxyObject;\r\n        for (let att of l.attributes) { featurearr.push(att.generateEcoreJson(loopDetectionObj)); }\r\n        for (let ref of l.references) { featurearr.push(ref.generateEcoreJson(loopDetectionObj)); }\r\n        for (let op of l.operations) { operationsarr.push(op.generateEcoreJson(loopDetectionObj)); }\r\n\r\n        json[ECoreClass.xsitype] = 'ecore:EClass';\r\n        json[ECoreClass.namee] = d.name;\r\n        json[ECoreClass.interface] = U.toBoolString(d.interface, false);\r\n        json[ECoreClass.abstract] = U.toBoolString(d.abstract, false);\r\n        if (d.instanceClassName) json[ECoreClass.instanceTypeName] = d.instanceClassName;\r\n        json[ECoreClass.eSuperTypes] = l.extends.map( superclass => superclass.typeEcoreString).join(\" \");\r\n        if (featurearr) json[ECoreClass.eStructuralFeatures] = featurearr;\r\n        if (operationsarr) json[ECoreClass.eOperations] = operationsarr;\r\n        return json; }\r\n\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addClass(context.data.name, context.data.interface, context.data.abstract, context.data.isPrimitive) as D;\r\n            // de.hideExcessFeatures = context.data.hideExcessFeatures;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WClass = le as any;\r\n            we.defaultValue = context.data.defaultValue;\r\n            we.extends = context.data.extends;\r\n            we.attributes = deep ? context.proxyObject.attributes.map(lchild => lchild.duplicate(deep).id) : context.data.attributes;\r\n            we.references = deep ? context.proxyObject.references.map(lchild => lchild.duplicate(deep).id) : context.data.references;\r\n            we.operations = deep ? context.proxyObject.operations.map(lchild => lchild.duplicate(deep).id) : context.data.operations;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DStructuralFeature | DOperation, 1, 'N'> {\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | DStructuralFeature, 1, 'N'>, ...context.data.attributes, ...context.data.references, ...context.data.operations];\r\n    }\r\n\r\n\r\n\r\n    protected set_partial(val: D[\"partial\"], context: Context): boolean { return SetFieldAction.new(context.data.id, \"partial\", val); }\r\n    protected get_partial(context: Context): D[\"partial\"] { return context.data.partial; }\r\n    protected set_partialdefaultname(val: D[\"partialdefaultname\"], context: Context): boolean { return SetFieldAction.new(context.data.id, \"partialdefaultname\", val, undefined, false); }\r\n    protected get_partialdefaultname(context: Context): D[\"partialdefaultname\"] { return context.data.partialdefaultname; }\r\n\r\n    public addAttribute(name?: DAttribute[\"name\"], type?: DAttribute[\"type\"]): DAttribute { return this.cannotCall(\"addAttribute\"); }\r\n    protected get_addAttribute(context: Context): this[\"addAttribute\"] {\r\n        return (name?: DAttribute[\"name\"], type?: DAttribute[\"type\"]) => DAttribute.new(name, type, context.data.id, true);\r\n\r\n    }\r\n\r\n    public addReference(name?: DReference[\"name\"], type?: DReference[\"type\"]): DReference { return this.cannotCall(\"addReference\"); }\r\n    protected get_addReference(context: Context): this[\"addReference\"] {\r\n        return (name?: DReference[\"name\"], type?: DReference[\"type\"]) => DReference.new(name, type, context.data.id, true);\r\n    }\r\n\r\n    public addOperation(name?: DOperation[\"name\"], type?: DOperation[\"type\"]): DOperation { return this.cannotCall(\"addOperation\"); }\r\n    protected get_addOperation(context: Context): this[\"addOperation\"] {\r\n        return (name?: DOperation[\"name\"], type?: DOperation[\"type\"]) => DOperation.new(name, type, [], context.data.id, true); }\r\n\r\n\r\n    protected get_abstract(context: Context): this[\"abstract\"] { return context.data.abstract; }\r\n    protected set_abstract(val: this[\"abstract\"], context: Context): boolean {\r\n        const data = context.data;\r\n        if(val && data.instances.length > 0) {\r\n            U.alert('error', 'Cannot change the abstraction level since there are instances.');\r\n        } else {\r\n            SetFieldAction.new(data, 'abstract', val);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    protected set_isPrimitive(val: this[\"isPrimitive\"], context: Context): boolean { SetFieldAction.new(context. data, 'isPrimitive', val); return true; }\r\n    // get is in classifier with all other \"type\"s getter and setter\r\n\r\n    protected get_interface(context: Context): this[\"interface\"] { return context.data.interface; }\r\n    protected set_interface(val: this[\"interface\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'interface', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_instances(context: Context): this[\"instances\"] {\r\n        return context.data.instances.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_instances(val: PackArr<this[\"instances\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'instances', list, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_operations(context: Context): this[\"operations\"] {\r\n        return context.data.operations.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_operations(val: PackArr<this[\"operations\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.operations;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'operations', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_features(context: Context): this[\"features\"] {\r\n        return context.data.features.map((pointer) => { return LPointerTargetable.from(pointer) });\r\n    }\r\n    protected set_features(val: PackArr<this[\"features\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.features;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'features', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_references(context: Context): this[\"references\"] {\r\n        return context.data.references.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_references(val: PackArr<this[\"references\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.references;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'references', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_attributes(context: Context): this[\"attributes\"] {\r\n        return context.data.attributes.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_attributes(val: PackArr<this[\"attributes\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.attributes;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'attributes', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_referencedBy(context: Context): this[\"referencedBy\"] {\r\n        return context.data.referencedBy.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_referencedBy(val: PackArr<this[\"referencedBy\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'referencedBy', list, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_extends(context: Context): this[\"extends\"] {\r\n        return context.data.extends.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_extends(val: PackArr<this[\"extends\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'extends', list, \"\", true);\r\n        return true;\r\n    }\r\n    protected add_extends(val: PackArr<this[\"extends\"]>, context: Context): void {\r\n        let ptrs: Pointer<DClass> = Pointers.from(val) as any;\r\n        SetFieldAction.new(context.data, 'extends', [...context.data.extends, ...ptrs], '', true);\r\n    }\r\n\r\n    protected remove_extends(val: PackArr<this[\"extends\"]> | number | number[], context: Context): void {\r\n        if (!Array.isArray(val)) val = [val];\r\n        if (!val.length) return;\r\n        let finalVal: D[\"extends\"];\r\n        if (typeof val[0] === \"number\") { finalVal = context.data.extends.filter((elem,index,arr)=> { return (val as any[]).includes(index); }); }\r\n        else {\r\n            finalVal = [...context.data.extends];\r\n            let ptrs: Pointer<DClass> = Pointers.from(val as PackArr<this[\"extends\"]>) as any;\r\n            for (let v of ptrs) { U.arrayRemoveAll(finalVal, v); }\r\n        }\r\n        SetFieldAction.new(context.data, 'extends', finalVal, '', true);\r\n    }\r\n\r\n    protected get_extendedBy(context: Context): this[\"extendedBy\"] {\r\n        return context.data.extendedBy.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_extendedBy(val: PackArr<this[\"extendedBy\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'extendedBy', list, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_implements(context: Context): this[\"implements\"] { return context.data.implements; }\r\n    protected set_implements(val: this[\"implements\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'implements', val, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_implementedBy(context: Context): this[\"implementedBy\"] { return context.data.implementedBy; }\r\n    protected set_implementedBy(val: this[\"implementedBy\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'implementedBy', val, \"\", true);\r\n        return true;\r\n    }\r\n\r\n\r\n    public canExtend(superclass: LClass, output: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []}): boolean {\r\n        this.cannotCall(\"canExtend\"); return false;\r\n    }\r\n\r\n    private get_canExtend(context: Context): (superclass: LClass, output: {reason: string, allTargetSuperClasses: LClass[]}) => boolean {\r\n        return (superclass: LClass, output: {reason: string, allTargetSuperClasses: LClass[]} =\r\n            {reason: '', allTargetSuperClasses: []}) => this._canExtend(context, superclass, output);\r\n    }\r\n\r\n    public isExtending(superclass: LClassifier, output: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []}): boolean {\r\n        return this.cannotCall(\"isExtending\");\r\n    }\r\n\r\n    private get_isExtending(context: Context): this[\"isExtending\"] {\r\n        return null as any; // todo\r\n    }\r\n\r\n    private get_superclasses(context: Context, plusThis: boolean = false): LClass[] {\r\n        let i: number;\r\n        const thiss: LClass = context.proxyObject;\r\n        const visited: Dictionary<Pointer, LClass> = {};\r\n        let queue: LClass[] = thiss.extends;\r\n        if (plusThis) queue = [thiss, ...queue];\r\n        const ret: LClass[] = [];\r\n        for (i = 0; i < queue.length; i++) {\r\n            let elem: LClass = queue[i];\r\n            if (visited[elem.id]) continue;\r\n            visited[elem.id] = elem;\r\n            ret.push(elem);\r\n            queue.push(...elem.extends);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    private get_allSubClasses(context: Context, plusThis: boolean = false): LClass[] {\r\n        const thiss: LClass = context.proxyObject;\r\n        const set: Set<LClass> = plusThis ? new Set<LClass>([thiss]) : new Set();\r\n        for (let i = 0; i < thiss.extendedBy.length; i++) {\r\n            // todo: would this access get_extendedBy 2*N times?? verify and optimize\r\n            U.SetMerge(true, set, thiss.extendedBy[i].allSubClasses); }\r\n        return [...set]; }\r\n\r\n\r\n    private _canExtend(context: Context, superclass: LClass, output: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []}): boolean {\r\n        if (!superclass) { output.reason = 'Invalid extend target: ' + superclass; return false; }\r\n        const thiss: LClass = context.proxyObject;\r\n        if (superclass.id === thiss.id) { output.reason = 'Classes cannot extend themselves.'; return false; }\r\n        // todo: se diversi proxy dello stesso oggetto sono considerati diversi questo fallisce, in tal caso fai thiss.extends.map( l => l.id).indexof(superclass.id)\r\n        if (thiss.extends.map(sc=>sc.id).indexOf(superclass.id) >= 0) { output.reason = 'Target class is already directly extended.'; return false; }\r\n        output.allTargetSuperClasses = superclass.superclasses;\r\n        if (thiss.superclasses.map(sc=> sc.id).indexOf(superclass.id) >= 0) { output.reason = 'Target class is already indirectly extended.'; return false; }\r\n        if (output.allTargetSuperClasses.map(sc=>sc.id).indexOf(thiss.id) >= 0) { output.reason = 'Cannot set this extend, it would cause a inheritance loop.'; return false; }\r\n        if (thiss.interface && !superclass.interface) { output.reason = 'An interface cannot extend a class.'; return false; }\r\n        // ora verifico se causa delle violazioni di override (attibuti omonimi string e boolean non possono overridarsi)\r\n        let i: number;\r\n        let j: number;\r\n        let children: LOperation[] =  thiss.operations; //[...thiss.getBasicOperations()];\r\n        let superchildren: LOperation[] = superclass.operations; //[...superclass.getBasicOperations()];\r\n        for (i = 0; i < children.length; i++) {\r\n            let op: LOperation = children[i];\r\n            for (j = 0; j < superchildren.length; j++){\r\n                let superchild: LOperation = superchildren[j];\r\n                if (op.name !== superchild.name) continue;\r\n                if (op._canOverride(superchild) || op._canPolymorph(superchild)) continue;\r\n                output.reason = 'Marked homonymous operations cannot override nor polymorph each others.';\r\n                setTimeout( () => {\r\n                    op._mark(true, superchild, 'override'); //  mark op && superchildren\r\n                    setTimeout( () => { op._mark(false, superchild, 'override'); }, 3000); // unmark\r\n                }, 1);\r\n                return false;\r\n            }\r\n        }\r\n        return true; }\r\n\r\n    private _isExtending(context: Context, superclass: LClass, orEqual: boolean = true): boolean {\r\n        if (!superclass) return false;\r\n        return this.get_superclasses(context, orEqual).includes(superclass); }\r\n\r\n    private add_Extends(context: Context, superclass: LClass, force: boolean = false): boolean {\r\n        let out: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []};\r\n        const thiss: LClass = context.proxyObject;\r\n        if (!force && !this._canExtend(context, superclass, out)) {  return false; }\r\n        SetFieldAction.new(thiss.__raw, 'extends', [superclass.id], '+=', true);\r\n        SetFieldAction.new(superclass.__raw, 'extendedBy', [thiss.id], '+=', true);\r\n        // const extendChildren: LClass[] =  [thiss, ...thiss.superclasses];\r\n        // console.log('calculateViolationsExtend children:'  + extendChildren, this);\r\n        // for (let extChild of extendChildren) { extChild._checkViolations(false); } // after instances have their meta-class changed, they might need to change shape or values.\r\n        return true; }\r\n\r\n    unsetExtends(context: Context, superclass: LClass): void {\r\n        if (!superclass) return;\r\n        console.log('UnsetExtend:', context);\r\n        // todo: when Object is loaded in m3, set him there for easy access.\r\n        //  if (superclass.id === LClass.genericObjectid) { Log.w(true, 'Cannot un-extend \"Object\"'); return; }\r\n        const thiss: LClass = context.proxyObject;\r\n        let index: number = thiss.extends.indexOf(superclass);\r\n        if (index < 0) return;\r\n\r\n        let newextends = thiss.extends.map(l => l.id);\r\n        let newextendedBy = superclass.extendedBy.map(l => l.id);\r\n        U.arrayRemoveAll(newextends, superclass.id)\r\n        U.arrayRemoveAll(newextendedBy, thiss.id)\r\n        SetFieldAction.new(thiss, 'extends', (newextends), '', true); // -=\r\n        SetFieldAction.new(superclass, 'extendedBy', (newextendedBy), '', true); // -=\r\n        // todo: update instances for (i = 0; i < thiss.instances.length; i++) { thiss.instances[i].unsetExtends(superclass); }\r\n        // todo: remove extend edge? here?\r\n\r\n        // todo: check violations\r\n        // const extendedby: LClass[] = [thiss, ...thiss.allSubClasses];\r\n        // for (i = 0; i < extendedby.length; i++) { extendedby[i].checkViolations(true); }\r\n    }\r\n\r\n    public instance(): DObject { return this.cannotCall('instance'); }\r\n    /*private get_instance_old(context: Context): () => DObject {\r\n        return () => {\r\n            const dClass: DClass = context.data;\r\n            const lClass: LClass = LClass.from(dClass);\r\n            const dObject = DObject.new(lClass.name.toLowerCase());\r\n            CreateElementAction.new(dObject);\r\n            BEGIN()\r\n            SetFieldAction.new(dObject, 'instanceof', dClass.id, '', true);\r\n            SetFieldAction.new(dClass, 'instances', dObject.id, '+=', true);\r\n\r\n            let father: LClass|undefined = lClass;\r\n            while(father) {\r\n                for(let dFeature of [...father.attributes, ...father.references]) {\r\n                    const dValue = DValue.new(dFeature.name); dValue.value = [U.initializeValue(dFeature.type)];\r\n                    CreateElementAction.new(dValue);\r\n\r\n                    SetFieldAction.new(dValue, 'father', dObject.id, '', true);\r\n                    SetFieldAction.new(dValue, 'instanceof', dFeature.id, '', true);\r\n                    SetFieldAction.new(dFeature, 'instances', dValue.id, '+=', true);\r\n                    SetFieldAction.new(dObject, 'features', dValue.id, '+=', true);\r\n\r\n                }\r\n                father = (father.extends.length > 0) ? father.extends[0] : undefined;\r\n            }\r\n            END()\r\n            return dObject;\r\n        };\r\n    }*/\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const ret = () => {\r\n            const canBeDeleted = data.instances.length === 0;\r\n            if(canBeDeleted) {\r\n                const pointedBy = U.filteredPointedBy(data, 'type');\r\n                for(let me of pointedBy) {\r\n                    if(me) {\r\n                        SetFieldAction.new(me.__raw as DReference, 'type', me.father.id, '', true);\r\n                    }\r\n                }\r\n                for(let me of data.extends) {\r\n                    SetFieldAction.new(me.__raw, 'extendedBy', me.__raw.extendedBy.indexOf(data.id), '-=', true);\r\n                }\r\n                for(let me of data.extendedBy) {\r\n                    SetFieldAction.new(me.__raw, 'extends', me.__raw.extends.indexOf(data.id), '-=', true);\r\n                }\r\n                data.superDelete();\r\n            } else { U.alert('error', 'Cannot delete the selected class since there are instances.'); }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DClassifier, DClass);\r\nRuntimeAccessibleClass.set_extend(LClassifier, LClass);\r\n@RuntimeAccessible\r\nexport class DDataType extends DPointerTargetable { // extends DClassifier\r\n    public static cname: string = \"DDataType\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LDataType;\r\n    // static logic: typeof LDataType;\r\n    // static structure: typeof DDataType;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    id!: Pointer<DDataType, 1, 1, LDataType>;\r\n    instanceClassName!: string;\r\n    parent: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    father!: Pointer<DPackage, 1, 1, LPackage>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    defaultValue!: Pointer<DObject, 1, 1, LObject>[] | string[];\r\n    // personal\r\n    serializable: boolean = true;\r\n    // usedBy: Pointer<DAttribute, 0, 'N', LAttribute> = [];\r\n\r\n\r\n    public static new(name?: DNamedElement[\"name\"], father?: Pointer, persist: boolean = true): DDataType {\r\n        Log.exx(\"DDataType is abstract, cannot instantiate\");\r\n        return null as any;\r\n        // if (!name) name = this.defaultname(\"datatype_\", father);\r\n        // return new Constructors(new DDataType('dwc'), father, persist, undefined).DPointerTargetable().DModelElement().DNamedElement(name).DClassifier().DDataType().end();\r\n    }\r\n}\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LDataType<Context extends LogicContext<DDataType> = any, C extends Context = Context> extends LClassifier { // extends DClassifier\r\n    public static cname: string = \"LDataType\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DDataType;\r\n    id!: Pointer<DDataType, 1, 1, LDataType>;\r\n    // static singleton: LDataType;\r\n    // static logic: typeof LDataType;\r\n    // static structure: typeof DDataType;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    instanceClassName!: string;\r\n    parent!: LPackage[];\r\n    father!: LPackage;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    defaultValue!: LObject[] | string[];\r\n    isPrimitive!: false;\r\n    isClass!: false;\r\n    isEnum!: true;\r\n    // personal\r\n    serializable!: boolean;\r\n\r\n\r\n    protected get_serializable(context: Context): this[\"serializable\"] { return context.data.serializable; }\r\n    protected set_serializable(val: this[\"serializable\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'serializable', val);\r\n        return true;\r\n    }\r\n\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DClassifier, DDataType);\r\nRuntimeAccessibleClass.set_extend(LClassifier, LDataType);\r\n@RuntimeAccessible\r\nexport class DStructuralFeature extends DPointerTargetable { // DTypedElement\r\n    public static cname: string = \"DStructuralFeature\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LStructuralFeature;\r\n    // static logic: typeof LStructuralFeature;\r\n    // static structure: typeof DStructuralFeature;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DStructuralFeature, 1, 1, LStructuralFeature>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    parent: Pointer<DClass, 0, 'N', LClass> = [];\r\n    father!: Pointer<DClass, 1, 1, LClass>;\r\n    name!: string;\r\n    type!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    // personal\r\n    instances: Pointer<DValue, 0, 'N', LValue> = [];\r\n    changeable: boolean = true;\r\n    volatile: boolean = true;\r\n    transient: boolean = false;\r\n    unsettable: boolean = false;\r\n    derived: boolean = false;\r\n    defaultValue!: (Pointer<DObject, 1, 1, LObject> | PrimitiveType)[];\r\n\r\n    public static new(name?: DNamedElement[\"name\"], type?: DTypedElement[\"type\"], father?: Pointer, persist: boolean = true): DStructuralFeature {\r\n        Log.exx(\"DStructuralFeature is abstract, cannot instantiate\");\r\n        return null as any;\r\n        // if (!name) name = this.defaultname(\"feature \", father);\r\n        // return new Constructors(new DStructuralFeature('dwc'), father, persist, undefined).DPointerTargetable().DModelElement().DNamedElement(name).DTypedElement(type).DStructuralFeature().end();\r\n    }\r\n    // getFeatureID(): number;\r\n    // getContainerClass(): EJavaClass\r\n}\r\n\r\n@Abstract\r\n@RuntimeAccessible\r\nexport class LStructuralFeature<Context extends LogicContext<DStructuralFeature> = any, C extends Context = Context>  extends LTypedElement { // DTypedElement\r\n    public static cname: string = \"LStructuralFeature\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DStructuralFeature;\r\n    id!: Pointer<DStructuralFeature, 1, 1, LStructuralFeature>;\r\n    // static singleton: LStructuralFeature;\r\n    // static logic: typeof LStructuralFeature;\r\n    // static structure: typeof DStructuralFeature;\r\n\r\n    // inherit redefine\r\n    annotations!: LAnnotation[];\r\n    parent!: LClass[];\r\n    father!: LClass;\r\n    name!: string;\r\n    namespace!: string;\r\n    type!: LClassifier;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    // personal\r\n    instances!: LValue[];\r\n    changeable!: boolean;\r\n    volatile!: boolean;\r\n    transient!: boolean;\r\n    unsettable!: boolean;\r\n    derived!: boolean;\r\n    // defaultValueLiteral!: string;\r\n    defaultValue!: (LObject[] | PrimitiveType[]);\r\n    // getFeatureID(): number;\r\n    // getContainerClass(): EJavaClass\r\n\r\n    protected get_instances(context: Context): this[\"instances\"] {\r\n        return context.data.instances.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_instances(val: PackArr<this[\"instances\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'instances', list, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_changeable(context: Context): this[\"changeable\"] { return context.data.changeable; }\r\n    protected set_changeable(val: this[\"changeable\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'changeable', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_volatile(context: Context): this[\"volatile\"] { return context.data.volatile; }\r\n    protected set_volatile(val: this[\"volatile\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'volatile', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_transient(context: Context): this[\"transient\"] { return context.data.transient; }\r\n    protected set_transient(val: this[\"transient\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'transient', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_unsettable(context: Context): this[\"unsettable\"] { return context.data.unsettable; }\r\n    protected set_unsettable(val: this[\"unsettable\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'unsettable', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_derived(context: Context): this[\"derived\"] { return context.data.derived; }\r\n    protected set_derived(val: this[\"derived\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'derived', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const ret = () => {\r\n            for(let instance of data.instances) { instance.delete(); }\r\n            data.superDelete();\r\n        }\r\n        return ret;\r\n    }\r\n    /*\r\n        protected get_defaultValueLiteral(context: Context): this[\"defaultValueLiteral\"] { return context.data.defaultValueLiteral; }\r\n        protected set_defaultValueLiteral(val: this[\"defaultValueLiteral\"], context: Context): boolean {\r\n            SetFieldAction.new(context.data, 'defaultValueLiteral', val, \"\", false);\r\n            return true;\r\n        }*/\r\n}\r\nRuntimeAccessibleClass.set_extend(DTypedElement, DStructuralFeature);\r\nRuntimeAccessibleClass.set_extend(LTypedElement, LStructuralFeature);\r\n@RuntimeAccessible\r\nexport class DReference extends DPointerTargetable { // DStructuralFeature\r\n    public static cname: string = \"DReference\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LReference;\r\n    // static logic: typeof LReference;\r\n    // static structure: typeof DReference;\r\n\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DReference, 1, 1, LReference>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    type!: Pointer<DClass, 1, 1, LClass>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    changeable: boolean = true;\r\n    volatile: boolean = true;\r\n    transient: boolean = false;\r\n    unsettable: boolean = false;\r\n    derived: boolean = false;\r\n    defaultValueLiteral!: string;\r\n    parent: Pointer<DClass, 0, 'N', LClass> = [];\r\n    father!: Pointer<DClass, 1, 1, LClass>;\r\n    instances: Pointer<DValue, 0, 'N', LValue> = [];\r\n    defaultValue!: Pointer<DObject, 1, 1, LObject>[];\r\n\r\n    // personal\r\n    containment: boolean = false;\r\n    container: boolean = false; // ?\r\n    resolveProxies: boolean = true; // ?\r\n    opposite!: Pointer<DReference, 0, 1, LReference>;\r\n    target: Pointer<DClass, 0, 'N', LClass> = [];\r\n    edges: Pointer<DEdge, 0, 'N', LEdge> = [];\r\n\r\n    public static new(name?: DReference[\"name\"], type?: DReference[\"type\"], father?: DReference[\"father\"], persist: boolean = true): DReference {\r\n        if (!type) type = father // default type is self-reference\r\n        if (!name) name = this.defaultname(\"ref_\", father);\r\n        return new Constructors(new DReference('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DStructuralFeature().DReference().end();\r\n    }\r\n\r\n    static new2(setter: Partial<ObjectWithoutPointers<DReference>>, father: DReference[\"father\"], type?: DReference[\"type\"], name?: DReference[\"name\"]): DReference {\r\n        if (!name) name = this.defaultname((name || \"ref_\"), father);\r\n        return new Constructors(new DReference('dwc'), father, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DStructuralFeature().DReference()\r\n            .end((d) => { Object.assign(d, setter); });\r\n    }\r\n\r\n}\r\n\r\n@Instantiable // LValue\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class LReference<Context extends LogicContext<DReference> = any, C extends Context = Context, D extends DReference = DReference>  extends LStructuralFeature {\r\n    public static cname: string = \"LReference\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DReference;\r\n    id!: Pointer<DReference, 1, 1, LReference>;\r\n    // static singleton: LReference;\r\n    // static logic: typeof LReference;\r\n    // static structure: typeof DReference;\r\n\r\n    // inherit redefine\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    type!: LClass;\r\n    ordered!: boolean;\r\n    unique!: boolean;\r\n    lowerBound!: number;\r\n    upperBound!: number;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    changeable!: boolean;\r\n    volatile!: boolean;\r\n    transient!: boolean;\r\n    unsettable!: boolean;\r\n    derived!: boolean;\r\n    defaultValueLiteral!: string;\r\n    parent!: LClass[];\r\n    father!: LClass;\r\n    instances!: LValue[];\r\n    defaultValue!: LObject[];\r\n\r\n    // personal\r\n    containment!: boolean;\r\n    container!: boolean; //??\r\n    resolveProxies!: boolean;\r\n    opposite?: LReference;\r\n    // target!: LClass[]; replaced by type\r\n    edges!: LEdge[];\r\n\r\n\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const model: GObject = {};\r\n        const d = context.data;\r\n        const l = context.proxyObject;\r\n        model[ECoreReference.xsitype] = 'ecore:EReference';\r\n        model[ECoreReference.eType] = l.type.typeEcoreString;\r\n        model[ECoreReference.namee] = d.name;\r\n        if (d.lowerBound != null && !isNaN(+d.lowerBound)) { model[ECoreReference.lowerbound] = +d.lowerBound; }\r\n        if (d.upperBound != null && !isNaN(+d.upperBound)) { model[ECoreReference.upperbound] = +d.upperBound; }\r\n        if (d.containment != null) { model[ECoreReference.containment] = d.containment; }\r\n        return model; }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addReference(context.data.name, context.data.type) as D;\r\n            de.many = context.data.many;\r\n            de.lowerBound = context.data.lowerBound;\r\n            de.upperBound = context.data.upperBound;\r\n            de.ordered = context.data.ordered;\r\n            de.required = context.data.required;\r\n            de.unique = context.data.unique;\r\n            de.changeable = context.data.changeable;\r\n            de.container = context.data.container;\r\n            de.containment = context.data.containment;\r\n            de.defaultValueLiteral = context.data.defaultValueLiteral;\r\n            de.derived = context.data.derived;\r\n            de.transient = context.data.transient;\r\n            de.unsettable = context.data.unsettable;\r\n            de.volatile = context.data.unsettable;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WReference = le as any;\r\n            we.opposite = context.data.opposite || undefined;\r\n            we.defaultValue = context.data.defaultValue;\r\n            we.type = context.data.type;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            // we.target = deep ? context.proxyObject.target.map(lchild => lchild.duplicate(deep).id) : context.data.target;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n    protected set_type(val: Pack1<this[\"type\"]>, context: Context): boolean { return super.set_type(val, context); }\r\n\r\n    public addClass(name?: DClass[\"name\"], isInterface?: DClass[\"interface\"], isAbstract?: DClass[\"abstract\"], isPrimitive?: DClass[\"isPrimitive\"],\r\n                    isPartial?: DClass[\"partial\"], partialDefaultName?: DClass[\"partialdefaultname\"]): DClass {\r\n        return this.cannotCall(\"LReference.addClass\"); }\r\n    protected get_addClass(context: Context): this[\"addClass\"] {\r\n        return (name?: DClass[\"name\"], isInterface?: DClass[\"interface\"], isAbstract?: DClass[\"abstract\"], isPrimitive?: DClass[\"isPrimitive\"],\r\n                isPartial?: DClass[\"partial\"], partialDefaultName?: DClass[\"partialdefaultname\"]) => {\r\n            BEGIN()\r\n            let dclass = DClass.new(name, isInterface, isAbstract, isPrimitive, isPartial, partialDefaultName, context.proxyObject.package!.id, true);\r\n            // SetFieldAction.new(context.data.id, \"type\", dclass.id);\r\n            this.set_type(dclass.id as any, context);\r\n            END();\r\n            return dclass;\r\n        } }\r\n\r\n\r\n    protected get_containment(context: Context): this[\"containment\"] { return context.data.containment; }\r\n    protected set_containment(val: this[\"containment\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'containment', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_container(context: Context): this[\"container\"] { return context.data.container; }\r\n    protected set_container(val: this[\"container\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'container', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_resolveProxies(context: Context): this[\"resolveProxies\"] { return context.data.resolveProxies; }\r\n    protected set_resolveProxies(val: this[\"resolveProxies\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'resolveProxies', val);\r\n        return true;\r\n    }\r\n\r\n    protected get_opposite(context: Context): this[\"opposite\"] { return LPointerTargetable.from(context.data.opposite); }\r\n    protected set_opposite(val: Pack<LReference | undefined>, context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'opposite', Pointers.from(val) as any as LAnnotation[\"id\"], \"\", true);\r\n        return true;\r\n    }\r\n    /*\r\n        /// todo: why this exist?  why not type?\r\n        protected get_target(context: Context): this[\"target\"] { return context.data.target.map(pointer => LPointerTargetable.from(pointer)); }\r\n        protected set_target(val: PackArr<this[\"target\"]>, context: Context): boolean {\r\n            const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n            SetFieldAction.new(context.data, 'target', list, \"\", true);\r\n            return true;\r\n        }*/\r\n\r\n    protected get_defaultValue(context: Context): this[\"defaultValue\"] { return LPointerTargetable.fromPointer(context.data.defaultValue); }\r\n    protected set_defaultValue(val: PackArr<this[\"defaultValue\"]>, context: Context): boolean {\r\n        // @ts-ignore\r\n        if (!val) (val) = []; else if (!Array.isArray(val)) val = [val];\r\n        let ptrs = Pointers.from(val);\r\n        SetFieldAction.new(context.data, 'defaultValue', ptrs, '', false);\r\n        return true; }\r\n\r\n    protected get_edges(context: Context): this[\"edges\"] {\r\n        return context.data.edges.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n    protected set_edges(val: PackArr<this[\"edges\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        SetFieldAction.new(context.data, 'edges', list, \"\", true);\r\n        return true;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DStructuralFeature, DReference);\r\nRuntimeAccessibleClass.set_extend(LStructuralFeature, LReference);\r\nfunction has_opposite(oppositename: string, ...comments: string[]): any {\r\n    // return (c:Constructor, key:string, ):any =>{}\r\n}\r\nfunction obsolete_attribute(...comments: string[]) {\r\n    return undefined as any; // function(c:Constructor, key:string,): any {}\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class DAttribute extends DPointerTargetable { // DStructuralFeature\r\n    public static cname: string = \"DAttribute\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LAttribute;\r\n    // static logic: typeof LAttribute;\r\n    // static structure: typeof DAttribute;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DAttribute, 1, 1, LAttribute>;\r\n    // @has_opposite(\"father\")\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    type!: Pointer<DClassifier, 1, 1, LClassifier>;\r\n    ordered: boolean = true;\r\n    unique: boolean = true;\r\n    lowerBound: number = 0;\r\n    upperBound: number = 1;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    changeable: boolean = true;\r\n    volatile: boolean = true;\r\n    transient: boolean = false;\r\n    unsettable: boolean = false;\r\n    derived: boolean = false;\r\n    defaultValueLiteral!: string;\r\n    //@obsolete_attribute()\r\n    parent: Pointer<DClass, 0, 'N', LClass> = [];\r\n\r\n    //@has_opposite(\"attributes\")\r\n    father!: Pointer<DClass, 1, 1, LClass>;\r\n\r\n    //@has_opposite(\"instanceof\")\r\n    instances: Pointer<DValue, 0, 'N', LValue> = [];\r\n    defaultValue!: PrimitiveType[];\r\n\r\n    // personal\r\n    isID: boolean = false; // ? exist in ecore as \"iD\" ?\r\n\r\n    public static new(name?: DAttribute[\"name\"], type?: DAttribute[\"type\"], father?: DAttribute[\"father\"], persist: boolean = true): DAttribute {\r\n        if (!name) name = this.defaultname(\"attr_\", father);\r\n        if (!type) type = LPointerTargetable.from(Selectors.getFirstPrimitiveTypes()).id; // default type as string\r\n        return new Constructors(new DAttribute('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DStructuralFeature().DAttribute().end();\r\n    }\r\n    static new2(setter: Partial<ObjectWithoutPointers<DReference>>, father: DAttribute[\"father\"], type?: DAttribute[\"type\"], name?: DAttribute[\"name\"]): DAttribute {\r\n        if (!name) name = this.defaultname((name || \"ref_\"), father);\r\n        return new Constructors(new DAttribute('dwc'), father, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DTypedElement(type).DStructuralFeature().DReference()\r\n            .end((d) => { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n@Leaf\r\n@Instantiable // (LValue)\r\n@RuntimeAccessible\r\nexport class LAttribute <Context extends LogicContext<DAttribute> = any, C extends Context = Context, D extends DAttribute = DAttribute> extends LStructuralFeature { // DStructuralFeature\r\n    public static cname: string = \"LAttribute\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DAttribute;\r\n    id!: Pointer<DAttribute, 1, 1, LAttribute>;\r\n    // static singleton: LAttribute;\r\n    // static logic: typeof LAttribute;\r\n    // static structure: typeof DAttribute;\r\n\r\n    // inherit redefine\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    type!: LClassifier;\r\n    ordered!: boolean;\r\n    unique!: boolean;\r\n    lowerBound!: number;\r\n    upperBound!: number;\r\n    many!: boolean;\r\n    required!: boolean;\r\n    changeable!: boolean;\r\n    volatile!: boolean;\r\n    transient!: boolean;\r\n    unsettable!: boolean;\r\n    derived!: boolean;\r\n    // defaultValueLiteral!: string;\r\n    defaultValue!: PrimitiveType[];\r\n    parent!: LClass[];\r\n    father!: LClass;\r\n    instances!: LValue[];\r\n\r\n    // personal\r\n    isID: boolean = false; // ? exist in ecore as \"iD\" ?\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const model = {};\r\n        const d = context.data;\r\n        const l = context.proxyObject;\r\n        EcoreParser.write(model, ECoreAttribute.xsitype, 'ecore:EAttribute');\r\n        EcoreParser.write(model, ECoreAttribute.eType, l.type.typeEcoreString);\r\n        EcoreParser.write(model, ECoreAttribute.namee, d.name);\r\n        EcoreParser.write(model, ECoreAttribute.lowerbound, '' + d.lowerBound);\r\n        EcoreParser.write(model, ECoreAttribute.upperbound, '' + d.upperBound);\r\n        return model; }\r\n\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addAttribute(context.data.name, context.data.type) as D;\r\n            de.many = context.data.many;\r\n            de.lowerBound = context.data.lowerBound;\r\n            de.upperBound = context.data.upperBound;\r\n            de.ordered = context.data.ordered;\r\n            de.required = context.data.required;\r\n            de.unique = context.data.unique;\r\n            de.changeable = context.data.changeable;\r\n            de.defaultValue = context.data.defaultValue;\r\n            de.defaultValueLiteral = context.data.defaultValueLiteral;\r\n            de.derived = context.data.derived;\r\n            de.transient = context.data.transient;\r\n            de.unsettable = context.data.unsettable;\r\n            de.volatile = context.data.volatile;\r\n            de.isID = context.data.isID\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WAttribute = le as any;\r\n            we.type = context.data.type;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n    public addEnum(...p:Parameters<this[\"addEnumerator\"]>): DEnumerator { return this.addEnumerator(...p); }\r\n    protected get_addEnum(context: Context): this[\"addEnumerator\"] { return this.get_addEnumerator(context); }\r\n    public addEnumerator(name?: DEnumerator[\"name\"], father?: DEnumerator[\"father\"]): DEnumerator { return this.cannotCall(\"Attribute.addEnumerator\"); }\r\n    protected get_addEnumerator(context: Context): this[\"addEnumerator\"] {\r\n        return (name?: DEnumerator[\"name\"], father?: DEnumerator[\"father\"]) => DEnumerator.new(name, context.proxyObject.package?.id, true); }\r\n\r\n    protected get_ID(context: Context): this[\"isID\"] { return context.data.isID; }\r\n    protected set_ID(val: this[\"isID\"], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'isID', val);\r\n        return true;\r\n    }\r\n    protected get_defaultValue(context: Context): this[\"defaultValue\"] { return context.data.defaultValue; }\r\n    protected set_defaultValue(val: unArr<this[\"defaultValue\"]>, context: Context): boolean {\r\n        // @ts-ignore\r\n        if (!val) (val) = []; else if (!Array.isArray(val)) val = [val];\r\n        SetFieldAction.new(context.data, 'defaultValue', val, '', false);\r\n        return true; }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DStructuralFeature, DAttribute);\r\nRuntimeAccessibleClass.set_extend(LStructuralFeature, LAttribute);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DEnumLiteral extends DPointerTargetable { // DNamedElement\r\n    public static cname: string = \"DEnumLiteral\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LAttribute;\r\n    // static logic: typeof LAttribute;\r\n    // static structure: typeof DAttribute;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DEnumLiteral, 1, 1, LEnumLiteral>;\r\n    parent: Pointer<DEnumerator, 0, 'N', LEnumerator> = [];\r\n    father!: Pointer<DEnumerator, 1, 1, LEnumerator>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    // personal\r\n    value!: number;\r\n    // ordinal: number=1; replaced by value\r\n    literal!: string;\r\n\r\n    public static new(name?: DNamedElement[\"name\"], value?: DEnumLiteral[\"value\"], father?: Pointer, persist: boolean = true): DEnumLiteral { //vv4\r\n        if (!name) name = this.defaultname(\"literal \", father);\r\n        return new Constructors(new DEnumLiteral('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DEnumLiteral(value).end();\r\n    }\r\n    static new2(setter: Partial<ObjectWithoutPointers<DEnumLiteral>>, father: DEnumLiteral[\"father\"], name?: DEnumLiteral[\"name\"]): DEnumLiteral {\r\n        if (!name) name = this.defaultname(\"literal \", father);\r\n        return new Constructors(new DEnumLiteral('dwc'), father, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DEnumLiteral()\r\n            .end((d) => { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class LEnumLiteral<Context extends LogicContext<DEnumLiteral> = any, C extends Context = Context, D extends DEnumLiteral = DEnumLiteral>  extends LNamedElement { // DNamedElement\r\n    public static cname: string = \"LEnumLiteral\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DEnumLiteral;\r\n    id!: Pointer<DEnumLiteral, 1, 1, LEnumLiteral>;\r\n    // static singleton: LAttribute;\r\n    // static logic: typeof LAttribute;\r\n    // static structure: typeof DAttribute;\r\n\r\n    // inherit redefine\r\n    parent!: LEnumerator[];\r\n    father!: LEnumerator;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    // personal\r\n    value!: this[\"ordinal\"];\r\n    ordinal!: number;\r\n    literal!: string;\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        const d = context.data;\r\n        json[EcoreLiteral.value] = d.value;\r\n        json[EcoreLiteral.literal] = d.literal;\r\n        json[EcoreLiteral.namee] = d.name;\r\n        return json; }\r\n\r\n    public generateEcoreJsonM1(): this[\"ordinal\"] { return this.cannotCall(\"GenerateEcoreJsonM1\"); }\r\n    protected get_generateEcoreJsonM1(context: Context): () => this[\"ordinal\"] { return this.impl_generateEcoreJsonM1(context); }\r\n    protected impl_generateEcoreJsonM1(context: Context): () => this[\"ordinal\"] {\r\n        // loopDetectionObj[context.data.id] = context.data; no loop detection here, the same literal can be exported multiple times in m1\r\n        // return context.data.literal;\r\n        // return context.data.name;\r\n        return () => context.data.value; }\r\n\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addLiteral(context.data.name, context.data.value) as D;\r\n            de.literal = context.data.literal;\r\n            de.value = context.data.value;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WEnumLiteral = le as any;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n\r\n    protected get_ordinal(context: Context): this[\"ordinal\"] { return this.get_value(context); }\r\n    protected set_ordinal(val: this[\"ordinal\"], context: Context): boolean { return this.set_value(val, context); }\r\n\r\n    protected get_value(context: Context): this[\"value\"] {\r\n        let ordinalAssumedByPosition = true; // per ottimizzazione forse è disattivabile\r\n        if (!ordinalAssumedByPosition) return context.data.value || 0;\r\n        return context.proxyObject.father.ordinals.map( o => o?.id).indexOf(context.data.id);\r\n    }\r\n    protected set_value(val: this[\"value\"], context: Context): boolean {\r\n        if (val === context.data.value) return true;\r\n        let ordinals = context.proxyObject.father.ordinals;\r\n        if (ordinals[val]) {\r\n            Log.e(\"that ordinal place is already taken by \" + ordinals[val].name, {sameOrdinalLit:ordinals[val], ordinals, thiss:context.data});\r\n            return false; }\r\n        return SetFieldAction.new(context.data, 'value', val); }\r\n\r\n    protected get_literal(context: Context): this[\"literal\"] { return context.data.literal; }\r\n    protected set_literal(val: this[\"literal\"], context: Context): boolean {\r\n        return SetFieldAction.new(context.data, 'literal', val, '', false); }\r\n\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DEnumLiteral);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LEnumLiteral);\r\n@Leaf\r\n@RuntimeAccessible\r\nexport class DEnumerator extends DPointerTargetable { // DDataType\r\n    public static cname: string = \"DEnumerator\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LEnumerator;\r\n    // static logic: typeof LEnumerator;\r\n    // static structure: typeof DEnumerator;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    id!: Pointer<DEnumerator, 1, 1, LEnumerator>;\r\n    instanceClassName!: string;\r\n    parent: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    father!: Pointer<DPackage, 1, 1, LPackage>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    defaultValue!: string[];\r\n    serializable: boolean = true;\r\n    // usedBy: Pointer<DAttribute, 0, 'N', LAttribute> = []; obsolete?\r\n    // personal\r\n    literals: Pointer<DEnumLiteral, 0, 'N', LEnumLiteral> = [];\r\n\r\n    public static new(name?: DNamedElement[\"name\"], father?: DEnumerator[\"father\"], persist: boolean = true): DEnumerator {\r\n        if (!name) name = this.defaultname(\"enum \", father);\r\n        return new Constructors(new DEnumerator('dwc'), father, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DEnumerator().end();\r\n    }\r\n    static new2(setter: Partial<ObjectWithoutPointers<DEnumerator>>, father: DEnumerator[\"father\"], name?: DEnumerator[\"name\"]): DEnumerator {\r\n        if (!name) name = this.defaultname(\"enum \", father);\r\n        return new Constructors(new DEnumerator('dwc'), father, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DEnumerator().end((d) => { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n@Node\r\n@RuntimeAccessible\r\nexport class LEnumerator<Context extends LogicContext<DEnumerator> = any, C extends Context = Context, D extends DEnumerator = DEnumerator> extends LDataType { // DDataType\r\n    public static cname: string = \"LEnumerator\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DEnumerator;\r\n    id!: Pointer<DEnumerator, 1, 1, LEnumerator>;\r\n    // static singleton: LEnumerator;\r\n    // static logic: typeof LEnumerator;\r\n    // static structure: typeof DEnumerator;\r\n\r\n    // inherit redefine\r\n    // instanceClass: EJavaClass // ?\r\n    // isInstance(object: EJavaObject): boolean; ?\r\n    // getClassifierID(): number;\r\n    instanceClassName!: string;\r\n    parent!: LPackage [];\r\n    father!: LPackage;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    defaultValue!:string[];\r\n    serializable!: boolean;\r\n    // usedBy!: LAttribute[];\r\n    isPrimitive!: false;\r\n    isClass!: false;\r\n    isEnum!: true;\r\n    // personal\r\n    literals!: LEnumLiteral[];\r\n    ordinals!: LEnumLiteral[]; // literal array ordered by ordinal number\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: Json = {};\r\n        let d = context.data;\r\n        if (d.instanceClassName) json[ECoreEnum.instanceTypeName] = d.instanceClassName;\r\n        json[ECoreEnum.xsitype] = 'ecore:EEnum';\r\n        json[ECoreEnum.namee] = d.name;\r\n        json[ECoreEnum.serializable] = d.serializable ? \"true\" : \"false\";\r\n        json[ECoreEnum.eLiterals] = context.proxyObject.literals.map(l => l.generateEcoreJson(loopDetectionObj));\r\n        return json; }\r\n\r\n    public duplicate(deep: boolean = true): this {\r\n        return this.cannotCall( ((this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name) + \"duplicate()\"); }\r\n    protected get_duplicate(context: Context): ((deep?: boolean) => this) {\r\n        return (deep: boolean = false) => {\r\n            BEGIN()\r\n            let de: D = context.proxyObject.father.addEnumerator(context.data.name) as D;\r\n            de.defaultValue = context.data.defaultValue;\r\n            de.serializable = context.data.serializable;\r\n            let le: this = LPointerTargetable.fromD(de);\r\n            let we: WEnumerator = le as any;\r\n            we.annotations = deep ? context.proxyObject.annotations.map(lchild => lchild.duplicate(deep).id) : context.data.annotations;\r\n            we.literals = deep ? context.proxyObject.literals.map(lchild => lchild.duplicate(deep).id) : context.data.literals;\r\n            END()\r\n            return le; }\r\n    }\r\n\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DEnumLiteral, 1, 'N'> {\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | DEnumLiteral, 1, 'N'>, ...context.data.literals]; }\r\n\r\n    public addLiteral(name?: DEnumLiteral[\"name\"], value?: DEnumLiteral[\"value\"]): DEnumLiteral { return this.cannotCall(\"addLiteral\"); }\r\n    protected get_addLiteral(context: Context): this[\"addLiteral\"] {\r\n        return (name?: DEnumLiteral[\"name\"], value?: DEnumLiteral[\"value\"]) => DEnumLiteral.new(name, value, context.data.id, true); }\r\n\r\n    protected get_literals(context: Context): this[\"literals\"] {\r\n        return context.data.literals.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        }); }\r\n\r\n    protected set_literals(val: PackArr<this[\"literals\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.literals;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'literals', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true; }\r\n\r\n    protected get_ordinals(context: Context): this[\"ordinals\"]{\r\n        let ret: LEnumLiteral[] = [];\r\n        let literals: LEnumLiteral[] = context.proxyObject.father.literals;\r\n        let dliterals: DEnumLiteral[] = literals.map(d => d.__raw);\r\n        /*\r\n        if it happens like:   second=2, third, fourth=4, fifth=3, sixth.(six would be 4 but 4 already exist)\r\n        there are 2 problems:\r\n        1) [3] is already occupied by third, but fith is correctly being the only one explicitly declaring his ordinal 3.\r\n           fixed by first assigning all known ordinals, then starting with the assumed ordinals.\r\n        2) sixth would get in position fourth, but that is already occupied\r\n         */\r\n\r\n        // adressing 1)\r\n        for (let i = 0; i < dliterals.length; i++) {\r\n            let v = dliterals[i].value;\r\n            if (v) { ret[v] = literals[i]; }\r\n        }\r\n\r\n        // setting assumed literals\r\n        let currentOrdinal = 0;\r\n        for (let i = 0; i < dliterals.length; i++) {\r\n            let v = dliterals[i].value;\r\n            if (v) { currentOrdinal = v; continue; }\r\n            while (ret[currentOrdinal]) currentOrdinal++; // adressing 2)\r\n            ret[currentOrdinal] = literals[i];\r\n        }\r\n        return ret; }\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const ret = () => {\r\n            const pointedBy = U.filteredPointedBy(data, 'type');\r\n            for(let me of pointedBy) {\r\n                if (me) {\r\n                    const dString = Selectors.getFirstPrimitiveTypes();\r\n                    SetFieldAction.new(me.__raw as DAttribute, 'type', dString.id, '', true);\r\n                }\r\n            }\r\n            data.superDelete();\r\n        }\r\n        return ret;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DDataType, DEnumerator);\r\nRuntimeAccessibleClass.set_extend(LDataType, LEnumerator);\r\n@RuntimeAccessible\r\nexport class DModelM1 extends DNamedElement{\r\n    public static cname: string = \"DModelM1\";\r\n    name!: string;\r\n    roots!: Pointer<DObject, 1, 'N', LObject> // no package ma LObjects[] (solo quelli isRoot)\r\n    children!: DModelM1[\"roots\"];\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LModelM1 extends LNamedElement{\r\n    public static cname: string = \"LModelM1\";\r\n    name!: string;\r\n    roots!: LObject[];\r\n    children!: LModelM1[\"roots\"];\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DModelM1, DNamedElement);\r\nRuntimeAccessibleClass.set_extend(LModelM1, LNamedElement);\r\ntype DPrimitiveType = DClass;\r\ntype LPrimitiveType = LClass;\r\n\r\n\r\n// problema: o costringo l'utente a fare sempre .value per ricevere il valore invece dei metadati\r\n// oppure ritorno il valore da subito ma dal valore non posso accedere ai metadati (upperbound...) a meno che non trovi un altor sistema.\r\n\r\n// possibile fix: LValue.toString() che ritorna il .value\r\n\r\n\r\n\r\n\r\n\r\n@RuntimeAccessible\r\nexport class DModel extends DNamedElement { // DNamedElement\r\n    public static cname: string = \"DModel\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LModel;\r\n    // static logic: typeof LModel;\r\n    // static structure: typeof DModel;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DModel, 1, 1, LModel>;\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n    // personal\r\n    packages: Pointer<DPackage, 0, 'N', LPackage> = [];\r\n    isMetamodel: boolean = true;\r\n    objects: Pointer<DObject, 0, 'N', LObject> = [];\r\n    models: Pointer<DModel, 0, 'N', LModel> = [];\r\n    instanceof!: Pointer<DModel, 0, 1, LModel>;\r\n\r\n    public static new(name?: DNamedElement[\"name\"], instanceoff?: DModel[\"instanceof\"], isMetamodel?: DModel[\"isMetamodel\"], persist: boolean = true): DModel {\r\n        let dmodels: DModel[] = Selectors.getAll(DModel, undefined, undefined, true, false);\r\n        let dmodelnames: string[] = dmodels.map((d: DModel) => d.name);\r\n        if (!name) name = this.defaultname(\"model_\", ((name: string) => dmodelnames.includes(name)));\r\n        return new Constructors(new DModel('dwc'), undefined, persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DModel(instanceoff, isMetamodel).end();\r\n    }\r\n    static new2(setter: Partial<ObjectWithoutPointers<DModel>>, name?: DModel[\"name\"], instanceoff?: DModel[\"instanceof\"]): DModel {\r\n        let dmodels: DModel[] = Selectors.getAll(DModel, undefined, undefined, true, false);\r\n        let dmodelnames: string[] = dmodels.map((d: DModel) => d.name);\r\n        if (!name) name = this.defaultname(\"model_\", ((name: string) => dmodelnames.includes(name)));\r\n        return new Constructors(new DModel('dwc'), undefined, true, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DModel(instanceoff).end((d) => { Object.assign(d, setter); });\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class EdgeStarter<T1=any, T2=any>{ // <T1 extends LPointerTargetable = LPointerTargetable, T2 extends LPointerTargetable = LPointerTargetable>{\r\n    public static cname: string = \"EdgeStarter\";\r\n    start: LModelElement;\r\n    end: LModelElement;\r\n    startNode: LGraphElement;\r\n    endNode: LGraphElement;\r\n    startVertex: LVoidVertex;\r\n    endVertex: LVoidVertex;\r\n    startSize: GraphSize;\r\n    endSize: GraphSize;\r\n    startVertexSize: GraphSize;\r\n    endVertexSize: GraphSize;\r\n    otherEnds: LGraphElement[];\r\n    overlaps: boolean;\r\n    vertexOverlaps: boolean;\r\n    constructor(start: LModelElement, end: LModelElement, sn: LGraphElement, en: LGraphElement, otherPossibleEnds: LGraphElement[] = []) {\r\n        this.start = start;\r\n        this.end = end;\r\n        this.startNode = sn;\r\n        this.endNode = en;\r\n        this.otherEnds = otherPossibleEnds || end.nodes;\r\n        this.startSize = sn.size;\r\n        this.endSize = en.size;\r\n        this.startVertex = sn.vertex as any;\r\n        this.endVertex = en.vertex as any;\r\n        this.startVertexSize = this.startVertex === sn ? this.startSize : this.startVertex.size;\r\n        this.endVertexSize = this.endVertex === en ? this.endSize : this.endVertex.size;\r\n        this.overlaps = this.startSize?.isOverlapping(this.endSize);\r\n        this.vertexOverlaps = this.startVertexSize?.isOverlapping(this.endVertexSize);\r\n    }\r\n    static oneToMany<T1 extends LModelElement = LModelElement, T2 extends LModelElement = LModelElement>(start: T1, ends:T2[]): EdgeStarter<T1, T2>[] {\r\n        let sn = start.node;\r\n        if (!sn) return [];\r\n        let rett: (EdgeStarter | undefined)[] = ends.map( (e) => {\r\n            if(!e) return undefined;\r\n            let en = e.node;\r\n            return en ? new EdgeStarter(start, e, sn as LGraphElement, en) : undefined;\r\n        });\r\n        let ret: (EdgeStarter)[] = rett.filter<EdgeStarter>(function(e: EdgeStarter|undefined): e is EdgeStarter { return !!e });\r\n        // let ret: (EdgeStarter)[] = rett.filter<EdgeStarter>((e): (e is EdgeStarter) => { return !!e });\r\n        return ret;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LModel<Context extends LogicContext<DModel> = any, C extends Context = Context, D extends DModel = DModel> extends LNamedElement {\r\n    public static cname: string = \"LModel\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DModel;\r\n    id!: Pointer<DModel, 1, 1, LModel>;\r\n    // static singleton: LModel;\r\n    // static logic: typeof LModel;\r\n    // static structure: typeof DModel;\r\n\r\n    // inherit redefine\r\n    parent!: LModel[];\r\n    father!: LModel;\r\n    annotations!: LAnnotation[];\r\n    name!: string;\r\n    namespace!: string;\r\n    // personal\r\n    isMetamodel!: boolean;\r\n\r\n    // Metamodel\r\n    packages!: LPackage[];\r\n    models!: LModel[];\r\n\r\n    // Model\r\n    instanceof?: LModel;\r\n    objects!: LObject[];\r\n    roots!: LObject[];\r\n\r\n    // utilities to go down in the tree (plural names)\r\n    enums!: LEnumerator[];\r\n    classes!: LClass[];\r\n    operations!: LOperation[];\r\n    parameters!: LParameter[];\r\n    exceptions!: LClassifier[];\r\n    attributes!: LAttribute[];\r\n    references!: LReference[];\r\n    literals!: LEnumLiteral[];\r\n    allSubAnnotations!: LAnnotation[];\r\n    allSubPackages!: LPackage[];\r\n    allSubObjects!: LObject[];\r\n    suggestedEdges!: {extend: EdgeStarter[], reference:EdgeStarter[], packageDependencies: EdgeStarter[]}; //, model: EdgeStarter[], package:EdgeStarter[], class:EdgeStarter[]};\r\n    __info_of__suggestedEdges: Info = {type: 'Dictionary<\"extend\" | \"reference\" | \"packageDependencies\" | DmodelName, EdgeStarter[]>', txt: \"A map to access all possible kind of edges based on model data.\" +\r\n            \"<br/>extend and reference are the most commonly used for horizontal references (outside the containment tree schema).\" +\r\n            \"<br/>packageDependencies links packages using classes from other packages.\" +\r\n            // \"<br/>other keys are the names of container data types (mode, package, class, object...) from them to their childrens rendered as Nodes (vertical tree schema).\" +\r\n            // todo: implement the commented part as LGrahElement.vertexs.map(v=>{start:v.parentnode.isVertex ? v.parentnode.id : undefined, end:v.id}).filter(e=>e.start) instead. it's a thing of graph more than model.\r\n            \"<br/> EdgeStarter is a collection of data useful to start a &lt;Edge /&gt; in JSX.\"}\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        const json: GObject = {};\r\n\r\n        // if it's M2 metamodel\r\n        if (context.data.isMetamodel) {\r\n            const packageArr: Json[] = [];\r\n            for (let pkg of context.proxyObject.packages) { packageArr.push(pkg.generateEcoreJson(loopDetectionObj)); }\r\n            // return (context.proxyObject.packages[0])?.generateEcoreJson(loopDetectionObj);\r\n            json[ECoreRoot.ecoreEPackage] = packageArr;\r\n            return json;\r\n        }\r\n\r\n        // if it's M1 model\r\n        // let serializeasroot = context.proxyObject.isRoot && loopDetectionObj.length; // if rootobj is nested because you started the serialization from another node, i prevent it generating root content\r\n        for (let obj of context.proxyObject.roots) { json[obj.ecoreRootName] = obj.generateEcoreJson(loopDetectionObj); }\r\n\r\n        return json; }\r\n\r\n    public addPackage(name?: DPackage[\"name\"], uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"]): DPackage { return this.cannotCall(\"addPackage\"); }\r\n    public get_addPackage(context: Context): ((name?: DPackage[\"name\"], uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"]) => DPackage) {\r\n        return (name?: DPackage[\"name\"], uri?: DPackage[\"uri\"], prefix?: DPackage[\"prefix\"]) => {\r\n            const me = DPackage.new(name, uri, prefix, context.data.id, true, DModel);\r\n            return me;\r\n        }\r\n    }\r\n\r\n    public addObject(instanceoff?:DObject[\"instanceof\"], name?: DObject[\"name\"]): DObject { return this.cannotCall(\"addObject\"); }\r\n    protected get_addObject(context: Context): this[\"addObject\"] {\r\n        return (instanceoff?:DObject[\"instanceof\"], name?: DObject[\"name\"]) => {\r\n            const dObject = DObject.new(instanceoff, context.data.id, DModel, undefined, true);\r\n            /*\r\n            if(!instanceoff) return dObject;\r\n            let father: LClass|undefined = LClass.fromPointer(instanceoff)?.extends?.[0];\r\n            while(father) {\r\n                for(let lFeature of [...father.attributes, ...father.references])\r\n                    DValue.new(lFeature.name, lFeature.id, undefined, dObject.id);\r\n                father = (father.extends.length > 0) ? father.extends[0] : undefined;\r\n            }\r\n            */\r\n            return dObject;\r\n        }\r\n    }\r\n\r\n    public get_suggestedEdges(context: Context): this[\"suggestedEdges\"]{\r\n        let ret: this[\"suggestedEdges\"];\r\n        if (context.data.isMetamodel) ret = this.get_suggestedEdgesM2(context);\r\n        else ret = this.get_suggestedEdgesM1(context);\r\n        /*\r\n        ret.extend = ret.extend || [];\r\n        ret.packageDependencies = ret.packageDependencies || [];\r\n        ret.reference = ret.reference || [];\r\n\r\n        console.log(\"suggested edges, pre filter\", {...ret});\r\n        ret.extend = ret.extend.filter( r => !r.startNode.size.isOverlapping(r.endNode.size));\r\n        ret.packageDependencies = ret.packageDependencies.filter( r => !r.startNode.size.isOverlapping(r.endNode.size));\r\n        ret.reference = ret.reference.filter( r => !r.startNode.size.isOverlapping(r.endNode.size));\r\n\r\n        console.log(\"suggested edges, post filter\", {...ret});*/\r\n        return ret;\r\n    }\r\n    private get_suggestedEdgesM2(context: Context): this[\"suggestedEdges\"]{\r\n        let ret: this[\"suggestedEdges\"] = {} as any;\r\n        let s: DState = store.getState();\r\n        let classes: LClass[] = this.get_classes(context, s);\r\n        let references: LReference[] = classes.flatMap(c=>c.references);\r\n        ret.reference = references.map( (r) => {\r\n            let sn = r.node;\r\n            if (!sn) return undefined;\r\n            let end = r.type;\r\n            if (end.id === r.id) return undefined;\r\n            let en = end.node;\r\n            if (!en) return undefined;\r\n            return new EdgeStarter(r, end, sn, en);\r\n        }).filter<EdgeStarter>(function(e):e is EdgeStarter{ return !!e});\r\n        // ret.extend = classes.flatMap( c => EdgeStarter.oneToMany(c, c.extends));\r\n\r\n        let alreadyAdded: Dictionary<Pointer, LClass> = {};\r\n        // if A extends B1, B2;    B1 extends C1, C2;    and node B1 is hidden. instead of edge from A to B, i display edge from A~C1, A~C2, A~B2\r\n        function SkipExtendNodeHidden(start: LClass, end: LClass[], rootCall: boolean = true): ({start: LClass, end: LClass, sn: LGraphElement, en: LGraphElement})[] {\r\n            let ret: {start: LClass, end: LClass, sn: LGraphElement, en: LGraphElement}[] = [] as any;\r\n            if (rootCall) { alreadyAdded = {}; alreadyAdded[start.id] = start; } // end classes can get added twice if from a different starting subclass path (in classes.flatMap -> each one should have his own dict).\r\n            // ret.start = start;\r\n            let sn = start.node;\r\n            if (!sn) return [];\r\n            //  let end: LClass[] = start.extends;\r\n            for (let e of end) {\r\n                let eid = e.id;\r\n                if (alreadyAdded[eid]) continue; // without this there might be duplicates if A extends B1, B2;  and both B1 & B2 extends C\r\n                alreadyAdded[eid] = e;\r\n                let en = e.node;\r\n                if (en) { ret.push({start, end:e, sn, en}); continue; } // continue;\r\n                let secondTierExtends = e.extends;\r\n                // for (let eend of secondTierExtends) {\r\n                ret.push(...SkipExtendNodeHidden(start, secondTierExtends, false));\r\n                //}\r\n            }\r\n            return ret;\r\n        }\r\n        ret.extend = classes.flatMap(c => SkipExtendNodeHidden(c, c.extends, true)).map( (es) => new EdgeStarter(es.start, es.end, es.sn, es.en));\r\n\r\n        let dependencies: {src:LModelElement, ends: LModelElement[]}[] = [...(classes.map(c=>{ return {src:c, ends:c.superclasses}})), ...(references.map(r=> { return {src:r, ends:[r.type]}}))]\r\n        let pkgdependencies: {src: LPackage, sn: LGraphElement, ends: Dictionary<Pointer, {end:LPackage, en:LGraphElement}>}[] = []; // transform form in dictionary to prevent duplicates\r\n        //dependencies.map( d=> { let end = d.end.package; return {src:d.src.package, end, endid:end.id}})\r\n\r\n        for (let d of dependencies) {\r\n            let src: LPackage | null = d.src.package;\r\n            if (!src) continue;\r\n            let srcnode: LGraphElement | undefined = src.node;\r\n            if (!srcnode) continue;\r\n            let ends: Dictionary<Pointer, {end:LPackage, en:LGraphElement}> = {};\r\n            for (let end of d.ends) {\r\n                let ep: LPackage|null = end.package;\r\n                if (!ep) continue;\r\n                let epnode: LGraphElement | undefined = ep.node;\r\n                if (!epnode) continue;\r\n                ends[ep.id] = {end:ep, en:epnode};\r\n            }\r\n            pkgdependencies.push( {src, sn:srcnode, ends});\r\n        }\r\n        ret.packageDependencies = pkgdependencies.flatMap( pd => ( Object.values(pd.ends).map((end) => new EdgeStarter(pd.src, end.end, pd.sn, end.en)))); // todo: check\r\n        return ret; }\r\n\r\n    private get_suggestedEdgesM1(context: Context): this[\"suggestedEdges\"]{\r\n        let ret: this[\"suggestedEdges\"] = {todo:true} as any;\r\n        return ret;// todo\r\n    }\r\n\r\n    protected get_models(context: Context): LModel[] {\r\n        return LModel.fromPointer(context.data.models);\r\n    }\r\n    protected set_models(val: PackArr<this['models']>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.models;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'models', list, '', true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    public duplicate(deep: boolean = true): this { throw new Error(\"Model.duplicate(): use export/import ecore instead.\"); }\r\n\r\n    protected set_instanceof(val: Pack1<this[\"instanceof\"]>, context: Context): boolean {\r\n        let ptr = Pointers.from(val);\r\n        SetFieldAction.new(context.data.id, \"instanceof\", ptr, undefined, true);\r\n        // update father's collections (pointedby's here are set automatically)\r\n        // todo: ptr && SetFieldAction.new(ptr, \"instances\", context.data.id, '+=', true);\r\n        return true; }\r\n    protected get_instanceof(context: Context): this[\"instanceof\"] { return context.data.instanceof ? LPointerTargetable.fromPointer(context.data.instanceof) : undefined; }\r\n\r\n    protected set_name(val: this['name'], context: Context): boolean {\r\n        const models: LModel[] = LModel.fromPointer(store.getState()['models']);\r\n        if(models.filter((model) => { return model.name === val }).length > 0) {\r\n            U.alert('error', 'Cannot rename the selected element since this name is already taken.');\r\n        } else {\r\n            SetFieldAction.new(context.data, 'name', val, '', false);\r\n        }\r\n        return true;\r\n    }\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | (DPackage|DObject), 1, 'N'> {\r\n        let children: Pointer<(DPackage|DObject), 0, 'N', (LPackage|LObject)>;\r\n        if(context.data.isMetamodel) children = context.data.packages;\r\n        else children = context.data.objects;\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | (DPackage|DObject), 1, 'N'>,\r\n            ...children];\r\n    }\r\n\r\n    protected get_isMetamodel(context: Context): this['isMetamodel'] {\r\n        return context.data.isMetamodel;\r\n    }\r\n    protected set_isMetamodel(val: this['isMetamodel'], context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'isMetamodel', val, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected get_objects(context: Context): this['objects'] {\r\n        return context.data.objects.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n\r\n    protected get_packages(context: Context): this[\"packages\"] {\r\n        return context.data.packages.map((pointer) => {\r\n            return LPointerTargetable.from(pointer)\r\n        });\r\n    }\r\n\r\n    protected set_packages(val: PackArr<this[\"packages\"]>, context: Context): boolean {\r\n        const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        const oldList = context.data.packages;\r\n        const diff = U.arrayDifference(oldList, list);\r\n        BEGIN();\r\n        SetFieldAction.new(context.data, 'packages', list, \"\", true);\r\n        for (let id of diff.added) {\r\n            SetFieldAction.new(id, 'father', context.data.id, '', true);\r\n            SetFieldAction.new(id, 'parent', context.data.id, '+=', true);\r\n        }\r\n        for (let id of diff.removed as Pointer<DModelElement>[]) {\r\n            SetFieldAction.new(id, 'father', undefined, '', true);\r\n            const parent = DPointerTargetable.from(id).parent;\r\n            U.arrayRemoveAll(parent, context.data.id);\r\n            SetFieldAction.new(id, 'parent', parent, '', true);\r\n        }\r\n        END();\r\n        return true;\r\n    }\r\n\r\n    protected get_roots(context: Context): this[\"roots\"] {\r\n        return this.get_objects(context).filter( o => o.isRoot);\r\n    }\r\n    protected get_classes(context: Context, s?: DState): this[\"classes\"] {\r\n        s = s||store.getState();\r\n        return this.get_allSubPackages(context, s).flatMap(p => p.classes || []);\r\n    }\r\n    protected get_references(context: Context, s?: DState): this[\"references\"] {\r\n        s = s||store.getState();\r\n        return this.get_classes(context, s).flatMap(p => p.references || []);\r\n    }\r\n\r\n    protected get_enums(context: Context): this[\"enums\"] {\r\n        return this.get_enumerators(context);\r\n    }\r\n\r\n    protected get_enumerators(context: Context, s?: DState): this[\"enums\"] {\r\n        s = s||store.getState();\r\n        return this.get_allSubPackages(context, s).flatMap(p => (p.enums || []));\r\n    }\r\n\r\n    protected get_allSubPackages(context: Context, state?: DState): this[\"allSubPackages\"] {\r\n        state = state || store.getState();\r\n        let tocheck: Pointer<DPackage>[] = context.data.packages || [];\r\n        let checked: Dictionary<Pointer, true> = {};\r\n        while (tocheck.length) {\r\n            let newtocheck: Pointer<DPackage>[] = [];\r\n            for (let ptr of tocheck) {\r\n                if (checked[ptr]) throw new Error(\"loop in packages containing themselves\");\r\n                checked[ptr] = true;\r\n                let dpackage: DPackage = DPointerTargetable.from(ptr, state);\r\n                U.arrayMergeInPlace(newtocheck, dpackage?.subpackages);\r\n            }\r\n            tocheck = newtocheck;\r\n        }\r\n        return LPointerTargetable.from(Object.keys(checked), state);\r\n    }\r\n    protected get_allSubObjects(context: Context, state?: DState): this[\"allSubObjects\"] {\r\n        state = state || store.getState();\r\n        return (Selectors.getAll(DObject, undefined, state, true, true) as LObject[]).filter( (o: LObject) => o.model.id === context.data.id);\r\n        /*\r\n        let tocheck: Pointer<DObject>[] = context.data.objects || [];\r\n        let checked: Dictionary<DObject, true> = {};\r\n        while (tocheck.length) {\r\n            let newtocheck: Pointer<DObject>[] = [];\r\n            for (let ptr of tocheck) {\r\n                if (checked[ptr]) throw new Error(\"loop in packages containing themselves\");\r\n                checked[ptr] = true;\r\n                let dpackage: DObject = DPointerTargetable.from(ptr, state);\r\n                U.arrayMergeInPlace(newtocheck, dpackage?.values.... it's a mess, filter subobjects here);\r\n            }\r\n            tocheck = newtocheck;\r\n        }\r\n        return LPointerTargetable.from(Object.keys(checked), state);*/\r\n    }\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const ret = () => { U.alert('error', 'In this version of the tool models cannot be deleted.'); }\r\n        return ret;\r\n    }\r\n\r\n    public getClassByNameSpace(namespacedclass: string): LClass | undefined { return this.cannotCall(\"getClassByNameSpace\"); }\r\n    protected get_getClassByNameSpace(context: Context): this[\"getClassByNameSpace\"] {\r\n        return (namespacedclass: string): LClass | undefined => {\r\n            let pos = namespacedclass.lastIndexOf(\":\");\r\n            let pkguri = namespacedclass.substring(0, pos);\r\n            let classname = namespacedclass.substring(pos+1);\r\n            let pkg: LPackage | undefined = this.get_getPackageByUri(context)(pkguri);\r\n            if (!pkg) return undefined;\r\n            // return pkg[\"@\" + classname];\r\n            return pkg.classes.filter((c) => c.name === classname)[0];\r\n        }; }\r\n    public getPackageByUri(uri: string): LPackage | undefined { return this.cannotCall(\"getPackageByUri\"); }\r\n    protected get_getPackageByUri(context: Context): this[\"getPackageByUri\"] {\r\n        return (uri: string)=>context.proxyObject.allSubPackages.filter((p)=>p.uri === uri)[0]; }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DModel);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LModel);\r\n\r\n\r\n@RuntimeAccessible\r\nexport abstract class DFactory_useless_ extends DPointerTargetable { // DModelElement\r\n    public static cname: string = \"DFactory_useless_\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LFactory_useless_;\r\n    // static logic: typeof LFactory_useless_;\r\n    // static structure: typeof DFactory_useless_;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DFactory_useless_, 1, 1, LFactory_useless_>;\r\n    parent: Pointer<DModelElement, 0, 'N', LModelElement> = [];\r\n    father!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    // personal\r\n    ePackage: Pointer<DPackage, 1, 1, LPackage> = '';\r\n    abstract create(DClass: DClass): DObject;\r\n    abstract createFromString(eDataType: DDataType, literalValue: string): EJavaObject;\r\n    abstract convertFromString(eDataType: DDataType, instanceValue: EJavaObject): string;\r\n    // ********************** my additions inherited ********************* //\r\n    // ********************** my additions personal ********************** //\r\n}\r\n@RuntimeAccessible\r\nexport abstract class LFactory_useless_<Context extends LogicContext<DFactory_useless_> = any, C extends Context = Context>  extends LModelElement {\r\n    public static cname: string = \"LFactory_useless_\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DFactory_useless_;\r\n    id!: Pointer<DFactory_useless_, 1, 1, LFactory_useless_>;\r\n    // static singleton: LFactory_useless_;\r\n    // static logic: typeof LFactory_useless_;\r\n    // static structure: typeof DFactory_useless_;\r\n\r\n    // inherit redefine\r\n    parent!: LModelElement[];\r\n    father!: LModelElement;\r\n    annotations!: LAnnotation[];\r\n    // personal\r\n    ePackage!: LPackage;\r\n    abstract create(DClass: DClass): DObject;\r\n    abstract createFromString(eDataType: DDataType, literalValue: string): EJavaObject;\r\n    abstract convertFromString(eDataType: DDataType, instanceValue: EJavaObject): string;\r\n    // ********************** my additions inherited ********************* //\r\n    // ********************** my additions personal ********************** //\r\n}\r\n\r\n// DModelElement.subclasses.push('DFactory_useless_'); // because it's abstract and cannot be used as a value, it's pure type definition\r\n// DModelElement.subclasses.push('LFactory_useless_'); // because it's abstract and cannot be used as a value, it's pure type definition\r\n// RuntimeAccessibleClass.set_extend(DModelElement, DFactory_useless_);\r\n// RuntimeAccessibleClass.set_extend(LModelElement, LFactory_useless_);\r\n\r\n@RuntimeAccessible\r\nexport class EJavaObject{\r\n    public static cname: string = \"EJavaObject\";\r\n\r\n}// ??? EDataType instance?\r\n\r\n\r\n@RuntimeAccessible\r\nexport class DMap extends Object { // DPointerTargetable\r\n    public static cname: string = \"DMap\";\r\n    // static logic: typeof LModelElement;\r\n    // static structure: typeof DModelElement;\r\n    // static singleton: LModelElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    __isDMap!: true;\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    // id!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LMap<Context extends LogicContext<DMap> = any, C extends Context = Context>  extends LPointerTargetable {\r\n    public static cname: string = \"LMap\";\r\n    // static logic: typeof LModelElement;\r\n    // static structure: typeof DModelElement;\r\n    // static singleton: LModelElement;\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    __isLMap!: true;\r\n    // id!: Pointer<DModelElement, 1, 1, LModelElement>;\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DMap as any);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LMap);\r\n@RuntimeAccessible\r\nexport class DObject extends DPointerTargetable { // extends DNamedElement, m1 class instance\r\n    public static cname: string = \"DObject\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n\r\n    // inherit redefine\r\n    annotations!: never[];\r\n    id!: Pointer<DObject, 1, 1, LObject>;\r\n    parent: Pointer<DModel | DValue, 0, 'N', LModel | LValue> = [];\r\n    father!: Pointer<DModel, 1, 1, LModel> |  Pointer<DValue, 1, 1, LValue>;\r\n    // annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name!: string;\r\n\r\n    // personal\r\n    instanceof!: Pointer<DClass, 0, 1, LClass>;\r\n    features: Pointer<DValue, 0, 'N', LValue> = [];\r\n\r\n\r\n    public static new(instanceoff?: DObject[\"instanceof\"], father?: DObject[\"father\"], fatherType?: typeof DModel | typeof DValue, name?: DNamedElement[\"name\"], persist: boolean = true): DObject {\r\n        // if (!name) name = this.defaultname(((meta: LNamedElement) => meta.name + \" \"), father);\r\n        if (!name) name = this.defaultname(((meta: LNamedElement) => (meta?.name || \"obj\") + \"_\"), father, instanceoff);\r\n        let ret = new Constructors(new DObject('dwc'), father, persist, fatherType).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name).DObject(instanceoff).end();\r\n        return ret;\r\n    }\r\n\r\n\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LObject<Context extends LogicContext<DObject> = any, C extends Context = Context, D extends DObject = DObject> extends LNamedElement { // extends DNamedElement, m1 class instance\r\n    public static cname: string = \"LObject\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DObject;\r\n    id!: Pointer<DObject, 1, 1, LObject>;\r\n\r\n    // inherit redefine\r\n    annotations!: never[];\r\n    children!: LValue[];\r\n    allchildren!: LValue[]; // including hidden values\r\n    truechildren!: LValue[]; // real shape without \"mirage\" values\r\n    parent!: (LModel | LValue)[];\r\n    father!: LModel | LValue;\r\n    model!: LModel;\r\n    // annotations!: LAnnotation[];\r\n    // from LClass\r\n\r\n    name!: string;\r\n    ecoreRootName!: string;\r\n    namespace!: string;\r\n    fullname!:string;\r\n    defaultValue!: DClass[\"defaultValue\"];\r\n    // abstract!: boolean;\r\n    // interface!: boolean;\r\n    // references!: LReference[];\r\n    // attributes!: LAttribute[];\r\n    // operations!: LOperation[];\r\n\r\n    // personal\r\n    deepSubObjects!: LObject[]; // todo: itera features (lvalue[]) deep e vitando di inserire doppioni (salva una mappatura di di già aggiunti e skip se ricompaiono)\r\n    subObjects!: LObject[];\r\n    referenceFeatures!: LValue[]; // subset of features that are references.\r\n    attributeFeatures!: LValue[]; // subset of features that are attributes.\r\n    shapelessFeatures!: LValue[]; // subset of features that are not mapped and can have any kind of values.\r\n    // + tutte le funzioni di comodità navigazionale del modello, trattarlo un pò come se fosse un modello (e quasi può esserlo)\r\n    instanceof!: LClass;\r\n    features!: LValue[];\r\n    referencedBy!: LObject[];\r\n    isRoot!: boolean;\r\n    readonly partial!: boolean;\r\n\r\n    protected get_truechildren(context: Context): this[\"children\"] {\r\n        let childs: LValue[] = super.get_children(context);\r\n        if (!context.data.instanceof) return childs;\r\n        return childs.filter( (c) => !c.isMirage);\r\n    }\r\n\r\n    protected get_allchildren(context: Context): this[\"children\"] { return super.get_children(context); }\r\n\r\n    protected get_children(context: Context, sort: boolean = true): this[\"children\"] {\r\n        let childs: LValue[] = super.get_children(context);\r\n        let meta: LClass = context.proxyObject.instanceof;\r\n        // if (!sort && (!meta || meta.partial)) return childs;\r\n        let conformchildren: undefined | Pointer[] = meta && !meta.partial ? meta.allChildren.map(c => c.id) : undefined;\r\n        if (!sort) {\r\n            // console.log(\"return get features:\", {context, meta, childs, conformchildren, ret:childs.filter((c) => (c.instanceof?.id) && conformchildren!.includes(c.instanceof?.id))});\r\n            if (!conformchildren) return childs;\r\n            return childs.filter((c) => (c.instanceof?.id) && conformchildren!.includes(c.instanceof?.id));\r\n        }\r\n\r\n        let bymetaparent: Dictionary<DocString<\"metaparent pointer\">, LValue[]> = {};\r\n        for (let v of childs) {\r\n            let vmeta = v.instanceof;\r\n            // console.log(\"get features filtering:\", {context, meta, vmeta, v, childs, conformchildren});\r\n\r\n            if (conformchildren && (!vmeta || !conformchildren.includes(vmeta.id))) continue;\r\n            let vmetaid: string = vmeta?.id as string; // undef as key is fine even if compiler complains, so i cast it\r\n            if (!bymetaparent[vmetaid]) bymetaparent[vmetaid] = [v]; else bymetaparent[vmetaid as any].push(v);\r\n        }\r\n        // console.log(\"return get features:\", {context, meta, childs, conformchildren, ret:Object.values(bymetaparent).flat()});\r\n        return Object.values(bymetaparent).flat();\r\n    }\r\n\r\n\r\n    // protected get_fromlclass<T extends keyof (LClass)>(meta: LClass, key: T): LClass[T] { return meta[key]; }\r\n    protected get_model(context: Context): LModelElement[\"model\"] {\r\n        let l: LValue | LObject | LModel = context.proxyObject;\r\n        while (l && l.className !== DModel.cname) l = l.father;\r\n        return l as LModel; }\r\n    // protected set_name(val: string, context: Context): boolean { return this.cannotSet(\"name\"); }\r\n    protected get_name(context: Context): LClass[\"name\"] { return context.data.name || context.proxyObject.instanceof.name; }\r\n    protected set_namespace(val: string, context: Context): boolean { return this.cannotSet(\"namespace\"); }\r\n    // protected get_namespace(context: Context): LClass[\"namespace\"] { return context.proxyObject.instanceof.namespace; }\r\n    protected set_fullname(val: string, context: Context): boolean { return this.cannotSet(\"fullname\"); }\r\n    protected get_fullname(context: Context): LClass[\"fullname\"] { return context.proxyObject.instanceof.fullname; }\r\n    protected set_ecoreRootName(val: string, context: Context): boolean { return this.cannotSet(\"ecoreRootName\"); }\r\n    protected get_ecoreRootName(context: Context): LObject[\"ecoreRootName\"] {\r\n        let instanceoff: LClass = context.proxyObject.instanceof;\r\n        if (!instanceoff) return \"schemaless:Object\";\r\n        return this.get_uri(context) + \":\" + instanceoff.name; // optimize later in instanceoff.namespace + \":\" + instanceoff.name; and implement namespace all around\r\n    }\r\n    protected set_partialdefaultname(val: DClass[\"partialdefaultname\"], context: Context): boolean { return this.cannotSet(\"DObject.partialdefaultname()\"); }\r\n    protected get_partialdefaultname(context: Context): DClass[\"partialdefaultname\"] { return context.data.instanceof ? context.proxyObject.instanceof.partialdefaultname : \"val_\"; }\r\n    protected set_partial(val: DClass[\"partial\"], context: Context): boolean { return this.cannotSet(\"DObject.set_partial()\"); }\r\n    protected get_partial(context: Context): DClass[\"partial\"] { return context.data.instanceof ? context.proxyObject.instanceof?.partial : true; }\r\n\r\n    /*    protected set_abstract(val: string, context: Context): boolean { return this.cannotSet(\"abstract\"); }\r\n        protected get_abstract(context: Context): LClass[\"abstract\"] { return context.proxyObject.instanceof.abstract; }\r\n        protected set_interface(val: string, context: Context): boolean { return this.cannotSet(\"interface\"); }\r\n        protected get_interface(context: Context): LClass[\"interface\"] { return context.proxyObject.instanceof.interface; }*/\r\n    protected set_defaultValue(val: string, context: Context): boolean { return this.cannotSet(\"defaultValue\"); }\r\n    protected get_defaultValue(context: Context): LClass[\"defaultValue\"] { return context.proxyObject.instanceof.defaultValue; }\r\n    protected set_referencedBy(val: string, context: Context): boolean { return this.wrongAccessMessage(\"referencedBy cannot be set directly. It should be updated automatically as side effect\"); }\r\n    protected get_referencedBy(context: Context): LObject[\"referencedBy\"] {\r\n        let state: DState = store.getState();\r\n        let targeting: LObject[] = LPointerTargetable.fromArr(context.data.pointedBy.map( p => {\r\n            let s: GObject = state;\r\n            for (let key of PointedBy.getPathArr(p)) {\r\n                s = s[key];\r\n                if (!s) return null;\r\n                if (s.className === DObject.cname) return s.id;\r\n            }\r\n        }));\r\n        return targeting; }\r\n\r\n    protected get_subObjects(context: Context): this[\"subObjects\"] {\r\n        let ref_features: LValue[] = this.get_referenceFeatures(context, false).filter( (f) => (f.instanceof as LReference)!.containment );\r\n        let shapeless_features: LValue[] = this.get_shapelessFeatures(context);\r\n        let vals: LObject[] = [\r\n            ...ref_features.flatMap((f) => (f.values as LObject[])).filter((val)=>!!val),\r\n            ...shapeless_features.flatMap((f) => (f.values as any))\r\n                .filter((val)=>(!!val && val.className === DObject.cname)) as LObject[]\r\n        ];\r\n        return vals;\r\n    }\r\n\r\n    protected get_deepSubObjects(context: Context): this[\"deepSubObjects\"] {\r\n        let alreadyparsed: Dictionary<Pointer, LObject> = {};\r\n        let arr: LObject[] = this.get_subObjects(context);\r\n        while(arr.length) {\r\n            let next: LObject[] = [];\r\n            for (let obj of arr) {\r\n                if (alreadyparsed[obj.id]) continue;\r\n                alreadyparsed[obj.id] = obj;\r\n                next.push(...obj.subObjects);\r\n            }\r\n            arr = next;\r\n        }\r\n        return Object.values(alreadyparsed) || [];\r\n    }\r\n\r\n    protected get_referenceFeatures(context: Context, includeshapeless: boolean = false): this[\"referenceFeatures\"] {\r\n        return context.proxyObject.features.filter((f) => (!f.instanceof ? includeshapeless : f.instanceof.className === DReference.cname));\r\n    }\r\n    protected get_attributeFeatures(context: Context, includeshapeless: boolean = false): this[\"attributeFeatures\"] {\r\n        return context.proxyObject.features.filter((f) => (!f.instanceof ? includeshapeless : f.instanceof.className === DAttribute.cname));\r\n    }\r\n\r\n    protected get_shapelessFeatures(context: Context): this[\"shapelessFeatures\"] {\r\n        return context.proxyObject.features.filter((f) => (!f.instanceof));\r\n    }\r\n\r\n    protected get_isRoot(context: Context): LObject[\"isRoot\"] { return context.proxyObject.father.className === DModel.cname; }\r\n    protected set_isRoot(val: never, context: Context): boolean { return this.wrongAccessMessage(\"isRoot cannot be set directly, change father element instead.\"); }\r\n\r\n    public feature(name: string): (PrimitiveType|LObject)|(PrimitiveType|LObject)[] { this.cannotCall('feature'); return null; }\r\n    private get_feature(context: Context): (name: string) => LValue[\"value\"] | LValue[\"values\"] {\r\n        return (name: string) => {\r\n            const lObject = context.proxyObject;\r\n            const features = lObject.features.filter((value) => {\r\n                return value.instanceof?.name === name\r\n            });\r\n            if(features.length > 0) {\r\n                const matchedFeature = features[0];\r\n                switch(matchedFeature.values.length) {\r\n                    case 0: return '';\r\n                    case 1: return matchedFeature.value;\r\n                    default: return matchedFeature.values;\r\n                }\r\n            } return '';\r\n        }\r\n    }\r\n\r\n    public addValue(name?: DValue[\"name\"], instanceoff?: DValue[\"instanceof\"], value?: DValue[\"values\"], isMirage?: boolean): DValue { return this.cannotCall(\"addValue\"); }\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        let asEcoreRoot = (context.proxyObject.isRoot);\r\n        // todo: actually use this loopdetectionobj\r\n        const json: GObject = {};\r\n        if (asEcoreRoot) {\r\n            console.log(\"generate object ecore\", {context, asEcoreRoot, json});\r\n            const lc: LClass = context.proxyObject.instanceof;\r\n            json[ECorePackage.xmiversion] = '2.0';\r\n            json[ECorePackage.xmlnsxmi] = 'http://www.omg.org/XMI';\r\n            // json[ECorePackage.xmlnsxsi] = 'http://www.w3.org/2001/XMLSchema-instance';\r\n            json[\"xmlns:\" + ( lc ? (lc.father.uri + \".\" +lc.father.name) : \"shapeless.model.uri\")] = 'http://www.eclipse.org/emf/2002/Ecore';\r\n        }\r\n\r\n        let features = context.proxyObject.features || [];\r\n        console.log(\"features\", {features});\r\n        for (let f of features){\r\n            json[f.name] = f.generateEcoreJson(loopDetectionObj);\r\n        }\r\n\r\n\r\n        return json; }\r\n    protected get_addValue(context: Context): this[\"addValue\"] {\r\n        return (name?: DValue[\"name\"], instanceoff?: DValue[\"instanceof\"], value?: DValue[\"values\"], isMirage?: boolean) => DValue.new(name, instanceoff, value, context.data.id, true, isMirage); }\r\n\r\n    protected get_namespace(context: Context): string {\r\n        return context.data.instanceof ? context.proxyObject.instanceof.father.prefix : \"schemaless\"; }\r\n    protected get_uri(context: Context): string {\r\n        if (!context.data.instanceof) return \"schemaless\";\r\n        let pkg = context.proxyObject.instanceof.father;\r\n        return pkg.uri;// + \".\" + pkg.name;\r\n    }\r\n    // protected get_namespace(context: Context): string { if (!context.data.instanceof) return \"schemaless\"; return context.proxyObject.instanceof.namespace; }\r\n\r\n    protected get_children_idlist(context: Context): Pointer<DAnnotation | DValue, 1, 'N'> {\r\n        return [...super.get_children_idlist(context) as Pointer<DAnnotation | DValue, 1, 'N'>,\r\n            ...context.data.features];\r\n    }\r\n\r\n    protected get_instanceof(context: Context): this[\"instanceof\"] {\r\n        const pointer = context.data.instanceof;\r\n        return LPointerTargetable.from(pointer)\r\n    }\r\n    protected set_instanceof(val: Pack1<this[\"instanceof\"]>, context: Context): boolean {\r\n        const metaptr: D[\"instanceof\"] = Pointers.from(val);\r\n        this._removeConformity(context);\r\n        SetFieldAction.new(context.data.id, \"instanceof\", metaptr, undefined, true);\r\n        // update father's collections (pointedby's here are set automatically)\r\n        metaptr && SetFieldAction.new(metaptr as Pointer<DClass>, \"instances\", context.data.id, '+=', true);\r\n        if (metaptr) this._forceConformity(context, metaptr);\r\n        return true;\r\n    }\r\n\r\n    private forceConformity(context: Context, meta: D[\"instanceof\"]): void {\r\n        let oldinstanceof = context.data.instanceof;\r\n        // context.data.instanceof = meta;\r\n        let ret = this._forceConformity(context, meta);\r\n        // context.data.instanceof = oldinstanceof;\r\n        return ret;\r\n    }\r\n    private _forceConformity(context: Context, meta: D[\"instanceof\"]): void {\r\n        let lmeta = meta && LPointerTargetable.wrap(meta) as this[\"instanceof\"];\r\n        if (!lmeta) return;\r\n        let attrs = lmeta.allAttributes;\r\n        let refs = lmeta.allReferences;\r\n        let values = context.proxyObject.allchildren;\r\n        let idmap: Dictionary<string, LAttribute | LReference> = {};\r\n        for (let a of attrs) { idmap[a.id] = a; }\r\n        for (let a of refs) { idmap[a.id] = a; }\r\n        console.log({values, data: context.data, l:context.proxyObject});\r\n        // damiano: todo quando viene cancellato una feature il puntatore in features e values rimane. use pointedby's\r\n        // then remove \"v &&\" \"filter in if\r\n        for (let v of values) { if(v && v.__raw.instanceof) delete idmap[v.__raw.instanceof]; }\r\n        console.log(\"forceconformity\", {attrs, refs, values: values.map(v=> v && v.__raw.instanceof), idmap});\r\n        for (let id in idmap) {\r\n            // let l = idmap[id];\r\n            context.proxyObject.addValue(undefined, id, [],true);\r\n        }\r\n    }\r\n    private _removeConformity(context: Context): void {\r\n        let childs = context.proxyObject.features;\r\n        for (let child of childs) if (child.isMirage) child.delete();\r\n    }\r\n\r\n    protected get_features(context: Context): this['features'] {\r\n        return this.get_children(context);\r\n        // return context.data.features.map((feature) => { return LPointerTargetable.from(feature) });\r\n    }\r\n\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const ret = () => {\r\n            const pointedBy = U.filteredPointedBy(data, 'values');\r\n            for(let me of pointedBy) {\r\n                if (me) {\r\n                    const lValue = me as LValue;\r\n                    const dFather = lValue.father.__raw as DObject;\r\n                    SetFieldAction.new(lValue.__raw, 'values', dFather.features.indexOf(data.id as string), '-=', true);\r\n                }\r\n            }\r\n            const me = data.instanceof;\r\n            SetFieldAction.new(me.__raw, 'instances', me.__raw.instances.indexOf(data.id), '-=', true);\r\n            data.superDelete();\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public ecorePointer(): string { return this.cannotCall(\"ecorePointer\"); }\r\n    protected get_ecorePointer(context: Context): () => string {\r\n        let lastvisited: Pointer<DObject, 1, 1, LObject> = context.data.id;\r\n        return () => \"@//\" + this.get_fatherList(context).map( (f: LModelElement | LObject | LValue) => {\r\n            if (f.className === DObject.cname) { lastvisited = (f as LObject).id; return ''; }\r\n            if (f.className === DModel.cname) { return ''; }\r\n            console.log(\"get_ecorepointer\", f, f.__raw, lastvisited);\r\n            return (f as LValue).name + \".\" + ((f as LValue).__raw.values.indexOf(lastvisited));\r\n        }).filter(v=>!!v).join(\"@/\");\r\n    }\r\n\r\n}\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DObject);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LObject);\r\n@RuntimeAccessible\r\nexport class DValue extends DModelElement { // extends DModelElement, m1 value (attribute | reference)\r\n    public static cname: string = \"DValue\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LValue;\r\n    // static logic: typeof LModelElement;\r\n    // static structure: typeof DValue;\r\n\r\n    // inherit redefine\r\n    id!: Pointer<DValue, 1, 1, LValue>;\r\n    parent: Pointer<DObject, 0, 'N', LObject> = [];\r\n    father!: Pointer<DObject, 1, 1, LObject>;\r\n    annotations: Pointer<DAnnotation, 0, 'N', LAnnotation> = [];\r\n    name?: string; // nome opzionale solo per modelli schema-less\r\n\r\n    // personal\r\n    // value: PrimitiveType | Pointer<DObject, 1, 1, LObject>; // vv4\r\n    // values: PrimitiveType[] | Pointer<DObject, 1, 'N', LObject> | Pointer<DEnumLiteral, 1, 'N', LEnumLiteral> = []; // vv4\r\n    values: PrimitiveType[] | Pointer<DObject|DEnumLiteral, 1, 'N', LObject|LEnumLiteral> = [];\r\n    instanceof!: Pointer<DAttribute, 1, 1, LAttribute > | Pointer<DReference, 1, 1, LReference> | undefined; // todo: maybe min lowerbound 0 if you want to allow free shape objects chiedere prof\r\n    edges!: Pointer<DEdge, 0, 'N', LEdge>;\r\n    // conformsTo!: Pointer<DStructuralFeature, 0, 'N', LStructuralFeature>; // low priority to do: attributo fittizio controlla a quali elementi m2 è conforme quando viene richiesto\r\n    isMirage!: boolean;\r\n    // IoT Section\r\n    topic: string = '';\r\n\r\n    public static new(name?: DNamedElement[\"name\"], instanceoff?: DValue[\"instanceof\"], val?: DValue[\"values\"],\r\n                      father?: DValue[\"father\"] | DObject, persist: boolean = true, isMirage: boolean = false): DValue {\r\n        if (!name) name = this.defaultname(\"property_\", father);\r\n        return new Constructors(new DValue('dwc'), (typeof father === \"string\" ? father : (father as DObject)?.id), persist, undefined).DPointerTargetable().DModelElement()\r\n            .DNamedElement(name)\r\n            .DValue(instanceoff, val, isMirage).end();\r\n    }\r\n}\r\n@RuntimeAccessible\r\nexport class LValue<Context extends LogicContext<DValue> = any, C extends Context = Context, D extends DValue = DValue> extends LModelElement { // extends DModelElement, m1 value (attribute | reference)\r\n    public static cname: string = \"LValue\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    public __raw!: DValue;\r\n    id!: Pointer<DValue, 1, 1, LValue>;\r\n\r\n    // inherit redefine\r\n    parent!: (LObject | LModel)[];\r\n    father!: LObject | LModel;\r\n    model!: LModel;\r\n    // from namedelement\r\n    name!: string;\r\n    namespace!: string;\r\n    fullname!:string;\r\n    type!: LClassifier; // Classifiers describing PrimitiveTypes or the classes that can be pointed.\r\n    primitiveType!: LClass;\r\n    classType!: LClass;\r\n    enumType!: LEnumerator;\r\n// from structuralfeature (ref + attr)\r\n    ordered!: boolean;\r\n    unique!: boolean;\r\n    lowerBound!: number;\r\n    upperBound!: number;\r\n    many!: boolean;\r\n    required!: boolean;\r\n\r\n    changeable!: boolean;\r\n    volatile!: boolean;\r\n    transient!: boolean;\r\n    unsettable!: boolean;\r\n    derived!: boolean;\r\n    defaultValue!: DStructuralFeature[\"defaultValue\"];\r\n    // defaultValueLiteral!: string;\r\n// from reference\r\n    containment!: boolean;\r\n    container!: boolean;\r\n    // resolveProxies!: boolean;\r\n    opposite?: LValue; // if DRef have opposite DRef, when you set a value ref you also set a opposite value ref from target to this src. they are always mirroring.\r\n    // target!: LClass[]; is value[]\r\n    edges!: LEdge[];\r\n    // IoT Section\r\n    topic!: string;\r\n\r\n\r\n    // personal\r\n    value!: PrimitiveType | LObject | LEnumLiteral;\r\n    isMirage!: boolean;\r\n    // value!: PrimitiveType | LObject;\r\n    values!: PrimitiveType[] | LObject[] | LEnumLiteral[];\r\n    instanceof!: LAttribute | LReference | undefined;\r\n    conformsTo!:( LAttribute | LReference)[]; // low priority to do: attributo fittizio controlla a quali elementi m2 è conforme quando viene richiesto\r\n\r\n    protected get_edges(context: Context): this[\"edges\"] { return LPointerTargetable.fromPointer(context.data.edges) || []; }\r\n    protected get_fromlfeature<C, T extends keyof (NonNullable<C>)>(meta: C, key: T): NonNullable<C>[T] { return meta ? (meta as any)[key] : undefined; }\r\n    protected get_opposite(context: Context): LReference[\"opposite\"] { return this.get_fromlfeature(context.proxyObject.instanceof as LReference, \"opposite\"); }\r\n    protected get_container(context: Context): LReference[\"container\"] { return this.get_fromlfeature(context.proxyObject.instanceof as LReference, \"container\"); }\r\n    protected get_containment(context: Context): LReference[\"containment\"] {\r\n        let iof = context.proxyObject.instanceof;\r\n        if (!iof) return true; // shapeless\r\n        return this.get_fromlfeature(iof as LReference, \"containment\"); }\r\n    // protected get_defaultValueLiteral(context: Context): LStructuralFeature[\"defaultValueLiteral\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"defaultValueLiteral\"); }\r\n    protected get_defaultValue(context: Context): LStructuralFeature[\"defaultValue\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"defaultValue\"); }\r\n    protected get_defaultderived(context: Context): LStructuralFeature[\"derived\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"derived\"); }\r\n    protected get_defaultunsettable(context: Context): LStructuralFeature[\"unsettable\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"unsettable\"); }\r\n    protected get_defaulttransient(context: Context): LStructuralFeature[\"transient\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"transient\"); }\r\n    protected get_volatile(context: Context): LStructuralFeature[\"volatile\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"volatile\"); }\r\n    protected get_changeable(context: Context): LStructuralFeature[\"changeable\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"changeable\"); }\r\n    protected get_required(context: Context): LStructuralFeature[\"required\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"required\"); }\r\n    protected get_unique(context: Context): LStructuralFeature[\"unique\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"unique\"); }\r\n    protected get_many(context: Context): LStructuralFeature[\"many\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"many\"); }\r\n    protected get_upperBound(context: Context): LStructuralFeature[\"upperBound\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"upperBound\"); }\r\n    protected get_lowerBound(context: Context): LStructuralFeature[\"lowerBound\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"lowerBound\"); }\r\n    protected get_ordered(context: Context): LStructuralFeature[\"ordered\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"ordered\"); }\r\n    protected get_enumType(context: Context): LStructuralFeature[\"enumType\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"enumType\"); }\r\n    protected get_classType(context: Context): LStructuralFeature[\"classType\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"classType\"); }\r\n    protected get_primitiveType(context: Context): LStructuralFeature[\"primitiveType\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"primitiveType\"); }\r\n    protected get_type(context: Context): LStructuralFeature[\"type\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"type\"); }\r\n    protected get_fullname(context: Context): LStructuralFeature[\"fullname\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"fullname\"); }\r\n    protected get_namespace(context: Context): LStructuralFeature[\"namespace\"] { return this.get_fromlfeature(context.proxyObject.instanceof, \"namespace\"); }\r\n    protected get_name(context: Context): LStructuralFeature[\"name\"] { return context.data.instanceof ? this.get_fromlfeature(context.proxyObject.instanceof, \"name\") : context.data.name || ''; }\r\n\r\n    protected get_instanceof(context: Context): this[\"instanceof\"] {\r\n        const pointer = context.data.instanceof;\r\n        if (!pointer) return undefined;\r\n        return LPointerTargetable.from(pointer)\r\n    }\r\n    protected set_instanceof(val: Pack1<this[\"instanceof\"]>, context: Context): boolean {\r\n        // const list = val.map((lItem) => { return Pointers.from(lItem) });\r\n        let ptr = Pointers.from(val);\r\n        SetFieldAction.new(context.data, 'instanceof', ptr, \"\", true);\r\n        return true;\r\n    }\r\n\r\n    protected get_isMirage(context: Context): this[\"isMirage\"] { return context.data.isMirage; }\r\n    protected set_isMirage(val: this[\"isMirage\"], context: Context): boolean { SetFieldAction.new(context.data, 'isMirage', val, \"\", false); return true; }\r\n\r\n    // individual value getters\r\n    protected get_value<T extends boolean>(context: Context, namedPointers: boolean = false, ecorePointers: boolean = false,\r\n                                           shapeless: boolean = false, keepempties: boolean = true, withmetainfo: T = false as T): T extends true ? ValueDetail : this[\"value\"]{\r\n        return this.get_values(context, true, namedPointers, ecorePointers, shapeless, keepempties, withmetainfo, 1)[0] as any;\r\n    }\r\n    public getValue<T extends boolean>(namedPointers: boolean = false, ecorePointers: boolean = false, shapeless: boolean = false, keepempties: boolean = true,\r\n                                       withmetainfo: T = false as T): T extends true ? ValueDetail : this[\"value\"]{ return this.cannotCall(\"getValue\"); }\r\n    protected get_getValue(context: Context): this[\"getValue\"] {\r\n        return function (namedPointers: boolean = false, ecorePointers: boolean = false, shapeless: boolean = false,\r\n                         keepempties: boolean = true, withmetainfo: boolean = false) {\r\n            return LValue.prototype.get_value(context, namedPointers, ecorePointers, shapeless, keepempties, withmetainfo) as any;\r\n        }\r\n    }\r\n\r\n    // multiple value getters\r\n    protected get_values<T extends boolean>(context: Context, fitSize: boolean = true, namedPointers: boolean = false, ecorePointers: boolean = false,\r\n                                            shapeless: boolean = false, keepempties: boolean = true, withmetainfo?: T, maxlimit?: number)\r\n        : (T extends undefined ? this[\"values\"] : T extends false ? this[\"values\"] : ValueDetail[]) & {type?: string}  {\r\n\r\n        let ret: any[] = [...context.data.values] as [];\r\n        let meta: LAttribute | LReference | undefined = shapeless ? undefined : context.proxyObject.instanceof;\r\n        let dmeta: undefined | DAttribute | DReference = meta?.__raw;\r\n\r\n        // if (meta && meta.className === DReference.name) ret = LPointerTargetable.fromArr(ret as DObject[]);\r\n        let typestr: string = meta ? meta.typeToShortString() : \"shapeless\";\r\n        if (!Array.isArray(ret)) ret = [];\r\n        if (dmeta && fitSize && ret.length < dmeta.lowerBound && dmeta.lowerBound > 0) {\r\n            let times = dmeta.lowerBound - ret.length;\r\n            while (times-- > 0) ret.push(undefined);\r\n            // ret.length = meta.lowerBound; not really working for expanding, it says \"emptyx10\" or so. doing .map() only iterates \"existing\" elements. behaves like as it's smaller.\r\n        }\r\n        if (maxlimit !== undefined) ret.length = maxlimit;\r\n        else if (dmeta && fitSize && ret.length > dmeta.upperBound && dmeta.upperBound >= 0) ret.length = dmeta.upperBound;\r\n\r\n        // console.log(\"get_values sizefixed\", {fitSize, arguments, upperbound:dmeta?.upperBound, lowerbound: dmeta?.lowerBound, len: ret.length, len0: context.data.values.length});\r\n        let numbermax = 0, numbermin = 0, round = true;\r\n        // ret is always an array of raw values before this point, eventually padded with lowerbound or trimmed at upperbound\r\n\r\n        let index = 0;\r\n        if (withmetainfo) { ret = ret.map(r => {return {value:r, rawValue: r, index: index++, hidden: false} as ValueDetail}); }\r\n        let mapperfunc: (a:any)=>any = undefined as any;\r\n        let numbercasting = (v: any): number => {\r\n            if (typeof v !== \"number\") {\r\n                if (!v) v = 0;\r\n                else if (v === \"true\") v = 1;\r\n                else if (v.constructor?.name=== \"Date\") v = v.getTime();\r\n                else if (typeof v === \"string\") {\r\n                    console.log(\"number casting:\", v,  U.getFirstNumber(v+'', true), {numbermax, numbermin});\r\n                    v = U.getFirstNumber(v+'', !round);\r\n                } else return NaN;\r\n            }\r\n            v = Math.min(numbermax, Math.max(numbermin, v));\r\n            return round ? Math.round(v) : v;\r\n        };\r\n        switch (typestr) {\r\n            case \"shapeless\":\r\n                let state: DState = store.getState();\r\n                mapperfunc = (val: any) => {\r\n                    if (!val || typeof val !== \"string\") return val;\r\n                    let l: any = LPointerTargetable.fromPointer(val, state);\r\n                    if (!l) return val;\r\n                    if (l.className === DEnumLiteral.cname) { l = (l as DEnumLiteral).literal; } else\r\n                    if (namedPointers) { l = (l.name ? (\"@\" + l.name) : (l as GObject)[\"@\"+l.name]?.__raw?.values?.[0] || (\"#\" + l.className));}\r\n                    else if (ecorePointers){ l = l.ecorePointer(); }\r\n                    return l;\r\n                };\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail) => { struct.value = mapperfunc(struct.value); });\r\n                else ret = ret.map(mapperfunc);\r\n                break;\r\n            default: // it's a reference or enum\r\n                mapperfunc = (r:any) => r && LPointerTargetable.wrap(r);\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail) => { struct.value = mapperfunc(struct.value); });\r\n                else ret = ret.map(mapperfunc);\r\n\r\n                // now ret is pointed DEnumLiteral or DObject or MetaInfoStructure<>\r\n                if ((meta as LAttribute)?.type?.className === DEnumerator.cname) {\r\n                    // replace numeric literals, mapped to literal ordinal. can happen with type switches\r\n                    if (true) {\r\n                        mapperfunc = (lit: LEnumLiteral|number) => {\r\n                            numbermax = Number.POSITIVE_INFINITY;\r\n                            numbermin = 0;\r\n                            let ordinal = numbercasting(lit);\r\n                            return isNaN(ordinal) ? lit : (meta!.type as LEnumerator).ordinals[ordinal];\r\n                        }\r\n                        if (withmetainfo) ret.forEach((struct: ValueDetail) => { struct.value = mapperfunc(struct.value); });\r\n                        else ret = ret.map(mapperfunc);\r\n                    }\r\n                    let filterfunc = (l: LEnumLiteral) => { if (!l) return keepempties; return l.father?.id === (meta as LAttribute).type.id; };\r\n                    if (withmetainfo) for(let struct of ret as ValueDetail[]) { struct.hidden = !filterfunc(struct.value as LEnumLiteral); } // && 'literal target is not of the correct type requested by metamodel'; }\r\n                    else ret = ret.filter(filterfunc);\r\n                    // todo: questo comportamento implica che quando importo un literal come testo da .ecore, devo assegnargli\r\n                    //  il puntatore al suo literal se trovato, altrimenti resta val[i] di tipo string/shapeless\r\n\r\n                    if (namedPointers) {\r\n                        mapperfunc = (lit?: LEnumLiteral) => lit?.name;\r\n                        if (withmetainfo) ret.forEach((struct: ValueDetail) => { struct.value = mapperfunc(struct.value); });\r\n                        else ret = ret.map(mapperfunc);\r\n                    }\r\n                    break;\r\n                }\r\n                // is reference with assigned shape (and type) -> filter correct typed targets\r\n                if (meta) {\r\n                    let filterfunc = (l: LObject) => {\r\n                        // hide values with a value that is not a pointer to correct type (but keep empties if requested)\r\n                        //let isExtending = l.instanceof?.isExtending((meta as LReference).type); // damiano: todo test & debug isextending\r\n                        let isExtending = true;\r\n                        return keepempties && !l ? true : isExtending;\r\n                    };\r\n                    if (withmetainfo) for(let struct of ret as ValueDetail[]) { struct.hidden = !filterfunc(struct.value as LObject); } // && \"ref target is not of correct type\"; }\r\n                    else ret = ret.filter(filterfunc);\r\n                }\r\n                // shaped (with m2-reference) but pointing to a shapeless object. can happen\r\n                if (namedPointers) {\r\n                    let mapperfunc = (l:LObject) => l && (l.name ? (\"@\" + l.name) : (l as GObject)[\"@\"+l.name]?.__raw?.values?.[0] || (\"#\" + l.className));\r\n                    if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = mapperfunc(struct.value as LObject); });\r\n                    else ret = ret.map(mapperfunc);\r\n                }\r\n                else if (ecorePointers && !(meta as LReference).containment){\r\n                    mapperfunc = (lval: LObject) => lval && lval.ecorePointer();\r\n                    if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = mapperfunc(struct.value as LObject); });\r\n                    else ret = ret.map(mapperfunc);\r\n                    // throw new Error(\"values as EcorePointers: todo. for containment do nothing, just nest the obj. for non-containment put the ecore reference string in array vals\")\r\n                }\r\n                break;\r\n            case ShortAttribETypes.EByte:\r\n                numbermin = -128;\r\n                numbermax = 127;\r\n                break;\r\n            case ShortAttribETypes.EShort:\r\n                numbermin = -32768;\r\n                numbermax = 32767;\r\n                break;\r\n            case ShortAttribETypes.EInt:\r\n                numbermin = -2147483648;\r\n                numbermax = 2147483647;\r\n                break\r\n            case ShortAttribETypes.ELong:\r\n                numbermin = -9223372036854775808;\r\n                numbermax = 9223372036854775807;\r\n                break;\r\n            case ShortAttribETypes.EFloat:\r\n            case ShortAttribETypes.EDouble:\r\n                numbermin = Number.NEGATIVE_INFINITY;\r\n                numbermax = Number.POSITIVE_INFINITY;\r\n                round = false;\r\n                break;\r\n            case ShortAttribETypes.EString:\r\n            case ShortAttribETypes.EDate:\r\n                mapperfunc = v => v ? v + '' : ''\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = mapperfunc(struct.value); });\r\n                else ret = ret.map(mapperfunc);\r\n                break;\r\n            case ShortAttribETypes.EChar:\r\n                mapperfunc = v => v ? (v + '')[0] : 'A';\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = mapperfunc(struct.value); });\r\n                else ret = ret.map(mapperfunc);\r\n                break;\r\n            case ShortAttribETypes.EBoolean:\r\n                mapperfunc = v => typeof v === \"boolean\" ? v : U.fromBoolString(v+'', v?.length>0, false);\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = mapperfunc(struct.value); });\r\n                else ret = ret.map(mapperfunc);\r\n                break;\r\n            case ShortAttribETypes.void:\r\n                if (withmetainfo) ret.forEach((struct: ValueDetail)=>struct.hidden = true);\r\n                else ret = [];\r\n                break;\r\n        }\r\n        // some kind of numeric type\r\n        if (numbermax !== 0) {\r\n            if (withmetainfo) ret.forEach((struct: ValueDetail)=>{ struct.value = numbercasting(struct.value); });\r\n            else ret = ret.map(numbercasting);\r\n        }\r\n        (ret as GObject).type = typestr;\r\n        // console.error(\"type value:\", {ret, typestr, meta, fitSize});\r\n        return ret as any;\r\n    }\r\n\r\n    public getValues<T extends boolean>(fitSize: boolean = true, namedPointers: boolean = false, ecorePointers: boolean = false, shapeless: boolean = false,\r\n                                        keepempties: boolean = true, withmetainfo?: T, maxlimit?: number)\r\n        : (T extends undefined ? this[\"values\"] : T extends false ? this[\"values\"] : ValueDetail[]) & {type?: string} {\r\n        return this.cannotCall(\"getValues\"); }\r\n    protected get_getValues(context: Context): this[\"getValues\"] {\r\n        return function (fitSize: boolean = true, namedPointers: boolean = true, ecorePointers: boolean = false,\r\n                         shapeless: boolean = false, keepempties: boolean = false, withmetainfo: any = false, limit?: number) {\r\n            return LValue.prototype.get_values(context, fitSize, namedPointers, ecorePointers, shapeless, keepempties, withmetainfo, limit) as any;\r\n        }\r\n    }\r\n    // stringified value getters\r\n    public valuestring(keepemptyquotes?: boolean): string { return this.cannotCall(\"valuestring\"); }\r\n    private get_valuestring(context: Context): this[\"valuestring\"] { return (keepemptyquotes?: boolean) => this.valuestring_impl(context, keepemptyquotes); }\r\n    private valuestring_impl(context: Context, keepemptyquotes?: boolean): string {\r\n        // console.error(\"valuestring_impl\", {context, data:context.data});\r\n        let val = this.get_values(context, true, true, false, false, true);\r\n        // console.log(\"valuestring_impl\", {val});\r\n        let ret: any;\r\n        switch (val.length) {\r\n            case 0: ret = ''; break;\r\n            case 1: ret = val[0]; break;\r\n            default:\r\n                let havestrings: boolean = val.type === ShortAttribETypes.EString;\r\n                let havechars: boolean = val.type === ShortAttribETypes.EChar;\r\n                let havepointers: boolean = false;\r\n                let haveLelements: boolean = false;\r\n                for (let vall of [val[0]]) {\r\n                    if ((vall as any)?.__isProxy) haveLelements = true;\r\n                    /*else if (typeof vall === \"string\") { havestrings = true; havepointers = havepointers || vall.includes(\"Pointer\"); }}\r\n                     */\r\n                }\r\n                /*if (havepointers) {\r\n                    val = LPointerTargetable.wrapAll(val);\r\n                    haveLelements = true;\r\n                }*//*\r\n                if (haveLelements) {\r\n                    val = val.map( l => l && (l.name ? (\"@\" + l.name) : (\"#\" + l.className)));\r\n                }*/\r\n                if (havestrings || havechars) {\r\n                    let valstr = JSON.stringify(val);\r\n                    if (!keepemptyquotes) valstr = U.replaceAll(valstr, \"\\\"\\\"\", \"\");\r\n                    ret = valstr.substring(1, valstr.length-1);\r\n                    break;\r\n                }\r\n                else ret = val.join(', ');\r\n        }\r\n        // console.error(\"valuestring_impl()\", {ret, context, data:context.data});\r\n        return (ret === undefined || ret === null ? '' : ret) + '';\r\n    }\r\n\r\n    public setValueAtPosition(index: number, val: this[\"values\"][0], info?: Partial<SetValueAtPoisitionInfoType>): {success: boolean, reason?: string} {\r\n        return this.cannotCall(\"setValueAtPosition\"); }\r\n\r\n    // only use through setValueAtPosition\r\n    protected _clearValueAtPosition(context: Context, index: number, info0?: Partial<SetValueAtPoisitionInfoType>, skipSettingUndefined: boolean = false) {\r\n        let info = (info0 || {}) as any as SetValueAtPoisitionInfoType;\r\n        let oldVal = context.data.values[index];\r\n        let oldTarget: LObject | undefined = typeof oldVal === \"string\" ? LObject.fromPointer(oldVal) : undefined;\r\n        /////////////////////// if oldTarget is LObject, update his pointedBy\r\n        // if (oldTarget) SetFieldAction.new(oldTarget, \"pointedBy\" '-=\", ... no need? reducer should do this)\r\n\r\n        /////////////////////// if ref is containment assign oldTarget father to DModel\r\n\r\n        if (info.isContainment === undefined) {\r\n            if (info.instanceof === undefined) info.instanceof = context.proxyObject.instanceof;\r\n            info.isContainment = !info.instanceof || (info.instanceof as LReference).containment;\r\n        }\r\n        if (info.isContainment && oldTarget?.className === \"DObject\") {\r\n            SetFieldAction.new(oldVal as Pointer<DObject>, \"father\", context.proxyObject.model.id, undefined, true);\r\n        }\r\n        if (!skipSettingUndefined) SetFieldAction.new(context.data, 'values.' + index as any, undefined, '', info.isPtr);\r\n    }\r\n    protected get_setValueAtPosition(context: Context): ((index: number, val: this[\"values\"][0], info?: Partial<SetValueAtPoisitionInfoType>) => {success: boolean, reason?: string}) {\r\n        return (index: number, val: this[\"values\"][0] | any, info0?: Partial<SetValueAtPoisitionInfoType>): { success: boolean, reason?: string } => {\r\n            let isPtr: boolean = undefined as any;\r\n            let lval: LObject | LEnumLiteral = undefined as any;\r\n            if (val === null) val = undefined;\r\n            if (context.data.values[index] === val) return { success: false, reason: \"identical assignment\" };\r\n            if ((val as any)?.id && (val as any)?.className) {\r\n                lval = (val.__isProxy ? val : LPointerTargetable.wrap<DObject>(val));\r\n                isPtr = !!lval;\r\n                val = (val as any).id;\r\n            }\r\n            let info = (info0 || {}) as any as SetValueAtPoisitionInfoType;\r\n            if (isPtr === undefined) isPtr = (info.isPtr === undefined ? Pointers.isPointer(val) : info.isPtr);\r\n\r\n            // set sideeffect part\r\n            if ((val !== undefined)) {\r\n                if (isPtr) {\r\n                    if (info.type === undefined) info.type = context.proxyObject.type;\r\n                    if (info.instanceof === undefined) info.instanceof = context.proxyObject.instanceof;\r\n                    if (info.isContainment === undefined) {\r\n                        info.isContainment = !info.instanceof || (info.instanceof.className === DReference.cname && (info.instanceof as LReference).containment);\r\n                    }\r\n                    lval = LPointerTargetable.fromPointer(val);\r\n                    if (!lval) return {success: false, reason: \"invalid pointer: \" + lval};\r\n                    // is enum\r\n                    if (lval.className === DEnumLiteral.cname) {\r\n                        let lvale: LEnumLiteral = lval as LEnumLiteral;\r\n                        if (info.instanceof && info.type && (lvale.father.id !== info.type.id)) return {success: false, reason: \"target is not of correct literal type\"};\r\n                        // no need to do checks / other sideeffects other than pointedBy i think.\r\n                    }\r\n                    // is ref\r\n                    if (lval.className === DObject.cname){\r\n                        let lvalo = lval as LObject;\r\n                        let lvalmeta: LClassifier | undefined = lvalo.instanceof;\r\n                        // if (info.instanceof && info.type && (!(lvalmeta as LClass)?.isExtending(info.type))) return {success: false, reason: \"target is not of correct type\"}; damiano todo: enable and implement isExtending\r\n                        if (info.fatherList === undefined) info.fatherList = context.proxyObject.fatherList;\r\n                        if (info.isContainment) {\r\n                            if ((info.fatherList as LPointerTargetable[]).map(father => father.id).includes(val))\r\n                                return {success: false, reason: \"cannot create a containment loop\"}; // todo: in LReference.set_containment need to forbid setting to true if there is a loop\r\n                            let oldContainer: LValue | LModel = lvalo.father;\r\n                            let oldContainerValue: LValue = (oldContainer.className === DModel.cname) ? undefined as any : (oldContainer as LValue);\r\n                            // detach contaied object from old parent\r\n                            if (oldContainerValue) {\r\n                                let valarr: any[] = oldContainerValue.__raw.values;\r\n                                for (let i = 0; i < valarr.length; i++) {\r\n                                    let v = valarr[i];\r\n                                    if (v === val) oldContainerValue.setValueAtPosition(i, undefined as any, undefined);\r\n                                }\r\n                            }\r\n                            SetFieldAction.new(val as Pointer<DObject>, \"father\", context.data.id, undefined, true);\r\n                        }\r\n                    }\r\n                    // automatic? SetFieldAction.new(val as Pointer<DObject>, \"pointedBy\", PointedBy.fromID(context.data.id, \"values.\" + index as any), \"+=\");\r\n                } else {\r\n                    // loose checks, i can assign any primitive to any primitive (will cast on get)\r\n                    if (info.instanceof === undefined) info.instanceof = context.proxyObject.instanceof;\r\n                    let metatype: string = (info.instanceof as LAttribute)?.typeToShortString() || \"shapeless\";\r\n                    if (typeof val === \"object\") {\r\n                        if (val.constructor === Date && (metatype !== \"EString\" && metatype !== \"EDate\" && metatype !== \"shapeless\"))\r\n                            return {\r\n                                success: false,\r\n                                reason: \"dates can only be assigned to values of type string or Date\"\r\n                            };\r\n                        // return {success: false, reason: \"objects are not assignable except for dates\"}; maybe i allow this instead\r\n                    }\r\n                }\r\n            }\r\n\r\n            // clear sideeffect part\r\n            this._clearValueAtPosition(context, index, info, true);\r\n\r\n            // actual set\r\n            SetFieldAction.new(context.data, 'values.' + index as any, val, '', isPtr);\r\n            if (info.setMirage !== false) SetFieldAction.new(context.data, 'isMirage', false, '', false);\r\n\r\n            // assegnato a giordano todo: wrap this and set toaster with failure message if it fails or better launch Log.w and bind toasts of different colors to Log funcs\r\n            return {success: true};\r\n        }\r\n    }\r\n    protected set_values(val: orArr<D[\"values\"]>, context: Context): boolean {\r\n        const list: D[\"values\"] = ((Array.isArray(val)) ? val : [val]) as D[\"values\"];\r\n        let modified = false;\r\n        for (let i = 0; i < list.length; i++) {\r\n            modified = modified || this.get_setValueAtPosition(context)(i, list[i], {setMirage: false} as any).success;\r\n        }\r\n        if (modified) context.data.isMirage && SetFieldAction.new(context.data, 'isMirage', false, '', false);\r\n        return true;\r\n\r\n        // old implementation\r\n        let l = context.proxyObject;\r\n        let instanceoff: LReference | LAttribute | undefined = l.instanceof;\r\n        let isRef: boolean | undefined = (!instanceoff ? undefined : instanceoff?.className === DReference.cname);\r\n        SetFieldAction.new(context.data, 'values', list as any, '', false);\r\n        // console.log(\"pre set_values actions\", l, list, val, context);\r\n\r\n        if (!l.instanceof || isRef && (instanceoff as LReference).containment) {\r\n            let i = 0;\r\n\r\n            for (let v0 of list) {\r\n                // console.log(\"loop set_value actions\", v, context.data, isRef, instanceoff, Pointers.isPointer(v));\r\n                i++;\r\n                if ((isRef || instanceoff === undefined) && Pointers.isPointer(v0)) { // if shapeless obj need to check val by val\r\n                    let v = v0 as Pointer<DModelElement> //Pointer<DObject> | Pointer<DEnumLiteral>;\r\n                    // console.log(\"loop set_value actions SET\", {v, data:context.data, isRef, instanceoff, isPtr:Pointers.isPointer(v)});\r\n                    let lval: LObject = LPointerTargetable.fromPointer(v);\r\n                    let oldContainer: LValue | LModel = lval.father;\r\n                    SetFieldAction.new(v, \"pointedBy\", PointedBy.fromID(context.data.id, \"values.\" + i as any), \"+=\");\r\n                    SetFieldAction.new(v, \"father\", context.data.id, undefined, true);\r\n                    if (oldContainer.className === DModel.cname) continue;\r\n                    let containerValue = (oldContainer as LValue);\r\n                    // let oldContainerValues = [...containerValue.__raw.value]; U.arrayRemoveAll(oldContainerValues, v);\r\n                    let oldContainerValues: Pointer[] = containerValue.__raw.values.map( va => va===v ? undefined as any : va);\r\n                    SetFieldAction.new(containerValue.id, \"values\", oldContainerValues, \"\", true);\r\n\r\n                    // todo: verify if works: remove val from old container\r\n                    let oldv = context.data.values[i];\r\n                    // if (Pointers.isPointer(oldv)) SetFieldAction.new(context.data.id, \"contains\", U.arrayRemoveAll([...context.data.contains], oldv), '', true);\r\n                    // SetFieldAction.new(context.data.id, \"contains\", oldv as DObject[\"id\"], undefined, true);\r\n\r\n                }\r\n            }\r\n        }\r\n        context.data.isMirage && SetFieldAction.new(context.data, 'isMirage', false, '', false);\r\n        return true;\r\n    }\r\n\r\n    protected set_value(val: D[\"values\"][0], context: Context): boolean {\r\n        let v: ValueDetail = this.get_value(context, false, false, false, true, true);\r\n        let r = this.setValueAtPosition(v?.index || 0, val);\r\n        Log.e(!r.success,  r.reason);\r\n        return r.success;\r\n    }\r\n\r\n    protected generateEcoreJson_impl(context: Context, loopDetectionObj: Dictionary<Pointer, DModelElement> = {}): Json {\r\n        loopDetectionObj[context.data.id] = context.data;\r\n        let values = this.get_values(context, true, false, true, false, false);\r\n        delete values[\"type\"];\r\n        let ret: any = [];\r\n        the_loop: for (let v of values){\r\n            let l: LObject | LEnumLiteral = v as any;\r\n            if (!l?.__isProxy) { ret.push(l); continue; }\r\n            switch (l.className){\r\n                case \"DOperation\": continue the_loop;\r\n                case \"DEnumLiteral\": ret.push((l as LEnumLiteral).generateEcoreJsonM1()); break;\r\n                default: ret.push(l.generateEcoreJson(loopDetectionObj)); break;\r\n            }\r\n        }\r\n        // ret = ret.filter((j: any) => (j !== undefined || j !== ''));\r\n        return (ret.length <= 1) ? ret[0] : ret; }\r\n\r\n    protected get_toString(context: Context): () => string { return () => this._toString(context); }\r\n    protected _toString(context: Context): string {\r\n        let val: any = this.get_values(context, true, true, false, false, true);\r\n        if (!val) return val + '';\r\n        if (!Array.isArray(val)) val = [val];\r\n        // if (!context.proxyObject.instanceof) val = val.map( (e: GObject) => { return  e.name ? \"@\" + e.name : e; });\r\n        // else if (context.proxyObject.instanceof?.className === DReference.name) val = val.map( (e: GObject) => { return e.name ? \"@\" + e.name : e; });\r\n        switch(val.length) {\r\n            case 0: return '';\r\n            case 1: return val[0] + '';\r\n            default: return val + '';\r\n        }\r\n    }\r\n\r\n    public rawValues(): void { super.cannotCall('rawValues'); }\r\n    public get_rawValues(context: Context): this[\"values\"]{\r\n        return (this.get_getValues(context))(false, false, false, true, true, false, undefined);\r\n    }\r\n    protected get_delete(context: Context): () => void {\r\n        const data = context.proxyObject;\r\n        const ret = () => {\r\n            const me = data.instanceof;\r\n            me && SetFieldAction.new(me.__raw, 'instances', me.__raw.instances.indexOf(data.id), '-=', true);\r\n            data.superDelete();\r\n            // super.get_delete(context);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    protected get_topic(context: Context): this[\"topic\"] {\r\n        return context.data.topic;\r\n    }\r\n    protected set_topic(val: string, context: Context): boolean {\r\n        SetFieldAction.new(context.data, 'topic', val, '', false);\r\n        return true;\r\n    }\r\n}\r\nRuntimeAccessibleClass.set_extend(DNamedElement, DValue);\r\nRuntimeAccessibleClass.set_extend(LNamedElement, LValue);\r\nexport type ValueDetail = {\r\n    value: LValue[\"value\"];\r\n    rawValue: DValue[\"values\"][0]; // PrimitiveType | Pointer<DObject> | Pointer<DEnumLiteral>\r\n    index: number;\r\n    hidden: boolean;\r\n};\r\nexport type SetValueAtPoisitionInfoType = {setMirage: boolean, isPtr: boolean, type: LValue[\"type\"], instanceof: LValue[\"instanceof\"], isContainment: boolean, fatherList: LValue[\"fatherList\"]};\r\n\r\n\r\nexport type WModelElement = getWParams<LModelElement, DModelElement>;\r\nexport type WModel = getWParams<LModel, DModel>;\r\nexport type WValue = getWParams<LValue, DValue>;\r\nexport type WNamedElement = getWParams<LNamedElement, DNamedElement>;\r\nexport type WObject = getWParams<LObject, DObject>;\r\nexport type WEnumerator = getWParams<LEnumerator, DEnumerator>;\r\nexport type WEnumLiteral = getWParams<LEnumLiteral, DEnumLiteral>;\r\nexport type WAttribute = getWParams<LAttribute, DAttribute>;\r\nexport type WReference = getWParams<LReference, DReference>;\r\nexport type WStructuralFeature = getWParams<LStructuralFeature, DStructuralFeature>;\r\nexport type WClassifier = getWParams<LClassifier, DClassifier>;\r\nexport type WDataType = getWParams<LDataType, DDataType>;\r\nexport type WClass = getWParams<LClass, DClass>;\r\nexport type WParameter = getWParams<LParameter, DParameter>;\r\nexport type WOperation = getWParams<LOperation, DOperation>;\r\nexport type WPackage = getWParams<LPackage, DPackage>;\r\nexport type WTypedElement = getWParams<LTypedElement, DTypedElement>;\r\nexport type WAnnotation = getWParams<LAnnotation, DAnnotation>;\r\n// export type WJavaObject = getWParams<LJavaObject, DJavaObject>;\r\nexport type WMap = getWParams<LMap, DMap>;\r\nexport type WFactory_useless_ = getWParams<LFactory_useless_, DFactory_useless_>;\r\n\r\n\r\n/*\r\nlet alld: GObject = {\r\n    DModelElement,\r\n    DModel,\r\n    DValue,\r\n    DNamedElement,\r\n    DObject,\r\n    DEnumerator,\r\n    DEnumLiteral,\r\n    DAttribute,\r\n    DReference,\r\n    DStructuralFeature,\r\n    DClassifier,\r\n    DDataType,\r\n    DClass,\r\n    DParameter,\r\n    DOperation,\r\n    DPackage,\r\n    DTypedElement,\r\n    DAnnotation,\r\n    DFactory_useless_, DMap};\r\nlet alll: GObject = {\r\n    LModelElement,\r\n    LModel,\r\n    LValue,\r\n    LNamedElement,\r\n    LObject,\r\n    LEnumerator,\r\n    LEnumLiteral,\r\n    LAttribute,\r\n    LReference,\r\n    LStructuralFeature,\r\n    LClassifier,\r\n    LDataType,\r\n    LClass,\r\n    LParameter,\r\n    LOperation,\r\n    LPackage,\r\n    LTypedElement,\r\n    LAnnotation,\r\n    LFactory_useless_, LMap};\r\n*/\r\n","import {\r\n    Dictionary,\r\n    DocString,\r\n    DPointerTargetable, DUser,\r\n    DState, Json,\r\n    Log,\r\n    LPointerTargetable,\r\n    orArr,\r\n    Pack1,\r\n    Pointer,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    store,\r\n    U,\r\n    unArr,\r\n    windoww\r\n} from \"../../joiner\";\r\n\r\n// transactional-like start of storage modification\r\n// todo: nested transaction che conti quanti begin hai effettuato e crei una matrice di pendingActions una per ogni livello nested?\r\n\r\n/*\r\n// let nestedlevel: number = 0;\r\nclass NestedLevel{\r\n    level: number;\r\n    actions: Action[] = [];\r\n    up:NestedLevel[] = [];\r\n    down?:NestedLevel;\r\n\r\n    constructor(prevLevel?: NestedLevel, actions: Action[] = []) {\r\n        // this.prev = prev;\r\n        this.down = prevLevel;\r\n        this.actions = actions;\r\n        this.level = prevLevel ? prevLevel.level + 1 : 0;\r\n    }\r\n\r\n    add1(a:Action){ this.actions.push(a); }\r\n    add(a:Action[]){ this.actions.push(...a); }\r\n    push(actions:Action[]=[]){\r\n        this.up.push(new NestedLevel(this, actions));\r\n    }\r\n}\r\n// @Singleton\r\nclass NestedTransactionManager{\r\n    // private levels: NestedLevel[] = [];\r\n    public currentLevel?: NestedLevel;\r\n    // simple array is not good i can have spikes as russian mountains going up and down in deepness it's kinda a matrix or a pile of dishes like below'\r\n\r\n\r\n    /*\r\n    todo: to debug missing END paired with a begin, seve stack trace of begins and ends\r\n    * every level must have his own array?\r\n    * Begin0, Begin1, Begin2, End2, End1, Begin1.1 Begin 1.2....\r\n    it's a tree!\r\n    *\r\n    *\r\n    * ______begin lv2                              _______Begin1.2\r\n    * _________________________begin lv1           ___________________Begin1.1\r\n    * ____________________________________________________________________________________________________ a begin lv0\r\n    * * /\r\n    constructor() {}\r\n    begin(actions: Action[]=[]): void { this.pushLevel(actions); }\r\n    pushLevel(actions: Action[]=[]): void {\r\n        if (!this.currentLevel) { this.currentLevel = new NestedLevel(undefined, actions); return; }\r\n        this.currentLevel.push(actions); }\r\n    end(){\r\n        if (!this.currentLevel) return this.finalEnd();\r\n        this.currentLevel = this.currentLevel?.down; }\r\n    finalEnd(){\r\n\r\n    }\r\n    // current(): NestedLevel { return this.currentLevel; }\r\n    addActions(a:Action[]): void { this.currentLevel!.add(a); }\r\n    addAction(a:Action): void { this.currentLevel!.add1(a); }\r\n}\r\nlet transactionmanager = new NestedTransactionManager();\r\nfunction BEGIN2(){\r\n    transactionmanager.pushLevel();\r\n}\r\nfunction ABORT2(){\r\n    transactionmanager.end();\r\n}\r\nfunction END2(){\r\n\r\n}*/\r\n\r\nexport function BEGIN_OLD() {\r\n    pendingActions = [];\r\n    hasBegun = true;\r\n}\r\nexport function ABORT_OLD() {\r\n    hasBegun = false;\r\n    pendingActions = [];\r\n}\r\nexport function END_OLD(actionstoPrepend: Action[] = []): boolean | DState {\r\n    hasBegun = false;\r\n    // for (let action of pendingActions) { }\r\n    const ca: CompositeAction = new CompositeAction( actionstoPrepend?.length ? [...actionstoPrepend, ...pendingActions] : pendingActions, false);\r\n    pendingActions = [];\r\n    return ca.fire();\r\n}\r\n\r\nlet pendingActions: Action[] = [];\r\nlet hasBegun = false;\r\nlet deepnessLevel = 0;\r\n\r\nexport function BEGIN() {\r\n    hasBegun = true; // redundant but actions are reading this, minimize changes\r\n    deepnessLevel++;\r\n}\r\nexport function ABORT() {\r\n    deepnessLevel--;\r\n    pendingActions = [];\r\n}\r\nexport function END(actionstoPrepend: Action[] = []): boolean {\r\n    deepnessLevel--;\r\n    if (actionstoPrepend.length) pendingActions = [...actionstoPrepend, ...pendingActions];\r\n\r\n    if (deepnessLevel < 0) { console.error(\"mismatching END()\"); deepnessLevel = 0; }\r\n    if (deepnessLevel === 0) return FINAL_END();\r\n    return false;\r\n}\r\nexport function FINAL_END(): boolean{\r\n    hasBegun = false;\r\n    const ca: CompositeAction = new CompositeAction(pendingActions, false);\r\n    pendingActions = [];\r\n    return ca.fire();\r\n}\r\n\r\n// make class isinstorage e mettici il path studia annotazioni per annotare gli oggett in modo che vengano rwappati prima di farli ritornare se sono annotati\r\n// minor todo: type as (...args: infer P) => any) ?\r\nexport function TRANSACTION<F extends ((...args: any) => any)>(func: F, ...params: Parameters<F>): boolean | DState {\r\n    BEGIN();\r\n    // minor todo: potrei fare l'override di Error() per fare in modo che gli errori vengano presi anche se non uso TRANSACTION o try-catch ?\r\n    try { func(...params); } catch(e) { Log.ee('Transaction failed:', e); ABORT(); return false; }\r\n    return END();\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class Action extends RuntimeAccessibleClass {\r\n    public static cname: string = \"Action\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static type = 'ACTION';\r\n    static SubType: {\r\n        vertexSubElements: 'vertexSubElements',\r\n        vertexSize: 'vertexSize'\r\n    };\r\n    id: Pointer;\r\n    sender: Pointer<DUser>;\r\n    token: Pointer<DUser>;\r\n    hasFired: number = 0;\r\n    // targetID: string | undefined;\r\n    // target: IClass = null as any;\r\n    consoleTargetSelector: string = '';\r\n    // field: string = ''; // es: ID_58\r\n    // value: any; // es: lowerbound, name, namespace, values (for attrib-ref)...\r\n    type: string;\r\n    public field: string;\r\n    public value: any;\r\n    // private src?: string[];\r\n    private stack?: string[];\r\n    subType?: string; //?\r\n    protected constructor(field: string, value: any, subType?: string){\r\n        super();\r\n        this.id = 'Pointer_' + Date.now();\r\n        this.sender = DUser.current;\r\n        this.token = DUser.token;\r\n        this.field = field;\r\n        this.value = value;\r\n        this.type = (this.constructor as any).type;\r\n        // this.src = new Error().stack?.split('\\n').splice( 4);\r\n        this.subType = subType;\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n\r\n    fire(forceRelaunch: boolean = false): boolean {\r\n        if (this.hasFired && !forceRelaunch) return false;\r\n        if (hasBegun) {\r\n            pendingActions.push(this);\r\n        } else {\r\n            this.hasFired++;\r\n            let storee = store || windoww.store;\r\n            console.log('firing action:', {\r\n                field: this.field,\r\n                val: this.value,\r\n                // stack:this.src,\r\n                thiss:this\r\n            });\r\n            storee.dispatch({...this});\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public static possibleInconsistencies: Dictionary<DocString<'subtype'>, Pointer[]> = {};\r\n    private static parse1(action: Action): ParsedAction {\r\n        const ret: ParsedAction = action as any;\r\n        ret.path = action.field; // normalize the path\r\n        ret.pathArray = ret.path.split('.');\r\n        ret.executionCount = 0;\r\n        if (!action.subType) return ret;\r\n        if (!Action.possibleInconsistencies[action.subType]) Action.possibleInconsistencies[action.subType] = [ action.value ];\r\n        else Action.possibleInconsistencies[action.subType].push(action.value);\r\n        return ret;\r\n    }\r\n\r\n    static parse<T extends Action | Action[], RET extends T extends any[] ? ParsedAction[] : ParsedAction>(actions: T): RET {\r\n        if ((actions as Action).className === CompositeAction.cname) throw new Error(\"Composite action cannot be parsed directly, parse composite.actions instead\");\r\n        if (!Array.isArray(actions)) return Action.parse1(actions) as RET;\r\n        return actions.map( Action.parse1 ) as RET;\r\n    }\r\n\r\n    static fromJson(json: Json): Action{\r\n        let action = new Action('dummy', 'dummy');\r\n        for(let key in json) (action as any)[key] = json[key];\r\n        return action;\r\n    }\r\n}\r\n@RuntimeAccessible\r\nexport class LoadAction extends Action {\r\n    public static cname: string = \"LoadAction\";\r\n    static type = 'LOAD';\r\n    static new(state: DState): boolean {  return state && new LoadAction(state).fire(); }\r\n    constructor(state: DState, fire: boolean = true) {\r\n        super('', state, '');\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        if (fire) this.fire();\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class SetRootFieldAction extends Action {\r\n    public static cname: string = \"SetRootFieldAction\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static type = 'SET_ROOT_FIELD';\r\n    isPointer: boolean;\r\n\r\n\r\n\r\n    static new(fullpath: string, val: string | string[], accessModifier: AccessModifier | undefined, isPointer: boolean): boolean;\r\n    static new<\r\n        VAL extends any,\r\n        PATH extends VAL extends string | string[] ? 'must specify \"isPointer\" parameter' : string,\r\n        // VAL extends (AM extends undefined | '' ? D[T] : (AM extends '-=' ? number[] : (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<D[T]> | D[T] | D[T][] : '_error_'))),\r\n        /*VAL extends (AM extends undefined | '' ? (D[T] extends any[] ? StrictExclude<D[T], string[]> : StrictExclude<D[T], string>) :\r\n            (AM extends '-=' ?\r\n                number[] :\r\n                (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<StrictExclude<D[T], string>> | StrictExclude<D[T], string> | (StrictExclude<D[T], string>)[] : '_error_'))),\r\n        */\r\n        ISPOINTER extends boolean,\r\n        AM extends AccessModifier | undefined = undefined,\r\n        // T extends arrayFieldNameTypes<D> = any\r\n        >(fullpath: PATH, val: VAL, accessModifier?: AM | undefined, isPointer?: ISPOINTER): boolean;\r\n    static new<\r\n        T extends string,\r\n        VAL extends any,\r\n        ISPOINTER extends boolean,\r\n        AM extends AccessModifier | undefined = undefined,\r\n        // T extends arrayFieldNameTypes<D> = any\r\n        >(fullpath: T, val: VAL, accessModifier: AM | undefined = undefined, isPointer?: ISPOINTER): boolean {\r\n        if (accessModifier) (fullpath as any) += accessModifier;\r\n        return new SetRootFieldAction(fullpath, val, false, isPointer).fire();\r\n    }\r\n\r\n    protected constructor(fullpath: string, value: any = undefined, fire: boolean = true, isPointer: boolean = false) {\r\n        super(fullpath, value, undefined);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        this.isPointer = isPointer;\r\n        if (fire) this.fire();\r\n    }\r\n\r\n    static create<\r\n        T extends string,\r\n        VAL extends any,\r\n        ISPOINTER extends boolean,\r\n        AM extends AccessModifier | undefined = undefined,\r\n        // T extends arrayFieldNameTypes<D> = any\r\n        >(fullpath: T, val: VAL, accessModifier: AM | undefined = undefined, isPointer?: ISPOINTER): SetRootFieldAction {\r\n        return new SetRootFieldAction(fullpath + (accessModifier || ''), val, false, isPointer);\r\n    }\r\n}\r\n\r\n\r\n// todo: ma non so come, fare in modo che [], +=, -=, siano disponibili solo se la chiave è il nome di un attributo di tipo array\r\ntype arrayFieldNameTypes<D> = keyof D | `${string & keyof D}[]` | `${string & keyof D}+=` | `${string & keyof D}-=` | `${string & keyof D}.${number}` | `${string & keyof D}[${number}]`;\r\ntype AccessModifier = '' | '[]' | '+=' | '-=' | `.${number}` | `[${number}]` | undefined;\r\n\r\n\r\ntype StrictExclude<T, U> = T extends U ? U extends T ? never : T : T;\r\n\r\n@RuntimeAccessible\r\nexport class SetFieldAction extends SetRootFieldAction {\r\n    public static cname: string = \"SetFieldAction\";\r\n    static type = 'SET_ME_FIELD';\r\n    /*\r\n        static new<\r\n            D extends DPointerTargetable,\r\n            T extends (keyof D),\r\n            AM extends AccessModifier | undefined = ''\r\n            >(me: D | Pointer<D>,\r\n              field: T,\r\n              val: string | string[],\r\n              accessModifier: AM | undefined,\r\n              isPointer: boolean): boolean;*/\r\n    static new<\r\n        D extends DPointerTargetable,\r\n        T extends (keyof D),\r\n        VAL extends\r\n            D[T] extends string | string[] ? 'must specify \"isPointer\" parameter' :\r\n                (AM extends undefined | '' ? D[T] : (AM extends '-=' ? number[] : (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<D[T]> | D[T] | D[T][] : '_error_'))),\r\n        // VAL extends (AM extends undefined | '' ? D[T] : (AM extends '-=' ? number[] : (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<D[T]> | D[T] | D[T][] : '_error_'))),\r\n        /*VAL extends (AM extends undefined | '' ? (D[T] extends any[] ? StrictExclude<D[T], string[]> : StrictExclude<D[T], string>) :\r\n            (AM extends '-=' ?\r\n                number[] :\r\n                (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<StrictExclude<D[T], string>> | StrictExclude<D[T], string> | (StrictExclude<D[T], string>)[] : '_error_'))),\r\n        */\r\n        ISPOINTER extends boolean | \"todo: ISPOINTER type = boolean but required only if val is UnArr< string > = string | string[], maybe do with override\",\r\n        AM extends AccessModifier | undefined = undefined,\r\n        // T extends arrayFieldNameTypes<D> = any\r\n        >(me: D | Pointer<D>,\r\n          field: T,\r\n          val: VAL,\r\n          accessModifier?: AM | undefined,\r\n          isPointer?: ISPOINTER): boolean;\r\n    static new<\r\n        D extends DPointerTargetable,\r\n        T extends (keyof D),\r\n        VAL extends AM extends '' | undefined ? orArr<string | null | undefined> :\r\n            (AM extends '-=' ? orArr<number> :\r\n                (AM extends '+=' ? orArr<string | null | undefined> : '_am_typeerror_')),\r\n        AM extends AccessModifier | undefined = undefined,\r\n        >(me: D | Pointer<D>, field: T,\r\n          val: VAL,\r\n          accessModifier: AM,\r\n          isPointer: boolean): boolean;\r\n\r\n    static new<\r\n        D extends DPointerTargetable,\r\n        T extends string & (keyof D),\r\n        VAL extends (AM extends undefined | '' ? D[T] : (AM extends '-=' ? number[] : (AM extends '+=' | '[]' | `[${number}]` | `.${number}` ? unArr<D[T]> | D[T] | D[T][] : '_error_'))),\r\n        ISPOINTER extends boolean | \"todo: ISPOINTER type = boolean but required only if val is UnArr< string > = string | string[], maybe do with override\",\r\n        AM extends AccessModifier | undefined = undefined,\r\n        // T extends arrayFieldNameTypes<D> = any\r\n        >(me: D | Pointer<D>, field: T, val: VAL, accessModifier: AM | undefined = undefined, isPointer?: ISPOINTER): boolean {\r\n        if (accessModifier) (field as any) += accessModifier;\r\n        return new SetFieldAction(me, field, val, false, isPointer as boolean).fire();\r\n    }\r\n\r\n\r\n    // field can end with \"+=\", \"[]\", or \"-1\" if it's array\r\n    protected constructor(me: DPointerTargetable | Pointer, field: string, val: any, fire: boolean = true, isPointer: boolean = false) {\r\n        Log.exDev(!me, 'BaseObject missing in SetFieldAction', {me, field, val});\r\n        super('idlookup.' + ((me as DPointerTargetable).id || me) + ( field ? '.' + field : ''), val, false, isPointer);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        if (fire) this.fire();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/*\r\ntodo: showcase this\r\nlet dclass: DClass = null as any;\r\nSetFieldAction.new(dclass, 'namek', '') // non è un attributo di \"DCLass\"\r\nSetFieldAction.new(dclass, 'parent', '') // val (stringa) non è assegnabile a parent (array di puntatori)\r\nSetFieldAction.new(dclass, 'name.5k', '') // non è un indice array valido\r\nSetFieldAction.new(dclass, 'name[4k]', '') // non è un indice array valido\r\nSetFieldAction.new(dclass, 'name[4]', '') // ok, anche se non dovrebbe accettare la dicitura array per name che è un primitivo (check non implementato, troppo difficile)\r\nSetFieldAction.new(dclass, 'name.5', '') // ok, equivale a dicitura array\r\n*/\r\n\r\n@RuntimeAccessible\r\nexport class RedoAction extends Action {\r\n    public static cname: string = \"RedoAction\";\r\n    static type = 'RedoAction';\r\n    public static new<F extends boolean = true>(amount: number = 1, notfire?: F): (F extends false ? boolean : RedoAction) {\r\n        let act = new RedoAction(amount);\r\n        if (!notfire) return act.fire() as any;\r\n        return act as any;\r\n    }\r\n    private constructor(amount: number = 1) {\r\n        super('', amount);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n}\r\n@RuntimeAccessible\r\nexport class UndoAction extends Action {\r\n    public static cname: string = \"UndoAction\";\r\n    static type = 'UndoAction';\r\n    public static new<F extends boolean = true>(amount: number = 1, notfire?: F): (F extends false ? boolean : UndoAction) {\r\n        let act = new UndoAction(amount);\r\n        if (!notfire) return act.fire() as any;\r\n        return act as any;\r\n    }\r\n    private constructor(amount: number = 1) {\r\n        super('', amount);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n}\r\n@RuntimeAccessible\r\nexport class CombineHistoryAction extends Action {\r\n    public static cname: string = \"CombineHistoryAction\";\r\n    static type = 'CombineHistoryAcCombineHistoryActiontion';\r\n    public static new<F extends boolean = true>(notfire?: F): (F extends false ? boolean : CombineHistoryAction) {\r\n        let act = new CombineHistoryAction();\r\n        if (!notfire) return act.fire() as any;\r\n        return act as any;\r\n    }\r\n    private constructor() {\r\n        super('', '');\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n    }\r\n}\r\n\r\n\r\n\r\n@RuntimeAccessible\r\nexport class CreateElementAction extends Action {\r\n    public static cname: string = \"CreateElementAction\";\r\n    static type = 'CREATE_ELEMENT';\r\n    value!: DPointerTargetable;\r\n    public static newBatch<F extends boolean = true>(me: DPointerTargetable[], notfire?: F): (F extends false ? boolean : CreateElementAction)[]{\r\n        return me.map( (e) => CreateElementAction.new(e, notfire));\r\n    }\r\n\r\n    public static new<F extends boolean = true>(me: DPointerTargetable , notfire?: F): (F extends false ? boolean : CreateElementAction) {\r\n        if ((me as LPointerTargetable).__raw) me = (me as LPointerTargetable).__raw;\r\n        let act = new CreateElementAction(me, !notfire);\r\n        if (!notfire) return act.fire() as any;\r\n        return act as any;\r\n    }\r\n    private constructor(me: DPointerTargetable, fire: boolean = true) {\r\n        super('idlookup.' + me.id, me);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        this.value = me;\r\n        if (fire) this.fire();\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class DeleteElementAction extends SetFieldAction {\r\n    public static cname: string = \"DeleteElementAction\";\r\n    static type = 'DELETE_ELEMENT';\r\n    public static new(me: Pack1<LPointerTargetable>): boolean {\r\n        return new DeleteElementAction(me as any).fire(); }\r\n    constructor(me: DPointerTargetable | Pointer) {\r\n        super((me as DPointerTargetable).id || me, '', undefined);\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        this.fire();\r\n    }\r\n}\r\n\r\n\r\n/*\r\n\r\n@RuntimeAccessible\r\nexport class IDLinkAction extends Action{\r\n    constructor() {\r\n        super(IDLinkAction.name,\r\n    }\r\n    nope, uso un proxy\r\n}*/\r\n\r\n@RuntimeAccessible\r\nexport class CompositeAction extends Action {\r\n    public static cname: string = \"CompositeAction\";\r\n    static type: string = 'COMPOSITE_ACTION';\r\n    actions: Action[] = [];\r\n\r\n    public static new(actions: Action[], launch: boolean = true): CompositeAction { return new CompositeAction(actions, launch); }\r\n    constructor(actions: Action[], launch: boolean = false) {\r\n        super('', '');\r\n        this.actions = actions;\r\n        this.className = (this.constructor as typeof RuntimeAccessibleClass).cname || this.constructor.name;\r\n        if (launch) this.fire();\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class ParsedAction extends SetRootFieldAction {\r\n    public static cname: string = \"ParsedAction\"; // NB: actually this is never created but \"converted\" from other actions by adding fields\r\n    path!: string; // path to a property in the store \"something.like.this\"\r\n    pathArray!: string[]; // path splitted \"like.1.this\"\r\n    executionCount!: number;\r\n}\r\n\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, Action);\r\nRuntimeAccessibleClass.set_extend(Action, LoadAction);\r\nRuntimeAccessibleClass.set_extend(Action, SetRootFieldAction);\r\nRuntimeAccessibleClass.set_extend(SetRootFieldAction, SetFieldAction);\r\nRuntimeAccessibleClass.set_extend(SetFieldAction, DeleteElementAction);\r\nRuntimeAccessibleClass.set_extend(Action, RedoAction as any);\r\nRuntimeAccessibleClass.set_extend(Action, UndoAction as any);\r\nRuntimeAccessibleClass.set_extend(Action, CreateElementAction as any);\r\nRuntimeAccessibleClass.set_extend(Action, CombineHistoryAction as any);\r\nRuntimeAccessibleClass.set_extend(Action, CompositeAction as any);\r\nRuntimeAccessibleClass.set_extend(SetRootFieldAction, ParsedAction as any);\r\n","// export type Class = { new(...args: any[]): any; };\r\nimport type {ShortAttribETypes, Pointer, RuntimeAccessibleClass, EdgeSegment} from \"../joiner\";\r\nimport type React from \"react\";\r\nimport {LEdgePoint, LGraphElement, LVoidEdge, LVoidVertex} from \"../joiner\";\r\n\r\nexport declare type Class<CtorArgs extends any[] = any[], InstanceType = {}, StaticType = {}, IsAbstract = false> = (abstract new (...args: any[]) => InstanceType) & StaticType;\r\nexport declare type CClass<CtorArgs extends any[] = any[], InstanceType = {}, StaticType = {}, IsAbstract = false> = (new (...args: any[]) => InstanceType) & StaticType;\r\ninterface Caller { caller: any; }\r\ninterface Bind { bind: any; }\r\ninterface Apply { apply: any; }\r\ninterface Call { call: any; }\r\nexport type Function =  Caller | Bind | Apply | Call;\r\nexport type Function2 =  (...a: any) => any;\r\nexport type Constructor<InstanceType = any> = (new (...a: any) => InstanceType) & {__proto__?: Constructor<InstanceType> & GObject};\r\nexport type AbstractConstructor<InstanceType = any> = (GObject | (new (...a: any) => InstanceType)) & {__proto__?: Constructor<InstanceType> & GObject};\r\nexport type Temporary = any;\r\nexport type Nullable<T> = T | null\r\nexport type UnixTimestamp = number;\r\ninterface NoCaller { caller?: never; }\r\ninterface NoBind { bind?: never; }\r\ninterface NoApply { apply?: never; }\r\ninterface NoCall { call?: never; }\r\n\r\n\r\nexport type orArr<T> = T | T[];\r\nexport type unArr<T extends any[] | any> = T extends any[] ? T[0] : T;\r\n\r\n// type primitiveType = string | number | boolean | symbol | null | undefined;\r\nexport type PrimitiveType = string | number | boolean | null | undefined;\r\ntype NotAFunction = NoCaller | NoBind | NoApply | NoCall;\r\ntype NotFunction = GObject & NotAFunction | PrimitiveType;\r\nexport type Info = {\r\n    type?: ShortAttribETypes | string | typeof RuntimeAccessibleClass,\r\n    readType?: ShortAttribETypes | string | typeof RuntimeAccessibleClass,\r\n    writeType?: ShortAttribETypes | string | typeof RuntimeAccessibleClass,\r\n    isNode?: boolean, isEdge?: boolean, isEdgePoint?:boolean,\r\n    txt: string | React.ReactElement,\r\n};\r\n\r\n\r\nexport type Empty = any;\r\nexport type UObject = { [key: string]: unknown; }\r\nexport type GObject<DocSubType = ''> = DocSubType extends object ? { [key: string]: any; } & DocSubType : { [key: string]: any; };\r\nexport type RawObject = { [key: string]: NotFunction; };\r\n// Json<T> = oggetto con le chiavi di T senza le funzioni (post deserializzazione)\r\nexport type Json<T extends GObject = RawObject> =\r\n\r\n        {[key in keyof T]: T[key] extends Function ? never : (T[key] extends symbol ? \"symbol\" :\r\n            Exclude<T[key], symbol>); }\r\n        ;\r\n\r\n// export type Dictionary<K extends keyof any, T> = { [P in K]: T; };\r\nexport type Dictionary<K extends keyof GObject = any, V = any> = { [P in K]: V; } & { _subMaps?: V};\r\n// _subMaps type *actually just Dict<str, boolean> but if i set it as bool and access a random element of the map it will be typed as boolean | V*/\r\nexport type DocString<T, COMMENT = ''> = string;\r\nexport type NotFound = null;\r\nexport const NotFoundv = null as NotFound;\r\nexport type nstring = null | string;\r\nexport type nnumber = null | number;\r\nexport type nbool = null | boolean;\r\nexport type bool = boolean;\r\nexport type TODO<T = any> = any;\r\nexport type NonEmptyString = Exclude<string, ''>;\r\nexport enum EdgeBendingMode {\r\n    \"Line\"=\"L\", // end\r\n    \"Bezier_quadratic\"=\"Q\", // bending1, end\r\n    \"Bezier_cubic\"=\"C\", // bending1, bending2, end\r\n    \"Bezier_cubic_mirrored\"=\"S\", // bending1, end // when there are multiple bezier curves on a row, this takes a bendingpoint1 from the last bezier curves mirrored https://css-tricks.com/svg-path-syntax-illustrated-guide/\r\n    \"Bezier_quadratic_mirrored\"=\"T\", // end // when there are multiple bezier curves on a row, this takes a bendingpoint1 from the last bezier curves mirrored https://css-tricks.com/svg-path-syntax-illustrated-guide/\r\n    \"Elliptical_arc\" = \"A\",// x y, rot, arc sweep, x y.  x,y are coords. rot is angle [0, 360), arc & sweep are {0,1}\r\n    // can do elliptical arc with a single EP. rotation i take it from rotating the actual EP. arc & sweep i take it from node state (maybe rotation too)\r\n    \"Bezier_QT\"=\"QT\", // first a Quadratic, then N quadratic mirrored\r\n    \"Bezier_CS\"=\"CS\", // first a Quadratic, then N quadratic mirrored\r\n}\r\nexport enum EdgeGapMode {\r\n    \"gap\" = \"gap\",\r\n    \"autoFill\" = \"autoFill\",\r\n    \"lineFill\" = \"lineFill\",\r\n    \"arcFill\" = \"arcFill\",\r\n    \"center\" = \"center\",\r\n    \"average\" = \"average\",\r\n}\r\n\r\n// export type Subtract<T, K> = {  [L in Exclude<keyof T, K>]: T[L] };\r\n// Or alternatively, and more concisely, as:\r\n\r\n// export type Subtract<T, K> = Pick<T, Exclude<keyof T, K>>;\r\nexport type Subtract<T, K> = Omit<T, keyof K>;\r\nexport type Overlap<T1, T2> =  Omit<T1, keyof T2> & T2;\r\n\r\n\r\n\r\n\r\n\r\n// tipo puramente documentazionale, è solo una stringa o array di stringhe\r\n/*export type Pointer<T extends DPointerTargetable = DPointerTargetable, lowerbound = number, upperbound = number | string, RET = LPointerTargetable> =\r\n    upperbound extends 'N' ? string[] : (\r\n    upperbound extends 0 ? never : (\r\n    lowerbound extends 0 ? (string | undefined | null) : string)); // & {[Symbol.iterator]: () => IterableIterator<string>};\r\n*/\r\ndeclare global  {\r\n    interface ProxyConstructor {\r\n        new <TS extends object, TT extends object = TS>(target: TS, handler: ProxyHandler<TS>): TT;\r\n        // official flawed definition: new <T extends object>(target: T, handler: ProxyHandler<T>): T;\r\n    }\r\n\r\n}\r\n\r\n\r\n// export type Proxyfied<T extends object> = T | GObject;// | T;\r\n\r\nexport type Proxyfied<T extends object> = UObject & T;\r\nexport const windoww: typeof window & GObject= window;\r\nexport type InOutParam<T> = T;\r\n\r\nexport type IsActually<T> = any; // for some reason typescript complains about circular type references? this is a workaround\r\n\r\ntype KeysnotOfType<T, TT> = { [P in keyof T as (T[P] extends TT ? never : P)]: T[P] };\r\ntype ObjectWithoutStrings<T> = {\r\n    [P in keyof T as (T[P] extends string ? never : (T[P] extends string[] ? never : P))]: T[P] // working on arr, keeps single ptrs\r\n};\r\ntype pureStringsNoPointers<T> = {\r\n    [P in keyof T as ( T[P] extends Pointer ? (Pointer extends T[P] ? P : (never)): never)]: T[P]\r\n};\r\nexport type ObjectWithoutPointers<T> = Omit<ObjectWithoutStrings<T> & pureStringsNoPointers<T>, 'pointedBy' | '_storePath'>\r\n\r\ntype refkeys = \"parent\" | \"father\" | \"classifiers\" | \"children\" | \"classes\" | \"packages\" | \"subpackages\" | \"annotations\" | \"\"\r\n    | \"type\" | \"attributes\" | \"references\" | \"operations\" | \"parameters\" | \"..... much more\"\r\n\r\nexport type InitialSizeField = number ;// | ((segment: EdgeSegment) => number);\r\nexport type InitialVertexSizeObj = Partial<{\r\n    id?: DocString<\"Just something to be used as a react key. doesn't need to be a proper Pointer id\">,\r\n    index?: number, // where the EdgePoint should be inserted\r\n    w: InitialSizeField, h: InitialSizeField, x: InitialSizeField, y: InitialSizeField}>;\r\nexport type InitialVertexSizeFunc = ((parent: LVoidEdge|LGraphElement, thiss: LVoidVertex|LEdgePoint)=>InitialVertexSizeObj);\r\nexport type InitialVertexSize =  undefined | InitialVertexSizeObj | InitialVertexSizeFunc; // | ((segment: EdgeSegment) => privateTempIVS);\r\n","import React, {CSSProperties, Dispatch, LegacyRef, PureComponent, ReactElement, ReactNode} from \"react\";\r\nimport {\r\n    AbstractConstructor,\r\n    Constructor, DGraph,\r\n    DModelElement, DPointerTargetable,\r\n    GObject,\r\n    DState,\r\n    LModelElement, LPointerTargetable, OCL, Pointer,\r\n    RuntimeAccessibleClass,\r\n    Selectors,\r\n    windoww\r\n} from \"../../joiner\";\r\nimport {connect} from \"react-redux\";\r\n\r\n\r\ninterface ThisState {\r\n    // listAllStateVariables: boolean,\r\n}\r\n\r\nclass BidirectionalOCLEditor extends PureComponent<AllProps, ThisState>{\r\n    static cname: string = \"BidirectionalOCLEditor\";\r\n\r\n    oclContainer? : LegacyRef<HTMLDivElement>\r\n    editor? : any\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        this.oclContainer = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.loadEditor()\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Readonly<AllProps>, prevState: Readonly<ThisState>, snapshot?: any) {\r\n        this.loadEditor()\r\n    }\r\n\r\n    loadEditor() {\r\n        const xtext = (window as GObject).xtext;\r\n        const url = (window as GObject).baseUrl;\r\n        if(xtext && url) {\r\n            this.editor = xtext.createEditor({ baseUrl: url,\r\n                serviceUrl: \"http://localhost:8085/xtext-service\",\r\n                syntaxDefinition: `xtext-resources/generated/mode-ocl.js`,\r\n                enableCors: true, // @ts-ignore\r\n                parent: this.oclContainer.current\r\n            })\r\n        }\r\n    }\r\n\r\n    getOclQuery() {\r\n        this.ocltextchanged(this.editor.getValue())\r\n    }\r\n\r\n    private ocltextchanged(oclText0: string| boolean): string{\r\n        let oclText = ''+oclText0;\r\n        let state: DState = windoww.store.getState();\r\n        let dmp: DModelElement[] = Selectors.getAllMP(state);\r\n        let lmp: LModelElement[] = Selectors.wrap(dmp, state);\r\n\r\n        console.log('all MP:', dmp, lmp);\r\n        let constructors: Constructor[] = RuntimeAccessibleClass.getAllClasses() as (Constructor|AbstractConstructor)[] as Constructor[];\r\n        let valids: DPointerTargetable[] = [];\r\n        try { valids = OCL.filter(true, \"src\", lmp, oclText, constructors) as DPointerTargetable[]; }\r\n        catch (e) { console.error('invalid ocl query:', {e, oclText, dmp, lmp});}\r\n        let out: { $matched: JQuery<HTMLElement>, $notMatched: JQuery<HTMLElement>} = {} as any;\r\n        console.log('filtered MP', {dmp, lmp, valids, validfilled:valids.filter(b=>!!b)});\r\n        let $htmlmatch: JQuery<HTMLElement> = DGraph.getNodes(valids.filter(b=>!!b) as DModelElement[], out);\r\n        console.log('filtered MP', {dmp, lmp, valids, $htmlmatch});\r\n        out.$notMatched.removeClass('ocl_match');\r\n\r\n        $htmlmatch.addClass('ocl_match');\r\n        return oclText;\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const data = this.props.data;\r\n        const otherprops: GObject = {...this.props};\r\n        if (!otherprops.style) otherprops.style = {};\r\n        if (!otherprops.style.width) otherprops.style.width = '100%';\r\n        delete otherprops.data; // tenta di settare l'attributo data con un proxy e fallisce perchè non è stringa\r\n        delete otherprops.obj; // obj è stato wrappato come proxy in \"data\"\r\n\r\n        return (<>\r\n            <div className={\"mt-2\"} style={{height: \"7em\"}}>\r\n                <div className={\"row\"}>\r\n                    <p className={\"col my-auto mx-auto mb-2\"}><b>{this.props.label}</b></p>\r\n                    <button onClick={() => this.getOclQuery()} className={\"col btn btn-success\"} style={{maxWidth: '3em'}}>\r\n                        <i className=\"bi bi-arrow-right\"></i>\r\n                    </button>\r\n                </div>\r\n                <div style={{marginTop: \".5em\", height: \"12em\"}} data-editor-xtext-lang={\"ocl\"} ref={this.oclContainer}>\r\n                </div>\r\n            </div>\r\n        </>);\r\n    }\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    getter?: ((val: any, baseobj: GObject, key: string) => string); // val is default value used without a getter = baseobj[key]\r\n    setter?: ((val: string|boolean, data?: LPointerTargetable) => any);\r\n    obj: DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    //LPointerTargetable | (Pointer<DPointerTargetable, 0, 'N', LPointerTargetable> & string);\r\n    field: string;\r\n    label?: string;\r\n    type? : 'button'|'checkbox'|'color'|'date'|'datetime-local'|'email' |'file' |'hidden' |'image' |'month' |\r\n        'number' |'password' |'radio' |'range' |'reset' |'search' |'submit' |'tel' |'text' |'time' |'url' |'week';\r\n    className?: string;\r\n    id?: string;\r\n    key?: string;\r\n    placeholder?: string;\r\n    min?: number;\r\n    max?: number;\r\n    step?: number|'any';\r\n    disabled?: boolean;\r\n    readonly?: boolean;\r\n    rootstyle?: CSSProperties;\r\n    labelstyle?: CSSProperties;\r\n    inputstyle?: CSSProperties;\r\n    wrap?: boolean;\r\n    tooltip?: string;\r\n    // propsRequestedFromHtmlAsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    data: LPointerTargetable & GObject;\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    console.log(\"ownProps.obj\", ({state, ownProps:{...ownProps}}));\r\n    if (!ownProps.obj) return ret;\r\n    let objid: Pointer = typeof ownProps.obj === 'string' ? ownProps.obj : ownProps.obj.id;\r\n    ret.data = ownProps.wrap === false ? ownProps.obj as any : LPointerTargetable.wrap(state.idlookup[objid]) || ownProps.obj;\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    return ret; }\r\nexport const OCLEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(mapStateToProps, mapDispatchToProps)(BidirectionalOCLEditor as any);\r\nOCLEditorConnected.cname = \"OCLEditorConnected\";\r\nexport const OCLEditorAce = (props: GObject & OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <OCLEditorConnected {...props} field={props.field} obj={props.obj} />\r\n}\r\n\r\nBidirectionalOCLEditor.cname = \"BidirectionalOCLEditor\";\r\nOCLEditorConnected.cname = \"OCLEditorConnected\";\r\nOCLEditorAce.cname = \"OCLEditorAce\";\r\n","import React, {Dispatch, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState} from \"../../redux/store\";\r\nimport {\r\n    Dictionary,\r\n    DPointerTargetable, DUser,\r\n    GObject,\r\n    LModelElement,\r\n    LPointerTargetable,\r\n    Overlap,\r\n    Pointer,\r\n    Selectors,\r\n    U\r\n} from \"../../joiner\";\r\nimport toast, {Toaster} from 'react-hot-toast';\r\n\r\n\r\nfunction InputComponent(props: AllProps) {\r\n    // todo: data can be injected with UX, if field is present, can take type from a metainfo like __info_of__\r\n    const data = props.data;\r\n    const selected = props.selected;\r\n    const fathers = U.fatherChain(data as LModelElement);\r\n    let editable = true;\r\n    for(let father of fathers) {\r\n        const user = Object.keys(selected).find(key => selected[key]?.id === father);\r\n        if(user && user !== DUser.current) editable = false;\r\n        if(!editable) break;\r\n    }\r\n\r\n    if(!data) return(<></>);\r\n    const readOnly = props.readonly || U.getDefaultViewsID().includes(data.id);\r\n    const getter = props.getter;\r\n    const setter = props.setter;\r\n    const field = props.field;\r\n    const value = (getter) ? getter(data) : (data[field] !== undefined) ? data[field] : 'undefined';\r\n    const type = (props.type) ? props.type : 'text';\r\n    const label: string|undefined = props.label;\r\n    const jsxLabel: ReactNode|undefined = props.jsxLabel;\r\n    /*\r\n    let tooltip: string | React.ReactElement | Info = props.tooltip === true ? data[\"__info_of__\" + field] : (props.tooltip || undefined);\r\n    if (typeof tooltip === \"object\" && (tooltip as Info).txt) {\r\n        tooltip = <div className={\"tooltip\"}>\r\n            <span className={\"type\"} style={{color: \"orange\"}}>{\":\"+tooltip.type+\"\\t\"}</span>\r\n            <span className={\"txt\"}>{(tooltip as Info).txt}</span>\r\n        </div>;\r\n    }\r\n    */\r\n    let tooltip: string = (props.tooltip === true) ? (data[\"__info_of__\" + field]) ? data[\"__info_of__\" + field].txt : '' : '';\r\n\r\n    let css = 'my-auto input ';\r\n    let inputClassName = (props.inputClassName || '');\r\n    css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n    let autosize: boolean = props.autosize === undefined ? false : props.autosize; // props.type===\"text\"\r\n    css += autosize ? ' autosize-input' : '';\r\n\r\n    const notify = () => toast((t: GObject) => (\r\n        <div onClick={() => toast.dismiss(t.id)}>\r\n            <label className={'ms-1'}>{tooltip}</label>\r\n        </div>\r\n    ));\r\n\r\n    const change = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        if(readOnly) return;\r\n        if(setter) setter(evt.target.value);\r\n        else {\r\n            const target = (['checkbox', 'radio'].includes(evt.target.type)) ? evt.target.checked : evt.target.value;\r\n            data[field] = target;\r\n        }\r\n    }\r\n\r\n    let className = (props as any).className || '';\r\n    let style = (props as any).style || {};\r\n    props = {...props, className:'', style:{}} as any;\r\n    let input = <input key={'input.' + data.id} spellCheck={false} readOnly={readOnly || !editable} className={css + inputClassName}\r\n                       type={type} value={value} onChange={change}\r\n                       checked={(['checkbox', 'radio'].includes(type)) ? !!value : undefined} />\r\n\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.hidden;\r\n\r\n    return(<div {...otherprops} style={{...{display: (jsxLabel || label) ? 'flex' : 'block', cursor: (tooltip) ? 'help' : 'auto'}, ...style}}\r\n                className={'p-1 ' + className}>\r\n        {(label && !jsxLabel) && <label className={'my-auto'} onClick={() => {if(tooltip) notify()}}>\r\n            {label}\r\n        </label>}\r\n        {(jsxLabel && !label) && <label className={'my-auto'} onClick={() => {if(tooltip) notify()}}>\r\n            {jsxLabel}\r\n        </label>}\r\n        { autosize ? <div className={ (autosize ? \"autosize-input-container\" : \"\") + (props.asLabel ? \" labelstyle\" : \"\")}\r\n                          data-value={value}>{input}</div> : input}\r\n        {tooltip && <Toaster position={'bottom-center'} /> }\r\n    </div>);\r\n}\r\nInputComponent.cname = \"InputComponent\";\r\nexport interface InputOwnProps {\r\n    data: LPointerTargetable | DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field: string;\r\n    getter?: (data: LPointerTargetable) => string;\r\n    setter?: (value: string|boolean) => void;\r\n    label?: string;\r\n    jsxLabel?: ReactNode;\r\n    type?: 'checkbox'|'color'|'date'|'datetime-local'|'email'|'file'|'image'|'month'|\r\n        'number'|'password'|'radio'|'range'|'tel'|'text'|'time'|'url'|'week';\r\n    readonly?: boolean;\r\n    tooltip?: string | boolean | ReactElement;\r\n    hidden?: boolean;\r\n    autosize?: boolean;\r\n    inputClassName?: string;\r\n    asLabel?: boolean;\r\n    key?: React.Key | null;\r\n}\r\ninterface StateProps {\r\n    data: LPointerTargetable & GObject;\r\n    selected: Dictionary<Pointer<DUser>, LModelElement|null>;\r\n\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = Overlap<InputOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: InputOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const pointer: Pointer = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data.id;\r\n    ret.data = LPointerTargetable.fromPointer(pointer);\r\n    const selected = state.selected;\r\n    ret.selected = {};\r\n    for(let user of Object.keys(selected)) {\r\n        const pointer = selected[user];\r\n        if(pointer) ret.selected[user] = LModelElement.fromPointer(pointer);\r\n        else ret.selected[user] = null;\r\n    }\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const InputConnected = connect<StateProps, DispatchProps, InputOwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(InputComponent);\r\n\r\n\r\nexport function Input(props: InputOwnProps, children: (string | React.Component)[] = []): ReactElement {\r\n    return <InputConnected {...{...props, children}} />;\r\n}\r\n\r\nInputComponent.cname = \"InputComponent\";\r\nInputConnected.cname = \"InputConnected\";\r\nInput.cname = \"Input\";\r\n// export default Input____a;\r\n","import React, {Dispatch, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState,\r\n    DPointerTargetable,\r\n    GObject,\r\n    LPointerTargetable,\r\n    U,\r\n    Overlap, Pointer} from \"../../joiner\";\r\nimport {SelectOwnProps} from \"./Select\";\r\n\r\n\r\nfunction TextAreaComponent(props: AllProps) {\r\n    const data = props.data;\r\n    if(!data) return(<></>);\r\n    const readOnly = props.readonly || U.getDefaultViewsID().includes(data.id);\r\n    const field = props.field;\r\n    const value = (data[field] !== undefined) ? data[field] : 'undefined';\r\n    const label: string|undefined = props.label;\r\n    const jsxLabel: ReactNode|undefined = props.jsxLabel;\r\n    const tooltip = props.tooltip;\r\n    let css = 'my-auto input ';\r\n    css += (jsxLabel) ? 'ms-1' : (label) ? 'ms-auto' : '';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n\r\n    const change = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        const target: string = evt.target.value;\r\n        data[field] = target;\r\n    }\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.hidden;\r\n\r\n    return(<div {...otherprops} style={{display: (jsxLabel || label) ? 'flex' : 'block'}} className={'p-1'}>\r\n        {(label && !jsxLabel) && <label className={'my-auto'}>\r\n            {label}\r\n        </label>}\r\n        {(jsxLabel && !label) && <label className={'my-auto'}>\r\n            {jsxLabel}\r\n        </label>}\r\n        <textarea spellCheck={false} readOnly={readOnly} className={css}\r\n               onChange={change} value={value} />\r\n    </div>);\r\n}\r\nexport interface TextAreaOwnProps {\r\n    data: LPointerTargetable | DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field: string;\r\n    label?: string;\r\n    jsxLabel?: ReactNode;\r\n    readonly?: boolean;\r\n    tooltip?: string;\r\n    hidden?: boolean;\r\n    key?: React.Key | null;\r\n}\r\ninterface StateProps { data: LPointerTargetable & GObject; }\r\ninterface DispatchProps { }\r\n\r\ntype AllProps = Overlap<TextAreaOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: TextAreaOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const pointer: Pointer = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data.id;\r\n    ret.data = LPointerTargetable.fromPointer(pointer);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const TextAreaConnected = connect<StateProps, DispatchProps, TextAreaOwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(TextAreaComponent);\r\n\r\nexport const TextArea = (props: TextAreaOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <TextAreaConnected {...{...props, children}} />;\r\n}\r\n\r\nTextAreaComponent.cname = \"TextAreaComponent\";\r\nTextAreaConnected.cname = \"TextAreaConnected\";\r\nTextArea.cname = \"TextArea\";\r\nexport default TextArea;\r\n","import type {LClass, DPointerTargetable} from \"../../joiner\";\r\nimport React, {Dispatch, LegacyRef, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport toast, {Toaster} from \"react-hot-toast\";\r\nimport {DState,\r\n    U,\r\n    LPointerTargetable,\r\n    GObject,\r\n    Pointer,\r\n    LEnumerator,\r\n    Selectors,\r\n    LModelElement,\r\n    Overlap} from \"../../joiner\";\r\n\r\n\r\nfunction SelectComponent(props: AllProps) {\r\n    const data = props.data;\r\n    if(!data) return(<></>);\r\n    const field = props.field;\r\n    const readOnly = props.readonly || U.getDefaultViewsID().includes(data.id);\r\n    const value = (data[field]?.id) ? data[field].id : 'undefined';\r\n    const label: string|undefined = props.label;\r\n    const jsxLabel: ReactNode|undefined = props.jsxLabel;\r\n    const tooltip = props.tooltip;\r\n    let css = 'my-auto select ';\r\n    css += (jsxLabel) ? 'ms-1' : 'ms-auto';\r\n    css += (props.hidden) ? ' hidden-input' : '';\r\n\r\n    const notify = () => toast((t: GObject) => (\r\n        <div onClick={() => toast.dismiss(t.id)}>\r\n            <label className={'ms-1'}>{tooltip}</label>\r\n        </div>\r\n    ));\r\n\r\n    function SelectChange(evt: React.ChangeEvent<HTMLSelectElement>) {\r\n        if(readOnly) return;\r\n        const target = evt.target.value;\r\n        console.log(\"setting:\", {data, field, target});\r\n        data[field] = target;\r\n    }\r\n\r\n    let hasReturn = false; let hasPrimitive = false; let hasClasses = false; let hasEnumerators = false;\r\n    if(field === 'type') {\r\n        switch (data.className) {\r\n            case 'DAttribute': hasPrimitive = hasEnumerators = true; break;\r\n            case 'DReference': hasClasses = true; break;\r\n            case 'DOperation': hasPrimitive = hasClasses = hasEnumerators = hasReturn = true; break;\r\n            case 'DParameter': hasPrimitive = hasClasses = hasEnumerators = true; break;\r\n        }\r\n    }\r\n    const returns = props.returns;\r\n    const primitives = props.primitives;\r\n    const classes: LClass[] = data.model.classes;\r\n    const enumerators: LEnumerator[] = data.model.enumerators;\r\n\r\n    const otherprops: GObject = {...props};\r\n    delete otherprops.data;\r\n    delete otherprops.getter;\r\n    delete otherprops.setter;\r\n    delete otherprops.jsxLabel;\r\n    delete otherprops.primitives;\r\n    delete otherprops.returns;\r\n    delete otherprops.hidden;\r\n    // todo per giordano: questa cosa non mi setta props.ref.current correttamente, puoi aggiustarlo tu? forse conosci meglio refs\r\n    return(<div {...otherprops} ref={props.ref as any} className={'d-flex p-1'} >\r\n        {(label && !jsxLabel) && <label className={'my-auto'} onClick={() => {if(tooltip) notify()}}>\r\n            {label}\r\n        </label>}\r\n        {(jsxLabel && !label) && <label className={'my-auto'} onClick={() => {if(tooltip) notify()}}>\r\n            {jsxLabel}\r\n        </label>}\r\n        <select className={css} value={value} onChange={SelectChange}>\r\n            {(hasReturn && returns.length > 0) && <optgroup label={'Defaults'}>\r\n                {returns.map((returnType, i) => {\r\n                    return <option key={i} value={returnType.id}>{returnType.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(hasPrimitive && primitives) && <optgroup label={'Primitives'}>\r\n                {primitives.map((primitive, i) => {\r\n                    return <option key={i} value={primitive.id}>{primitive.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(hasEnumerators && enumerators.length > 0) && <optgroup label={'Enumerators'}>\r\n                {enumerators.map((enumerator, i) => {\r\n                    return <option key={i} value={enumerator.id}>{enumerator.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {(hasClasses && classes.length > 0) && <optgroup label={'Classes'}>\r\n                {classes.map((classifier, i) => {\r\n                    return <option key={i} value={classifier.id}>{classifier.name}</option>\r\n                })}\r\n            </optgroup>}\r\n            {props.options}\r\n        </select>\r\n        {(tooltip) && <Toaster position={'bottom-center'} />}\r\n    </div>);\r\n}\r\nSelectComponent.cname = \"SelectComponent\";\r\nexport interface SelectOwnProps {\r\n    data?: DPointerTargetable | Pointer<DPointerTargetable, 1, 1, LPointerTargetable>;\r\n    field: string;\r\n    label?: string;\r\n    jsxLabel?: ReactNode;\r\n    tooltip?: string;\r\n    hidden?: boolean;\r\n    options?: JSX.Element;\r\n    key?: React.Key | null;\r\n    ref?: React.RefObject<HTMLElement> | LegacyRef<HTMLElement>;\r\n    readonly?: boolean;\r\n}\r\ninterface StateProps {\r\n    data: LPointerTargetable & GObject;\r\n    primitives: LClass[];\r\n    returns: LClass[]; }\r\ninterface DispatchProps { }\r\n\r\ntype AllProps = Overlap<SelectOwnProps, Overlap<StateProps, DispatchProps>>;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: SelectOwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    if (!ownProps.data) return ret;\r\n    const pointer: Pointer = typeof ownProps.data === 'string' ? ownProps.data : ownProps.data.id;\r\n    ret.data = LPointerTargetable.fromPointer(pointer);\r\n    ret.primitives = LPointerTargetable.fromPointer(state.primitiveTypes);\r\n    ret.returns = LPointerTargetable.fromPointer(state.returnTypes);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const SelectConnected = connect<StateProps, DispatchProps, SelectOwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(SelectComponent);\r\n\r\nexport const Select = (props: SelectOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <SelectConnected {...{...props, children}} />;\r\n}\r\n\r\n\r\nSelectComponent.cname = \"SelectComponent\";\r\nSelectConnected.cname = \"SelectConnected\";\r\nSelect.cname = \"Select\";\r\nexport default Select;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState} from \"../../redux/store\";\r\n\r\n\r\nfunction ImageComponent(props: AllProps) {\r\n    let link;\r\n    if (props.code && props.name){\r\n        link = 'https://www.svgrepo.com/show/';\r\n        link += props.code + '/';\r\n        link += props.name + '.svg';\r\n    } else {\r\n        link = (props as any).src;\r\n    }\r\n    return <img className={'h-100 w-100'} src={link} />; // damiano: what's this? added to read src if provided\r\n}\r\ninterface OwnProps { code: string; name: string; }\r\ninterface StateProps { }\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ImageConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ImageComponent);\r\n\r\nexport const Image = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ImageConnected {...{...props, children}} />;\r\n}\r\n\r\nImageComponent.cname = \"ImageComponent\";\r\nImageConnected.cname = \"ImageConnected\";\r\nImage.cname = \"Image\";\r\nexport default Image;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport Xarrow from \"react-xarrows\";\r\nimport {DState} from \"../../joiner\";\r\n\r\n\r\nfunction EdgeComponent(props: AllProps) {\r\n    const source = props.source;\r\n    const target = props.target;\r\n    const label = (props.label) ? props.label : '';\r\n\r\n    return(<Xarrow start={source} end={target} labels={label} />);\r\n}\r\ninterface OwnProps {\r\n    source: string,\r\n    target: string,\r\n    label?: string\r\n}\r\ninterface StateProps { }\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const EdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgeComponent);\r\n\r\nexport const Edge = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgeConnected {...{...props, children}} />;\r\n}\r\nexport default Edge;\r\n","import React, {PureComponent, ReactNode} from \"react\";\r\nimport ReactJson from 'react-json-view' // npm i react-json-view\r\nimport './logger.scss'\r\nimport {GObject} from \"../../joiner\";\r\n\r\n// private\r\ninterface ThisState { }\r\n\r\nexport class DataOutputComponent extends PureComponent<AllProps, ThisState>{\r\n    static cname: string = \"DataOutputComponent\";\r\n\r\n    render(): ReactNode {\r\n        {/* themes:\r\n                                        export interface ThemeObject {\r\n                                            base00: string;\r\n                                            base01: string;\r\n                                            base02: string;\r\n                                            base03: string;\r\n                                            base04: string;\r\n                                            base05: string;\r\n                                            base06: string;\r\n                                            base07: string;\r\n                                            base08: string;\r\n                                            base09: string;\r\n                                            base0A: string;\r\n                                            base0B: string;\r\n                                            base0C: string;\r\n                                            base0D: string;\r\n                                            base0E: string;\r\n                                            base0F: string;\r\n                                        }\r\n\r\n                                            export type ThemeKeys =\r\n                                              | 'apathy'\r\n                                              | 'apathy:inverted'\r\n                                              | 'ashes'\r\n                                              | 'bespin'\r\n                                              | 'brewer'\r\n                                              | 'bright:inverted'\r\n                                              | 'bright'\r\n                                              | 'chalk'\r\n                                              | 'codeschool'\r\n                                              | 'colors'\r\n                                              | 'eighties'\r\n                                              | 'embers'\r\n                                              | 'flat'\r\n                                              | 'google'\r\n                                              | 'grayscale'\r\n                                              | 'grayscale:inverted'\r\n                                              | 'greenscreen'\r\n                                              | 'harmonic'\r\n                                              | 'hopscotch'\r\n                                              | 'isotope'\r\n                                              | 'marrakesh'\r\n                                              | 'mocha'\r\n                                              | 'monokai'\r\n                                              | 'ocean'\r\n                                              | 'paraiso'\r\n                                              | 'pop'\r\n                                              | 'railscasts'\r\n                                              | 'rjv-default'\r\n                                              | 'shapeshifter'\r\n                                              | 'shapeshifter:inverted'\r\n                                              | 'solarized'\r\n                                              | 'summerfruit'\r\n                                              | 'summerfruit:inverted'\r\n                                              | 'threezerotwofour'\r\n                                              | 'tomorrow'\r\n                                              | 'tube'\r\n                                              | 'twilight'; */}\r\n        return <ReactJson src={this.props.data}\r\n                          collapsed={1}\r\n                          collapseStringsAfterLength={20}\r\n                          displayDataTypes={true}\r\n                          displayObjectSize={true}\r\n                          enableClipboard={true}\r\n                          groupArraysAfterLength={100}\r\n                          indentWidth={4}\r\n                          iconStyle={\"triangle\"}\r\n                          name={this.props.rootName}\r\n                          quotesOnKeys={true} shouldCollapse={ false /*((field: CollapsedFieldProps) => { return Object.keys(field.src).length > 3;*/ }\r\n                          sortKeys={false}\r\n                          theme={\"rjv-default\"}\r\n        >{this.props.children}</ReactJson>;\r\n    };\r\n\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    data: GObject;\r\n    rootName?: string;\r\n}\r\n// private\r\ntype AllProps = OwnProps;\r\n/*\r\nif (!windoww.mycomponents) windoww.mycomponents = {};\r\nwindoww.mycomponents.DataOutput = DataOutputComponent;\r\nwindoww.mycomponents.DataOutputComponent = DataOutputComponent;*/\r\n////// mapper func\r\n\r\n","import React, {PureComponent, ReactNode} from \"react\";\r\nimport './logger.scss';\r\nimport {DataOutputComponent, DDate, Dictionary, GObject, Log, U, UnixTimestamp} from \"../../joiner\";\r\n\r\n// private\r\ninterface ThisState {\r\n    messages: Dictionary<string, Dictionary<string, any[]>>\r\n    filters: {category: ((cat: string) => boolean) | null, tag: ((tag: string) => boolean) | null, datafilter: ((data: any[]) => boolean) | null};\r\n    categoriesActive: Dictionary<string, boolean>;\r\n    searchTag: string;\r\n    searchTagAsRegExp: boolean;\r\n    id: number;\r\n    minDate: UnixTimestamp;\r\n    maxDate: UnixTimestamp;\r\n}\r\n\r\nexport class LoggerComponent extends PureComponent<AllProps, ThisState>{\r\n    public static cname: string = \"LoggerComponent\";\r\n    public static loggers: LoggerComponent[] = [];\r\n    private static max_id: number = 0;\r\n    public static Log(category: string, key: string, data: any[]): void{\r\n        for (let logger of LoggerComponent.loggers) { logger.log(category, key, data); }\r\n    }\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        this.state = {\r\n            id: LoggerComponent.max_id++,\r\n            messages: {},\r\n            searchTag: '',\r\n            searchTagAsRegExp: false,\r\n            categoriesActive: {},\r\n            minDate: DDate.addYear(new Date(), -1, true).getTime(),\r\n            maxDate: DDate.addYear(new Date(), +1, true).getTime(),\r\n            filters: {category: null, tag: null, datafilter: null}};\r\n        LoggerComponent.loggers.push(this);\r\n        Log.registerLogger(this, Log.e);\r\n    }\r\n\r\n    private isCatActive(cat: string): boolean {\r\n        return !!(this.state.categoriesActive[cat] && this.state.filters.category?.(cat));\r\n    }\r\n\r\n    private changeSearchTag = (e: React.ChangeEvent<HTMLInputElement>): void => {\r\n        this.setState({...this.state, searchTag: e.target.value});\r\n    }\r\n    private changeRegexpTag = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({...this.state, searchTagAsRegExp: e.target.checked});\r\n\r\n    }\r\n    private changeMinDate = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({...this.state, minDate: new Date(e.target.value).getTime() });\r\n\r\n    }\r\n    private changeMaxDate = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({...this.state, maxDate: new Date(e.target.value).getTime() });\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const allCategories: string[] = Object.keys(this.state.messages);\r\n        const activeCategories: string[] = allCategories.filter( cat => this.isCatActive(cat));\r\n        const allTags: string[] = U.arrayUnique(activeCategories.flatMap( (cat) => Object.keys(this.state.messages[cat])))\r\n        const activeTags: string[] = allTags.filter( (tag: string) => (this.state.searchTagAsRegExp ? tag.match(this.state.searchTag) : tag === this.state.searchTag));\r\n        return (<>\r\n            <div>\r\n                <h1>Search by tag</h1>\r\n                <datalist>\r\n                    { allTags.map(tag => <option key={tag} value={tag}>{tag}</option>) }\r\n                </datalist>\r\n                <input list={\"#logger_\" + this.state.id + \"_keylist\"} value={this.state.searchTag} onChange={ this.changeSearchTag } />\r\n                {/*<Input label={\"as RegExp\"} type=\"checkbox\" checked={this.state.searchTagAsRegExp} onChange={this.changeRegexpTag} />\r\n                <input label={\"from\"} type=\"datetime-local\" value={ new Date(this.state.minDate).toString()} onChange={this.changeMinDate} />\r\n                <input label={\"to\"} type=\"datetime-local\" value={ new Date(this.state.maxDate).toString()} onChange={this.changeMaxDate} /> */}\r\n            </div>\r\n            <ul className={\"categories\"}>\r\n                { allCategories.map((cat, i) => <li className={\"category cat_\"+ i + \" \" + cat} key={cat} data-active={this.isCatActive(cat)}>{cat}</li>) }\r\n            </ul>\r\n            <ul className={\"entries\"}>\r\n                {\r\n                    activeCategories.flatMap( (cat) => {\r\n                        return Object.keys(this.state.messages[cat]).map( (tag) => {\r\n                            let entries = this.state.messages[cat][tag]\r\n                            return <li><span className={\"tag\"}>{tag}</span>{\r\n                                entries.map( (parameter) => <span className=\"parameter\">\r\n                                    <DataOutputComponent data={parameter} rootName={tag} />\r\n                                </span>)\r\n                            }</li>;\r\n                        });\r\n                    })\r\n                }\r\n            </ul>\r\n        </>); }\r\n\r\n\r\n\r\n    public log = (category: string, key: string, data: any[], fullconcat?: string): void => {\r\n        if (!this.state.categoriesActive.hasOwnProperty(category)) {\r\n            this.setState({categoriesActive: { ...this.state.categoriesActive, category: true}});\r\n            const category: GObject = {};\r\n            category[key] = data;\r\n            this.setState({messages: { ...this.state.messages, category} });\r\n        }\r\n\r\n        const messages: GObject = { ...this.state.messages};\r\n        messages[category] = messages[category] ? { ...messages[category]} : {};\r\n        messages[category][key] = messages[category][key] ? [ ...messages[category][key], data] : [data];\r\n        this.setState( {messages});\r\n    }// .bind(this);\r\n\r\n    componentWillUnmount(): void {\r\n        U.arrayRemoveAll(LoggerComponent.loggers, this);\r\n    }\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    // propsRequestedFromHtmlAsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n////// mapper func\r\n\r\n/*\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\nexport const LoggerComponentConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(LoggerComponent);*/\r\n","import React, {CSSProperties, PureComponent, ReactChild, ReactNode} from \"react\";\r\n// import { connect } from \"react-redux\";\r\n// import {DState} from \"../../redux/store\";\r\nimport './overlap.scss';\r\n\r\n// private\r\ninterface ThisState {\r\n}\r\n\r\nexport class Overlap extends PureComponent<AllProps, ThisState>{\r\n    static cname: string = \"Overlap\";\r\n\r\n    render(): ReactNode {\r\n        console.log('overlap childs:', this.props.children);\r\n        if (!this.props.children || !Array.isArray(this.props.children)) return this.props.children;\r\n        const children = this.props.children; // ? (Array.isArray(this.props.children) ? this.props.children : [this.props.children]) : [];\r\n        return (<>\r\n            {/*trouble on svg: G elements cannot be styled and rect cannot be nested, i cannot force a container to take size of children unless set size with plain js*/}\r\n            <div className={\"overlap-parent\" + (this.props.autosizex ? \" overlap-child-chooses-width\" : \"\") + (this.props.autosizex ? \" overlap-child-chooses-height\" : \"\")} style={{...this.props.style}}>\r\n                {React.Children.map(children, cc => {\r\n                        return <div className={\"overlap-child-wrapper\" + (!this.props.autosizex ? \" overlap-parent-chooses-width\" : \"\") + (!this.props.autosizey ? \" overlap-parent-chooses-height\" : \"\")}>{cc}</div>\r\n                    })}\r\n            </div>\r\n        </>); }\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    children: ReactChild[] | ReactChild;\r\n    // sizefollows: \"parent\" | \"child\";\r\n    autosizex?: boolean;\r\n    autosizey?: boolean;\r\n    style?: CSSProperties;\r\n    // propsRequestedFromHtmlAsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n////// mapper func\r\n/*\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n*/\r\n\r\n(Overlap as any).defaultProps = {\r\n  autosizex: true,\r\n  autosizey: true,\r\n  style: undefined,\r\n  children: [],\r\n} as OwnProps; // todo: se esporto con connect fose devo farlo al risultato della connect\r\nexport default Overlap;\r\n/*connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Overlap);*/\r\n","import React, {Dispatch, PureComponent, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport type {DGraph, Dictionary, DocString, DState, Pointer} from \"../../joiner\";\r\nimport './defaultColorScheme.scss';\r\n\r\n// private\r\ninterface ThisState {\r\n}\r\n\r\nclass ColorSchemeComponent extends PureComponent<AllProps, ThisState>{\r\n    static cname: string = \"ColorSchemeComponent\";\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n    }\r\n\r\n    render(): ReactNode {\r\n        let userColorSchemeCss = '';\r\n        for (let graphid in this.props.userMadeColorScheme) {\r\n            userColorSchemeCss += \"\\n\\n #graph_\" + graphid + \"{ \\n\" + this.props.userMadeColorScheme[graphid] + \"\\n}\";\r\n        }\r\n        // NB: default styles are in scss file and are not editable.\r\n        return <style>{userColorSchemeCss}</style>; }\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    // propsRequestedFromJSX_AsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    userMadeColorScheme: Dictionary<Pointer<DGraph>, DocString<'CSS variables'>>;\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n////// mapper func\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.userMadeColorScheme = {};\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\nexport const ColorScheme = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ColorSchemeComponent);\r\n\r\n\r\n\r\nColorSchemeComponent.cname = \"ColorSchemeComponent\";\r\nColorScheme.cname = \"ColorScheme\";\r\nexport default ColorScheme;\r\n","import React, {ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DClassifier,\r\n    DEnumerator,\r\n    Dictionary,\r\n    DModel,\r\n    DModelElement,\r\n    DPackage, DV,\r\n    GObject,\r\n    GraphElementComponent,\r\n    GraphElementDispatchProps,\r\n    GraphElementOwnProps,\r\n    GraphElementReduxStateProps,\r\n    GraphElementStatee,\r\n    DState,\r\n    LModelElement,\r\n    Log,\r\n    LViewElement,\r\n    RuntimeAccessibleClass, SetRootFieldAction,\r\n    windoww,\r\n    Field, Graph, GraphVertex, Vertex, VoidVertex, RuntimeAccessible\r\n} from \"../../joiner\";\r\n// import {Field, Graph, GraphVertex} from \"../vertex/Vertex\";\r\n\r\nconst superclass: typeof GraphElementComponent = RuntimeAccessibleClass.classes.GraphElementComponent as any as typeof GraphElementComponent;\r\n\r\n// private\r\nclass DefaultNodeStatee extends GraphElementStatee { }\r\n\r\n// from ownstateprops function getVertexID(props: AllPropss): Pointer<DVoidVertex, 0, 1, LVoidVertex> { return props.vertex?.id; }\r\n\r\n\r\n// Giordano: add ignore for webpack\r\n@RuntimeAccessible\r\n//@ts-ignore\r\nexport class DefaultNodeComponent<AllProps extends AllPropss = AllPropss, NodeState = DefaultNodeStatee> extends superclass<AllProps, NodeState>{\r\n    public static cname: string = \"DefaultNodeComponent\";\r\n\r\n    static mapStateToProps(state: DState, ownProps: GraphElementOwnProps): GraphElementReduxStateProps {\r\n        let ret: GraphElementReduxStateProps = {} as GraphElementReduxStateProps; // NB: cannot use a constructor, must be pojo\r\n        GraphElementComponent.mapLModelStuff(state, ownProps, ret); // not necessary either?\r\n        // GraphElementComponent.mapLGraphElementStuff(state, ownProps, ret, dGraphDataClass); not necessary, it's demanded to sub-components\r\n        try{\r\n            GraphElementComponent.mapViewStuff(state, ret, ownProps);\r\n            (ret as any).skiparenderforloading = false;\r\n        } catch(e) {\r\n            (ret as any).skiparenderforloading = true; // model id is updated, but he's still trying to load old model which got replaced and is not in state.\r\n            /* crashes on loading because old model and new model have different timestamps? looks by id of old model with same number and diffferent timestamp\r\n        Log.ex(!ret.data, \"can't find model data:\", {meid, state, ownpropsdata:ownProps.data, ownProps});*/ }\r\n        return ret; }\r\n\r\n    constructor(props: AllProps, context: any) { super(props, context); }\r\n\r\n    render(): ReactNode {\r\n        if ((this.props as any).skiparenderforloading) {\r\n            console.log(\"realoading render: \", {thiss:this, data:this.props.data});\r\n            windoww.bugged = this;\r\n            console.log(\"realoading render: \", {thiss:this, data:this.props.data});\r\n            SetRootFieldAction.new(\"rerenderforloading\", new Date().getTime()); return <div>loading...</div>;}\r\n        const view: LViewElement = this.props.view;\r\n        const modelElement: LModelElement | undefined = this.props.data;\r\n        if (!view) { Log.exx({props: this.props, thiss:this}); }\r\n        // if (!view) { SetRootFieldAction.new(\"uselessrefresh_afterload\", new Date().getTime()); return <div>Loading...</div>; }\r\n\r\n        let componentMap: Dictionary<string, (props: GObject, children?: (string | React.Component)[]) => ReactElement> = windoww.components;\r\n        let dmodelMap: Dictionary<string, typeof DModelElement> = RuntimeAccessibleClass.classes as any;\r\n\r\n        let serializableProps = {...this.props, data: this.props.data?.id, view: this.props.view?.id, views: this.props.views?.map( v => v.id )};\r\n        // console.log('dnode render', {props: {...this.props}, serializableProps});\r\n        let componentfunction: typeof Graph = null as any;\r\n        if (view.forceNodeType) {\r\n            switch (view.forceNodeType) {\r\n                default: Log.exDevv('unrecognized View.forceNodeType:' + view.forceNodeType, {view, modelElement});\r\n                return <div>dev error</div>\r\n                case \"Graph\": case \"GraphComponent\": componentfunction = Graph; break;\r\n                // case windoww.GraphElementComponent.cname:\r\n                case windoww.VertexComponent.cname: componentfunction = Vertex; break;\r\n                case windoww.FieldComponent.cname: componentfunction = Field; break;\r\n                case windoww.GraphVertexComponent.cname: componentfunction = GraphVertex; break; }\r\n            // console.log(\"force node type\", {requested:view.forceNodeType, G:  windoww.GraphComponent.name, GE: windoww.GraphElementComponent.name, GV: windoww.GraphVertexComponent.name, V: windoww.VertexComponent.name, F:windoww.FieldComponent.name})\r\n            return componentfunction(serializableProps, this.props.children);}\r\n\r\n        if (modelElement?.className) switch(modelElement.className) {\r\n            case \"DModel\": componentfunction = Graph; break;\r\n            case \"DPackage\": componentfunction = GraphVertex; break;\r\n            case \"DClassifier\":\r\n            case \"DEnumerator\":\r\n            case \"DObject\":\r\n            case \"DClass\": componentfunction = Vertex; break;\r\n            case \"DAnnotation\":\r\n            case \"DAttribute\":\r\n            case \"DOperation\":\r\n            case \"DParameter\":\r\n            case \"DReference\":\r\n            case \"DEnumLiteral\":\r\n            case \"DValue\":\r\n            case \"DModelElement\": componentfunction = Field; break;\r\n            default:\r\n                Log.exDevv('invalid model class, add a case in the switch', {modelElement, view, dmodelMap, componentMap});\r\n                // const dmodel: typeof DModelElement = dmodelMap[modelElement.className];\r\n                // Log.exDev(!dmodel || !dmodel.defaultComponent, 'invalid model class:', {dmodel, modelElement, view, dmodelMap, componentMap});\r\n                // return dmodel.defaultComponent(serializableProps, this.props.children);\r\n        } else componentfunction = VoidVertex; // model-less, VoidVertex\r\n\r\n        if (componentfunction) return componentfunction(serializableProps, this.props.children);\r\n        // errore: questoon passa gli id correttamente al sottoelemento vertex o field\r\n        return DV.errorView(\"Error: DefaultNode is missing both view and model, please state node type explicitly: Graph, GraphVertex, Vertex or Field\");\r\n    }\r\n\r\n}\r\n\r\n// private\r\nclass DefaultNodeOwnProps extends GraphElementOwnProps {}\r\nclass DefaultNodeReduxStateProps  extends GraphElementReduxStateProps {}\r\nclass DefaultNodeDispatchProps extends GraphElementDispatchProps {}\r\ntype AllPropss = DefaultNodeOwnProps & DefaultNodeReduxStateProps & DefaultNodeDispatchProps;\r\n\r\n\r\nconst DefaultNodeConnected = connect<DefaultNodeReduxStateProps, DefaultNodeDispatchProps, DefaultNodeOwnProps, DState>(\r\n    DefaultNodeComponent.mapStateToProps,\r\n    DefaultNodeComponent.mapDispatchToProps\r\n)(DefaultNodeComponent as any);\r\n// export const Vertex = VertexConnected;\r\n\r\n\r\nexport const DefaultNode = (props: DefaultNodeOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <DefaultNodeConnected {...{...props, children}} />; }\r\n\r\n\r\nDefaultNodeComponent.cname = \"DefaultNodeComponent\";\r\nDefaultNodeConnected.cname = \"DefaultNodeConnected\";\r\nDefaultNode.cname = \"DefaultNode\";\r\n","import React, {Dispatch, PureComponent, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\n// import './graph.scss';\r\nimport {DGraph, DModel, DPointerTargetable, DState, LGraph, LModel} from \"../../joiner\";\r\n\r\n\r\n// private\r\ninterface ThisState { }\r\n\r\nexport class GraphsContainerComponent extends PureComponent<AllProps, ThisState>{\r\n    public static cname: string = \"GraphsContainerComponent\";\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n    }\r\n\r\n    // todo: per ogni vista crea un set di opzioni {enableAutocorrect: \"boolean(true)\", displayEdges: \"boolean(true)\", maximumGraphWidth: \"number(2000)\"} specificate dall\\'utente che deve specificare sia il tipo (Come se osse una funzione) che il valore predefinito\r\n    // il grafo deve leggere l'oggetto di opzioni e creare un menù che consente di cambiarle (una checkbox al posto dell'enableAutocorrect (bool), uno spinner per maximumGraphWidth (number...)\r\n\r\n    render(): ReactNode {\r\n        // const editinput = \"<input onChange={(e) => this.data.name = e.target.value } value={this.data.name} />\";\r\n        // const editinput = \"\";\r\n        // todo: rendi opzionale obj = this.data.id se non è specificato.\r\n        // const editinput = \"<Input obj={this.data.id} field={'name'} getter={val => val.toUpperCase()} setter={(val) => val.toLowerCase()} />\";\r\n        // \"<Input obj={this.data} field={'name'} getter={val => val.toUpperCase()} setter={(val) => val.toLowerCase()} />\";\r\n        return (<>\r\n            {\r\n                this.props.graphs.map( (m: LGraph) => (\r\n                    <>\r\n                        {/*<svg style={{backgroundColor: 'red'}}>\r\n                        <Overlap style={{width: '100px'}}>\r\n                            success, now i can test resize handler overlayed to content and dragndrop dnd\r\n                            <foreignObject className={\"rectangle\"} />\r\n                            <foreignObject className={\"ellipse\"} />\r\n                            <foreignObject className={\"point\"} />\r\n                        </Overlap>\r\n                        </svg><svg style={{backgroundColor: 'red'}}>\r\n                            <Overlap>\r\n                                <foreignObject className={\"rectangle\"} style={{width: '100px'}}/>\r\n                                <foreignObject className={\"ellipse\"} style={{width: '300px'}}/>\r\n                                <foreignObject className={\"point\"} />\r\n                            </Overlap>\r\n                        </svg>* /}\r\n                        <GraphElement data={m} />*/}\r\n                        {/*\r\n                            Giordano comment this problem with model's children\r\n                            <Graph graphid={m.id} data={m.model} view={undefined}>\r\n                                <Vertex data={m.model}/>\r\n                            </Graph>\r\n\r\n                        */}\r\n                        {this.props.children/*<QA />*/}\r\n                    </>)\r\n                )\r\n            }\r\n        </>); }\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    // propsRequestedFromHtmlAsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    models: LModel[];\r\n    graphs: LGraph[];\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n////// mapper func\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    console.log('mapStateToProps', {ret, state, ownProps, models: state.models})\r\n    ret.models = state.models.length ? state.models.map( (mid) => mid && DPointerTargetable.wrap(state.idlookup[mid] as DModel)) as LModel[] : [];\r\n    ret.graphs = state.graphs.length ? state.graphs.map( (mid) => mid && LGraph.wrap(state.idlookup[mid] as DGraph)) as LGraph[] : [];\r\n    /// to fill\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\n\r\nconst GraphsContainerConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(GraphsContainerComponent);\r\n\r\nexport const GraphsContainer = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <GraphsContainerConnected {...{...props, children}} />; }\r\n\r\n\r\nGraphsContainer.cname = \"GraphsContainer\";\r\nGraphsContainerConnected.cname = \"GraphsContainerConnected\";\r\nGraphsContainerComponent.cname = \"GraphsContainerComponent\";\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {LGraphElement} from \"../../model/dataStructure\";\r\nimport Xarrow, {xarrowPropsType, Xwrapper} from \"react-xarrows\";\r\nimport {SetRootFieldAction} from \"../../redux/action/action\";\r\nimport {GObject, LClass, LReference, Selectors} from \"../../joiner\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport { useStateIfMounted } from \"use-state-if-mounted\";\r\nimport $ from \"jquery\";\r\n\r\nconst crypto = require(\"crypto\");\r\ninterface ThisState {}\r\nfunction EdgeComponent(props: AllProps, state: ThisState) {\r\n    const sourceNode = props.source;\r\n    let source: LClass|LReference|undefined = sourceNode.model as any;\r\n    const targetNode = props.target;\r\n    let target: LClass|LReference|undefined = targetNode.model as any;\r\n\r\n    const show = props.showAnchor;\r\n    const size = props.size;\r\n    const color = props.color;\r\n\r\n    const [middleAnchor, setMiddleAnchor] = useStateIfMounted('');\r\n\r\n    const firstOptions: xarrowPropsType = {\r\n        start: sourceNode.id, end: middleAnchor,\r\n        path: \"grid\", color: color, strokeWidth: size,\r\n        showHead: false, zIndex: 100\r\n    };\r\n    const lastOptions: xarrowPropsType = {\r\n        start: middleAnchor, end: targetNode.id,\r\n        path: \"grid\", color: color, strokeWidth: size, zIndex: 100\r\n    };\r\n\r\n    if(source?.className == \"DReference\") {\r\n        source = source as LReference;\r\n        firstOptions.start = source.father.nodes[0].id;\r\n        lastOptions.showHead = false;\r\n        if(source.containment) {\r\n            firstOptions.showTail = true;\r\n            firstOptions.tailSize = 15;\r\n            firstOptions.tailShape = {svgElem: <rect style={{\r\n                    rotate: \"45deg\", fill: \"white\", strokeWidth: \"0.1\", stroke: color,\r\n                }} width=\".5pt\" height=\".5pt\" />, offsetForward: 1};\r\n        }\r\n    }\r\n    if(source?.className == \"DClass\") {\r\n        source = source as LClass;\r\n        lastOptions.showHead = true;\r\n        lastOptions.headSize = 15;\r\n        lastOptions.headColor = 'white';\r\n        lastOptions.headShape = {svgElem:<svg><path strokeWidth={0.1} stroke={color} d=\"M 0 0 L 1 0.5 L 0 1 L 0 0 z\"/></svg>};\r\n    }\r\n\r\n    useEffectOnce(() => {\r\n        setMiddleAnchor(crypto.randomBytes(20).toString('hex'));\r\n    })\r\n\r\n    useEffect(() => {\r\n        const middleware: GObject = $('[id=\"' + middleAnchor + '\"]');\r\n        if(middleware) {\r\n            middleware.draggable({\r\n                cursor: \"grabbing\",\r\n                containment: \"window\",\r\n                drag: function (event: GObject, obj: GObject) {\r\n                    SetRootFieldAction.new(\"dragging\", {})\r\n                }\r\n            });\r\n        }\r\n    })\r\n\r\n    const click = (event: React.MouseEvent<HTMLDivElement>) => {\r\n        if(source) {\r\n            SetRootFieldAction.new('_lastSelected', {\r\n                node: sourceNode.id,\r\n                view: undefined,\r\n                modelElement: source.id\r\n            });\r\n        }\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    }\r\n\r\n    const contextMenu = (event: React.MouseEvent<HTMLDivElement>) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    }\r\n\r\n    return(<div onClick={click} onContextMenu={contextMenu}>\r\n        <div style={{borderColor: color}} id={middleAnchor} className={\"middle-anchor\"}></div>\r\n        <Xarrow {...firstOptions} />\r\n        <Xarrow {...lastOptions} />\r\n    </div>);\r\n}\r\ninterface OwnProps { source: LGraphElement; target: LGraphElement; }\r\ninterface StateProps { showAnchor: boolean, size: number, color: string }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    /*const edgeSettings = state._edgeSettings;\r\n    const showAnchor = false //edgeSettings.showAnchor;\r\n    const size = edgeSettings.strokeWidth;\r\n    const color = edgeSettings.color;\r\n    const ret: StateProps = { showAnchor, size, color };*/\r\n    return {} as any;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const EdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgeComponent);\r\n\r\nexport const Edge = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgeConnected {...{...props, children}} />;\r\n}\r\n\r\nEdgeComponent.cname = \"EdgeComponent\";\r\nEdgeConnected.cname = \"EdgeConnected\";\r\nEdge.cname = \"Edge\";\r\nexport default Edge;\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {LClass, LGraphElement, LModelElement, LReference, MyProxyHandler,} from \"../../joiner\";\r\nimport Edge from \"./Edge\";\r\n\r\n\r\ninterface ThisState {}\r\n\r\nfunction EdgesComponent(props: AllProps, state: ThisState) {\r\n    const me = props.source.model;\r\n    if(props.targets && props.targets.length <= 0) {\r\n        return <></>;\r\n    }\r\n    if(me?.className === \"DReference\") {\r\n        const lReference: LReference = me as any;\r\n        const lTarget: LModelElement = MyProxyHandler.wrap(lReference?.type);\r\n        return <>\r\n            {(props.targets) ? props.targets.map((targetNode) => {\r\n                return <Edge source={props.source} target={targetNode} />\r\n            }) : <Edges source={props.source} targets={(lTarget) ? lTarget.nodes : []} />}\r\n        </>;\r\n    }\r\n    if(me?.className === \"DClass\") {\r\n        const lClass: LClass = me as any;\r\n        if(lClass.extends.length > 0) {\r\n            const lTarget: LModelElement = MyProxyHandler.wrap(lClass?.extends[0]);\r\n            return <>\r\n                {(props.targets) ? props.targets.map((targetNode) => {\r\n                    return <Edge source={props.source} target={targetNode} />\r\n                }) : <Edges source={props.source} targets={(lTarget) ? lTarget.nodes : []} />}\r\n            </>;\r\n        }\r\n    }\r\n    return <></>;\r\n}\r\ninterface OwnProps { source: LGraphElement; targets?: LGraphElement[] }\r\ninterface StateProps {}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {};\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const EdgesConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgesComponent);\r\n\r\nexport const Edges = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgesConnected {...{...props, children}} />;\r\n}\r\nexport default Edges;\r\n","import React, {Dispatch, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DEdge,\r\n    DGraph,\r\n    DGraphElement,\r\n    DGraphVertex, Dictionary,\r\n    DVoidVertex, EdgeBendingMode, GObject,\r\n    GraphElementComponent,\r\n    GraphElementDispatchProps,\r\n    GraphElementOwnProps,\r\n    GraphElementReduxStateProps,\r\n    GraphElementStatee, GraphPoint,\r\n    GraphSize,\r\n    DState,\r\n    LClass, LEdge, LGraphElement,\r\n    LModelElement,\r\n    LPointerTargetable,\r\n    LUser,\r\n    LVoidVertex, Overlap,\r\n    RuntimeAccessibleClass,\r\n    U,\r\n    EdgeOwnProps, EdgeStateProps,\r\n    LViewPoint\r\n} from \"../../joiner\";\r\n\r\nlet groupingsize: Dictionary<EdgeBendingMode, number> = {} as any;\r\ngroupingsize[EdgeBendingMode.Line] = 1;\r\ngroupingsize[EdgeBendingMode.Bezier_quadratic] = 2;\r\ngroupingsize[EdgeBendingMode.Bezier_cubic] = 3;\r\ngroupingsize[EdgeBendingMode.Bezier_quadratic_mirrored] = 1;\r\ngroupingsize[EdgeBendingMode.Bezier_cubic_mirrored] = 2;\r\ngroupingsize[EdgeBendingMode.Elliptical_arc] = 2; // (1_coord), (rotation), (sweep    arc), (1_coord)\r\n\r\nconst superclassGraphElementComponent: typeof GraphElementComponent = RuntimeAccessibleClass.classes.GraphElementComponent as any as typeof GraphElementComponent;\r\nconst superclassGraphElementComponentuntyped: any = RuntimeAccessibleClass.classes.GraphElementComponent as any;\r\nclass ThisStatee extends GraphElementStatee {}\r\n\r\nexport class EdgeComponent<AllProps extends AllPropss = AllPropss, ThisState extends ThisStatee = ThisStatee>\r\n    extends superclassGraphElementComponent<AllProps, ThisState> {\r\n    public static cname: string = \"EdgeComponent\";\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n    }\r\n/*\r\n    path(): string {\r\n        let coords = this.pathCoords();\r\n        let svgletter: EdgeBendingMode = (this.props.view.bendingMode || \"L\");\r\n        let strings: string[] = coords.map(gp => gp.x+\" \" + gp.y);\r\n        return \"M\"+strings.join(\" \" + svgletter); }\r\n\r\n    pathCoords(): GraphPoint[] {\r\n        const ret = this.props;\r\n        let svgletter: EdgeBendingMode = (ret).view.bendingMode;\r\n        if (!ret.node) return []; // \"node missing\"\r\n        let coords: GraphPoint[] = (ret.node.midnodes as { x:number, y:number }[] as GraphPoint[]) || [];\r\n        let grouping = groupingsize[svgletter];\r\n        console.log(\"edgeee\", {coords, svgletter, groupingsize, midnodes:ret.node.midnodes, mnraw: ret.node.midnodes.map(mn=>mn.__raw), ret});\r\n        let scoord: GraphPoint = ret.node.startPoint || new GraphPoint(10, 10);\r\n        let ecoord: GraphPoint = ret.node.endPoint || new GraphPoint(100, 100);\r\n        return [scoord, ...coords, ecoord]; }\r\n\r\n    pathSegments(): GraphPoint[][]{\r\n        return U.pairArrayElements(this.pathCoords(), true); }\r\n*/\r\n    render(): ReactNode {\r\n        if (!this.props.node) return \"loading\";\r\n        // set classes\r\n        let nodeType = \"Edge\";\r\n        let classesoverride = [nodeType];\r\n        // set classes end\r\n        let styleoverride: React.CSSProperties = {}\r\n        return super.render(nodeType, styleoverride, classesoverride);\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nclass DispatchProps extends GraphElementDispatchProps {\r\n}\r\n\r\ntype AllPropss = Overlap<Overlap<EdgeOwnProps, EdgeStateProps>, DispatchProps>;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: EdgeOwnProps): EdgeStateProps {\r\n    const ret: EdgeStateProps = new EdgeStateProps();\r\n    // superret.lastSelected = state._lastSelected ? LPointerTargetable.from(state._lastSelected.modelElement) : null;\r\n    ret.isEdgePending = {\r\n        user: LPointerTargetable.from(state.isEdgePending.user),\r\n        source: LPointerTargetable.from(state.isEdgePending.source)\r\n    };\r\n    ret.viewpoint = LViewPoint.fromPointer(state.viewpoint);\r\n    let startnodeid = LGraphElement.getNodeId(ownProps.start);\r\n    let endnodeid = LGraphElement.getNodeId(ownProps.end);\r\n    ret.start = LPointerTargetable.fromPointer(startnodeid);\r\n    ret.end = LPointerTargetable.fromPointer(endnodeid);\r\n    // ret.key = ownProps.key || (startnodeid || (ownProps.start as any)?.id || ownProps.start) + \"~\" + (endnodeid || (ownProps.end as any)?.id || ownProps.end);\r\n    // key is already used as key || nodeid on super.render()\r\n    // console.log(\"edge\", {ret, ownProps});\r\n\r\n    const superret: EdgeStateProps = GraphElementComponent.mapStateToProps(state, ownProps, DEdge, ret) as EdgeStateProps;\r\n    // U.objectMergeInPlace(superret, ret);\r\n    // U.removeEmptyObjectKeys(superret);\r\n    // console.error(superret, ret); throw Error(\"aaa\");\r\n    return superret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const superret: GraphElementDispatchProps = GraphElementComponent.mapDispatchToProps(dispatch);\r\n    const ret: GraphElementDispatchProps = new GraphElementDispatchProps();\r\n    U.objectMergeInPlace(superret, ret);\r\n    U.removeEmptyObjectKeys(superret);\r\n    return superret;\r\n}\r\n\r\n\r\nexport const EdgeConnected = connect<EdgeStateProps, DispatchProps, EdgeOwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgeComponent as any);\r\n\r\nexport const DamEdge = (props: EdgeOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgeConnected {...{...props, children}} isGraph={false} isVertex={true} />;\r\n}\r\n\r\nEdgeComponent.cname = \"EdgeComponent\";\r\nEdgeConnected.cname = \"EdgeConnected\";\r\nDamEdge.cname = \"DamEdge\";\r\n","import {OCLEditorAce} from \"../components/forEndUser/OCLEditor\";\r\n\r\nexport {OclEditor} from \"../components/rightbar/oclEditor/OclEditor\";\r\nexport {OCLEditorAce} from \"../components/forEndUser/OCLEditor\"\r\n\r\n\r\nexport {Input} from \"../components/forEndUser/Input\";\r\nexport {TextArea} from \"../components/forEndUser/TextArea\";\r\nexport {Select} from \"../components/forEndUser/Select\";\r\nexport {Image} from \"../components/forEndUser/Image\";\r\nexport {Edge} from \"../components/forEndUser/Edge\";\r\n\r\n\r\nexport {DataOutputComponent} from \"../components/logger/DataOutput\";\r\nexport {LoggerComponent} from \"../components/logger/loggerComponent\";\r\n\r\n/// import components that must save themselves to global variable to be accessible for user\r\n\r\nexport {Overlap} from \"../components/forEndUser/Overlap\";\r\nexport {ColorScheme} from \"../components/colorScheme/colorScheme\";\r\nexport {GraphElement, GraphElementComponent} from \"../graph/graphElement/graphElement\";\r\n// export {Graph, GraphComponent} from \"../graph/graph/graph\"; // require graphelement\r\n// export {Graph} from \"../graph/vertex/Vertex\"; // require graphelement\r\nexport {DefaultNode, DefaultNodeComponent} from \"../graph/defaultNode/DefaultNode\"; // require graphelement\r\nexport {Graph, Vertex, VoidVertex, GraphVertex, Field, EdgePoint, VertexComponent} from \"../graph/vertex/Vertex\"; // require overlap, graphelement\r\nexport {GraphsContainer, GraphsContainerComponent} from \"../graph/graph/graphContainer\"; // require vertex, graph\r\n//export {DockLayoutComponent} from \"../components/abstract/DockLayoutComponent\";\r\nexport {Edges} from \"../graph/edge/Edges\";\r\nexport {DamEdge, EdgeComponent,} from \"../graph/damedges/damedge\";\r\n\r\n\r\n\r\n\r\nconsole.info('components loaded');\r\n","// import * as detectzoooom from 'detect-zoom'; alternative: https://www.npmjs.com/package/zoom-level\r\nimport React, {ReactElement} from \"react\";\r\n// import {Mixin} from \"ts-mixer\";\r\nimport type {AbstractConstructor, Constructor, Dictionary, GObject, Pointer, Temporary} from \"../joiner\";\r\nimport {\r\n    CreateElementAction,\r\n    DAttribute,\r\n    DClassifier,\r\n    DLog,\r\n    DModelElement,\r\n    DPointerTargetable,\r\n    DRefEdge,\r\n    DReference,\r\n    GraphPoint,\r\n    DState,\r\n    DUser,\r\n    LUser,\r\n    Json,\r\n    JsType,\r\n    LClassifier,\r\n    LGraphElement,\r\n    LModelElement,\r\n    LNamedElement,\r\n    LogicContext,\r\n    MyError,\r\n    RuntimeAccessible,\r\n    Selectors,\r\n    TODO,\r\n    windoww, RuntimeAccessibleClass\r\n} from \"../joiner\";\r\nimport Swal from \"sweetalert2\";\r\n// import KeyDownEvent = JQuery.KeyDownEvent; // https://github.com/tombigel/detect-zoom broken 2013? but works\r\n\r\nconsole.warn('loading ts U log');\r\n\r\n\r\n@RuntimeAccessible\r\nexport class U {\r\n    static cname: string = \"U\";\r\n\r\n    public static getFromEnvironment(variable: string): string|number|boolean {\r\n        const value = process.env['REACT_APP_' + variable.toUpperCase()];\r\n        if(value !== undefined) return value;\r\n        return 0;\r\n    }\r\n\r\n    public static fatherChain(me: LModelElement): Pointer<DModelElement, 0, 'N', LModelElement> {\r\n        if(!me) return [];  // without this line go through delete error\r\n        const fathers: Pointer<DModelElement, 0, 'N', LModelElement>= [me.id];\r\n        const toCheck: LModelElement[] = [me];\r\n        while(toCheck.length > 0) {\r\n            const element = toCheck.pop();\r\n            if(element && element.father) {\r\n                fathers.push(element.father.id);\r\n                toCheck.push(element.father);\r\n            }\r\n        }\r\n        return fathers;\r\n    }\r\n\r\n    public static deepEqual (x: GObject, y: GObject): boolean {\r\n        const ok = Object.keys, tx = typeof x, ty = typeof y;\r\n        return x && y && tx === 'object' && tx === ty ? (\r\n            ok(x).length === ok(y).length &&\r\n            ok(x).every(key => U.deepEqual(x[key], y[key]))\r\n        ) : (x === y);\r\n    }\r\n\r\n    public static sleep(s: number): Promise<void> {\r\n        return new Promise((resolve) => setTimeout(resolve, s * 1000));\r\n    }\r\n\r\n    public static getDefaultViewsID(): string[] {\r\n        const views: string[] = []\r\n        views.push('Pointer_ViewModel');\r\n        views.push('Pointer_ViewPackage');\r\n        views.push('Pointer_ViewClass');\r\n        views.push('Pointer_ViewEnum');\r\n        views.push('Pointer_ViewAttribute');\r\n        views.push('Pointer_ViewReference');\r\n        views.push('Pointer_ViewOperation');\r\n        views.push('Pointer_ViewLiteral');\r\n        views.push('Pointer_ViewObject');\r\n        views.push('Pointer_ViewValue');\r\n        views.push('Pointer_ViewDefaultPackage');\r\n        return views;\r\n    }\r\n\r\n\r\n    public static getRandomString(length: number): string {\r\n        const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\r\n        let randomString = '';\r\n        let index = 0;\r\n        while(index < length) {\r\n            const randomNumber = Math.floor(Math.random() * characters.length);\r\n            randomString += characters.charAt(randomNumber);\r\n            index += 1;\r\n        }\r\n        return randomString;\r\n    }\r\n\r\n    public static alert(title: string, text: string) {\r\n        let color = 'text-';\r\n        switch(title.toLowerCase()) {\r\n            case 'error': color += 'danger'; break;\r\n            default: color += 'primary'\r\n        }\r\n        let html = '<style>body.swal2-no-backdrop .swal2-container {background-color: rgb(0 0 0 / 60%) !important}</style>';\r\n        html += `<div><b><label class='fs-5 mb-2 text-uppercase ${color}'>${title}</label></b><hr/>`;\r\n        html += `<label class='fs-6 mt-3'>${text}</label><br/>`;\r\n        const result = Swal.fire({\r\n            html: html,\r\n            backdrop: false,\r\n            showCloseButton: true,\r\n            showConfirmButton: false\r\n            //confirmButtonText: 'GOT IT'\r\n        })\r\n    }\r\n\r\n    public static popup(element: any) {\r\n        let html = '<style>body.swal2-no-backdrop .swal2-container {background-color: rgb(0 0 0 / 60%) !important}</style>'+ element;\r\n        const result = Swal.fire({\r\n            html: html,\r\n            backdrop: false,\r\n            showCloseButton: true,\r\n            showConfirmButton: false\r\n            //confirmButtonText: 'GOT IT'\r\n        })\r\n    }\r\n    public static filteredPointedBy(data: LModelElement, label: string): LModelElement[] {\r\n        const models: LModelElement[] = [];\r\n        for(let dict of data.pointedBy) {\r\n            const pointedBy = dict.source.split('.');\r\n            if(pointedBy.length === 3 && pointedBy[2] === label) {\r\n                models.push(LModelElement.fromPointer(pointedBy[1]));\r\n            }\r\n        }\r\n        return models;\r\n    }\r\n\r\n    public static getFatherFieldToDelete(data: LModelElement): keyof DModelElement|null {\r\n        const father = data.father;\r\n        let field = '';\r\n        switch(father.className + '|' + data.className) {\r\n            // DPackage\r\n            case 'DModel|DPackage': field = 'packages'; break;\r\n            case 'DPackage|DPackage': field = 'subpackages'; break;\r\n            // DEnumerator and DClass\r\n            case 'DPackage|DEnumerator':\r\n            case 'DPackage|DClass': field = 'classifiers'; break;\r\n            // DAttribute\r\n            case 'DClass|DAttribute': field = 'attributes'; break;\r\n            // DReference\r\n            case 'DClass|DReference': field = 'references'; break;\r\n            // DOperation\r\n            case 'DClass|DOperation': field = 'operations'; break;\r\n            // DEnumLiteral\r\n            case 'DEnumerator|DEnumLiteral': field = 'literals'; break;\r\n            // DObject\r\n            case 'DModel|DObject': field = 'objects'; break;\r\n            // DParameter\r\n            case 'DOperation|DParameter': field = 'parameters'; break;\r\n            // DValue\r\n            case 'DObject|DValue': field = 'features'; break;\r\n            // Error\r\n            default: return null;\r\n        }\r\n        return field as keyof DModelElement;\r\n    }\r\n\r\n    public static getReduxFieldToDelete(data: LModelElement): keyof DState|null {\r\n        let field = '';\r\n        switch(data.className) {\r\n            // DPackage\r\n            case 'DPackage': field = 'packages'; break;\r\n\r\n            // DClass\r\n            case 'DClass': field = 'classs'; break;\r\n            // DEnumerator\r\n            case 'DEnumerator': field = 'enumerators'; break;\r\n            // DAttribute\r\n            case 'DAttribute': field = 'attributes'; break;\r\n            // DReference\r\n            case 'DReference': field = 'references'; break;\r\n            // DOperation\r\n            case 'DOperation': field = 'operations'; break;\r\n            // DParameter\r\n            case 'DParameter': field = 'parameters'; break;\r\n            // DEnumLiteral\r\n            case 'DEnumLiteral': field = 'enumliterals'; break;\r\n            // DObject\r\n            case 'DObject': field = 'objects'; break;\r\n            // DValue\r\n            case 'DValue': field = 'values'; break;\r\n\r\n            // Error\r\n            default: return null;\r\n        }\r\n        return field as keyof DState;\r\n    }\r\n\r\n    public static initializeValue(typeclassifier: undefined|DClassifier|LClassifier|Pointer<DClassifier, 1, 1, LClassifier>): string {\r\n        // if(!classifier) return 'null';\r\n        const pointer: Pointer = typeof typeclassifier === 'string' ? typeclassifier : (typeclassifier as DClassifier)?.id;\r\n        const me: LNamedElement = LNamedElement.fromPointer(pointer);\r\n        switch(me?.name) {\r\n            default:\r\n            case 'EString': return '';\r\n            case 'EChar':  return 'a';\r\n            case 'EInt': return '0';\r\n            case 'ELong': return '0';\r\n            case 'EShort': return '0';\r\n            case 'Byte': return '0';\r\n            case 'EFloat': return '0';\r\n            case 'EDouble': return '0';\r\n            case 'EBoolean': return 'false';\r\n            case 'EDate': return new Date().toJSON().slice(0,10);\r\n        }\r\n        return 'null';\r\n    }\r\n\r\n    public static orderChildrenByTimestamp(context: LogicContext): LModelElement[] {\r\n        const children = context.proxyObject.children;\r\n        if(children && children.length > 0) {\r\n            let orderedChildren = new Map<number, LModelElement>();\r\n            for(let child of children) {\r\n                let timestamp = child.id.slice(-13);\r\n                orderedChildren.set(+timestamp, child);\r\n            }\r\n            orderedChildren = new Map([...orderedChildren.entries()].sort());\r\n            return [...orderedChildren.values()];\r\n        } else return [];\r\n    }\r\n\r\n\r\n    public static followPath(base: GObject, path: string): {chain: GObject[], lastObject: GObject, keys:string[], lastkey: string, lastval: any, failedRemainingPath: string[]} {\r\n        let patharr = path.split('.');\r\n        let base0 = base;\r\n        let ret: {chain: GObject[], lastObject: GObject, keys: string[], lastkey: string, lastval: any, failedRemainingPath: string[]}  = {} as any;\r\n        ret.keys = patharr;\r\n        ret.chain = [base];\r\n        let lastObject = base;\r\n\r\n        for (let i = 0; i < patharr.length; i++) {\r\n            let path = ret.lastkey = patharr[i];\r\n            lastObject = base;\r\n            base = base[path];\r\n            ret.chain.push(base);\r\n            if (typeof base !== \"object\" || i + 1 === patharr.length) {\r\n                ret.failedRemainingPath = patharr.slice(i);\r\n                ret.lastval = base;\r\n                ret.lastObject = lastObject;\r\n                return ret;\r\n            }\r\n        }\r\n        throw new Error(\"followPath should never reach here\");\r\n        return ret;\r\n    }\r\n\r\n    static multiReplaceAllKV(a: string, kv: string[][] = []): string {\r\n        const keys: string[] = [];\r\n        const vals: string[] = [];\r\n        let i: number;\r\n        for (i = 0; i < kv.length; i++) { keys.push(kv[i][0]); vals.push(kv[i][0]); }\r\n        return U.multiReplaceAll(a, keys, vals); }\r\n\r\n    static multiReplaceAll(a: string, searchText: string[] = [], replacement: string[] = []): string {\r\n        Log.ex(searchText.length !== replacement.length, 'search and replacement must be have same length: ' + searchText.length + \"vs\" + replacement.length + \" \" +JSON.stringify(searchText) + \"   \" + JSON.stringify(replacement));\r\n        let i = -1;\r\n        while (++i < searchText.length) { a = U.replaceAll(a, searchText[i], replacement[i]); }\r\n        return a; }\r\n\r\n    static replaceAll(str: string, searchText: string, replacement: string, debug: boolean = false, warn: boolean = true): string {\r\n        if (!str) { return str; }\r\n        return str.split(searchText).join(replacement); }\r\n\r\n    static toFileName(a: string = 'nameless.txt'): string {\r\n        if (!a) { a = 'nameless.txt'; }\r\n        a = U.multiReplaceAll(a.trim(), ['\\\\', '//', ':', '*', '?', '<', '>', '\"', '|'],\r\n            ['[lslash]', '[rslash]', ';', '°', '_', '{', '}', '\\'', '!']);\r\n        return a;\r\n    }\r\n\r\n\r\n    // warn: this check if the scope containing the function is strict, to check if a specific external scope-file is strict\r\n    // you have to write inline the code:        var isStrict = true; eval(\"var isStrict = false\"); if (isStrict)...\r\n    // @ts-ignore\r\n    public static isStrict: boolean = ( function() { return !this; })();\r\n\r\n    // merge properties with first found first kept (first parameters have priority on override). only override null|undefined values, not (false|0|'') values\r\n    static objectMergeInPlace<A extends object, B extends object>(output: A, ...objarr: B[]): void {\r\n        const out: GObject = output;\r\n        for (let o of objarr) for (let key in o) {\r\n            // noinspection BadExpressionStatementJS,JSUnfilteredForInLoop\r\n            out[key] ?? (out[key] = o[key]);\r\n        }\r\n    }\r\n\r\n    public static log(log: any) {\r\n        console.clear();\r\n        console.log(\"###\", log);\r\n    }\r\n\r\n    static removeEmptyObjectKeys(obj: GObject): void{\r\n        for (let key of Object.keys(obj)) {\r\n            if (obj[key] === null || obj[key] === undefined) delete obj[key];\r\n        }\r\n    }\r\n\r\n    // usage example: objectMergeInPlace_conditional(baseobj, (out, key, current) => !out[key] && current[key];\r\n    // culprit of \"couldn't find intersection\" problem: condition type: (out:A&B, key: string | number, current:B, objarr?: B[], indexOfCurrent?: number) => boolean\r\n    static objectMergeInPlace_conditional<A extends GObject, B extends GObject>(output: A, condition: (...a:any)=>any, ...objarr: B[]): A & B {\r\n        const out: GObject<\"A & B\"> = output;\r\n        let i: number = 0;\r\n        for (let o of objarr) for (let key in o) { if (condition(out, key, o, objarr, i++)) out[key] = o[key]; }\r\n        return out as  A & B; }\r\n\r\n    static buildFunctionDocumentation(f: Function): {parameters: {name: string, defaultVal: string | undefined, typedesc: string | null}[], returns: string | undefined, f: Function, fname: string | undefined, isLambda: boolean, signature: string} {\r\n        Log.e(!JsType.isFunction(f), 'getFunctionSignature() parameter must be a function');\r\n        // let parameters: {name: string, defaultVal: string, typedesc: string}[] = []; //{name: '', defaultVal: undefined, typedesc: ''};\r\n        let ret: {parameters: {name: string, defaultVal: string | undefined, typedesc: string | null}[], returns: string | undefined, f: Function, fname: string | undefined, isLambda: boolean, signature: string}\r\n            = {parameters: [], returns: undefined, f: f, fname: undefined, isLambda: null as Temporary, signature: ''};\r\n        let str: string = f.toString();\r\n        let starti: number = str.indexOf('(');\r\n        let endi: number;\r\n        let parcounter: number = 1;\r\n        for (endi = starti + 1; endi < str.length; endi++) {\r\n            if (str[endi] === ')' && --parcounter === 0) break;\r\n            if (str[endi] === '(') parcounter++; }\r\n\r\n        let parameterStr = str.substring(starti + 1, endi);\r\n        // console.log('getfuncsignature starti:', starti, 'endi', endi, 'fname:', str.substr(0, starti), 'parameterStr:', parameterStr);\r\n        ret.fname = str.substr(0, starti).trim();\r\n        ret.fname = ret.fname.substr(0, ret.fname.indexOf(' ')).trim();\r\n        // 2 casi: anonimo \"function (par1...){}\" e \"() => {}\", oppure nominato: \"function a1(){}\"\r\n        if (ret.fname === '' || ret.fname === 'function') ret.fname = undefined; // 'anonymous function';\r\n\r\n\r\n\r\n        let returnstarti: number = str.indexOf('/*', endi + 1);\r\n        let returnendi: number = -1;\r\n        let bodystarti: number = str.indexOf('{', endi + 1);\r\n        if (returnstarti === -1 || bodystarti !== -1 && bodystarti < returnstarti) {\r\n            // no return type or comment is past body\r\n            ret.returns = undefined;\r\n        } else {\r\n            returnendi = str.indexOf('*/', returnstarti + 2);\r\n            ret.returns = str.substring(returnstarti + 2, returnendi).trim();\r\n            bodystarti = str.indexOf('{', returnendi); }\r\n        if (ret.returns === '') ret.returns = undefined;\r\n\r\n        // is lambda if do not have curly body or contains => between return comment and body\r\n        // console.log('isLambda:', bodystarti, str.substring(Math.max(endi, returnendi)+1, bodystarti));\r\n        ret.isLambda =  bodystarti === -1 || str.substring((window as any).Math.max(endi, returnendi)+1, bodystarti).trim() === '=>';\r\n\r\n        let regexp = /([^=\\/\\,]+)(=?)([^,]*?)(\\/\\*[^,]*?\\*\\/)?,/g; // only problem: the last parameter won't match because it does not end with \",\", so i will append it everytime.\r\n        let match;\r\n        while ((match = regexp.exec(parameterStr + ','))) {\r\n            // match[0] is always the full match (not a capture group)\r\n            // match[2] can only be \"=\" or empty string\r\n            // nb: match[4] can be \"/*something*/\" or \",\" a single , without spaces.\r\n            let par: {name: string, defaultVal: string | undefined, typedesc: string | null} = {name: match[1], defaultVal: match[3], typedesc: match[4] && match[4].length > 1 ? match[4] : null};\r\n            par.name = par.name.trim();\r\n            par.defaultVal = par.defaultVal ? par.defaultVal.trim() : undefined;\r\n            par.typedesc = par.typedesc && par.typedesc && par.typedesc.length > 1 ? par.typedesc.substring(2, par.typedesc.length - 2).trim() || null : null;\r\n            ret.parameters.push(par); }\r\n        // set signature\r\n\r\n        ret.signature = '' + (ret.fname ? '/*' + ret.fname + '*/' : '') + '(';\r\n        let i: number;\r\n        for (i = 0; i < ret.parameters.length; i++) {\r\n            let par = ret.parameters[i];\r\n            ret.signature += (i === 0 ? '' : ', ') + par.name + (par.typedesc ? '/*' + par.typedesc + '*/' : '') + (par.defaultVal ? ' = ' + par.defaultVal : '');\r\n        }\r\n        ret.signature += ')' + (ret.returns ? '/*' + ret.returns + '*/' : '');\r\n        return ret; }\r\n\r\n    // warn: if return is not explicitly inserted (if that's the case set imlicitReturn = false) with a scope and the code have multiple statemepts it will fail.\r\n    // can modify scope AND context\r\n    // warn: can access external scope (from the caller)\r\n    // if the context (this) is missing it will take the scope as context.\r\n    // warn: cannot set different scope and context, \"this\" della funzione sovrascrive anche il \"this\" interno allo scope come chiave dell'oggetto\r\n    // warn: if you modify\r\n    public static evalInContextAndScope<T = any>(codeStr: string, scope0?: GObject, context0?: GObject): T {\r\n        // console.log('evalInContextAndScope', {codeStr, scope, context});\r\n        // scope per accedere a variabili direttamente \"x + y\"\r\n        // context per accedervi tramite this, possono essere impostati come diversi.\r\n        if (!scope0 && !context0) { Log.ex(true, 'evalInContextAndScope: must specify at least one of scope || context', {codeStr, scope0, context0}); }\r\n\r\n        // scope.this = scope.this || context || scope; non funziona\r\n        // console.log('\"with(this){ return eval( \\'\" + codeStr + \"\\' ); }\"', \"with(this){ return eval( '\" + codeStr + \"' ); }\");\r\n        // eslint-disable-next-line no-restricted-syntax,no-with\r\n        // if (allowScope && allowContext) { return function(){ with(this){ return eval( '\" + codeStr + \"' ); }}.call(scopeAndContext); }\r\n        // if (allowScope && allowContext) { return new Function( \"with(this){ return eval( '\" + codeStr + \"' ); }\").call(scopeAndContext); }\r\n        let _ret: T = null as any;\r\n        console.log(\"pre eval 0\", {scope0, sproto: scope0?.__proto__, context0, cproto: context0?.__proto__});\r\n        let scope: GObject | undefined;\r\n        let context: GObject | undefined;\r\n        if (scope0) { scope = {...scope0, __proto__: scope0.__proto__}; scope.__proto__ = scope0.__proto__; } else scope = undefined;\r\n        if (context0) { context = {...context0, __proto__: context0.__proto__}; context.__proto__ = context0.__proto__; } else context = undefined;\r\n        if (!context) context = scope; // se creo un nuovo contesto pulisco anche lo scope dalle variabili locali di questa funzione.\r\n        const _eval = {codeStr, context, scope};\r\n        console.log(\"pre eval 1\", {scope, sproto: scope?.__proto__, context, cproto: context?.__proto__});\r\n\r\n\r\n        /*\r\n        if (allowScope && allowContext) { return new Function( \"with(this){ return eval( '\" + codeStr.replace(/'/g, \"\\\\'\") + \"' ); }\").call(scopeAndContext); }\r\n        if (!allowScope && allowContext) { return new Function( \"return eval( '\" + codeStr + \"' );\").call(scopeAndContext); }\r\n        if (allowScope && !allowContext) { return eval(\"with(scopeAndContext){ \" + codeStr + \" }\"); }*/\r\n//      U.pe(!!scope && U.isStrict(), 'cannot change scope while in strict mode (\"use strict\")');\r\n        let prefixDeclarations: string = \"\", postfixDeclarations: string = '';\r\n        if (scope) {\r\n            if (U.isStrict) {\r\n                for (let key in scope) {\r\n                    key = key.trim();\r\n                    if (!key) continue;\r\n                    // anche se li assegno non cambiano i loro valori nel contesto fuori dall'eval, quindi lancio eccezioni con const.\r\n                    prefixDeclarations += \"const \" + key + \" = this.\" + key + \"; \";\r\n                    postfixDeclarations = \"\";\r\n                }\r\n            } else {\r\n                prefixDeclarations = \"with(\" + (context ? \"this._eval.\" : \"\") + \"scope){ \";\r\n                postfixDeclarations = \" }\";\r\n            }\r\n        }\r\n        if (scope && context) {\r\n            (context as any)._eval = _eval;\r\n            console.log('pre eval jsx SC:', context, 'body:', {codeStr, Input: windoww.Input, _eval,\r\n                f:prefixDeclarations + \"return eval( \" + codeStr + \" );\" + postfixDeclarations});\r\n            _ret = new (Function as any)(prefixDeclarations + \"return eval( \" + codeStr + \" );\" + postfixDeclarations).call(context);\r\n            delete (context as any)._eval; } else\r\n        if (!scope && context) {\r\n            console.log('pre eval jsx C:', {context, codeStr, Input: windoww.Input, _eval,\r\n                f:new (Function as any)(prefixDeclarations + \"return eval( this._eval.codeStr );\" + postfixDeclarations)});\r\n            _ret = new (Function as any)( \"return eval( this._eval._codeStr );\").call(context); } else\r\n        if (scope && !context) {\r\n            console.log('pre eval jsx S:', context, 'body:', {codeStr, Input: windoww.Input, _eval,\r\n                f:new (Function as any)(prefixDeclarations + \"return eval( this._eval.codeStr );\" + postfixDeclarations)});\r\n            // NB: potrei creare lo scope con \"let key = value;\" per ogni chiave, ma dovrei fare json stringify e non è una serializzazione perfetta e può dare eccezioni(circolarità)\r\n            // console.log({isStrict: U.isStrict, eval: \"eval(\" + prefixDeclarations + codeStr + postfixDeclarations + \")\"});\r\n            _ret = eval(prefixDeclarations + codeStr + postfixDeclarations); }\r\n        return _ret; }\r\n\r\n    //T extends ( ((...args: any[]) => any) | (() => any)\r\n    public static execInContextAndScope<T extends (...args: any) => any>(func: T, parameters: Parameters<T>, scope?: GObject, context?: GObject): ReturnType<T>{\r\n        Log.l(false, 'execInCtxScope', {func, parameters, scope, context});\r\n        let ret: any;\r\n        const _eval = {context, scope, func, parameters: parameters || []};\r\n        let prefixDeclarations: string = \"\", postfixDeclarations: string = '';\r\n        if (scope) {\r\n            if (U.isStrict) {\r\n                for (let key in scope) {\r\n                    // anche se li assegno non cambiano i loro valori nel contesto fuori dall'eval, quindi lancio eccezioni con const.\r\n                    prefixDeclarations += \"const \" + key + \" = this.\" + key + \"; \";\r\n                    postfixDeclarations = \"\";\r\n                }\r\n            } else {\r\n                prefixDeclarations = \"with(\" + (context ? \"this._eval.\" : \"\") + \"scope){ \";\r\n                postfixDeclarations = \" }\";\r\n            }\r\n        }\r\n        if (!scope && !context) { Log.ex(true, 'execInContextAndScope: must specify at least one of scope || context', {func, scope, context}); }\r\n        if (!context) context = scope; // se creo un nuovo contesto pulisco anche lo scope dalle variabili locali di questa funzione.\r\n        if (scope && context) {\r\n            context._eval = _eval;\r\n            // will the scope work with \"with\" outside the function body?\r\n            ret = new Function( prefixDeclarations + \"return this._eval.func.apply(this._eval.context, this._eval.parameters);\" + postfixDeclarations).call(context);\r\n            delete context._eval;\r\n        }\r\n        if (!scope && context) { return _eval.func.apply(_eval.context, _eval.parameters); }\r\n        if (scope && !context) {\r\n            // todo: non credo funzioni, _eval non dovrebbe essere accessibile dopo la \"with\" forse devo fare scope._eval = _eval;\r\n            return eval(prefixDeclarations + \"return _eval.func(..._eval.parameters);\" + postfixDeclarations); }\r\n        return ret; }\r\n\r\n    // warn: aggiunge un layer di scope ma ha accesso anche agli scope precedenti (del chiamante della funzione e superiori)\r\n    // warn2: può modificare lo scope internamente all'eval ma ogni cambiamento è perso all'uscita dell'esecuzione (modifica copie)\r\n    // warn3: gli oggetti nested variabili dentro oggetti dello scope) sono modificabili con modifiche persistenti perchè vengono pasate per puntatore.\r\n    // warn4: richiede un return per leggere il valore\r\n    // insomma: sta funzione fa schifo ma non c'è di meglio e non puoi nè permettere nè vietare completamente le modifiche allo scope.\r\n    private static execInScope_DO_NOT_USE(codeStr: string, scope: GObject) {\r\n        return (new Function(...Object.keys(scope), codeStr))(...Object.values(scope));\r\n    }\r\n\r\n    // can modify context in-place, requires \"this\" before variable\r\n    private static evalInContext(js: string, context: GObject): unknown {\r\n        //# Return the results of the in-line anonymous function we .call with the passed context\r\n        return function() { return eval(js); }.call(context);\r\n    }/*\r\n    / *\r\n    // NO: ha 2 problemi: il contesto non è persistente e puoi accedere al contesto solo con \"this\" ma non direttamente usando i nomi delle variabili\r\n    public static evalInContext(contextObj: GObject, code: string): any{\r\n        return U.evalContextFunction.call(contextObj || {}, code);\r\n    }\r\n\r\n    // only create a context for \"this\", wich is bound by .call(), should never be called without .call()\r\n    private static evalContextFunction(code: string): any { eval(code); }\r\n*/\r\n    public static highOrderFunctionExampleTyped<T extends (...args: any[]) => ReturnType<T>>(func: T): (...funcArgs: Parameters<T>) => ReturnType<T> {\r\n        const funcName = (func as any).cname || func.name;\r\n\r\n        // Return a new function that tracks how long the original took\r\n        return (...args: Parameters<T>): ReturnType<T> => {\r\n            console.time(funcName);\r\n            const results = func(...args);\r\n            console.timeEnd(funcName);\r\n            return results; };\r\n    }\r\n\r\n    static asClass<T extends Function>(obj: any, classe: T, elseReturn: T | null = null): null | T { return obj instanceof classe ? obj as any as T: elseReturn; }\r\n    static asString<T>(propKey: unknown, elseReturn: T | null = null): string | null | T { return typeof propKey === 'string' ? propKey : elseReturn; }\r\n    static isString(propKey: unknown): boolean { return typeof propKey === 'string'; }\r\n\r\n    static loadScript(path: string, useEval: boolean = false): void {\r\n        const script = document.createElement('script');\r\n        script.src = path;\r\n        script.type = 'text/javascript';\r\n        Log.eDev(useEval, 'loadScript', 'useEval','useEval todo. potrebbe essere utile per avviare codice fuori dalle funzioni in futuro.');\r\n        document.body.append(script); }\r\n\r\n    static ancestorArray<T extends Element>(domelem: T, stopNode?: Node, includeSelf: boolean = true): Array<T> {\r\n        // [0]=element, [1]=father, [2]=grandfather... [n]=document\r\n        if (domelem === null || domelem === undefined) { return []; }\r\n        const arr = includeSelf ? [domelem] : [];\r\n        let tmp: T = domelem.parentNode as T;\r\n        while (tmp !== null && tmp !== stopNode) {\r\n            arr.push(tmp);\r\n            tmp = tmp.parentNode as T; }\r\n        return arr; }\r\n\r\n    static toHtml<T extends Element>(html: string, container?: Element, containerTag: string = 'div'): T {\r\n        if (!container) { container = document.createElement(containerTag); }\r\n        Log.e(!html || html === '', 'toHtml', 'require a non-empty string', html);\r\n        container.innerHTML = html;\r\n        const ret: T = container.firstChild as any;\r\n        if (ret) container.removeChild(ret);\r\n        return ret; }\r\n\r\n    public static levenshtein(a: string, b: string): number {\r\n        if (!a.length) return b.length;\r\n        if (!b.length) return a.length;\r\n        let cost = (a.charAt(a.length - 1) === b.charAt(b.length - 1)) ? 0 : 1;\r\n        return (window as any).Math.min(\r\n            U.levenshtein(a.substring(0, a.length - 1), b) + 1,\r\n            U.levenshtein(a, b.substring(0, b.length - 1)) + 1,\r\n            U.levenshtein(a.substring(0, a.length - 1), b.substring(0, b.length - 1)) + cost,\r\n        );\r\n    }\r\n\r\n    public static getClosestPropertyName(names: string[], name: string): string {\r\n        let lowest = Infinity;\r\n        return names.reduce(function(previous, current) {\r\n            let distance = U.levenshtein(current, name);\r\n            if (distance < lowest) {\r\n                lowest = distance;\r\n                return current;\r\n            }\r\n            return previous;\r\n        }, '');\r\n    }\r\n    public static getClosestPropertyNames(names: string[], name: string): string[] {\r\n        let distances: {distance: number, value: string}[] = names.map( value => { return {distance: U.levenshtein(value, name), value}; });\r\n        return distances.sort( (a, b) => a.distance - b.distance).map( e => e.value);\r\n    }\r\n\r\n    //todo for console\r\n    public static autoCorrectProxy<T extends GObject>(target: T, recursive: boolean, logger: Console): ProxyHandler<T> {\r\n        return new Proxy(target, {\r\n            get: function(target, name) {\r\n                let namestr = U.asString(name, null);\r\n                if (!namestr) return undefined;\r\n                if (name in target) return target[namestr];\r\n                const suggestions: string[] = U.getClosestPropertyNames(Object.getOwnPropertyNames(target), namestr);\r\n                logger.warn(`${namestr} is not defined, did you meant ${suggestions[0]}?\\t\\nother suggestions:`, suggestions);\r\n                return namestr && target[suggestions[0]];\r\n            },\r\n        });\r\n    }\r\n\r\n    static arrayRemoveAll<T>(arr: Array<T>, elem: T, debug: boolean = false): void {\r\n        let index;\r\n        if (!arr) return;\r\n        while (true) {\r\n            index = arr.indexOf(elem);\r\n            Log.l(debug, 'ArrayRemoveAll: index: ', index, '; arr:', arr, '; elem:', elem);\r\n            if (index === -1) { return; }\r\n            arr.splice(index, 1);\r\n            Log.l(debug, 'ArrayRemoveAll RemovedOne:', arr);\r\n        }\r\n    }\r\n\r\n    static arrayUnique<T>(arr: T[]): Array<T> { return [ ...new Set<T>(arr)]; }\r\n\r\n    static fileReadContent(file: File, callback: (content :string) => void): void {\r\n        const textType = /text.*/;\r\n        try { if (!file.type || file.type.match(textType)) {\r\n            let reader = new FileReader();\r\n            reader.onload = function(e) { callback( '' + reader.result ); };\r\n            reader.readAsText(file);\r\n            return;\r\n        } } catch(e) { Log.e(true, \"Exception while trying to read file as text. Error: |\", e, \"|\", file); }\r\n        Log.e(true, \"Wrong file type found: |\", file ? file.type : null, \"|\", file); }\r\n\r\n    static fileRead(onChange: (e: Event, files: FileList | null, contents?: string[]) => void, extensions: string[] | FileReadTypeEnum[], readContent: boolean): void {\r\n        // $(document).on('change', (e) => console.log(e));\r\n        console.log(\"importEcore: pre file reader\");\r\n        myFileReader.show(onChange, extensions, readContent);\r\n    }\r\n\r\n    public static clear(htmlNode: Element): void {\r\n        if (htmlNode) while (htmlNode.firstChild) { htmlNode.removeChild(htmlNode.firstChild); }\r\n    }\r\n\r\n    static clearAllTimeouts(): void {\r\n        const highestTimeoutId: number = setTimeout(() => {}, 1) as any;\r\n        for (let i = 0 ; i < highestTimeoutId ; i++) { clearTimeout(i); }\r\n    }\r\n\r\n    static getStackTrace(sliceCalls: number = 2): string[] {\r\n        const ret: string | undefined = Error().stack;\r\n        // try { var a = {}; a.debug(); } catch(ex) { ret = ex.stack; }\r\n        // if (Array.isArray(ret)) return ret;\r\n        if (!ret) return ['UnknownStackTrace'];\r\n        const arr: string[] = ret.split('\\n');\r\n        // first 2 entries are \"Erorr\" and \"getStackTrace()\"\r\n        return sliceCalls > 0 ? arr.slice( sliceCalls ) : arr; }\r\n\r\n    // 0 for caller, 1 for caller of caller, -1 for current function, up to -4 to see internal layers (useless)\r\n    public static getCaller(stacksToSkip: number = 0): string {\r\n        const stack: string[] = this.getStackTrace(4);\r\n        // erase getStackTrace() and isFirstTimeCalled() + Error() first stack + n° of layer the caller wants.\r\n        return stack[stacksToSkip]; }\r\n\r\n    private static gotcalledby: Dictionary<string, boolean> = {};\r\n\r\n    // todo: use in Log.once\r\n    // returns true only the first time this line is reached, false in loops >1 loop, false in recursion >1 recursion, false even days after the first execution unless the page is reloaded\r\n    public static isFirstTimeCalledByThisLine(stacksToSkip: number = 0): boolean {\r\n        const caller: string = this.getCaller(stacksToSkip);\r\n        if (U.gotcalledby[caller]) return false;\r\n        return U.gotcalledby[caller] = true; }\r\n\r\n    public static lineKey(): string { return this.getCaller(0); }\r\n\r\n    // Prevent the backspace key from navigating back.\r\n    static preventBackSlashHistoryNavigation(event: JQuery.KeyDownEvent): boolean {\r\n        if (!event || !event.key || event.key.toLowerCase() !== 'backspace') { return true; }\r\n        const types: string[] = ['text', 'password', 'file', 'search', 'email', 'number', 'date',\r\n            'color', 'datetime', 'datetime-local', 'month', 'range', 'search', 'tel', 'time', 'url', 'week'];\r\n        const srcElement: JQuery<any> = $((event as any)['srcElement'] || event.target);\r\n        const disabled = srcElement.prop('readonly') || srcElement.prop('disabled');\r\n        if (!disabled) {\r\n            if (srcElement[0].isContentEditable || srcElement.is('textarea')) { return true; }\r\n            if (srcElement.is('input')) {\r\n                const type = srcElement.attr('type');\r\n                if (!type || types.indexOf(type.toLowerCase()) > -1) { return true; }\r\n            }\r\n        }\r\n        event.preventDefault();\r\n        return false; }\r\n\r\n    static SetMerge<T>(modifyFirst: boolean = true, ...iterables: Iterable<T>[]): Set<T> {\r\n        const set: Set<T> = modifyFirst ? iterables[0] as Set<T>: new Set<T>();\r\n        Log.e(!(set instanceof Set), 'U.SetMerge() used with modifyFirst = true requires the first argument to be a set');\r\n        for (let iterable of iterables) { for (let item of iterable) { set.add(item); } }\r\n        return set; }\r\n\r\n    // merge with unique elements\r\n    static ArrayMergeU(arr1: any[], ...arr2: any[]): void { U.ArrayMerge0(true, arr1, arr2); }\r\n    // merge without unique check\r\n    static ArrayMerge(arr1: any[], ...arr2: any[]): void { U.ArrayMerge0(false, arr1, arr2); }\r\n    // implementation\r\n    static ArrayMerge0(unique: boolean, arrtarget: any[], ...arrays: any[]): void {\r\n        if (!arrtarget || !arrays) return;\r\n\r\n        if (unique) { for (let arri of arrays) for (let e of arri) U.ArrayAdd(arrtarget, e); }\r\n        else { for (let arri of arrays) Array.prototype.push.apply(arrtarget, arri); }\r\n    }\r\n\r\n    static ArrayAdd<T>(arr: Array<T>, elem: T, unique: boolean = true, throwIfContained: boolean = false): boolean {\r\n        Log.ex(!arr || !Array.isArray(arr), 'ArrayAdd arr null or not array:', arr);\r\n        if (!unique) { arr.push(elem); return true; }\r\n        if (arr.indexOf(elem) === -1) { arr.push(elem); return true; }\r\n        Log.ex(throwIfContained, 'ArrayAdd element already contained:', arr, elem);\r\n        return false; }\r\n\r\n\r\n    private static maxID: number = 0;\r\n    public static idPrefix: string = '';\r\n    // static getID(): string { return U.idPrefix + U.maxID++; }\r\n    static getID: Generator<number> = function* idgenerator(): Generator<number> { let i: number = 0; while(true) yield i++; }();\r\n\r\n\r\n    static getType(param: any): string {\r\n        switch (typeof param) {\r\n            default: return typeof param;\r\n            case 'object':\r\n                return (param?.constructor as typeof RuntimeAccessibleClass)?.cname || param?.className || \"{_rawobject_}\";\r\n            case 'function': // and others\r\n                return \"geType for function todo: distinguish betweeen arrow and classic\";\r\n        }\r\n    }\r\n\r\n    static stringCompare(s1: string, s2: string): -1 | 0 | 1 { return (s1 < s2) ? -1 : (s1 > s2) ? 1 : 0; }\r\n\r\n    static endsWith(str: string, suffix: string | string[]): boolean {\r\n        if (Array.isArray(suffix)) {\r\n            for (let suf of suffix) {\r\n                if (U.endsWith(str, suf)) return true;\r\n            }\r\n            return false;\r\n        }\r\n        return str.length >= suffix.length && str.lastIndexOf(suffix) === str.length - suffix.length;\r\n    }\r\n\r\n\r\n    static arrayMergeInPlace<T>(arr1: T[], ...otherArrs: T[][]): T[] {\r\n        for (const arr of otherArrs) arr1.push.apply(arr1, arr || []);\r\n        return arr1; }\r\n\r\n    static getEndingNumber(s: string, ignoreNonNumbers: boolean = false, allowDecimal: boolean = false): number {\r\n        let i = s.length;\r\n        let numberEnd = -1;\r\n        while (--i > 0) {\r\n            if (!isNaN(+s[i])) { if (numberEnd === -1) { numberEnd = i; } continue; }\r\n            if (s[i] === '.' && !allowDecimal) { break; }\r\n            if (s[i] === '.') { allowDecimal = false; continue; }\r\n            if (!ignoreNonNumbers) { break; }\r\n            if (numberEnd !== -1) { ignoreNonNumbers = false; }\r\n        }\r\n        s = numberEnd === -1 ? '1' : s.substring(i, numberEnd);\r\n        return +parseFloat(s); }\r\n\r\n    static increaseEndingNumber(s: string, allowLastNonNumberChars: boolean = false, allowDecimal: boolean = false, increaseWhile?: ((x: string) => boolean)): string {\r\n        let regexpstr = '([0-9]+' + (allowDecimal ? '|[0-9]+\\\\.[0-9]+' : '') + ')' + (allowLastNonNumberChars ? '[^0-9]*' : '') + '$';\r\n        const matches: RegExpExecArray | null = new RegExp(regexpstr, 'g').exec(s); // Global (return multi-match) Single line (. matches \\n).\r\n        // S flag removed for browser support (firefox), should work anyway.\r\n        let prefix: string;\r\n        let num: number;\r\n        if (!matches) {\r\n            prefix = s;\r\n            num = 2;\r\n        } else {\r\n            Log.ex(matches.length > 2, 'parsing error: /' + regexpstr + '/gs.match(' + s + ')');\r\n            let i = s.length - matches[0].length;\r\n            prefix = s.substring(0, i);\r\n            num = 1 + (+matches[1]);\r\n        }\r\n        if (increaseWhile) while (increaseWhile(prefix + num)) { num++; }\r\n        return prefix + num; }\r\n\r\n\r\n    public static shallowEqual(objA: GObject, objB: GObject): boolean {\r\n        if (objA === objB) { return true; }\r\n\r\n        if (!objA || !objB || typeof objA !== 'object' || typeof objB !== 'object') { return false; }\r\n\r\n        var keysA = Object.keys(objA);\r\n        var keysB = Object.keys(objB);\r\n\r\n        // if (keysA.length !== keysB.length) { return false; }\r\n        // Test for A's keys different from B.\r\n        // var bHasOwnProperty = hasOwnProperty.bind(objB);\r\n        for (let keya in objA) if (objA[keya] !== objB[keya]) return false;\r\n\r\n        // for (var i = 0; i < keysA.length; i++) if (!bHasOwnProperty(keysA[i]) || objA[keysA[i]] !== objB[keysA[i]]) { return false; }\r\n        return true;\r\n    }\r\n\r\n    // returns true only if parameter is already a number by type. UU.isNumber('3') will return false\r\n    static isNumber(o: any): boolean { return +o === o && !isNaN(o); }\r\n\r\n    public static getAllPrototypes(constructor: Constructor, chainoutoutrecursive: GObject[] = [], currentRecursion = 0, maxRecursion = 20, cache: boolean = true): GObject[] {\r\n        // console.log('getAllPrototypes:', {name: constructor.name, currentRecursion, constructor, chainoutoutrecursive});\r\n        if (cache && (constructor as any).__allprototypes) return (constructor as any).__allprototypes;\r\n        let prototype = (constructor.prototype?.name) && constructor.prototype;\r\n        let __proto__ = (constructor.__proto__?.name) && constructor.__proto__;\r\n        if (!prototype && !__proto__ || currentRecursion >= maxRecursion) return chainoutoutrecursive;\r\n        if (prototype) chainoutoutrecursive.push(prototype);\r\n        if (__proto__) chainoutoutrecursive.push(__proto__);\r\n        if (prototype) U.getAllPrototypes(prototype, chainoutoutrecursive, currentRecursion + 1, maxRecursion);\r\n        if (__proto__) U.getAllPrototypes(__proto__, chainoutoutrecursive, currentRecursion + 1, maxRecursion);\r\n        if (cache) (constructor as any).__allprototypes = chainoutoutrecursive;\r\n        return chainoutoutrecursive;\r\n    }\r\n\r\n    public static classIsExtending(subconstructor: Constructor | AbstractConstructor, superconstructor: Constructor | AbstractConstructor): boolean {\r\n        return (superconstructor as typeof DPointerTargetable)?._extends?.includes(subconstructor as any) || false;\r\n        // return U.getAllPrototypes(subconstructor).includes(superconstructor);\r\n    }\r\n\r\n    static isObject(v: GObject|any, returnIfNull: boolean = true, returnIfUndefined: boolean = false, retIfArray: boolean = false): boolean {\r\n        if (v === null) { return returnIfNull; }\r\n        if (v === undefined) { return returnIfUndefined; }\r\n        if (Array.isArray(v)) { return retIfArray; }\r\n        // nb: mind that typeof [] === 'object'\r\n        return typeof v === 'object'; }\r\n\r\n    static objectFromArrayValues(arr: (string | number)[]): Dictionary<string | number, boolean> {\r\n        let ret: Dictionary = {};\r\n        // todo: improve efficiency\r\n        for (let val of arr) { ret[val] = true; }\r\n        return ret;\r\n    }\r\n\r\n    static toBoolString(bool: boolean, ifNotBoolean: boolean = false): string { return bool === true ? 'true' : (bool === false ? 'false' : '' + ifNotBoolean); }\r\n    static fromBoolString<T extends any>(str: string | boolean): boolean;\r\n    static fromBoolString<T extends any>(str: string | boolean, defaultVal?: T): boolean | T;\r\n    static fromBoolString<T extends any>(str: string | boolean, defaultVal?: T, allowNull?: boolean): boolean | null | T;\r\n    static fromBoolString<T extends any>(str: string | boolean, defaultVal: T = false as any, allowNull: boolean = false, allowUndefined: boolean = false): boolean | null | undefined | T {\r\n        str = ('' + str).toLowerCase();\r\n        if (allowNull && (str === 'null')) return null;\r\n        if (allowUndefined && (str === 'undefined')) return undefined;\r\n\r\n        if (str === \"true\" || str === 't' || str === '1') return true;\r\n        // if (defaultVal === true) return str === \"false\" || str === 'f' || str === '0'; // false solo se è esplicitamente false, true se ambiguo.\r\n        if (str === \"false\" || str === 'f' || str === '0') return false;\r\n        return defaultVal;\r\n    }\r\n\r\n    static arrayDifference<T>(starting: T[], final: T[]): {added: T[], removed: T[], starting: T[], final: T[]} {\r\n        let ret: {added: T[], removed: T[], starting: T[], final: T[]} = {} as any;\r\n        ret.starting = starting;\r\n        ret.final = final;\r\n        if (!starting) starting = [];\r\n        if (!final) final = [];\r\n        ret.removed = Uarr.arraySubtract(starting, final, false); // start & !end\r\n        ret.added = Uarr.arraySubtract(final, starting, false); // end & !start\r\n        return ret;\r\n    }\r\n\r\n    // returns <\"what changed from old to neww\"> and in nested objects recursively\r\n    // todo: how can i tell at what point it's the fina lvalue (might be a nestedobj) and up to when it's a delta to follow and unroll?   using __isAdelta:true ?\r\n    // NB: this returns the delta that generates the future. if you want the delta that generate the past one, invert parameter order.\r\n    public static objectDelta<T extends object>(old: T, neww: T, deep: boolean = true): Partial<T>{\r\n        let newwobj: GObject = neww;\r\n        let oldobj: GObject = old;\r\n        if (old === neww) return {};\r\n        let diff = U.objdiff(old, neww); // todo: optimize this, remove the 3 loops below and add those directly in U.objdiff(old, neww, ret); writing inside the obj in third parameter\r\n\r\n        let ret: GObject = {}; // {__isAdelta:true};\r\n        for (let key in diff.added) { ret[key] = newwobj[key]; }\r\n        for (let key in diff.changed) {\r\n            let subold = oldobj[key];\r\n            let subnew = newwobj[key];\r\n            if (typeof subold === typeof subnew && typeof subold === \"object\") { ret[key] = deep ? U.objectDelta(subold, subnew, true) : subnew; }\r\n            else ret[key] = subnew;\r\n        }\r\n        // todo: add to variable naming rules: can't start with \"_-\", like in \"_-keyname\", it means \"keyname\" removed in undo delta\r\n        let removedprefix = \"\"; // \"_-\";\r\n        for (let key in diff.removed) { ret[removedprefix + key] = undefined; } //newwobj[key]; }\r\n        // console.log(\"objdiff\", {old, neww, diff, ret});\r\n        return ret as Partial<T>;\r\n    }\r\n\r\n    // difference react-style. lazy check by === equality field by field\r\n    public static objdiff<T extends GObject>(old:T, neww: T): {removed: Partial<T>, added: Partial<T>, changed: Partial<T>} {\r\n        // let ret: GObject = {removed:{}, added:{}, changed:{}};\r\n        let ret: {removed: Partial<T>, added: Partial<T>, changed: Partial<T>}  = {removed:{}, added:{}, changed:{}};\r\n        if (!neww && !old) { return ret; }\r\n        if (!neww) { ret.removed = old; return ret; }\r\n        if (!old) { ret.added = neww; return ret; }\r\n        let oldkeys: string[] = Object.keys(old);\r\n        let newkeys: string[] = Object.keys(neww);\r\n\r\n        let key: any;\r\n        for (key in old) {\r\n            // if (neww[key] === undefined){\r\n            if (!(key in neww)){ // if neww have a key with undefined value, it counts (and should) as having that property key defined\r\n                (ret.removed as GObject)[key] = old[key]; continue;\r\n                // if (old[key] === undefined) { continue; }\r\n                // continue;\r\n            }\r\n            if (neww[key] === old[key]) continue;\r\n            (ret.changed as GObject)[key] = old[key];\r\n        }\r\n        for (let key in neww) {\r\n            if (!(key in old)){ (ret.added as GObject)[key] = neww[key]; }\r\n        }\r\n        return ret;\r\n    }\r\n    /*  {a: { b: { c1: 1, c2:2, c3:3 } }, d: 1 }     ---->  {\"a.b.c1\":1, \"a.b.c2\":2, \"a.b.c3\":3. \"d\":1}*/\r\n    public static flattenObjectToRoot(obj: GObject, prefix: string = '', pathseparator: string = '.'): GObject{\r\n        return Object.keys(obj).reduce((acc: GObject, k: string) => {\r\n            const pre = prefix.length ? prefix + pathseparator : '';\r\n            if (typeof obj[k] === 'object') Object.assign(acc, U.flattenObjectToRoot(obj[k], pre + k, pathseparator));\r\n            else acc[pre + k] = obj[k];\r\n            return acc;\r\n        }, {});\r\n    }\r\n\r\n    // from {a:{aa:true, ab:\"ab\"}, b:4} to [\"a.aa = true\", \"a.ab = \\\"ab\\\"\", \"a.b = 4\"]\r\n    // maxkeylength is max length of any individual key, after it it will become: superlongpath --> supe...path\r\n    // maxsubpaths is how many subpaths are displayed at most. after it it will be: super.rea.lly.long.pa.th --> super.rea.pa.th\r\n    public static ObjectToAssignementStrings<R extends {str: string, fullstr: string, path:string[], fullpath:string[], val: string, fullvalue: string, pathlength?: number}>\r\n    (obj: GObject, maxkeylength: number = 10, maxsubpaths: number = 6, maxvallength: number = 20, toolongreplacer: string = \"…\", out?:{best: R}&R[], quotestrings: boolean = true): {best: string}&string[] {\r\n        const pathseparator = \".\";\r\n        const valueseparator = \" = \";\r\n        const filterrow = (rowpaths: string[]) => { return (!rowpaths.includes(\"clonedCounter\") && !rowpaths.includes(\"pointedBy\")); };\r\n        let flatten = U.flattenObjectToRoot(obj, '', pathseparator);\r\n        let i = -1;\r\n        let tmp;\r\n        let ret: {best: string} & string[] = [] as GObject as {best: string} & string[];\r\n        tmp = (maxkeylength - toolongreplacer.length)/2;\r\n        let halfpath = { start: (window as any).Math.floor(tmp), end: (window as any).Math.ceil(tmp) };\r\n        tmp = (maxvallength - toolongreplacer.length)/2;\r\n        let halfval = { start: (window as any).Math.floor(tmp), end: (window as any).Math.ceil(tmp) };\r\n        tmp = (maxsubpaths - toolongreplacer.length)/2;\r\n        let halfsubpaths = { start: (window as any).Math.floor(tmp), end: (window as any).Math.ceil(tmp) };\r\n\r\n\r\n        let bestpathsize = 0;\r\n        let best: R | null = null;\r\n        let countsize = (total: number, arrelem: string): number => total + arrelem.length;\r\n        const filterbest = (row: R) => {\r\n            row.pathlength = row.fullstr.length; // row.fullpath.reduce<number>(countsize, 0);\r\n            if (!best || bestpathsize < row.pathlength && filterrow(row.fullpath)) {\r\n                best = row; bestpathsize = row.pathlength;\r\n                if (out) out.best = best;\r\n                ret.best = best.str;\r\n            }\r\n        }\r\n        console.log(\"u get assignements\", {flatten, obj});\r\n\r\n        for (let key in flatten) {\r\n            let row: R = {fullpath: key.split(pathseparator), fullstr: key} as R;\r\n            // if (!filterrow(row.fullpath)) continue;\r\n            // stringify(undefined) = undefined, so i add + \"\"\r\n            try {\r\n                if (!quotestrings && typeof flatten[key] === \"string\") row.fullvalue = flatten[key];\r\n                else row.fullvalue = JSON.stringify(flatten[key]) + \"\";\r\n            } catch(e) { row.fullvalue = \"⁜not serializable⁜\"; }\r\n            // console.log(\"U get assignements loop\", {row, key, flatten, obj});\r\n            row.val = row.fullvalue.length <= maxvallength ? row.fullvalue : row.fullvalue.substring(0, halfval.start) + toolongreplacer + row.fullvalue.substring(halfval.start);\r\n            if (row.fullpath.length > maxsubpaths) {\r\n                row.path = [...row.fullpath];\r\n                row.path.splice( halfsubpaths.start, row.fullpath.length - halfsubpaths.start - halfsubpaths.end, toolongreplacer);\r\n            } else row.path = row.fullpath;\r\n\r\n            // row.path = row.fullpath.length <= maxsubpaths ? row.fullpath : [...row.fullpath.slice(0, halfsubpaths.start), ...row.fullpath.toomanyarraycopies];\r\n            row.path = row.path.map((p: string) => (p.length <= maxkeylength ? p : p.substring(0, halfpath.start) + toolongreplacer + p.substring(p.length - halfpath.end)));\r\n            if (out) { out.push(row); }\r\n            row.str = row.path.join(pathseparator) + valueseparator + row.val;\r\n            ret.push( row.str );\r\n            filterbest(row);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\r\n    static download(filename: string = 'nameless.txt', text: string = '', debug: boolean = true): void {\r\n        if (!text) { return; }\r\n        filename = U.toFileName(filename);\r\n        const htmla: HTMLAnchorElement = document.createElement('a');\r\n        const blob: Blob = new Blob([text], {type: 'text/plain', endings: 'native'});\r\n        const blobUrl: string = URL.createObjectURL(blob);\r\n        Log.l(debug, text + '|\\r\\n| <-- rn, |\\n| <--n.');\r\n        htmla.style.display = 'none';\r\n        htmla.href = blobUrl;\r\n        htmla.download = filename;\r\n        document.body.appendChild(htmla);\r\n        htmla.click();\r\n        window.URL.revokeObjectURL(blobUrl);\r\n        document.body.removeChild(htmla); }\r\n\r\n    static formatXml(xml: string): string {\r\n        const reg = /(>)\\s*(<)(\\/*)/g;\r\n        const wsexp = / *(.*) +\\n/g;\r\n        const contexp = /(<.+>)(.+\\n)/g;\r\n        xml = xml.replace(reg, '$1\\n$2$3').replace(wsexp, '$1\\n').replace(contexp, '$1\\n$2');\r\n        const pad: string = '' || '\\t';\r\n        let formatted = '';\r\n        const lines = xml.split('\\n');\r\n        let indent = 0;\r\n        let lastType = 'other';\r\n        // 4 types of tags - single, closing, opening, other (text, doctype, comment) - 4*4 = 16 transitions\r\n        const transitions: GObject = {\r\n            'single->single': 0,\r\n            'single->closing': -1,\r\n            'single->opening': 0,\r\n            'single->other': 0,\r\n            'closing->single': 0,\r\n            'closing->closing': -1,\r\n            'closing->opening': 0,\r\n            'closing->other': 0,\r\n            'opening->single': 1,\r\n            'opening->closing': 0,\r\n            'opening->opening': 1,\r\n            'opening->other': 1,\r\n            'other->single': 0,\r\n            'other->closing': -1,\r\n            'other->opening': 0,\r\n            'other->other': 0\r\n        };\r\n        let i = 0;\r\n        for (i = 0; i < lines.length; i++) {\r\n            const ln = lines[i];\r\n\r\n            // Luca Viggiani 2017-07-03: handle optional <?xml ... ?> declaration\r\n            if (ln.match(/\\s*<\\?xml/)) {\r\n                formatted += ln + '\\n';\r\n                continue;\r\n            }\r\n            // ---\r\n\r\n            const single = Boolean(ln.match(/<.+\\/>/)); // is this line a single tag? ex. <br />\r\n            const closing = Boolean(ln.match(/<\\/.+>/)); // is this a closing tag? ex. </a>\r\n            const opening = Boolean(ln.match(/<[^!].*>/)); // is this even a tag (that's not <!something>)\r\n            const type = single ? 'single' : closing ? 'closing' : opening ? 'opening' : 'other';\r\n            const fromTo = lastType + '->' + type;\r\n            lastType = type;\r\n            let padding = '';\r\n\r\n            indent += transitions[fromTo];\r\n            let j: number;\r\n            for (j = 0; j < indent; j++) {\r\n                padding += pad;\r\n            }\r\n            if (fromTo === 'opening->closing') {\r\n                formatted = formatted.substr(0, formatted.length - 1) + ln + '\\n'; // substr removes line break (\\n) from prev loop\r\n            } else {\r\n                formatted += padding + ln + '\\n';\r\n            }\r\n        }\r\n\r\n        return formatted.trim(); }\r\n\r\n\r\n    // https://stackoverflow.com/questions/13861254/json-stringify-deep-objects  implementation with depth\r\n    static circularStringify(obj: GObject, replacer?: null | ((key: string, value: any) => any), space?: string | number, maxDepth_unsupported: number = 100): string {\r\n        const cache: any[] = [];\r\n        return JSON.stringify(obj, (key, value: any) => {\r\n            if (typeof value === 'object' && value !== null) {\r\n                // Duplicate reference found, discard key\r\n                if (cache.includes(value)) return \"[Circular Reference]\"; // might happen both before and after the replacer func\r\n                if (replacer){\r\n                    value = replacer(key, value);\r\n                    if (cache.includes(value)) return \"[Circular Reference]\"; // might happen both before and after the replacer func\r\n                }\r\n                // Store value in our collection\r\n                cache.push(value);\r\n            }\r\n            return value;\r\n        }, space);\r\n    }\r\n\r\n    static getFirstNumber(s: string, allowDecimalDot: boolean = true, allowDecimalComma: boolean = true, valueifmismatch: any = null): number {\r\n        let commamode = (allowDecimalComma ? (allowDecimalDot ?\"(\\\\.|\\\\,)\" : \"\\\\,\") : (allowDecimalDot ? \"\\\\.\" : \"will not use this regex\"));\r\n        let floatregex = new RegExp(\"-?\" + commamode  + \"?\\\\d+(\" + commamode + \"\\\\d{1,2})?\");\r\n        let intregex = /-?\\d+/;\r\n        let ret: any;\r\n        if (allowDecimalDot || allowDecimalComma) ret = floatregex.exec(s);\r\n        else ret = intregex.exec(s);\r\n        console.log({ret, floatregex, intregex, s});\r\n        ret = ret && ret[0]; // first match\r\n        if (ret === null) return valueifmismatch;\r\n\r\n        let tmpindex:number;\r\n        if (allowDecimalComma) ret = U.replaceAll(ret, \",\", \".\");\r\n        // while (allowDecimalComma && (tmpindex = ret.indexOf(\",\")) !== ret.lastIndexOf(\",\")) ret.substring(tmp+1) // ret.indexOf(.)\r\n        while ((allowDecimalDot || allowDecimalComma) && (tmpindex = ret.indexOf(\".\")) !== ret.lastIndexOf(\".\")) ret = ret.substring(tmpindex+1) // ret.indexOf(.)\r\n        // if (ret[0]===\"-\" && (ret[1]===\",\" || ret[1]===\".\")) ret = \"-0.\"+ret.substring(2); automatically done bu js.    +\"-.5\" = -0.5\r\n        return +ret;\r\n    }\r\n\r\n    private static pairArrayElementsRepeatFunc<T>(val: T, index: number, arr:T[]): T[]{ return [arr[index], arr[index+1]] }\r\n    private static pairArrayElementsReducerFunc<T>(accumulator: T[][], value: T, index: number, array: T[]):T[][] {\r\n        if (index % 2 === 0) accumulator.push(array.slice(index, index + 2));\r\n        return accumulator; }\r\n\r\n    // from arr[] to arr[][]. if is with repetitions is: [1,2], [2,3], [3,4]... (ret.length = source.length-1)\r\n    // if without repetitions is: [1,2], [3,4].... (ret.length = Math.ceil(source.length/2);\r\n    public static pairArrayElements<T>(arr:T[], withRepetitions:boolean = false):T[][] {\r\n        if (withRepetitions) { return arr.map(U.pairArrayElementsRepeatFunc).slice(0, arr.length-1); }\r\n        return arr.reduce( U.pairArrayElementsReducerFunc as ((accumulator: T[][], value: T, index: number, array: T[]) => T[][]), []); }\r\n\r\n    // removes line // and block /**/ comments  todo: can likely be improved by a regular expression\r\n    public static decomment_all(str: string): string { return this.decomment_line(this.decomment_block(str)); }\r\n    // removes line comments //\r\n    public static decomment_line(str: string, trimLines: boolean = true): string {\r\n        return str\r\n            .split(\"\\n\")\r\n            .map(s=> { let i = s.indexOf(\"//\"); s = (i === -1 ? s : s.substring(i)); return trimLines ? s.trim() : s; } )\r\n            .join(\"\\n\");\r\n    }\r\n    // removes block comments /**/\r\n    public static decomment_block(str: string): string {\r\n        // let maxcomments = 100;\r\n        while(true){\r\n            // if (--maxcomments===0) break;\r\n            let s: number = str.indexOf(\"/*\");\r\n            if (s === -1) break;\r\n            let e: number = str.indexOf(\"*/\", s+1);\r\n            if (e === -1) e = str.length;\r\n            str = str.substring(0, s) + str.substring(e+2);\r\n        }\r\n        return str; }\r\n\r\n}\r\nexport class DDate{\r\n    static cname: string = \"DDate\";\r\n\r\n    public static addDay(date: Date, offset: number, inplace: boolean): Date {\r\n        const ret: Date = inplace ? date : new Date(date);\r\n        ret.setDate(date.getDate() + offset);\r\n        return ret;\r\n    }\r\n    public static addMonth(date: Date, offset: number, inplace: boolean): Date {\r\n        const ret: Date = inplace ? date : new Date(date);\r\n        ret.setMonth(date.getMonth() + offset);\r\n        return ret;\r\n    }\r\n    public static addYear(date: Date, offset: number, inplace: boolean): Date {\r\n        const ret: Date = inplace ? date : new Date(date);\r\n        ret.setFullYear(date.getFullYear() + offset);\r\n        return ret;\r\n    }\r\n}\r\n\r\nexport class myFileReader {\r\n    private static input: HTMLInputElement = null as any;\r\n    private static fileTypes: string[] = null as any;\r\n    private static onchange: (e: Event) => void = null as any;\r\n    // constructor(onchange: (e: ChangeEvent) => void = null, fileTypes: FileReadTypeEnum[] | string[] = null) { myFileReader.setinfos(fileTypes, onchange); }\r\n    private static setinfos(fileTypes: undefined | FileReadTypeEnum[] | string[], onchange: (e: Event, files: FileList | null, contents: string[] | undefined ) => void, readcontent: boolean) {\r\n        myFileReader.fileTypes = (fileTypes || myFileReader.fileTypes) as string[];\r\n        const debug: boolean = false;\r\n        debug&&console.log('fileTypes:', myFileReader.fileTypes, fileTypes);\r\n        myFileReader.input = document.createElement('input');\r\n        const input: HTMLInputElement = myFileReader.input;\r\n        myFileReader.onchange = function (e: Event): void {\r\n            if (!readcontent) { onchange(e, input.files, undefined); return; }\r\n            let contentObj: Dictionary<number, string> = {};\r\n            let fileLetti: number = 0;\r\n            for (let i: number = 0; input.files && i <input.files.length; i++) {\r\n                const f: File = input.files[i];\r\n                debug&&console.log('filereadContent['+i+']( file:', f, ')');\r\n                U.fileReadContent(f, (content: string) => {\r\n                    debug&&console.log('file['+i+'] read complete. done: ' + ( 1 + fileLetti) + ' / ' + input.files?.length, 'contentObj:', contentObj);\r\n                    contentObj[i] = content; // cannot use array, i'm not sure the callbacks will be called in order. using push is safer but could alter order.\r\n                    // this is last file to read.\r\n                    if (input.files && ++fileLetti === input.files.length) {\r\n                        const contentArr: string[] = [];\r\n                        for (let j: number = 0; j < input.files.length; j++) { contentArr.push(contentObj[j]); }\r\n                        onchange(e, input.files, contentArr);\r\n                    }\r\n                });\r\n            }\r\n        } || myFileReader.onchange;\r\n    }\r\n    private static reset(): void {\r\n        myFileReader.fileTypes = undefined as any;\r\n        myFileReader.onchange = undefined as any;\r\n        myFileReader.input = undefined as any;\r\n    }\r\n    public static show(onChange: (e: Event, files: FileList | null, contents?: string[]) => void, extensions: undefined | string[] | FileReadTypeEnum[] = undefined, readContent: boolean): void {\r\n        console.log(\"importEcore: pre file reader\", myFileReader.input);\r\n        myFileReader.setinfos(extensions, onChange, readContent);\r\n        //if (!myFileReader.input) return;\r\n        myFileReader.input.setAttribute('type', 'file');\r\n        if (myFileReader.fileTypes) {\r\n            myFileReader.input.setAttribute('accept', myFileReader.fileTypes.join(','));\r\n        }\r\n        //console.log('fileTypes:', myFileReader.fileTypes, 'input:', myFileReader.input);\r\n        $(myFileReader.input).on('change.custom' as any, myFileReader.onchange).trigger('click');\r\n        myFileReader.reset();\r\n    }\r\n\r\n}\r\n@RuntimeAccessible\r\nexport class Uarr{\r\n    static cname: string = \"UArr\";\r\n    public static arrayIntersection<T>(arr1: T[], arr2: T[]): T[]{\r\n        if (!arr1 || ! arr2) return null as any;\r\n        return arr1.filter( e => arr2.indexOf(e) >= 0);\r\n    }\r\n\r\n    static arraySubtract(arr1: any[], arr2: any[], inPlace: boolean): any[]{\r\n        let i: number;\r\n        const ret: any[] = inPlace ? arr1 : [...arr1];\r\n        for (i = 0; i < arr2.length; i++) { U.arrayRemoveAll(ret, arr2[i]); }\r\n        return ret; }\r\n\r\n    static equals<T extends any>(a1: T[], a2: T[], deep: boolean): boolean {\r\n        Log.ex(deep, \"deep array comparison is not supported yet\");\r\n        if (!a1 || !a2) return false;\r\n        if (a1.length !== a2.length) return false;\r\n        for (let i = 0; i < a1.length; i++) if (a1[i] !== a2[i]) return false;\r\n        return true;\r\n    }\r\n}\r\n\r\nexport class FocusHistoryEntry {\r\n    static cname: string = \"FocusHistoryEntry\";\r\n    time: Date;\r\n    evt: JQuery.FocusInEvent;\r\n    element: Element;\r\n    constructor(e: JQuery.FocusInEvent, element?: Element, time?: Date) {\r\n        this.evt = e;\r\n        this.element = element || e.target;\r\n        this.time = time || new Date();\r\n    }\r\n}\r\n\r\nexport enum ShortAttribETypes {\r\n    void = 'void',\r\n    EChar  = 'EChar',\r\n    EString  = 'EString',\r\n    EDate  = 'EDate',\r\n    EBoolean = 'EBoolean',\r\n    EByte  = 'EByte',\r\n    EShort  = 'EShort',\r\n    EInt  = 'EInt',\r\n    ELong  = 'ELong',\r\n    EFloat  = 'EFloat',\r\n    EDouble  = 'EDouble',\r\n    /*\r\n  ECharObj  = 'ECharObj',\r\n  EStringObj  = 'EStringObj',\r\n  EDateObj  = 'EDateObj',\r\n  EFloatObj  = 'EFloatObj',\r\n  EDoubleObj  = 'EDoubleObj',\r\n  EBooleanObj = 'EBooleanObj',\r\n  EByteObj  = 'EByteObj',\r\n  EShortObj  = 'EShortObj',\r\n  EIntObj  = 'EIntObj',\r\n  ELongObj  = 'ELongObj',\r\n  EELIST  = 'EELIST',*/\r\n\r\n}\r\nwindoww.ShortAttribETypes = ShortAttribETypes;\r\n\r\nexport const ShortAttribSuperTypes: Dictionary<ShortAttribETypes, ShortAttribETypes[]> = {\r\n    \"void\"     : [],\r\n    \"EChar\"    : [ShortAttribETypes.EString],\r\n    \"EString\"  : [],\r\n    \"EDate\"    : [],\r\n    \"EBoolean\" : [ShortAttribETypes.EByte, ShortAttribETypes.EShort, ShortAttribETypes.EInt, ShortAttribETypes.ELong, ShortAttribETypes.EFloat, ShortAttribETypes.EDouble],\r\n    \"EByte\"    : [ShortAttribETypes.EShort, ShortAttribETypes.EInt, ShortAttribETypes.ELong, ShortAttribETypes.EFloat, ShortAttribETypes.EDouble],\r\n    \"EShort\"   : [ShortAttribETypes.EInt, ShortAttribETypes.ELong, ShortAttribETypes.EFloat, ShortAttribETypes.EDouble],\r\n    \"EInt\"     : [ShortAttribETypes.ELong, ShortAttribETypes.EFloat, ShortAttribETypes.EDouble],\r\n    \"ELong\"    : [ShortAttribETypes.EFloat, ShortAttribETypes.EDouble],\r\n    \"EFloat\"   : [ShortAttribETypes.EDouble],\r\n    \"EDouble\"  : []\r\n};\r\n\r\nexport class SelectorOutput {\r\n    jqselector!: string;\r\n    attrselector!: string;\r\n    attrRegex!: RegExp;\r\n    exception!: any;\r\n    resultSetAttr!: Attr[];\r\n    resultSetElem!: JQuery<Element>;\r\n}\r\nexport enum Keystrokes {\r\n    escape = 'Escape',\r\n    capsLock = 'CapsLock',\r\n    shift = 'Shift',\r\n    tab = 'Tab',\r\n    alt = 'Alt',\r\n    control = 'Control',\r\n    end = 'End',\r\n    home = 'Home',\r\n    pageUp = 'PageUp',\r\n    pageDown = 'PageDown',\r\n    enter = 'Enter', // event.code = 'NumpadEnter' se fatto da numpad, oppure \"numpad3\", \"NumpadMultiply\", ShiftLeft, etc...\r\n    numpadEnter = 'NumpadEnter',\r\n    audioVolumeMute = 'AudioVolumeMute',\r\n    audioVolumeUp = 'AudioVolumeUp',\r\n    audioVolumeDown = 'AudioVolumeDown',\r\n    mediaTrackPrevious = 'MediaTrackPrevious',\r\n    delete = 'Delete', // canc\r\n    backspace = 'Backspace',\r\n    space = ' ',\r\n    altGraph = 'AltGraph',\r\n    arrowLeft = 'ArrowLeft',\r\n    arrowRight = 'ArrowRight',\r\n    arrowUp = 'ArrowUp',\r\n    arrowDown = 'ArrowDown',\r\n    insert = 'Insert',\r\n    f1 = 'F1',\r\n    // weird ones:\r\n    meta = 'Meta', // f1, or other f's with custom binding and windows key\r\n    unidentified = 'Unidentified', // brightness\r\n    __NotReacting__ = 'fn, print, maybe others', // not even triggering event?\r\n}\r\n\r\n\r\nexport enum AttribETypes {\r\n    void = '???void',\r\n    EChar = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EChar',\r\n    EString = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EString',\r\n    EDate = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EDate',\r\n    EFloat = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EFloat',\r\n    EDouble = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EDouble',\r\n    EBoolean = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBoolean',\r\n    EByte = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EByte',\r\n    EShort = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EShort',\r\n    EInt = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EInt',\r\n    ELong = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//ELong',\r\n    /*\r\n  ECharObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//ECharObject',\r\n  EStringObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EStringObject',\r\n  EDateObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EDateObject',\r\n  EFloatObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EFloatObject',\r\n  EDoubleObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EDoubleObject',\r\n  EBooleanObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EBooleanObj',\r\n  EByteObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EByteObject',\r\n  EShortObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EShortObject',\r\n  EIntObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EIntegerObject',\r\n  ELongObj = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//ELongObject', */\r\n    // EELIST = 'ecore:EDataType http://www.eclipse.org/emf/2002/Ecore#//EEList', // List<E> = List<?>\r\n}\r\n\r\n// export type Json = object;\r\n\r\nexport class ParseNumberOrBooleanOptions{\r\n    defaultValue?: any;\r\n    allowNull?: boolean; nullValue?: any;\r\n    allowUndefined?: boolean; undefinedValue?: any;\r\n    allowedNan?: boolean; nanValue?: any;\r\n    allowBooleans?: boolean; trueValue?: any; falseValue?: any;\r\n    constructor(\r\n        defaultValue: any = null, allowNull: boolean = false, nullValue: any = null,\r\n        allowUndefined: boolean = false, undefinedValue: any = undefined,\r\n        allowedNan: boolean = false, nanValue: any = NaN,\r\n        allowBooleans: boolean = true, trueValue : any = 1, falseValue: any = 0) {\r\n        this.defaultValue = defaultValue; this.allowNull = allowNull; this.nullValue = nullValue;\r\n        this.allowUndefined = allowUndefined; this.undefinedValue = undefinedValue;\r\n        this.allowedNan = allowedNan; this.nanValue = nanValue;\r\n        this.allowBooleans = allowBooleans; this.trueValue = trueValue; this.falseValue = falseValue;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class Log{\r\n    static cname: string = \"Log\";\r\n    constructor() { }\r\n    // public static history: Dictionary<string, Dictionary<string, any[]>> = {}; // history['pe']['key'] = ...parameters\r\n    public static lastError: any[];\r\n    private static loggerMapping: Dictionary<string, LoggerInterface[]> = {} // takes function name returns logger list\r\n    public static registerLogger(logger: LoggerInterface, triggerAt: (typeof windoww.U.pe) & {name: string, cname:string}) {\r\n        let tname: string = (triggerAt as any).cname || (triggerAt as any).name;\r\n        if (!Log.loggerMapping[tname]) Log.loggerMapping[tname] = [];\r\n        Log.loggerMapping[tname].push(logger);\r\n    }\r\n\r\n    static disableConsole(){\r\n        // @ts-ignore\r\n        console['logg'] = console.log;\r\n        console.log = () => {}; }\r\n\r\n    static enableConsole() {\r\n        // @ts-ignore\r\n        if (console['logg']) console.log = console['logg']; }\r\n\r\n    private static log(prefix: string, category: string, originalFunc: typeof console.log, b: boolean, ...restArgs: any[]): string {\r\n        if (!b) { return ''; }\r\n        const key: string = windoww.U.getCaller(1);\r\n        if (restArgs === null || restArgs === undefined) { restArgs = []; }\r\n        let str = '[' + prefix + ']' + key + ': ';\r\n        for (let i = 0; i < restArgs.length; i++) {\r\n            // console.log(prefix, {i, restArgs, curr:restArgs[i]});\r\n            str += '' +\r\n                (typeof restArgs[i] === 'symbol' ?\r\n                    '' + String(restArgs[i]) :\r\n                    restArgs[i])\r\n                + '\\t\\r\\n'; }\r\n        if (Log.loggerMapping[category]) for (const logger of Log.loggerMapping[category]) { logger.log(category, key, restArgs, str); }\r\n        originalFunc(key, ...restArgs);\r\n        return str; }\r\n\r\n    public static e(b: boolean, ...restArgs: any[]): string {\r\n        if (!b) return '';\r\n        const str = Log.log('Error', 'e', console.error, b, ...restArgs);\r\n        Log.lastError = restArgs;\r\n        return str;\r\n        // throw new Error(str);\r\n    }\r\n\r\n    public static eDev(b: boolean, ...restArgs: any[]): string {\r\n        if (!b) return '';\r\n        const str = Log.log('Dev Error','eDev', console.error, b, ...restArgs);\r\n        Log.lastError = restArgs;\r\n        return str;\r\n        // throw new Error(str);\r\n    }\r\n\r\n    public static ex(b: boolean, ...restArgs: any[]): null | never | any {\r\n        if (!b) return null;\r\n        const str = Log.log('Error', 'e', console.error, b, ...restArgs);\r\n        Log.lastError = restArgs;\r\n        windoww.ee = restArgs;\r\n        windoww.e1 = restArgs[1];\r\n        throw new MyError(str, ...restArgs); }\r\n\r\n    public static exDev(b: boolean, ...restArgs: any[]): null | never | any {\r\n        if (!b) return null;\r\n        const str = Log.log('Dev Error','eDev', console.error, b, ...restArgs);\r\n        Log.lastError = restArgs;\r\n        windoww.ee = restArgs;\r\n        windoww.e1 = restArgs[1];\r\n        throw new MyError(str, ...restArgs); }\r\n\r\n    public static i(b: boolean, ...restArgs: any[]): string { return Log.log('Info', 'i', console.log, b, ...restArgs); }\r\n    public static l(b: boolean, ...restArgs: any[]): string { return Log.log('Log', 'l', console.log, b, ...restArgs); }\r\n    public static w(b: boolean, ...restArgs: any[]): string { return Log.log('Warn', 'w', console.warn, b, ...restArgs); }\r\n\r\n\r\n    public static eDevv<T extends any = any>(firstParam?: NotBool<T>, ...restAgs: any): string { return Log.eDev(true, ...[firstParam, ...restAgs]); }\r\n    public static ee(...restAgs: any): string { return Log.e(true, ...restAgs); }\r\n    public static exDevv<T extends any = any>(firstParam?: NotBool<T>, ...restAgs: any): never | any { return Log.exDev(true, ...[firstParam, ...restAgs]); }\r\n    public static exx(...restAgs: any): never | any { return Log.ex(true, ...restAgs); }\r\n    public static ii(...restAgs: any): string { return Log.i(true, ...restAgs); }\r\n    public static ll(...restAgs: any): string { return Log.l(true, ...restAgs); }\r\n    public static ww(...restAgs: any): string { return Log.w(true, ...restAgs); }\r\n}\r\n\r\ntype NotBool<T> = Exclude<T, boolean>;\r\n\r\ninterface LoggerInterface{\r\n    log: (category: string, key: string, data: any[], fullconcat?: string) => any;\r\n}\r\n\r\n\r\n\r\nexport class FileReadTypeEnum {\r\n    public static image: FileReadTypeEnum = \"image/*\" as any;\r\n    public static audio: FileReadTypeEnum = \"audio/*\" as any;\r\n    public static video: FileReadTypeEnum = \"video/*\" as any;\r\n    /// a too much huge list https://www.iana.org/assignments/media-types/media-types.xhtml\r\n    public static AndManyOthersButThereAreTooMuch: string = \"And many others... https://www.iana.org/assignments/media-types/media-types.xhtml\";\r\n    public static OrJustPutFileExtension: string = \"OrJustPutFileExtension\";\r\n}\r\n\r\nconsole.warn('loaded ts U');\r\n","import React, {Dispatch, ReactElement} from 'react';\r\nimport {DValue, Input, DState, LValue, Pointer} from \"../../../../joiner\";\r\nimport {connect} from \"react-redux\";\r\n\r\n\r\nfunction MqttEditorComponent(props: AllProps) {\r\n    const lValue = props.lValue;\r\n    const room = props.room;\r\n    const topics = props.topics;\r\n\r\n    const change = (evt:  React.ChangeEvent<HTMLSelectElement>) => {\r\n        lValue.topic = evt.target.value || '';\r\n    }\r\n\r\n    const parsedTopic = (topics.includes(lValue.topic)) ? lValue.topic : '';\r\n\r\n    if(!room) return(<></>);\r\n    return(<div className={'d-flex p-1'}>\r\n        <label className={'my-auto'}>Topic</label>\r\n        <select className={'my-auto ms-auto select'} value={parsedTopic} onChange={change}>\r\n            <option value={''}>-----</option>\r\n            <option value={''}>NO TOPIC</option>\r\n            {topics.map((topic, index) => {\r\n                return(<option key={index} value={topic}>{topic}</option>);\r\n            })}\r\n        </select>\r\n    </div>);\r\n}\r\n\r\ninterface OwnProps {valueId: Pointer<DValue, 1, 1, LValue>}\r\ninterface StateProps {lValue: LValue, room: string, topics: string[]}\r\ninterface DispatchProps {}\r\n\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const lValue = LValue.fromPointer(ownProps.valueId);\r\n    const room = state.room;\r\n    const topics = state.topics;\r\n    return {lValue, room, topics};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    return ret;\r\n}\r\n\r\n\r\nexport const MqttEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MqttEditorComponent);\r\n\r\nexport const MqttEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <MqttEditorConnected {...{...props, children}} />;\r\n}\r\nexport default MqttEditor;\r\n","import React from \"react\";\r\nimport type {Dictionary, DocString, LReference, Pointer, ValueDetail} from \"../../../../joiner\";\r\nimport {\r\n    DAttribute,\r\n    DClass,\r\n    DEnumerator,\r\n    DReference,\r\n    LAttribute,\r\n    LClass,\r\n    LEnumerator,\r\n    LObject,\r\n    LPointerTargetable,\r\n    LStructuralFeature,\r\n    LValue,\r\n    Selectors,\r\n    SetFieldAction\r\n} from \"../../../../joiner\";\r\nimport MqttEditor from \"./MqttEditor\";\r\n\r\n\r\ninterface Props {value: LValue}\r\nfunction Value(props: Props) {\r\n    const lValue = props.value;\r\n    const dValue = lValue.__raw;\r\n    const feature: LStructuralFeature = LStructuralFeature.fromPointer(lValue.instanceof?.id);\r\n    let field = 'text'; let stepSize = 1; let maxLength = 524288;\r\n    let min = -9223372036854775808;\r\n    let max = 9223372036854775807; // for long, todo: aggiusta per tutti gli altri. in switch\r\n    switch(feature?.type.name) {\r\n        default: field=\"text\"; break;\r\n        case 'EChar': maxLength = 1; break;\r\n        case 'EInt':\r\n        case 'ELong':\r\n        case 'EShort':\r\n        case 'Byte': field = 'number'; break;\r\n        case 'EFloat': field = 'number'; stepSize = 0.1; break;\r\n        case 'EDouble': field = 'number'; stepSize = 0.01; break;\r\n        case 'EBoolean': field = 'checkbox'; break;\r\n        case 'EDate': field = 'date'; break;\r\n    }\r\n    let upperBound = feature ? (feature as LReference | LAttribute).__raw.upperBound : -1;\r\n    if (upperBound < 0) upperBound = 999;\r\n    let filteredvalues: ValueDetail[] = lValue.getValues(true, false, false, false, true, true) as any;\r\n\r\n    const add = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n        // SetFieldAction.new(dValue, 'value', U.initializeValue(feature?.type), '+=', false);\r\n        SetFieldAction.new(dValue, 'values', undefined, '+=', false);\r\n    }\r\n    const remove = (index: number, isPointer: boolean | undefined) => {\r\n        if (isPointer === undefined) isPointer = !!(filteredvalues[index].value as any)?.__isProxy; // Pointers.isPointer\r\n        SetFieldAction.new(dValue, 'values', index, '-=', isPointer);\r\n        /*\r\n        let oldValues = filteredvalues.map( v => v.rawValue);\r\n        let newValues = [...oldValues];\r\n        newValues.splice(index, 1); // removes in place\r\n        console.log(\"removing:\", {oldValues, newValues, index});\r\n        SetFieldAction.new(dValue, 'value', newValues, '=', false);*/\r\n    }\r\n    function changeDValue(event: React.ChangeEvent<HTMLInputElement|HTMLSelectElement>, index: number, isPointer: boolean | undefined) {\r\n        let inputvalue: string | boolean = field === 'checkbox' ? (event.target as HTMLInputElement).checked : event.target.value;\r\n        if (inputvalue === \"undefined\") inputvalue = undefined as any;\r\n        let result = lValue.setValueAtPosition(index, inputvalue, {isPtr: isPointer});\r\n        console.log(\"setting DValue\", {inputvalue, result, lValue});\r\n    }\r\n\r\n\r\n    let isattr = false, isenum = false, isref = false, isshapeless = false;\r\n    switch(feature?.className){\r\n        default: isshapeless = true; break;\r\n        case DAttribute.cname:\r\n            if (feature.type.className === DClass.cname) isattr = true; else\r\n            if (feature.type.className === DEnumerator.cname) isenum = true;\r\n            break;\r\n        case DReference.cname: isref = true; break;\r\n    }\r\n\r\n    // let pointables: {objects:LObject[], literals: LEnumLiteral[]};\r\n    let select_options: JSX.Element | JSX.Element[] | null;\r\n\r\n\r\n    if (isref) {\r\n        let isContainment: boolean = lValue.containment;\r\n        // todo: move this utility in LClass.instances\r\n        let containerObjectsID: Pointer[] = lValue.fatherList.map( lm => lm.id);\r\n        let validObjects = Selectors.getObjects().filter((obj) => obj.instanceof?.id === feature.type?.id);\r\n        validObjects =  validObjects.filter( obj => !containerObjectsID.includes(obj.id)); // avoiding containment loops damiano todo: put this filter in set_value too\r\n        let freeObjects = [];\r\n        let boundObjects = [];\r\n        for (let o of validObjects) {\r\n            // todo: this check of self contain is too simple does not detect loops, would need to use fatherChain\r\n            if (isContainment && o.id === lValue.father.id) continue; // no self contain\r\n            if (o.isRoot) freeObjects.push(o); else boundObjects.push(o);\r\n        }\r\n        let map = (object: LObject) => <option key={object.id} value={object.id}>{object.name/*.feature('name')*/}</option>;\r\n        select_options = <><optgroup label={\"Free Objects\"}>{freeObjects.map(map)}</optgroup><optgroup label={\"Bound Objects\"}>{boundObjects.map(map)}</optgroup></>; }\r\n    else if (isenum) {\r\n        select_options = <optgroup label={\"Literals of \" + feature.type.name}>{(feature.type as LEnumerator).literals.map((literal, i) => <option key={literal.id} value={literal.id}>{literal.name}</option>)}</optgroup>;\r\n    }\r\n    else if (isshapeless) {\r\n        // damiano todo: rewrite entirely this section to separate bound and free objects, copying from if(isref)\r\n        // pointables = {objects: Selectors.getObjects(), literals: LPointerTargetable.fromArr(Selectors.getAllEnumLiterals())};\r\n        let isContainment: boolean = lValue.containment;\r\n        let enums: LEnumerator[] = LPointerTargetable.fromArr(Selectors.getAllEnumerators())\r\n        let classes: LClass[] = LPointerTargetable.fromArr(Selectors.getAllClasses())\r\n        let shapelessObjects: LObject[] = Selectors.getObjects().filter((o) => !o.instanceof);\r\n        // console.log(\"select_options\", {enums, classes, shapelessObjects});\r\n        let classmap: Dictionary<DocString<\"classname\">, {free:LObject[], bound:LObject[], all: LObject[]}> = {};\r\n        let shapeless: {free:LObject[], bound:LObject[], all: LObject[]} = {free:[], bound:[], all: shapelessObjects};\r\n        for (let c of classes) {\r\n            let row: {free:LObject[], bound:LObject[], all: LObject[]} = {free: [], bound:[], all: c.instances};\r\n            classmap[c.name] = row;\r\n            for (let o of row.all) {\r\n                // todo: this check of self contain is too simple does not detect loops, would need to use fatherChain\r\n                if (isContainment && o.id === lValue.father.id) continue; // no self contain\r\n                if (o.isRoot) row.free.push(o); else row.bound.push(o);\r\n            }\r\n        }\r\n        for (let o of shapelessObjects) { if (o.isRoot) shapeless.free.push(o); else shapeless.bound.push(o); }\r\n\r\n        select_options = <>\r\n            <option value={''} key={0}>--- Not a Reference ---</option>\r\n            { Object.keys(classmap).map((cname) => !classmap[cname].all.length ? null :\r\n                <>\r\n                    {!classmap[cname].free.length ? null :\r\n                        <optgroup label={\"Free    instances of \" + cname} key={\"f-\" + cname}>\r\n                            {classmap[cname].free.map((o) => <option value={o.id} key={o.id}>{o.name}</option>)}\r\n                        </optgroup>\r\n                    }\r\n                    {!classmap[cname].bound.length ? null :\r\n                        <optgroup label={\"Bound instances of \" + cname} key={\"b-\" + cname}>\r\n                            {classmap[cname].bound.map((o) => <option value={o.id} key={o.id}>{o.name}</option>)}\r\n                        </optgroup>\r\n                    }\r\n                </>) }\r\n            { !shapeless.free.length ? null : <optgroup label={\"Free    shapeless objects\"}>{shapeless.free.map( (o) => <option value={o.id} key={o.id}>{o.name}</option>)}</optgroup> }\r\n            { !shapeless.bound.length ? null : <optgroup label={\"Bound shapeless objects\"}>{shapeless.bound.map( (o) => <option value={o.id} key={o.id}>{o.name}</option>)}</optgroup> }\r\n            { enums.map((c) => !c.literals.length ? null : <optgroup label={\"Literals of \" + c.name}>{ c.literals.map((o)=> <option value={o.id} key={o.id}>{o.name}</option>)}</optgroup>) }\r\n        </>\r\n        // console.log(\"select_options post\", {select_options, enums, classes, shapelessObjects});\r\n    }\r\n    else select_options = null;\r\n\r\n    // let rawvalues: any[] = lValue.__raw.value || [];\r\n    console.log(\"filtered values\", {filteredvalues});\r\n    let isPtr = isattr ? false : (isenum || isref ? true : undefined/*for shapeless*/);\r\n    const valueslist = (filteredvalues).map( (val, index) =>\r\n            val.hidden ? null :\r\n            <div className={'mt-1 d-flex ms-4'} key={index}>\r\n                <div className={'border border-dark'}></div>\r\n                { isattr && <input onChange={(evt) => { changeDValue(evt, index, false) }} className={'input ms-1'} value={val.value + ''}\r\n                                   checked={!!val.value} min={min} max={max} type={field} step={stepSize} maxLength={maxLength} placeholder={\"empty\"}/> }\r\n                { isenum && <select onChange={(evt) => {changeDValue(evt, index, true)}} className={'ms-1 select'} value={val.rawValue+''} data-valuedebug={val.rawValue}>\r\n                    {<option key=\"undefined\" value={'undefined'}>-----</option>}\r\n                    { select_options }\r\n                </select>}\r\n                { isref && <select onChange={(evt) => {changeDValue(evt, index, true)}} className={'ms-1 select'} value={val.rawValue+''} data-valuedebug={val.rawValue}>\r\n                    <option value={'undefined'}>-----</option>\r\n                    {select_options}\r\n                </select>}\r\n                { isshapeless && <>\r\n                    { <select key={index} onChange={(evt) => {changeDValue(evt, index, undefined)}} className={'select ms-1'} value={val.rawValue+''}>{select_options}</select> }\r\n                    →\r\n                    { <input key={\"raw\"+index} onChange={(evt) => {changeDValue(evt, index, false)}} className={'input ms-1'} value={val.rawValue+''} list={\"objectdatalist\"} type={\"text\"} placeholder={\"empty\"}/> }\r\n                    { /*(val as LObject)?.id && <span>points to {val}</span> */}\r\n                </>\r\n                }\r\n                <button className={'btn btn-danger ms-2'} onClick={(evt) => {remove(index, isPtr)}}>\r\n                    <i className={'p-1 bi bi-trash3-fill'}></i>\r\n                </button>\r\n        </div>);\r\n\r\n    return(<div>\r\n        <div className={'d-flex'}>\r\n            <label className={'ms-1 my-auto'}>Values</label>\r\n            <button className={'btn btn-primary ms-auto me-1'} disabled={filteredvalues.length >= upperBound} onClick={add}>\r\n                <i className={'p-1 bi bi-plus'}></i>\r\n            </button>\r\n        </div>\r\n        { valueslist }\r\n        <hr className={\"my-3\"} />\r\n        <MqttEditor valueId={dValue.id} />\r\n    </div>)\r\n}\r\n\r\nexport default Value;\r\n","import React, {ReactNode} from \"react\";\r\nimport type {GObject, LModelElement} from \"../../../joiner\";\r\nimport {\r\n    DObject,\r\n    DValue,\r\n    Input,\r\n    LModel,\r\n    LObject,\r\n    LOperation,\r\n    LPointerTargetable,\r\n    LValue,\r\n    Select, Selectors,\r\n    SetFieldAction,\r\n    store\r\n} from \"../../../joiner\";\r\nimport Value from \"./editors/Value\";\r\n\r\nexport default class Structure {\r\n    public static cname: string = \"Structure\";\r\n\r\n    private static BaseEditor(lModelElement: LModelElement) : ReactNode {\r\n        if(!lModelElement) return(<></>);\r\n        return(<>\r\n            {/*<Input obj={lModelElement} field={\"id\"} label={\"ID\"} type={\"text\"} readonly={true} />*/}\r\n            <Input data={lModelElement} field={\"name\"} label={\"Name\"} type={\"text\"} tooltip={\"Element name\"} />\r\n        </>);\r\n    }\r\n    public static ModelEditor(lModel: LModelElement): ReactNode {\r\n        if(!lModel) return(<></>);\r\n        return(<>{Structure.BaseEditor(lModel)}</>);\r\n    }\r\n    public static PackageEditor(lPackage: LModelElement): ReactNode {\r\n        if(!lPackage) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(lPackage)}\r\n            <Input data={lPackage} field={\"uri\"} label={\"NsURI\"} type={\"text\"} tooltip={\"Namespace URI of the package, i.e. the URI that is displayed in the xmlns tag to identify this package in an XMI document\"} />\r\n            <Input data={lPackage} field={\"prefix\"} label={\"NsPrefix\"} type={\"text\"} tooltip={\"Namespace prefix that is used when references to instances of the classes in this package are serialized\"} />\r\n        </>);\r\n    }\r\n    public static ClassEditor(lClass: LModelElement): ReactNode {\r\n        if(!lClass) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(lClass)}\r\n            <Input data={lClass} field={\"abstract\"} label={\"IsAbstract\"} type={\"checkbox\"} tooltip={\"If set to True, the generated implementation class will have the abstract keyword\"} />\r\n            <Input data={lClass} field={\"interface\"} label={\"IsInterface\"} type={\"checkbox\"} tooltip={\"If set to True, only the java interface will be generated. There will be no corresponding implementation class and no create method in the factory\"} />\r\n            <Input data={lClass} field={\"partial\"} label={\"IsPartial\"} type={\"checkbox\"} tooltip={\"If set to True, the class will be partial.\"} />\r\n        </>);\r\n    }\r\n    private static DataTypeEditor(lDataType: LModelElement): ReactNode {\r\n        if(!lDataType) return(<></>);\r\n        return(<Input data={lDataType} field={\"serializable\"} label={\"IsSerializable\"} type={\"checkbox\"} tooltip={\"It represents whether values of this type will be serialized\"} />);\r\n    }\r\n    public static EnumEditor(lEnum: LModelElement): ReactNode {\r\n        if(!lEnum) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(lEnum)}\r\n            {Structure.DataTypeEditor(lEnum)}\r\n        </>);\r\n    }\r\n    private static TypedElementEditor(lTypedElement: LModelElement): ReactNode {\r\n        if(!lTypedElement) return(<></>);\r\n        return(<>\r\n            <Select data={lTypedElement} field={\"type\"} label={\"Type\"} tooltip={\"Element Type\"} />\r\n            <Input data={lTypedElement} field={\"lowerBound\"} label={\"Lower Bound\"} type={\"number\"} tooltip={\"Determines the setting of the required property. If lowerBound is 0, the required property will be set to False. Otherwise, the required property will be set to True\"} />\r\n            <Input data={lTypedElement} field={\"upperBound\"} label={\"Upper Bound\"} type={\"number\"} tooltip={\"Determines the setting of the many property. If upperBound is 1, the many property will be set to False. Otherwise, the many property will be set to True\"} />\r\n            <Input data={lTypedElement} field={\"ordered\"} label={\"IsOrdered\"} type={\"checkbox\"} tooltip={\"It represents whether order is meaningful\"} />\r\n            <Input data={lTypedElement} field={\"unique\"} label={\"IsUnique\"} type={\"checkbox\"} tooltip={\"Indicates whether a many-valued attribute is allowed to have duplicates\"} />\r\n        </>);\r\n    }\r\n    private static StructuralFeatureEditor(lStructuralFeature: LModelElement): ReactNode {\r\n        if(!lStructuralFeature) return(<></>);\r\n        return(<>\r\n            <Input data={lStructuralFeature} field={\"defaultValueLiteral\"} label={\"Default Value Literal\"} type={\"text\"} tooltip={\"Determines the value returned by the get method if the feature has never been set\"} />\r\n            <Input data={lStructuralFeature} field={\"changeable\"} label={\"IsChangeable\"} type={\"checkbox\"} tooltip={\"Indicates whether the reference may be modified. If changeable is set to False, no set() method is generated for the reference\"} />\r\n            <Input data={lStructuralFeature} field={\"volatile\"} label={\"IsVolatile\"} type={\"checkbox\"} tooltip={\"Indicates whether the reference cannot be cached. If volatile is set to True, the generated class does not contain a field to hold the reference and the generated get() and set() methods for the reference are empty\"} />\r\n            <Input data={lStructuralFeature} field={\"transient\"} label={\"IsTransient\"} type={\"checkbox\"} tooltip={\"Indicates whether the reference should not be stored\"} />\r\n            <Input data={lStructuralFeature} field={\"unsettable\"} label={\"IsUnsettable\"} type={\"checkbox\"} tooltip={\"Indicates that the feature may be unset\"} />\r\n            <Input data={lStructuralFeature} field={\"derived\"} label={\"IsDerived\"} type={\"checkbox\"} tooltip={\"A derived feature typically computes its value from those of other features. It will typically be transient and will often be volatile and not changeable. The default copier won't copy it\"} />\r\n        </>); // damiano: derived description tooltip might be wrong\r\n    }\r\n    public static AttributeEditor(lAttribute: LModelElement): ReactNode {\r\n        if(!lAttribute) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(lAttribute)}\r\n            {Structure.TypedElementEditor(lAttribute)}\r\n            {Structure.StructuralFeatureEditor(lAttribute)}\r\n            <Input data={lAttribute} field={\"isID\"} label={\"IsID\"} type={\"checkbox\"} tooltip={\"An ID attribute explicitly models the one unique ID of an object\"} />\r\n        </>);\r\n    }\r\n    public static ReferenceEditor(lReference: LModelElement): ReactNode {\r\n        if(!lReference) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(lReference)}\r\n            {Structure.TypedElementEditor(lReference)}\r\n            {Structure.StructuralFeatureEditor(lReference)}\r\n            <Input data={lReference} field={\"containment\"} label={\"IsContainment\"} type={\"checkbox\"} tooltip={\"Indicates whether the reference is a containment\"} />\r\n            <Input data={lReference} field={\"container\"} label={\"IsContainer\"} type={\"checkbox\"} tooltip={\"Indicates whether the reference is a container. This is the opposite of a containment EReference. If container is true, the generated accessor methods will have container semantics\"} />\r\n            <Input data={lReference} field={\"resolveProxies\"} label={\"IsResolveProxies\"} type={\"checkbox\"} tooltip={\"Indicates whether proxy references should be resolved automatically\"} />\r\n        </>);\r\n    }\r\n    public static EnumLiteralEditor(lEnumLiteral: LModelElement): ReactNode {\r\n        if(!lEnumLiteral) return(<></>);\r\n        //vv4\r\n        return(<>\r\n            {Structure.BaseEditor(lEnumLiteral)}\r\n            <Input data={lEnumLiteral} field={\"value\"} label={\"Ordinal\"} type={\"number\"} tooltip={\"Determines the integer value that is associated with this literal\"} />\r\n        </>);\r\n    }\r\n\r\n    public static OperationEditor(me: LModelElement): ReactNode {\r\n        const operation: LOperation = LOperation.fromPointer(me.id);\r\n        if(!operation) return(<></>);\r\n        return(<>\r\n            {Structure.BaseEditor(operation)}\r\n            <Select data={operation.id} field={'type'} label={'Return'} tooltip={\"Method return type\"} />\r\n            {operation.parameters.map((parameter, index) => {\r\n                if (index > 0) {\r\n                    return <div key={index}>\r\n                        <label className={'ms-1'}>Parameter</label>\r\n                        <div className={'ms-3'}>\r\n                            <Input data={parameter.id} field={\"name\"} label={'• Name'} type={\"text\"} tooltip={\"Name of the generated argument\"} />\r\n                            <Select data={parameter.id} field={\"type\"} label={'• Type'} tooltip={\"Argument type\"} />\r\n                        </div>\r\n                    </div>\r\n                }\r\n            })}\r\n            {operation.exceptions.map((exception, index) => {\r\n                return <div key={index}>\r\n                    <Input data={exception.id} field={\"name\"} label={\"Exception\"} type={\"text\"} tooltip={\"Exception name\"} />\r\n                </div>\r\n            })}\r\n        </>);\r\n    }\r\n    public static ObjectEditor(me: LModelElement): ReactNode {\r\n        const object: LObject = LObject.fromPointer(me.id);\r\n        if(!object) return(<></>);\r\n        let conform = true;\r\n        // damiano todo: this is redundant because it's always conform, but those kind of checks are\r\n        //                 better be done adding a property like lobject.conformsto(lclass)\r\n        for(let feature of object.features) {\r\n            let upperBound =  feature.instanceof ? feature.instanceof.upperBound : -1;\r\n            upperBound = (upperBound === -1) ? 999 : upperBound;\r\n            const lowerBound =  feature.instanceof ? feature.instanceof.lowerBound : -1;\r\n            const value = feature.values;\r\n            // const length = (Array.isArray(value)) ? value.length : (value === '') ? 0 : 1;\r\n            conform = (value.length >= lowerBound && value.length <= upperBound);\r\n        }\r\n\r\n        return(<div>\r\n\r\n            {object.instanceof && conform && <label className={'p-1'}>The instance <b className={'text-success'}>CONFORMS</b> to {object.instanceof.name}</label>}\r\n            {object.instanceof && !conform && <label className={'p-1'}>The instance <b className={'text-danger'}>NOT CONFORMS</b> to {object.instanceof.name}</label>}\r\n            {!object.instanceof && <label className={'p-1'}>The instance is <b className={'text-warning'}>SHAPELESS</b></label>}\r\n            {!object.partial ?\r\n                null :\r\n                <div className={\"d-flex p-1\"}>\r\n                    <label className={'my-auto'}>Features</label>\r\n                    <button className={'btn btn-primary ms-auto'} onClick={()=>{object.addValue()}}>\r\n                        <i className={'p-1 bi bi-plus'}></i>\r\n                    </button>\r\n                </div>\r\n            }\r\n            {this.forceConform(object)}\r\n        </div>);\r\n    }\r\n    public static forceConform(me: LObject) {\r\n        let mm: LModel = Selectors.getLastSelectedModel().m2 as LModel; // LPointerTargetable.fromPointer(store.getState().metamodel as any);\r\n\r\n        if (!mm) return <></>\r\n        return <div className={'d-flex p-1'}>\r\n            <label className={'my-auto'}>Force Type</label>\r\n            <select className={'my-auto ms-auto select'} onChange={ (event)=>{\r\n                (window as any).debugmm = mm;\r\n                (window as any).debugm = me;\r\n                me.instanceof = event.target.value === \"undefined\" ? undefined : event.target.value as any;\r\n            } } value={me.instanceof?.id || \"undefined\"}>\r\n                <optgroup label={mm.name}>\r\n                    {\r\n                        (mm.classes || []).map( c =>\r\n                            <option value={c.id}>{c?.name || c.id}</option>\r\n                        )\r\n                    }\r\n                    <option value={\"undefined\"}>Object</option>\r\n                </optgroup>\r\n            </select>\r\n        </div>\r\n    }\r\n    public static ValueEditor(me: LModelElement): ReactNode {\r\n        const lValue: LValue = LValue.fromPointer(me.id);\r\n        if(!lValue) return(<></>);\r\n        return(<div>\r\n            <Value value={lValue} />\r\n        </div>);\r\n    }\r\n    public static Editor(lModelElement: LModelElement|undefined) : ReactNode {\r\n        if(lModelElement){\r\n            switch (lModelElement.className){\r\n                default: break;\r\n                case \"DModel\": return Structure.ModelEditor(lModelElement);\r\n                case \"DPackage\": return Structure.PackageEditor(lModelElement);\r\n                case \"DClass\": return Structure.ClassEditor(lModelElement);\r\n                case \"DAttribute\": return Structure.AttributeEditor(lModelElement);\r\n                case \"DReference\": return Structure.ReferenceEditor(lModelElement);\r\n                case \"DEnumerator\": return Structure.EnumEditor(lModelElement);\r\n                case \"DEnumLiteral\": return Structure.EnumLiteralEditor(lModelElement);\r\n                case \"DOperation\": return Structure.OperationEditor(lModelElement);\r\n                case \"DObject\" : return Structure.ObjectEditor(lModelElement);\r\n                case \"DValue\" : return Structure.ValueEditor(lModelElement);\r\n            }\r\n        }\r\n        return <div></div>;\r\n    }\r\n}\r\n\r\n","import React, {Dispatch, PureComponent, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DGraphElement,\r\n    DModelElement,\r\n    DPointerTargetable,\r\n    DViewElement,\r\n    DState,\r\n    LGraphElement,\r\n    LModelElement,\r\n    LViewElement,\r\n    Pointer, U,\r\n} from \"../../../joiner\";\r\nimport Structure from \"./Structure\";\r\n\r\n\r\ninterface ThisState {}\r\n\r\nclass StructureEditorComponent extends PureComponent<AllProps, ThisState> {\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n    }\r\n\r\n    render(): ReactNode{\r\n        const lModelElement: LModelElement | undefined = this.props.selected?.modelElement;\r\n        return <div className={\"px-4\"}>\r\n            <div className={\"mt-3\"}>\r\n                {Structure.Editor(lModelElement)}\r\n            </div>\r\n            {/*\r\n            <hr className={'mt-5'} />\r\n            <div>Exportable Json</div>\r\n            <span style={{whiteSpace: \"pre\"}}>{JSON.stringify(lModelElement?.generateEcoreJson(), null, \"\\t\")}</span>\r\n            <hr className={'mt-5'} />\r\n            <div>Internal state</div>\r\n            <span style={{whiteSpace: \"pre\"}}>{JSON.stringify(lModelElement, null, '\\t')}</span>\r\n            */}\r\n        </div>;\r\n    }\r\n}\r\n\r\ninterface OwnProps {}\r\ninterface StateProps {\r\n    selectedid?: { node: Pointer<DGraphElement, 1, 1>; view: Pointer<DViewElement, 1, 1>; modelElement: Pointer<DModelElement, 0, 1> };\r\n    selected?: { node: LGraphElement; view: LViewElement; modelElement?: LModelElement };\r\n}\r\ninterface DispatchProps {}\r\n\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.selectedid = state._lastSelected;\r\n    ret.selected = ret.selectedid && {\r\n        node: DPointerTargetable.wrap(state.idlookup[ret.selectedid.node]) as LGraphElement,\r\n        view: DPointerTargetable.wrap(state.idlookup[ret.selectedid.view]) as LViewElement,\r\n        modelElement: ret.selectedid.modelElement ? DPointerTargetable.wrap<DPointerTargetable, LModelElement>(state.idlookup[ret.selectedid.modelElement]) : undefined };\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    return ret;\r\n}\r\n\r\n\r\nexport const StructureEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(StructureEditorComponent);\r\n\r\nexport const StructureEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <StructureEditorConnected {...{...props, children}} />;\r\n}\r\nexport default StructureEditor;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DState,\r\n    DPointerTargetable,\r\n    DViewElement,\r\n    GObject, Input,\r\n    LModelElement,\r\n    LPointerTargetable,\r\n    LViewElement,\r\n    Pointer, Select, SetRootFieldAction\r\n} from \"../../../joiner\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport Structure from \"../structureEditor/Structure\";\r\n\r\ninterface Props {data: LModelElement}\r\nfunction Child(props: Props) {\r\n    const data = props.data;\r\n    const classname = data.className.slice(1).toLowerCase();\r\n    const css = classname + '-name';\r\n\r\n    const click = (evt: React.MouseEvent<HTMLButtonElement>) => {\r\n        const selected = { node: undefined, view: undefined, modelElement: data.id };\r\n        SetRootFieldAction.new('_lastSelected', selected);\r\n    }\r\n    // I got problems with operation's exception\r\n    return <div className={'mt-1 ms-3'}>\r\n        <div className={'d-flex'}>\r\n            <button className={'btn'} onClick={click}>\r\n                <i className={'bi bi-eye'}></i>\r\n            </button>\r\n            <label className={css + ' ms-1 text-capitalize my-auto'}>{classname}:</label>\r\n            <label className={'ms-1 my-auto'}>{((data as GObject).name) ? (data as GObject).name : 'unnamed'}</label>\r\n        </div>\r\n        {data.className !== 'DOperation' && data.children.map((child, i) => {\r\n            return <Child key={i} data={child} />\r\n        })}\r\n    </div>\r\n}\r\n\r\nfunction TreeEditorComponent(props: AllProps) {\r\n    const data = props.data;\r\n    if(data) {\r\n        const classname = data.className.slice(1).toLowerCase();\r\n        const css = classname + '-name';\r\n        // I got problems with operation's exception\r\n        return <div className={'p-2'}>\r\n            <div className={'d-flex'}>\r\n                <button className={'btn'}>\r\n                    <i className={'bi bi-eye-slash'}></i>\r\n                </button>\r\n                <label className={css + ' ms-1 text-capitalize my-auto'}>{classname}:</label>\r\n                <label className={'ms-1 my-auto'}>{((data as GObject).name) ? (data as GObject).name : 'unnamed'}</label>\r\n            </div>\r\n            {data.className !== 'DOperation' && data.children.map((child, i) => {\r\n                return <Child key={i} data={child} />\r\n            })}\r\n        </div>\r\n    } else return <></>\r\n}\r\ninterface OwnProps { }\r\ninterface StateProps { data: LModelElement|undefined }\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const pointer = state._lastSelected?.modelElement;\r\n    if(pointer) ret.data = LModelElement.fromPointer(pointer);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const TreeEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(TreeEditorComponent);\r\n\r\nexport const TreeEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <TreeEditorConnected {...{...props, children}} />;\r\n}\r\nexport default TreeEditor;\r\n","import React from \"react\";\r\nimport type {LViewElement} from \"../../../view/viewElement/view\";\r\nimport {DViewElement} from \"../../../view/viewElement/view\";\r\nimport {CreateElementAction, DeleteElementAction, SetRootFieldAction} from \"../../../redux/action/action\";\r\nimport {U} from \"../../../joiner\";\r\n\r\ninterface Props { views: LViewElement[]; }\r\nfunction ViewsData(props: Props) {\r\n    const views = props.views;\r\n\r\n    const add = (evt: React.MouseEvent<HTMLButtonElement>) => {\r\n        const jsx =`<div className={'root bg-white'}>Hello World!</div>`;\r\n        const view: DViewElement = DViewElement.new('View', jsx);\r\n        CreateElementAction.new(view);\r\n        SetRootFieldAction.new('stackViews', view.id, '+=', true);\r\n    }\r\n    const remove = (evt: React.MouseEvent<HTMLButtonElement>, index:number, view: LViewElement) => {\r\n        SetRootFieldAction.new('viewelements', view.id, '-=', true);\r\n        DeleteElementAction.new(view.id);\r\n    }\r\n    const select = (evt: React.MouseEvent<HTMLButtonElement>, view: LViewElement) => {\r\n        SetRootFieldAction.new('stackViews', view.id, '+=', true);\r\n    }\r\n\r\n    return(<div>\r\n        <div className={'d-flex p-2'}>\r\n            <b className={'ms-1 my-auto'}>VIEWS</b>\r\n            <button className={'btn btn-primary ms-auto'} onClick={add}>\r\n                <i className={'p-1 bi bi-plus'}></i>\r\n            </button>\r\n        </div>\r\n        {views.map((view, i) => {\r\n            return <div key={i} className={'d-flex p-1 mt-1 border round'}>\r\n                <label className={'my-auto'}>{view?.name}</label>\r\n                <button className={'btn btn-success ms-auto'} onClick={(evt) => {select(evt, view)}}>\r\n                    <i className={'p-1 bi bi-info-lg'}></i>\r\n                </button>\r\n                <button className={'btn btn-danger ms-1'} disabled={U.getDefaultViewsID().includes(view.id)}\r\n                        onClick={(evt) => {remove(evt, i, view)}}>\r\n                    <i className={'p-1 bi bi-trash3-fill'}></i>\r\n                </button>\r\n            </div>\r\n        })}\r\n    </div>);\r\n}\r\n\r\nexport default ViewsData;\r\n","import React from 'react';\r\nimport {LViewElement, Input, SetFieldAction, LViewPoint} from '../../../../joiner';\r\nimport {OclEditor} from \"../../oclEditor/OclEditor\";\r\n\r\ninterface Props {view: LViewElement, viewpoints: LViewPoint[], readonly: boolean}\r\n\r\nfunction InfoData(props: Props) {\r\n    const view = props.view;\r\n    const viewpoints = props.viewpoints;\r\n    const readOnly = props.readonly;\r\n\r\n    const objectTypes = [\"\", \"DModel\", \"DPackage\", \"DEnumerator\", \"DEnumLiteral\", \"DClass\", \"DAttribute\", \"DReference\", \"DOperation\", \"DParameter\", \"DObject\", \"DValue\", \"DStructuralFeature\"];\r\n    const classesOptions = <optgroup label={\"Object type\"}>\r\n            {objectTypes.map((o)=><option key={o} value={o}>{o.length ? o.substring(1) : \"anything\"}</option>)}\r\n    </optgroup>;\r\n\r\n    const changeVP = (evt: React.ChangeEvent<HTMLSelectElement>) => {\r\n        const value = evt.target.value;\r\n        if(value !== 'null') SetFieldAction.new(view.id, 'viewpoint', value, '', true);\r\n        else SetFieldAction.new(view.id, 'viewpoint', '', '', false);\r\n    }\r\n\r\n    return(<>\r\n        <Input data={view} field={\"name\"} label={\"Name\"} type={\"text\"}/>\r\n        <Input data={view} field={\"explicitApplicationPriority\"} label={\"Priority\"} type={\"number\"}/>\r\n        <div className={'d-flex p-1'}>\r\n            <label className={'my-auto'}>Viewpoint</label>\r\n            <select className={'my-auto ms-auto select'} disabled={readOnly}\r\n                    value={String(view.viewpoint?.id)} onChange={changeVP}>\r\n                <option value={'null'}>-----</option>\r\n                {viewpoints.map((viewpoint, index) => {\r\n                    return(<option key={index} value={viewpoint.id}>{viewpoint.name}</option>);\r\n                })}\r\n            </select>\r\n        </div>\r\n        {/* damiano: qui Select component avrebbe fatto comodo al posto del select nativo, ma è troppo poco generica*/}\r\n        <div className=\"p-1\" style={{display: \"flex\"}}><label className=\"my-auto\">Appliable to</label>\r\n            <select data-obj={view.id} data-field={'appliableToClasses'} data-label={'Appliable to'} data-options={ classesOptions }\r\n                    value={view.appliableToClasses[0] || ''} onChange={(e) => { view.appliableToClasses = e.target.value as any; }}\r\n                    className={\"my-auto ms-auto select\"}>\r\n                {classesOptions}\r\n            </select>\r\n        </div>\r\n        <OclEditor viewid={view.id} />\r\n    </>);\r\n}\r\n\r\nexport default InfoData;\r\n","import React from 'react';\r\nimport {LViewElement, Input, SetFieldAction, TextArea} from '../../../../joiner';\r\n\r\ninterface Props {view: LViewElement, readonly: boolean}\r\n\r\nfunction NodeData(props: Props) {\r\n    const view = props.view;\r\n    const readOnly = props.readonly;\r\n\r\n    const objectTypes = [\"\", \"DModel\", \"DPackage\", \"DEnumerator\", \"DEnumLiteral\", \"DClass\", \"DAttribute\", \"DReference\", \"DOperation\", \"DParameter\", \"DObject\", \"DValue\", \"DStructuralFeature\"];\r\n    const classesOptions = <optgroup label={\"Object type\"}>\r\n        {objectTypes.map((o)=><option key={o} value={o}>{o.length ? o.substring(1) : \"anything\"}</option>)}\r\n    </optgroup>;\r\n\r\n    const changeFN = (evt: React.ChangeEvent<HTMLSelectElement>) => {\r\n        const value = evt.target.value;\r\n        SetFieldAction.new(view.id, 'forceNodeType', value, '', false);\r\n    }\r\n\r\n    return(<>\r\n        {/*<Select obj={view} field={\"useSizeFrom\"} options={\r\n            <optgroup label=\"Node position depends from what?\">\r\n                <option value={EuseSizeFrom.view}>View</option>\r\n                <option value={EuseSizeFrom.node}>Graph: Same position in different views</option>\r\n                <option value={EuseSizeFrom.node}>Node: Never the same position (default)</option>\r\n            </optgroup>\r\n        } tooltip={ \"View: Elements with the same view will keep the same position in different graphs\\n\" +\r\n                    \"Graph: Element in a graph will maintain the position when changing view\\n\"+\r\n                    \"Node: Ensuring every visual element uses his personal size (default)\"\r\n        }></Select>*/}\r\n        <Input data={view} field={\"width\"} label={\"Width\"} type={\"number\"}/>\r\n        <Input data={view} field={\"height\"} label={\"Height\"} type={\"number\"}/>\r\n        {/*<Input data={view} field={\"scalezoomx\"} label={\"Zoom X\"} type={\"number\"}/>*/}\r\n        {/*<Input data={view} field={\"scalezoomy\"} label={\"Zoom Y\"} type={\"number\"}/>*/}\r\n        <div className={'d-flex p-1'}>\r\n            <label className={'my-auto'}>Force Node</label>\r\n            <select className={'my-auto ms-auto select'} disabled={readOnly}\r\n                    value={view.forceNodeType} onChange={changeFN}>\r\n                <option value={undefined}>-----</option>\r\n                {['Graph', 'GraphVertex', 'Vertex', 'Field'].map((node, index) => {\r\n                    return(<option key={index} value={node}>{node}</option>);\r\n                })}\r\n            </select>\r\n        </div>\r\n        {/*from damiano: il primo StoreSize tooltip funziona, il secondo no. perchè? l'html viene popolato correttamente ma risulta opacità 0, puoi cercare di risolverlo tu?*/}\r\n        <Input data={view} field={\"storeSize\"} label={\"store Size\"} tooltip={\r\n            <div>\"Active: the node position depends from the view currently displayed. Inactive: it depends from the graph.\"</div>} type={\"checkbox\"} />\r\n        <Input data={view} field={\"storeSize\"} label={\"Store Size\"} type={\"checkbox\"} tooltip={true}/>\r\n        <Input data={view} field={\"lazySizeUpdate\"} label={\"Lazy Update\"} type={\"checkbox\"} tooltip={true}/>\r\n\r\n        <div className=\"p-1\" style={{display: \"flex\"}}><label className=\"my-auto\">Appliable to</label>\r\n            <select data-obj={view.id} data-field={'appliableToClasses'} data-label={'Appliable to'} data-options={classesOptions}\r\n                    value={view.appliableToClasses[0] || ''} onChange={(e) => { view.appliableToClasses = e.target.value as any; }}\r\n                    className={\"my-auto ms-auto select\"} disabled={readOnly}>\r\n                {classesOptions}\r\n            </select>\r\n        </div>\r\n        <Input data={view} field={\"adaptWidth\"} label={\"Adapt Width\"} type={\"checkbox\"}/>\r\n        <Input data={view} field={\"adaptHeight\"} label={\"Adapt Height\"} type={\"checkbox\"}/>\r\n        <Input data={view} field={\"draggable\"} label={\"Draggable\"} type={\"checkbox\"}/>\r\n        <Input data={view} field={\"resizable\"} label={\"Resizable\"} type={\"checkbox\"}/>\r\n        <TextArea data={view} field={'onDragStart'} label={'OnDragStart'} />\r\n        <TextArea data={view} field={'onDragEnd'} label={'OnDragEnd'} />\r\n        <TextArea data={view} field={'onResizeStart'} label={'OnResizeStart'} />\r\n        <TextArea data={view} field={'onResizeEnd'} label={'OnResizeEnd'} />\r\n    </>);\r\n}\r\n\r\nexport default NodeData;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {DState, DViewElement, LViewElement, Pointer, U} from \"../../../joiner\";\r\n\r\n\r\nfunction JsxEditorComponent(props: AllProps) {\r\n    const view = props.view;\r\n    const readOnly = U.getDefaultViewsID().includes(view.id);\r\n    const [jsx, setJsx] = useStateIfMounted(view.jsxString);\r\n\r\n    const change = (value: string|undefined) => {\r\n        if(value !== undefined) setJsx(value);\r\n        //if(value !== undefined) view.jsxString = value;\r\n    }\r\n\r\n\r\n    const blur = (evt: React.FocusEvent<HTMLDivElement>) => {\r\n        view.jsxString = jsx;\r\n    }\r\n\r\n    return <div style={{marginTop: '2.5em', height: '10em'}} tabIndex={-1} onBlur={blur}>\r\n        <label className={'ms-1'}>JSX Editor</label>\r\n        <Editor className={'mx-1'} onChange={change} options={{readOnly: readOnly}}\r\n                defaultLanguage={'html'} value={view.jsxString} />\r\n    </div>;\r\n}\r\ninterface OwnProps { viewid: Pointer<DViewElement, 1, 1, LViewElement>; }\r\ninterface StateProps { view: LViewElement }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.view = LViewElement.fromPointer(ownProps.viewid);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const JsxEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(JsxEditorComponent);\r\n\r\nexport const JsxEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <JsxEditorConnected {...{...props, children}} />;\r\n}\r\n\r\nJsxEditorComponent.cname = \"JsxEditorComponent\";\r\nJsxEditorConnected.cname = \"JsxEditorConnected\";\r\nJsxEditor.cname = \"JsxEditor\";\r\nexport default JsxEditor;\r\n","import React from 'react';\r\nimport {LViewElement, TextArea} from '../../../../joiner';\r\nimport JsxEditor from \"../../jsxEditor/JsxEditor\";\r\n\r\ninterface Props {view: LViewElement, readonly: boolean}\r\n\r\nfunction TemplateData(props: Props) {\r\n    const view = props.view;\r\n    const readOnly = props.readonly;\r\n\r\n    return(<>\r\n        <TextArea data={view} field={\"constants\"} label={\"Constants\"} />\r\n        <TextArea data={view} field={\"preRenderFunc\"} label={\"PreRender Function\"} />\r\n        <JsxEditor viewid={view.id} />\r\n    </>);\r\n}\r\n\r\nexport default TemplateData;\r\n","import React from 'react';\r\nimport {EdgeBendingMode, Input, LViewElement, LViewPoint} from '../../../../joiner';\r\n\r\ninterface Props {view: LViewElement, readonly: boolean}\r\n\r\nfunction EdgeData(props: Props) {\r\n    const view = props.view;\r\n    const readOnly = props.readonly;\r\n\r\n    return(<>\r\n        <section><h1>Edge options</h1>\r\n            <b>to do</b>\r\n            <div style={{display: \"none\"}}>\r\n                <select data-data={view} data-field={\"bendingMode\"} onChange={(e)=> view.bendingMode = e.target.value as any} value={view.bendingMode} data-value={view.bendingMode}>\r\n                    <optgroup label={\"How the edge should bend to address EdgePoints\"}>{\r\n                        Object.keys(EdgeBendingMode).map( k => <option value={(EdgeBendingMode as any)[k]}>{k}</option>)\r\n                    }</optgroup></select>\r\n\r\n                <Input data={view} field={\"edgeEndStopAtBoundaries\"} />\r\n                {/*view.*/}\r\n            </div>\r\n        </section>\r\n    </>);\r\n}\r\n\r\nexport default EdgeData;\r\n","import React from 'react';\r\nimport {CoordinateMode, LViewElement} from '../../../../joiner';\r\nimport {EdgeGapMode} from \"../../../../joiner/types\";\r\n\r\ninterface Props {view: LViewElement, readonly: boolean}\r\n\r\nfunction EdgePointData(props: Props) {\r\n    const view = props.view;\r\n    const readOnly = props.readonly;\r\n\r\n    return(<>\r\n        <section><h1>EdgePoint options</h1>\r\n            <b>to do</b>\r\n            <div style={{display: \"none\"}}>\r\n                <select data-data={view} data-field={\"edgePointCoordMode\"} onChange={(e)=> view.edgePointCoordMode = e.target.value as any}\r\n                        value={view.edgePointCoordMode} data-value={view.edgePointCoordMode}>\r\n                    <optgroup label={\"How the edge should bend to address EdgePoints\"}>{\r\n                        Object.keys(CoordinateMode).map( k => <option value={(CoordinateMode as any)[k]}>{k}</option>)\r\n                    }</optgroup></select>\r\n                <select data-data={view} data-field={\"edgeGapMode\"} onChange={(e)=> view.edgeGapMode = e.target.value as any}\r\n                        value={view.edgeGapMode} data-value={view.edgeGapMode}>\r\n                    <optgroup label={\"How to stop upon meeting an EdgePoint\"}>{\r\n                        Object.keys(EdgeGapMode).map( k => <option value={(EdgeGapMode as any)[k]}>{k}</option>)\r\n                    }</optgroup></select>\r\n            </div>\r\n        </section>\r\n    </>);\r\n}\r\n\r\nexport default EdgePointData;\r\n","import React from \"react\";\r\nimport type {LViewElement, LViewPoint, DViewPoint} from \"../../../joiner\";\r\nimport {SetFieldAction, SetRootFieldAction} from \"../../../redux/action/action\";\r\nimport OclEditor from \"../oclEditor/OclEditor\";\r\nimport JsxEditor from \"../jsxEditor/JsxEditor\";\r\nimport {U,\r\n    Select,\r\n    TextArea,\r\n    Input,\r\n    EdgeBendingMode,\r\n    CoordinateMode} from \"../../../joiner\";\r\nimport {EdgeGapMode} from \"../../../joiner/types\";\r\nimport InfoData from \"./data/InfoData\";\r\nimport NodeData from \"./data/NodeData\";\r\nimport TemplateData from \"./data/TemplateData\";\r\nimport EdgeData from \"./data/EdgeData\";\r\nimport EdgePointData from \"./data/EdgePointData\";\r\nimport {DockLayout} from \"rc-dock\";\r\nimport {LayoutData} from \"rc-dock/lib/DockData\";\r\n\r\ninterface Props { view: LViewElement; viewpoints: LViewPoint[]; }\r\n\r\nfunction ViewData(props: Props) {\r\n    const view = props.view;\r\n    const viewpoints = props.viewpoints;\r\n    const readOnly = U.getDefaultViewsID().includes(view.id);\r\n\r\n    const layout: LayoutData = { dockbox: { mode: 'horizontal', children: [] }};\r\n    const tabs = [\r\n        { id: '1', title: 'Info', group: '1', closable: false, content: <InfoData view={view} viewpoints={viewpoints} readonly={readOnly} /> },\r\n        { id: '2', title: 'Node', group: '1', closable: false, content: <NodeData view={view} readonly={readOnly} /> },\r\n        { id: '3', title: 'Template', group: '1', closable: false, content: <TemplateData view={view} readonly={readOnly} /> },\r\n        { id: '4', title: 'Edge', group: '1', closable: false, content: <EdgeData view={view} readonly={readOnly} /> },\r\n        { id: '5', title: 'EdgePoint', group: '1', closable: false, content: <EdgePointData view={view} readonly={readOnly} /> }\r\n    ];\r\n    layout.dockbox.children.push({tabs});\r\n\r\n    const back = (evt: React.MouseEvent<HTMLButtonElement>) => {\r\n        SetRootFieldAction.new('stackViews', undefined, '-=', true);\r\n    }\r\n\r\n    return(<div>\r\n        <div className={'d-flex p-2'}>\r\n            <b className={'ms-1 my-auto'}>VIEW</b>\r\n            <button className={'btn btn-danger ms-auto'} onClick={back}>\r\n                <i className={'p-1 bi bi-arrow-left'}></i>\r\n            </button>\r\n        </div>\r\n        <DockLayout defaultLayout={layout} style={{position: 'absolute', left: 10, top: 40, right: 10, bottom: 10 }} />\r\n    </div>);\r\n}\r\n\r\nexport default ViewData;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {DState} from \"../../../redux/store\";\r\nimport {connect} from \"react-redux\";\r\nimport {LViewElement, LViewPoint} from \"../../../joiner\";\r\nimport ViewsData from \"./Views\";\r\nimport ViewData from \"./View\";\r\n\r\nfunction ViewsEditorComponent(props: AllProps) {\r\n\r\n    const views = props.views;\r\n    const stackViews = props.stackViews;\r\n    const viewpoints = props.viewpoints;\r\n\r\n    return(<div>\r\n        {(stackViews.length > 0) ?\r\n            <ViewData view={stackViews[stackViews.length - 1]} viewpoints={viewpoints} /> :\r\n            <ViewsData views={views} />}\r\n    </div>);\r\n}\r\ninterface OwnProps { }\r\ninterface StateProps {\r\n    views: LViewElement[];\r\n    stackViews: LViewElement[];\r\n    viewpoints: LViewPoint[];\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.views = LViewElement.fromPointer(state.viewelements);\r\n    ret.stackViews = LViewElement.fromPointer(state.stackViews);\r\n    ret.viewpoints = LViewPoint.fromPointer(state.viewpoints);\r\n    ret.views = ret.views.filter(view => !(view.viewpoint) || view.viewpoint?.id === state.viewpoint);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ViewsEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ViewsEditorComponent);\r\n\r\nexport const ViewsEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ViewsEditorConnected {...{...props, children}} />;\r\n}\r\nexport default ViewsEditor;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState} from \"../../../redux/store\";\r\nimport {LModelElement, LViewElement, LGraphElement, Input}  from \"../../../joiner\";\r\n\r\nfunction StyleEditorComponent(props: AllProps) {\r\n    const selected = props.selected;\r\n    if(!selected) return(<></>);\r\n    return(<div className={'p-3'}>\r\n        {/*<Input obj={selected.node} field={\"id\"} label={\"ID\"} type={\"text\"} readonly={true}/>*/}\r\n        <Input data={selected.node} field={\"x\"} label={\"X Position\"} type={\"number\"} readonly={true} />\r\n        <Input data={selected.node} field={\"y\"} label={\"Y Position\"} type={\"number\"} readonly={true} />\r\n        <Input data={selected.node} field={\"width\"} label={\"Width\"} type={\"number\"} readonly={true} />\r\n        <Input data={selected.node} field={\"height\"} label={\"Height\"} type={\"number\"} readonly={true} />\r\n        <Input data={selected.node} field={\"zIndex\"} label={\"Z Index\"} type={\"number\"} readonly={true} />\r\n        <Input data={selected.node} field={\"selectedBy\"} label={\"Selected By\"} type={\"text\"} readonly={true} />\r\n    </div>);\r\n\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {\r\n    selected?: {\r\n        node: LGraphElement;\r\n        view: LViewElement;\r\n        modelElement?: LModelElement\r\n    };\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    let ret: StateProps = {};\r\n    const selected = state._lastSelected;\r\n    if(selected) {\r\n        const modelElement = state._lastSelected?.modelElement;\r\n        const node = state._lastSelected?.node;\r\n        const view = state._lastSelected?.view;\r\n        if(node && view) {\r\n            ret.selected = {\r\n                node: LGraphElement.fromPointer(node),\r\n                view: LViewElement.fromPointer(node),\r\n                modelElement: (modelElement) ? LModelElement.fromPointer(modelElement) : undefined\r\n            }\r\n        }\r\n    }\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const StyleEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(StyleEditorComponent);\r\n\r\nexport const StyleEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <StyleEditorConnected {...{...props, children}} />;\r\n}\r\nexport default StyleEditor;\r\n\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState, GObject, SetRootFieldAction} from \"../../../joiner\";\r\n\r\n\r\nfunction EdgeEditorComponent(props: AllProps) {\r\n    const strokeWidth = props.strokeWidth;\r\n    const zIndex = props.zIndex;\r\n    const color = props.color;\r\n    const path = props.path;\r\n    const extend = props.extend;\r\n    const referenceM2 = props.referenceM2;\r\n    const referenceM1 = props.referenceM1;\r\n\r\n    const changeOptions = (evt: React.ChangeEvent<HTMLInputElement|HTMLSelectElement>, field: string) => {\r\n        const value = evt.target.value;\r\n        if(value) {\r\n            const options: GObject = {strokeWidth, zIndex, color, path};\r\n            options[field] = value;\r\n            SetRootFieldAction.new('_edgeSettings', options, '', false);\r\n        }\r\n    }\r\n\r\n    const changeDisplayed = (evt: React.ChangeEvent<HTMLInputElement>, field: string) => {\r\n        const value = evt.target.checked;\r\n        const options: GObject = {extend, referenceM2, referenceM1};\r\n        options[field] = value;\r\n        SetRootFieldAction.new('_edgesDisplayed', options, '', false);\r\n    }\r\n\r\n    return(<div className={\"mt-3\"}>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Stroke Width</label>\r\n            <input value={strokeWidth} className={\"input ms-auto\"} type={'number'} step={0.1} min={0}\r\n                   onChange={(evt) => changeOptions(evt, 'strokeWidth')} />\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Z Index</label>\r\n            <input value={zIndex} className={\"input ms-auto\"} type={'number'} step={1}\r\n                   onChange={(evt) => changeOptions(evt, 'zIndex')} />\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Color</label>\r\n            <input value={color} className={\"input ms-auto\"} type={'color'}\r\n                   onChange={(evt) => changeOptions(evt, 'color')} />\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Path</label>\r\n            <select value={path} className={\"select ms-auto\"} onChange={(evt) => changeOptions(evt, 'path')}>\r\n                <option value={'grid'}>Grid</option>\r\n                <option value={'smooth'}>Smooth</option>\r\n                <option value={'straight'}>Straight</option>\r\n            </select>\r\n\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Display Extends</label>\r\n            <input checked={extend} className={\"input ms-auto\"} type={'checkbox'}\r\n                   onChange={(evt) => changeDisplayed(evt, 'extend')} />\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Display References on M2</label>\r\n            <input checked={referenceM2} className={\"input ms-auto\"} type={'checkbox'}\r\n                   onChange={(evt) => changeDisplayed(evt, 'referenceM2')} />\r\n        </div>\r\n        <div className={\"d-flex mx-3 mt-1\"}>\r\n            <label>Display References on M1</label>\r\n            <input checked={referenceM1} className={\"input ms-auto\"} type={'checkbox'}\r\n                   onChange={(evt) => changeDisplayed(evt, 'referenceM1')} />\r\n        </div>\r\n    </div>);\r\n}\r\ninterface OwnProps { }\r\ninterface StateProps {\r\n    strokeWidth: number, zIndex: number, color: string, path: string,\r\n    extend: boolean, referenceM2: boolean, referenceM1: boolean\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;/*\r\n    ret.strokeWidth = edgeSettings.strokeWidth;\r\n    ret.zIndex = edgeSettings.zIndex;\r\n    ret.color = edgeSettings.color;\r\n    ret.path = edgeSettings.path;\r\n    const edgesDisplayed = state._edgesDisplayed;\r\n    ret.extend = edgesDisplayed.extend;\r\n    ret.referenceM2 = edgesDisplayed.referenceM2;\r\n    ret.referenceM1 = edgesDisplayed.referenceM1;*/\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const EdgeEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgeEditorComponent);\r\n\r\nexport const EdgeEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgeEditorConnected {...{...props, children}} />;\r\n}\r\n\r\nEdgeEditorComponent.cname = \"EdgeEditorComponent\";\r\nEdgeEditorConnected.cname = \"EdgeEditorConnected\";\r\nEdgeEditor.cname = \"EdgeEditor\";\r\nexport default EdgeEditor;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {CreateElementAction, SetFieldAction, SetRootFieldAction, DState, DViewPoint, Input, LViewElement, LViewPoint, Pointer, U} from \"../../../joiner\";\r\n\r\n\r\nfunction ViewpointsEditorComponent(props: AllProps) {\r\n    const views = props.views;\r\n    const viewpoints = props.viewpoints;\r\n    const selected = props.selected;\r\n\r\n    const editName = (evt: React.ChangeEvent<HTMLInputElement>, viewpoint: LViewPoint) => {\r\n        viewpoint.name = evt.target.value;\r\n    }\r\n    const add = (evt: React.MouseEvent<HTMLButtonElement>) => {\r\n        const dViewPoint = DViewPoint.new('ViewPoint', '');\r\n        CreateElementAction.new(dViewPoint);\r\n    }\r\n    const remove = (index: number, viewpoint: LViewPoint) => {\r\n        const filteredViews = views.filter(view => view.viewpoint?.id === viewpoint.id);\r\n        for(let view of filteredViews) SetFieldAction.new(view.id, 'viewpoint', null);\r\n        SetRootFieldAction.new('viewpoints', index, '-=', true);\r\n    }\r\n    const select = (viewpoint: LViewPoint) => {\r\n        SetRootFieldAction.new('viewpoint', viewpoint.id, '', true);\r\n    }\r\n\r\n    return(<div>\r\n        <div className={'d-flex p-2'}>\r\n            <b className={'ms-1 my-auto'}>VIEWPOINTS</b>\r\n            <button className={'btn btn-primary ms-auto'} onClick={add}>\r\n                <i className={'p-1 bi bi-plus'}></i>\r\n            </button>\r\n        </div>\r\n        {viewpoints.map((viewpoint, index) => {\r\n            return <div key={index} className={'d-flex p-1 mt-1 border round'}\r\n                        style={{ backgroundColor: (selected.id === viewpoint.id) ? 'white' : 'transparent'}}>\r\n                <input className={'p-0 input hidden-input'} value={viewpoint.name} type={'text'}\r\n                       onChange={(evt) => {editName(evt, viewpoint)}} disabled={index === 0} />\r\n                <button className={'btn btn-success ms-auto'} disabled={selected.id === viewpoint.id}\r\n                        onClick={(evt) => {select(viewpoint)}}>\r\n                    <i className={'p-1 bi bi-check2'}></i>\r\n                </button>\r\n                <button className={'btn btn-danger ms-1'} disabled={index === 0 || selected.id === viewpoint.id}\r\n                        onClick={(evt) => {remove(index, viewpoint)}}>\r\n                    <i className={'p-1 bi bi-trash3-fill'}></i>\r\n                </button>\r\n            </div>\r\n        })}\r\n    </div>);\r\n}\r\ninterface OwnProps { }\r\ninterface StateProps {\r\n    viewpoints: LViewPoint[],\r\n    selected: LViewPoint,\r\n    views: LViewElement[]\r\n}\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.viewpoints = LViewPoint.fromPointer(state.viewpoints);\r\n    ret.selected = LViewPoint.fromPointer(state.viewpoint);\r\n    ret.views = LViewElement.fromPointer(state.viewelements.slice(10))\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ViewpointsEditorConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ViewpointsEditorComponent);\r\n\r\nexport const ViewpointsEditor = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ViewpointsEditorConnected {...{...props, children}} />;\r\n}\r\nexport default ViewpointsEditor;\r\n","import React, {Dispatch, PureComponent, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DState,\r\n    DGraphElement,\r\n    Dictionary,\r\n    GObject,\r\n    LGraphElement,\r\n    LModelElement,\r\n    LPointerTargetable,\r\n    LViewElement,\r\n    Pointer,\r\n    RuntimeAccessibleClass,\r\n    U,\r\n    windoww\r\n} from \"../../../joiner\";\r\nimport * as util from \"util\";\r\nimport {GraphElementComponent} from \"../../../graph/graphElement/graphElement\";\r\n\r\nvar Convert = require('ansi-to-html');\r\nvar ansiConvert = new Convert();\r\n(window as any).ansiconvert = ansiConvert;\r\n\r\nclass ThisState{\r\n    expression!: string;\r\n    output: any;\r\n}\r\n\r\n// trasformato in class component così puoi usare il this nella console. e non usa accidentalmente window come contesto\r\n\r\nlet hiddenkeys = [\"pointedBy\", \"clonedCounter\", \"parent\", \"_subMaps\", \"inspect\", \"__random\"];\r\nfunction fixproxy(output: any/*but not array*/, hideDKeys: boolean = true, addLKeys: boolean = true):\r\n    { output: any, shortcuts?: GObject<'L singleton'>, comments?: Dictionary<string, string | {type:string, txt:string}>, hiddenkeys?: GObject} {\r\n\r\n    let proxy: LPointerTargetable | undefined;\r\n    if (output?.__isProxy) {\r\n        proxy = output;\r\n        output = output.__raw; //Object.fromEntries(Object.getOwnPropertyNames(p).map(k => [k, p[k]]));\r\n    } else proxy = undefined;\r\n\r\n    let ret: ReturnType<typeof fixproxy> = {output};\r\n    switch(typeof output) {\r\n        case \"function\": return {output: U.buildFunctionDocumentation(output)};\r\n        default: return {output};\r\n        case \"object\":\r\n            ret.output = output = {...output};\r\n            if ((addLKeys && proxy)) {\r\n                console.log(\"console output\", {output, proxy});\r\n                let Lsingleton: GObject<'L singleton'> = (RuntimeAccessibleClass.get(output?.className)?.logic?.singleton) || {};\r\n                let comments: Dictionary<string, string | {type:string, txt:string}> = {};\r\n                ret.shortcuts = {...Lsingleton};\r\n                ret.comments = comments;\r\n                for (let key in output) {\r\n                    if (Lsingleton[\"__info_of__\" + key]) comments[key] = Lsingleton[\"__info_of__\" + key];\r\n                }\r\n                for (let key in Lsingleton) {\r\n                    // todo: might define some func private in L like \"private info_of_fieldname\" where fuction body is comment documentation extracted,\r\n                    //  or actually directly private info_of_id = <a href=\"...\"><span>Unique identifier, and value used to point this object.</span></a>\r\n                    if ((key in output) || (key.indexOf(\"__info_of__\") === 0)) {\r\n                        delete ret.shortcuts[key];\r\n                        continue;\r\n                    } else { if (ret.shortcuts[key] === undefined) ret.shortcuts[key] = ''; }\r\n                    if (Lsingleton[\"__info_of__\" + key]) comments[key] = Lsingleton[\"__info_of__\" + key];\r\n                    if (comments[key]) continue; // if explicitly commented, i will not attempt to generate documentation.\r\n                    let entryvalue = Lsingleton[key];\r\n                    switch (typeof entryvalue) {\r\n                        case \"object\":\r\n                        case \"function\":\r\n                            ret.shortcuts[key] = U.buildFunctionDocumentation(entryvalue);\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            if (hiddenkeys) {\r\n                ret.hiddenkeys = {};\r\n                for (let key of hiddenkeys) {\r\n                    ret.hiddenkeys[key] = output[key];\r\n                    delete output[key];\r\n                    // delete output.shortcuts[key];\r\n                }\r\n            }\r\n            break;\r\n    }\r\n    return ret; }\r\n\r\nexport class ConsoleComponent extends PureComponent<AllProps, ThisState>{\r\n    public static cname: string = \"ConsoleComponent\";\r\n    lastNode?: Pointer<DGraphElement>;\r\n    constructor(props: AllProps) {\r\n        super(props);\r\n        this.state = {expression:'', output: null};\r\n        this.change = this.change.bind(this);\r\n        this.change(undefined);\r\n    }\r\n    private _context: GObject = {};\r\n    change(evt?: React.ChangeEvent<HTMLTextAreaElement>) {\r\n        if (!this) return; // component being destroyed and remade after code hot update\r\n        let expression: string | undefined = evt?.target.value.trim() || this.state.expression || '';\r\n        let output;\r\n        // let context = {...this.props, props: this.props}; // makeEvalContext(this.props as any, {} as any);\r\n\r\n        if (this.props.node?.id) {\r\n            let component = GraphElementComponent.map[this.props.node.id];\r\n            this._context = {...component.props.evalContext};\r\n            this._context.fromcomponent = true;\r\n        }\r\n        else {\r\n            this._context = {...this.props, props: this.props};\r\n        }\r\n        try { output = U.evalInContextAndScope(expression || 'undefined', this._context, this._context); }\r\n        catch (e: any) {\r\n            console.error(\"console error\", e);\r\n            output = '<span style=\"color:red\">Invalid Syntax!<br></span>' + e.toString(); }\r\n        this.setState({expression, output});\r\n    }\r\n\r\n    render(){\r\n        const data = this.props.data;/*\r\n        const [expression, setExpression] = useStateIfMounted('data');\r\n        const [output, setOutput] = useStateIfMounted('');*/\r\n        if (!this.props.node) return(<></>);\r\n        if (this.lastNode !== this.props.node.id) this.change(); // force reevaluation if selected node changed\r\n        this.lastNode = this.props.node.id;\r\n\r\n            let outstr;\r\n            // try { outstr = U.circularStringify(this.state.output, (key, value)=> { return value.__isProxy ? value.name : value; }, \"\\t\", 1) }\r\n            // (window as any).inspect = util.inspect;\r\n            // (window as any).tmpp = this.state.output;\r\n            let ashtml: boolean\r\n            let output: any = this.state.output;\r\n            let shortcuts: GObject<'L singleton'> | undefined = undefined;\r\n            let comments: Dictionary<string, string | {type:string, txt:string}> | undefined = undefined;\r\n            let hidden: Dictionary<string, string> | undefined = undefined;\r\n            try {\r\n                let hiddenkeys: GObject | undefined = {};\r\n                if (Array.isArray(output) && output[0]?.__isProxy) {\r\n                    output = output.map(o => fixproxy(o).output);\r\n                    comments = {\"separator\": '<span>Similar to <a href={\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/join\"}>Array.join(separator)</a>' +\r\n                            ', but supports array of JSX nodes and JSX as separator argument.</span>'};\r\n                    shortcuts = {\"separator\": \"\"};\r\n                    console.log(\"console result (array):\", {output});\r\n                }\r\n                else {\r\n                    let ret = fixproxy(output);\r\n                    output = ret.output;\r\n                    comments = ret.comments;\r\n                    shortcuts = ret.shortcuts;\r\n                    hidden = ret.hiddenkeys;\r\n                    console.log(\"console result:\", {output, ret});\r\n                }\r\n                // todo: as i fix the displaying of a LViewElement without replacing it with __raw,\r\n                //  i will fix window, component and props displaying too i think they crash for props.data, props.view...\r\n                if (output?._reactInternals) {\r\n                    output = {\"React.Component\": {props:\"...navigate to expand...\", state:\"\", _isMounted:output._isMounted}}\r\n                }\r\n                let format = (val: GObject) => U.replaceAll(ansiConvert.toHtml(util.inspect(val, true, 2, true)), \"style=\\\"color:#FFF\\\"\", \"style=\\\"color:#000\\\"\");\r\n                outstr = \"<h4>Result:</h4>\" + format(output);\r\n                if (shortcuts || comments){\r\n                    // if(!shortcuts) shortcuts = {};\r\n                    if(!comments) comments = {};\r\n                    if (shortcuts) outstr += \"<br><br><h4>Shortcuts</h4>\" + format(shortcuts);\r\n                    if (hidden) outstr +=\"<br><br><h4>Other less useful properties</h4>\" + format(hidden);\r\n                    for (let commentKey in comments){\r\n                        let commentVal: any = comments[commentKey];\r\n                        if (commentVal?.type) commentVal = \":\" + commentVal?.type + \" ~ \" + commentVal?.txt;\r\n                        let commentKeyEscaped = U.multiReplaceAll(commentKey, [\"$\", \"-\"], [\"\\\\$\", \"\\\\-\"]); // _ should be safe, .-,?^ not happening?\r\n                        let regexp = new RegExp(\"^({?\\\\s*\" +commentKey+\":.*)$\", \"gm\");\r\n                        outstr = outstr.replace(regexp, \"$1 // \" + commentVal);\r\n                    }\r\n                }\r\n                ashtml = true; }\r\n            catch(e: any) {\r\n                console.error(e);\r\n                throw e;\r\n                outstr = \"[circular object]: \" + e.toString();\r\n                ashtml = false;\r\n            }\r\n            console.log(\"console result (string)\", {outstr});\r\n            let contextkeys;\r\n            let objraw = this.state.output?.__raw || (typeof this.state.output === \"object\" ? this.state.output : \"[primitiveValue]\") || {};\r\n            if (this.state.expression.trim() === \"\") contextkeys = [\"data\", \"node\", \"view\", \"getSize()\", \"setSize({x:?, y:?, w:?, h:?})\", \"component\"].join(\", \");\r\n            else if (this.state.expression.trim() === \"this\") contextkeys = [\"Warning: \\\"this\\\" will refer to the Console component instead of a GraphElement component.\"].join(\", \");\r\n            else contextkeys = Array.isArray(objraw) ? [\"array[number]\", ...Object.keys(Array.prototype)].join(\"</br>\") : Object.getOwnPropertyNames(objraw).join(\", \");// || []).join(\", \")\r\n\r\n            this.setNativeConsoleVariables();\r\n            return(<div className={'p-2 w-100 h-100'}>\r\n                <textarea spellCheck={false} className={'p-0 input mb-2 w-100'} onChange={this.change} />\r\n                {/*<label>Query {(this.state.expression)}</label>*/}\r\n                <label>On {((data as GObject)?.name || \"model-less node (\" + this.props.node.className + \")\") + \" - \" + this.props.node?.className}</label>\r\n                <hr className={'mt-1 mb-1'} />\r\n                { ashtml && <div style={{whiteSpace:\"pre\"}} dangerouslySetInnerHTML={ashtml ? { __html: outstr as string} : undefined} /> }\r\n                { !ashtml && <div style={{whiteSpace:\"pre\"}}>{ outstr }</div>}\r\n                <label className={\"mt-2\"}>Context keys:</label>\r\n                {\r\n                    contextkeys\r\n                }\r\n            </div>)\r\n    }\r\n\r\n    private setNativeConsoleVariables(): void { // just fordebugging\r\n        let context = this._context;\r\n        windoww.context = context;\r\n        windoww.data = context.data;\r\n        windoww.node = context.node;\r\n        windoww.edge = context.edge;\r\n        windoww.output = this.state.output;\r\n        if (context.data?.model) windoww.model = context.data?.model;\r\n    }\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps { data: LModelElement|undefined, node: LGraphElement|undefined, view: LViewElement|undefined }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    let ptr;\r\n    ptr = state._lastSelected?.modelElement;\r\n    ret.data = (ptr) ? LModelElement.fromPointer(ptr) : undefined;\r\n    ptr = state._lastSelected?.node;\r\n    ret.node = (ptr) ? LModelElement.fromPointer(ptr) : undefined;\r\n    ptr = state._lastSelected?.view;\r\n    ret.view = (ptr) ? LModelElement.fromPointer(ptr) : undefined;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ConsoleConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ConsoleComponent);\r\n\r\nexport const Console = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ConsoleConnected {...{...props, children}} />;\r\n}\r\n\r\nConsoleComponent.cname = \"ConsoleComponent\";\r\nConsoleConnected.cname = \"ConsoleConnected\";\r\nConsole.cname = \"Console\";\r\nexport default Console;\r\n","import React, {Dispatch, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport \"./toolbar.scss\";\r\nimport {\r\n    DState,\r\n    DGraphElement,\r\n    Dictionary,\r\n    DModel,\r\n    DModelElement,\r\n    DNamedElement,\r\n    DObject,\r\n    DocString,\r\n    DPointerTargetable,\r\n    DViewElement,\r\n    LGraphElement,\r\n    LModel,\r\n    LModelElement,\r\n    LObject,\r\n    LValue,\r\n    LViewElement,\r\n    MyProxyHandler,\r\n    Pointer,\r\n    SetFieldAction,\r\n    RuntimeAccessibleClass,\r\n    DVoidEdge,\r\n    DEdge,\r\n    DEdgePoint,\r\n    EdgeSegment,\r\n    LVoidEdge,\r\n    Constructors,\r\n    WVoidEdge,\r\n    Log,\r\n    LEdgePoint\r\n} from \"../../joiner\";\r\nimport {InitialVertexSizeObj} from \"../../joiner/types\";\r\n\r\ninterface ThisState {}\r\n\r\nfunction getItems(data: LModelElement|undefined, myDictValidator: Dictionary<DocString<\"DClassName\">, DocString<\"hisChildren\">[]>, items: string[], node?:LGraphElement): ReactNode[] {\r\n    const reactNodes: ReactNode[] = [];\r\n    // todo: does myDictValidator have any reason to exist? if something is invalid it should not make it on toolbar jsx generated list\r\n    for (let item_dname of items) {\r\n        if (item_dname[0]==\"_\") {\r\n            item_dname = item_dname.substring(2);\r\n            data = data?.father || data;\r\n        }\r\n        let item = item_dname.substring(1).toLowerCase();\r\n        reactNodes.push(<div className={\"toolbar-item \" + item} key={item_dname} onClick={() => {\r\n            console.log(\"toolbar click:\", {item_dname, data, myDictValidator, items, node});\r\n            switch(item_dname){\r\n                case DVoidEdge.cname:\r\n                case DEdge.cname:\r\n                    // no add edges through toolbar for now\r\n                    break;\r\n                case DEdgePoint.cname:\r\n                    let ledge: LVoidEdge = (node as LEdgePoint | LVoidEdge).edge;\r\n                    let dedge: DVoidEdge = ledge.__raw;\r\n                    let wedge: WVoidEdge = ledge as any;\r\n                    console.log(\"toolbar click:\", {item_dname, data, skip:!myDictValidator[item_dname], items, ledge});\r\n                    // if (!myDictValidator[item_dname]) return;\r\n                    let longestSeg: EdgeSegment = undefined as any; // just because compiler does not know it is always found through the for loop\r\n                    let longestIndex: number=0;\r\n                    let segms = ledge.segments.segments;\r\n                    // longestIndex = segms.length - 1;// i just put it at end because this edgepoint\r\n                    for (; longestIndex < segms.length; longestIndex++) if (segms[longestIndex].isLongest) { longestSeg = segms[longestIndex]; break;}\r\n                    // let index = edge.segments.all.findIndex((s: EdgeSegment) => s.isLongest);\r\n                    let newmp: InitialVertexSizeObj = {...(longestSeg.start.pt.add(longestSeg.end.pt, true).divide(2)), w: 15, h: 15, index:longestIndex};\r\n                    // @ts-ignore\r\n                    newmp.x -= newmp.w/2; newmp.y -= newmp.h/2;\r\n\r\n                    newmp.id = Constructors.makeID();\r\n                    let subelements = [...dedge.subElements];\r\n                    let prevNodeid = longestSeg.start.ge.id;\r\n                    let prevnodeindex = subelements.indexOf(prevNodeid);\r\n                    if (prevnodeindex === -1) {\r\n                        if (prevNodeid === dedge.start) prevnodeindex = 0; // first and last are not subelements\r\n                        else if (prevNodeid === dedge.end) prevnodeindex = subelements.length;\r\n                        else Log.exDevv(\"edgepoint insert position not found\", {subelements, prevNodeid, longestSeg, dedge, ledge});\r\n                    } else prevnodeindex += 1;\r\n                    let goodway = true; // not working// todo: keep his true branch and remove this when finished debug. false crashed for missing father on subelements, guess i need more delay??\r\n                    if (goodway) newmp.index = prevnodeindex;\r\n                    // delete (newmp as any).id;\r\n                    let mp = [...dedge.midPoints];\r\n                    mp.splice(longestIndex, 0, newmp);\r\n                    wedge.midPoints = mp;\r\n                    //\r\n                    let olddebug = [...subelements];\r\n                    subelements.splice(prevnodeindex, 0, newmp.id as string);\r\n                    console.log(\"injecting ep\", {prevnodeindex, newmp, prevNodeid, longestSeg, old: olddebug, new: subelements, ledge, dedge});\r\n                    // this might break pointers too\r\n                    let fixorder = () => { wedge.subElements = subelements; }\r\n                    if (!goodway) setTimeout( fixorder, 1); // need to wait edgepoint creation\r\n                    // selectNode(newmp);\r\n                    break;\r\n                default:\r\n                    if (!data || !myDictValidator) return;\r\n                    let d = data.addChild(item);\r\n                    if (myDictValidator[item_dname]) select(d); break;\r\n            }\r\n        }}>+{item}</div>);\r\n    }\r\n    return reactNodes;\r\n}\r\nfunction select(d: DModelElement): DModelElement {\r\n    if (d && d.id) setTimeout(()=>$(\".Graph [data-dataid='\"+d?.id+\"']\").trigger(\"click\"), 10);\r\n    return d; }\r\nfunction selectNode(d: DGraphElement|{id: string}): any {\r\n    if (d && d.id) setTimeout(()=>$(\".Graph [data-nodeid='\"+d?.id+\"']\").trigger(\"click\"), 10);\r\n    return d; }\r\n\r\nfunction ToolBarComponent(props: AllProps, state: ThisState) {\r\n    const lModelElement: LModelElement = props.selected?.modelElement ? props.selected?.modelElement : MyProxyHandler.wrap(props.model);\r\n    const node: LGraphElement | undefined = props.selected?.node;\r\n    const isMetamodel: boolean = props.isMetamodel;\r\n    const metamodel: LModel|undefined = props.metamodel;\r\n    // const myDictValidator: Map<string, ReactNode[]> = new Map();\r\n    const downward: Dictionary<DocString<\"DClassName\">, DocString<\"hisChildren\">[]> = {}\r\n    const addChildren = (items: string[]) => items ? getItems(lModelElement, downward, [...new Set(items)], node) : [];\r\n\r\n    downward[\"DModel\"] = [\"DPackage\"];\r\n    downward[\"DPackage\"] = [\"DPackage\", \"DClass\", \"DEnumerator\"];\r\n    downward[\"DClass\"] = [\"DAttribute\", \"DReference\", \"DOperation\"];\r\n    downward[\"DEnumerator\"] = [\"DLiteral\"];\r\n    downward[\"DOperation\"] = [\"DParameter\", \"DException\"];\r\n\r\n    // nodes\r\n    // downward[\"DEdge\"] = [\"DEdgePoint\"]\r\n    // downward[\"DVoidEdge\"] = [\"DEdgePoint\"]\r\n\r\n    // for (let parentKey in downward) myDictValidator.set(parentKey, addChildren(\"package\"));\r\n    let upward: Dictionary<DocString<\"DClassName (model)\">, DocString<\"hisDParents\">[]> = {};\r\n    for (let parentKey in downward){\r\n        let vals = downward[parentKey];\r\n        if(!vals) continue;\r\n        for (let child of vals) {\r\n            if (!upward[child]) upward[child] = [];\r\n            upward[child].push(parentKey)\r\n            upward[child].push(...(downward[parentKey]||[]));\r\n        }\r\n    }\r\n\r\n    // exceptions:\r\n    upward[\"DPackage\"] = [\"_pDPackage\"]; //, \"DModel\"]; because from a package, i don't want to prompt the user to create a model in toolbar.\r\n    upward[\"DEdgeNode\"] = []; //, \"DEdge\", \"DVoidEdge\"]; because from a edgeNode, i don't want to prompt the user to create a edge in toolbar.\r\n    // upward[\"DClass\"] = [\"_pDPackage\", \"DClass\", \"DEnumerator\"];\r\n\r\n    // if (RuntimeAccessibleClass.extends(props.selected?.node?.className, DVoidEdge)) { }\r\n    if (isMetamodel) {\r\n        return(<div className={\"toolbar mt-2\"}>\r\n            <b className={'d-block text-center text-uppercase mb-1'}>Add sibling</b>\r\n            {lModelElement && addChildren(upward[lModelElement.className])}\r\n            {node && addChildren(upward[node.className])}\r\n            <hr className={'my-2'} />\r\n            <b className={'d-block text-center text-uppercase mb-1'}>Add sublevel</b>\r\n            {lModelElement && addChildren(downward[lModelElement.className])}\r\n            {node && addChildren(downward[node.className])}\r\n            <div className={\"toolbar-item annotation\"} onClick={() => select(lModelElement.addChild(\"annotation\"))}>+annotation</div>\r\n            <hr className={'my-2'} />\r\n        </div>);\r\n    }\r\n    else {\r\n        const classes = metamodel?.classes;\r\n        const model: LModel = LModel.fromPointer(props.model);\r\n        const lobj: LObject | undefined = lModelElement.className === \"DObject\" ? lModelElement as LObject : undefined;\r\n        const lfeat: LValue | undefined = lModelElement.className === \"DValue\" ? lModelElement as LValue : undefined;\r\n\r\n        return(<div className={\"toolbar mt-2\"}>\r\n            <b className={'d-block text-center text-uppercase mb-1'}>Add root level</b>\r\n            {classes?.filter((lClass) => {return !lClass.abstract && !lClass.interface}).map((lClass, index) => {\r\n                return <div key={\"LObject_\"+lClass.id} className={\"toolbar-item LObject\"} onClick={() => { select(model.addObject(lClass.id)) }}>\r\n                    +{lClass.name}\r\n                </div>\r\n            })}\r\n            <div key={\"RawObject\"} className={\"toolbar-item class\"} onClick={() => { select(model.addObject()); }}>+Object</div>\r\n            <hr className={'my-2'} />\r\n            <b className={'d-block text-center text-uppercase mb-1'}>Add sublevel</b>\r\n            {(lobj && (!lobj.instanceof || lobj.partial)) && <div key={\"Feature\"} className={\"toolbar-item feature\"} onClick={() => { lobj.addValue(); }}>+Feature</div>}\r\n            {(lfeat && lfeat.values.length < lfeat.upperBound) && <div key={\"Value\"} className={\"toolbar-item value\"} onClick={() => {\r\n                SetFieldAction.new(lfeat.id, 'value' as any, undefined, '+=', false); }}>+Value</div>}\r\n            {node && addChildren(downward[node.className])}\r\n            <hr className={'my-2'} />\r\n        </div>);\r\n    }\r\n\r\n}\r\ninterface OwnProps {\r\n    model: Pointer<DModel, 1, 1, LModel>;\r\n    isMetamodel: boolean;\r\n    metamodelId?: Pointer<DModelElement, 1, 1, LModelElement>;\r\n}\r\n\r\ninterface StateProps {\r\n    selectedid?: { node: Pointer<DGraphElement, 1, 1>; view: Pointer<DViewElement, 1, 1>; modelElement: Pointer<DModelElement, 0, 1> };\r\n    selected?: { node: LGraphElement; view: LViewElement; modelElement?: LModelElement };\r\n    metamodel?: LModel;\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.selectedid = state._lastSelected;\r\n    ret.selected = ret.selectedid && {\r\n        node: DPointerTargetable.wrap(state.idlookup[ret.selectedid.node]) as LGraphElement,\r\n        view: DPointerTargetable.wrap(state.idlookup[ret.selectedid.view]) as LViewElement,\r\n        modelElement: ret.selectedid.modelElement ? DPointerTargetable.wrap<DPointerTargetable, LModelElement>(state.idlookup[ret.selectedid.modelElement]) : undefined\r\n    };\r\n    if(ownProps.metamodelId) { ret.metamodel = LModel.fromPointer(ownProps.metamodelId); }\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ToolBarConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ToolBarComponent);\r\n\r\nexport const ToolBar = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ToolBarConnected {...{...props, children}} />;\r\n}\r\nexport default ToolBar;\r\n\r\n\r\n\r\n\r\n","import React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState, GObject, LClass, LPointerTargetable, LUser} from \"../../joiner\";\r\nimport \"./edge.scss\";\r\nimport Xarrow, {Xwrapper} from \"react-xarrows\";\r\n\r\nfunction PendingEdgeComponent(props: AllProps) {\r\n\r\n    const source = props.source;\r\n    const [mousePosition, setMousePosition] = useStateIfMounted({x: 0, y: 0});\r\n    const options = props.edgeSettings;\r\n\r\n    useEffect(() => {\r\n        if(source) {\r\n            const updateMousePosition = (ev: MouseEvent) => {setMousePosition({x: ev.clientX, y: ev.clientY});};\r\n            window.addEventListener('mousemove', updateMousePosition);\r\n            return () => {window.removeEventListener('mousemove', updateMousePosition);};\r\n        }\r\n    }, );\r\n\r\n    return <Xwrapper>\r\n        <div style={{top: mousePosition.y - 100, left: mousePosition.x - 10}}\r\n             id={'extend-target'}></div>\r\n        {source && <Xarrow start={source.nodes[0].id} end={'extend-target'} {...options} />}\r\n    </Xwrapper>;\r\n}\r\n\r\ninterface OwnProps { }\r\ninterface StateProps { user?: LUser, source?: LClass, edgeSettings?: GObject }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = { } as any;\r\n/*    ret.user = LPointerTargetable.from(state.isEdgePending.user);\r\n    ret.source = LPointerTargetable.from(state.isEdgePending.source);\r\n    ret.edgeSettings = state._edgeSettings;*/\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const PendingEdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(PendingEdgeComponent);\r\n\r\nexport const PendingEdge = (props: AllProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <PendingEdgeConnected {...{...props, children}} />;\r\n}\r\nexport default PendingEdge;\r\n","import axios, {AxiosRequestConfig, AxiosResponse} from 'axios';\r\nimport {GObject, LModelElement, LNamedElement, U} from \"../joiner\";\r\nimport {MemoRecModel, MemoRecNamed, MemoRecObject} from \"./types\";\r\n\r\n/*\r\n\r\nper cors policy il client deve mandare richieste allo stesso server.\r\nquindi le deve mandare a node.js e node.js server deve rimandarle a spring con un proxy server\r\n\r\n*/\r\n\r\nexport default class MemoRec {\r\n    static async post(path: string, obj: MemoRecObject): Promise<AxiosResponse> {\r\n        console.clear();\r\n        return await axios.post('/' + path, obj);\r\n    }\r\n\r\n    static async structuralFeature(me: LModelElement): Promise<{data:GObject[], type:'class'|'package'}> {\r\n\r\n        const named: LNamedElement = LNamedElement.fromPointer(me.id);\r\n        const model = me.model;\r\n        const classes = model.classes;\r\n\r\n\r\n        const memorecClasses: MemoRecNamed[] = [];\r\n\r\n        for(let myClass of classes) {\r\n            const attributes = myClass.attributes.map(x => x.name);\r\n            const references = myClass.references.map(x => x.name);\r\n            memorecClasses.push({name: myClass.name, methodInvocations: [...attributes, ...references]});\r\n        }\r\n\r\n        const memorecModel: MemoRecModel = {name: model.name, methodDeclarations: memorecClasses};\r\n\r\n        const memorecObject: MemoRecObject = {context: named.name, model: memorecModel};\r\n        console.log('input', memorecObject);\r\n\r\n        const response = await MemoRec.post('structuralFeatures', memorecObject);\r\n        console.log(response);\r\n\r\n        const data:GObject[] = response.data.slice(0, 10);\r\n        data.sort((a,b) => b.score - a.score);\r\n\r\n        // SetRootFieldAction.new('memorec', {data: response.data, type: 'class'});\r\n        return {data: data, type: 'class'};\r\n\r\n    }\r\n\r\n    static async classifier(me: LModelElement): Promise<{data:GObject[], type:'class'|'package'}> {\r\n        console.clear();\r\n        const named: LNamedElement = LNamedElement.fromPointer(me.id);\r\n        const model = me.model;\r\n        const packages= model.packages;\r\n\r\n        const memorecPackages: MemoRecNamed[] = [];\r\n\r\n        for(let myPackage of packages) {\r\n            const classes = myPackage.classes.map(x => x.name);\r\n            memorecPackages.push({name: myPackage.name, methodInvocations: classes});\r\n        }\r\n        const memorecModel: MemoRecModel = {name: model.name, methodDeclarations: memorecPackages};\r\n\r\n        const memorecObject: MemoRecObject = {context: named.name, model: memorecModel};\r\n        console.log('input', memorecObject);\r\n\r\n        const response = await MemoRec.post('classes', memorecObject);\r\n        console.log(response);\r\n\r\n        const data:GObject[] = response.data.slice(0, 10);\r\n        data.sort((a,b) => b.score - a.score);\r\n        //SetRootFieldAction.new('memorec', {data: response.data, type: 'package'}); //setta l'oggetto memorec\r\n        return {data: data, type: 'package'};\r\n    }\r\n}\r\n","import React, {Dispatch, ReactElement, ReactNode, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport \"./style.scss\";\r\nimport {CreateElementAction, SetRootFieldAction} from \"../../redux/action/action\";\r\nimport {\r\n    DValue,\r\n    DViewElement,\r\n    GObject,\r\n    LClass,\r\n    LGraphElement,\r\n    LNamedElement,\r\n    LPackage,\r\n    LUser,\r\n    LValue, DState,\r\n} from \"../../joiner\";\r\nimport MemoRec from \"../../memorec/api\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\n\r\nfunction ContextMenuComponent(props: AllProps) {\r\n\r\n    const user = props.user;\r\n    const display = props.display;\r\n    const position = props.position;\r\n    const me = props.me; //refer to selected\r\n    const node = props.node;\r\n    const jsxList: ReactNode[] = [];\r\n    const [memorec, setMemorec] = useStateIfMounted<{data:GObject[], type:'class'|'package'}|null>(null);\r\n    const [suggestedName, setSuggestedName] = useStateIfMounted('');\r\n\r\n\r\n    useEffect(() => {\r\n        if(!display) close();\r\n    },[display])\r\n\r\n    const close = () => {\r\n        setSuggestedName('');\r\n        setMemorec(null);\r\n        SetRootFieldAction.new(\"contextMenu\", {display: false, x: 0, y: 0});\r\n    }\r\n    const addView = () => {\r\n        if(me) {\r\n            const jsx =`<div className={'root bg-white'}>Hello World!</div>`;\r\n            const dView: DViewElement = DViewElement.new(me.name + 'View', jsx);\r\n            switch(me.className) {\r\n                case 'DClass':\r\n                    dView.query = `context DObject inv: self.instanceof.name = '${me.name}'`;\r\n                    break;\r\n                case 'DAttribute':\r\n                case 'DReference':\r\n                    dView.query = `context DValue inv: self.instanceof.name = '${me.name}'`;\r\n                    break;\r\n                case 'DObject':\r\n                    dView.query = `context DObject inv: self.id = '${me.id}'`;\r\n                    break;\r\n            }\r\n            CreateElementAction.new(dView);\r\n            SetRootFieldAction.new('stackViews', dView.id, '+=', true);\r\n        }\r\n    }\r\n    const structuralFeature = async () => {\r\n        if(!me) return;\r\n        const data = await MemoRec.structuralFeature(me);\r\n        setMemorec(data);\r\n    }\r\n\r\n    const classifier = async() => {\r\n        if (!me) return;\r\n        const data = await MemoRec.classifier(me);\r\n        setMemorec(data);\r\n    }\r\n\r\n    const suggestOnClass = (isAttribute:boolean) => {\r\n        if(!me) return;\r\n        const lClass: LClass = LClass.fromPointer(me.id);\r\n        if(isAttribute) lClass.addAttribute(suggestedName);\r\n        else lClass.addReference(suggestedName);\r\n        //add attribute/refence to class\r\n        close();\r\n\r\n    }\r\n    const suggestOnPackage = () => {\r\n        if(!me) return;\r\n        const lPackage: LPackage = LPackage.fromPointer(me.id);\r\n        lPackage.addClass(suggestedName);\r\n        //add class to package\r\n        close();\r\n    }\r\n    if(display && me && node) {\r\n        jsxList.push(<div className={\"col title text-center\"}>{me.className}</div>);\r\n        jsxList.push(<hr />);\r\n\r\n        /* Memorec */\r\n        if(me.className === 'DClass')\r\n            jsxList.push(<div onClick={structuralFeature} className={\"col item\"}>AI Suggest <i\r\n                className=\"bi bi-arrow-right-short\"></i></div>);\r\n        if(me.className === 'DPackage')\r\n            jsxList.push(<div onClick={classifier} className={\"col item\"}>AI Suggest</div>);\r\n        jsxList.push(<div onClick={() => {close(); node.zIndex += 1;}} className={\"col item\"}>Up</div>);\r\n        jsxList.push(<div onClick={() => {close(); node.zIndex -= 1;}} className={\"col item\"}>Down</div>);\r\n        jsxList.push(<div onClick={() => {close(); addView();}} className={\"col item\"}>Add View</div>);\r\n        jsxList.push(<div onClick={() => {close(); me?.delete();}} className={\"col item\"}>Delete</div>);\r\n        switch (me.className) {\r\n            case 'DValue': if ((me as any as LValue).instanceof) jsxList.pop(); break;\r\n            case 'DClass':\r\n                jsxList.push(<div onClick={() => {\r\n                    close();\r\n                    SetRootFieldAction.new('isEdgePending', {user: user.id, source: me.id});\r\n                }} className={\"col item\"}>Extend</div>);\r\n                break;\r\n        }\r\n    }\r\n\r\n    return(<>\r\n\r\n        <div className={\"context-menu round\"} style={{top: position.y - 100, left: position.x - 10}}>\r\n            {jsxList.map((jsx, index) => { return <div key={index}>{jsx}</div>; })}\r\n        </div>\r\n\r\n        {(memorec) && <div className={\"context-menu round\"} style={{top: position.y - 100, left: position.x + 130}}>\r\n\r\n            {(memorec && memorec.data?.map((obj, index) => {\r\n                return (<div key={index}>\r\n                    <div className={\"col item2\"} onClick={() => setSuggestedName(obj.recommendedItem)}>\r\n                        {obj.recommendedItem} : {obj.score}\r\n                    </div>\r\n                </div>)\r\n            })) }\r\n\r\n        </div>}\r\n        {(memorec && suggestedName) && <div className={\"context-menu round\"} style={{top: position.y - 100, left: position.x + 270}}>\r\n\r\n            {(memorec?.type === 'class') ? <>\r\n                <div> <div className={'col item2'} onClick={() =>suggestOnClass(true)} >attribute</div> </div>\r\n                <div><div className={'col item2'} onClick={() =>suggestOnClass(false)} >reference</div> </div>\r\n            </> : <div> <div className={'col item2'} onClick={() =>suggestOnPackage()}> class </div> </div>}\r\n        </div>\r\n        }\r\n    </>);\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {\r\n    user: LUser,\r\n    display: boolean,\r\n    position: {x: number, y: number},\r\n    me?: LNamedElement,\r\n    node?: LGraphElement,\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const user = LUser.from(state.currentUser);\r\n    const display = state.contextMenu.display;\r\n    const position = {x: state.contextMenu.x, y: state.contextMenu.y}\r\n    const mePointer = state._lastSelected?.modelElement;\r\n    const me: LNamedElement | undefined = mePointer ? LNamedElement.fromPointer(mePointer) : undefined;\r\n    const nodePointer = state._lastSelected?.node;\r\n    const node: LGraphElement | undefined = nodePointer ? LGraphElement.fromPointer(nodePointer) : undefined;\r\n    const ret: StateProps = { user, display, position, me, node };\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ContextMenuConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ContextMenuComponent);\r\n\r\nexport const ContextMenu = (props: OwnProps, childrens: (string | React.Component)[] = []): ReactElement => {\r\n    return <ContextMenuConnected {...{...props, childrens}} />;\r\n}\r\nexport default ContextMenu;\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DGraphElement, LGraphElement} from \"../../model/dataStructure\";\r\nimport {GObject, Pointer, SetRootFieldAction} from \"../../joiner\";\r\nimport Xarrow from \"react-xarrows\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport crypto from \"crypto\";\r\nimport $ from \"jquery\";\r\n\r\nfunction ReferenceEdgeComponent(props: AllProps) {\r\n    const source = props.source;\r\n    const target = props.target;\r\n    const containment = props.containment;\r\n    let startOptions = props.options;\r\n    let endOptions = props.options;\r\n    if(containment) {\r\n        startOptions = {\r\n            ...startOptions,\r\n            showTail: true,\r\n            tailSize: 15,\r\n            tailShape: {svgElem: <rect style={{\r\n                    rotate: '45deg', fill: 'white', strokeWidth: '0.1', stroke: startOptions.color,\r\n                }} width='.5pt' height='.5pt' />, offsetForward: 1}\r\n        }\r\n    }\r\n\r\n    const [middleAnchor, setMiddleAnchor] = useStateIfMounted('');\r\n    useEffectOnce(() => {\r\n        setMiddleAnchor(crypto.randomBytes(20).toString('hex'));\r\n    });\r\n    useEffect(() => {\r\n        const middleware: GObject = $('[id=\"' + middleAnchor + '\"]');\r\n        if(middleware) {\r\n            middleware.draggable({\r\n                cursor: \"grabbing\",\r\n                containment: \"window\",\r\n                drag: function (event: GObject, obj: GObject) {\r\n                    SetRootFieldAction.new(\"dragging\", {})\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    if(props.display) {\r\n        return(<>\r\n            <div style={{borderColor: startOptions.color}} id={middleAnchor} className={'middle-anchor'}></div>\r\n            <Xarrow start={source.id} end={middleAnchor} {...startOptions} showHead={false} />\r\n            <Xarrow start={middleAnchor} end={target.id} {...endOptions} />\r\n        </>);\r\n    } else { return(<></>); }\r\n\r\n}\r\ninterface OwnProps {\r\n    sourceID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    targetID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    containment: boolean;\r\n}\r\ninterface StateProps { source: LGraphElement, target: LGraphElement, options: GObject, display: boolean }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = { } as any;\r\n/*    ret.source = LGraphElement.fromPointer(ownProps.sourceID);\r\n    ret.target = LGraphElement.fromPointer(ownProps.targetID);\r\n    ret.options = state._edgeSettings;\r\n    ret.display = state._edgesDisplayed.referenceM2;*/\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ReferenceEdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ReferenceEdgeComponent);\r\n\r\nexport const ReferenceEdge = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ReferenceEdgeConnected {...{...props, children}} />;\r\n}\r\nexport default ReferenceEdge;\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DGraphElement, LGraphElement} from \"../../model/dataStructure\";\r\nimport {GObject, Pointer, SetRootFieldAction} from \"../../joiner\";\r\nimport Xarrow from \"react-xarrows\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport crypto from \"crypto\";\r\nimport $ from \"jquery\";\r\n\r\nfunction ExtendEdgeComponent(props: AllProps) {\r\n    const source = props.source;\r\n    const target = props.target;\r\n    let options = props.options;\r\n    options = {\r\n        ...options,\r\n        showHead: true,\r\n        headSize: 15,\r\n        headColor: 'white',\r\n        headShape: {svgElem:<svg><path strokeWidth={0.1} stroke={options.color} d={'M 0 0 L 1 0.5 L 0 1 L 0 0 z'} /></svg>}\r\n    }\r\n\r\n    const [middleAnchor, setMiddleAnchor] = useStateIfMounted('');\r\n    useEffectOnce(() => {\r\n        setMiddleAnchor(crypto.randomBytes(20).toString('hex'));\r\n    });\r\n    useEffect(() => {\r\n        const middleware: GObject = $('[id=\"' + middleAnchor + '\"]');\r\n        if(middleware) {\r\n            middleware.draggable({\r\n                cursor: \"grabbing\",\r\n                containment: \"window\",\r\n                drag: function (event: GObject, obj: GObject) {\r\n                    SetRootFieldAction.new(\"dragging\", {})\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    if(props.display) {\r\n        return(<>\r\n            <div style={{borderColor: options.color}} id={middleAnchor} className={'middle-anchor'}></div>\r\n            <Xarrow start={source.id} end={middleAnchor} {...options} showHead={false} />\r\n            <Xarrow start={middleAnchor} end={target.id} {...options} />\r\n        </>);\r\n    } else { return(<></>); }\r\n\r\n}\r\ninterface OwnProps {\r\n    sourceID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    targetID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n}\r\ninterface StateProps { source: LGraphElement, target: LGraphElement, options: GObject, display: boolean }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = { } as any;\r\n    /*\r\n    ret.source = LGraphElement.fromPointer(ownProps.sourceID);\r\n    ret.target = LGraphElement.fromPointer(ownProps.targetID);\r\n    ret.options = state._edgeSettings;\r\n    ret.display = state._edgesDisplayed.extend;*/\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ExtendEdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ExtendEdgeComponent);\r\n\r\nexport const ExtendEdge = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ExtendEdgeConnected {...{...props, children}} />;\r\n}\r\nexport default ExtendEdge;\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement, useEffect} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DGraphElement, LGraphElement} from \"../../model/dataStructure\";\r\nimport {GObject, Pointer, SetRootFieldAction} from \"../../joiner\";\r\nimport Xarrow from \"react-xarrows\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport crypto from \"crypto\";\r\nimport \"./style.scss\";\r\nimport $ from \"jquery\";\r\n\r\nfunction ValueEdgeComponent(props: AllProps) {\r\n    const source = props.source;\r\n    const target = props.target;\r\n    let options = props.options;\r\n    options = {\r\n        ...options,\r\n        showHead: false\r\n    }\r\n\r\n    const [middleAnchor, setMiddleAnchor] = useStateIfMounted('');\r\n    useEffectOnce(() => {\r\n        setMiddleAnchor(crypto.randomBytes(20).toString('hex'));\r\n    });\r\n    useEffect(() => {\r\n        const middleware: GObject = $('[id=\"' + middleAnchor + '\"]');\r\n        if(middleware) {\r\n            middleware.draggable({\r\n                cursor: \"grabbing\",\r\n                containment: \"window\",\r\n                drag: function (event: GObject, obj: GObject) {\r\n                    SetRootFieldAction.new(\"dragging\", {})\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    if(props.display) {\r\n        return(<>\r\n            <div style={{borderColor: options.color}} id={middleAnchor} className={'middle-anchor'}></div>\r\n            <Xarrow start={source.id} end={middleAnchor} showHead={false} {...options} />\r\n            <Xarrow start={middleAnchor} end={target.id} {...options} />\r\n        </>);\r\n    } else { return(<></>); }\r\n\r\n}\r\ninterface OwnProps {\r\n    sourceID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n    targetID: Pointer<DGraphElement, 1, 1, LGraphElement>;\r\n}\r\ninterface StateProps { source: LGraphElement, target: LGraphElement, options: GObject, display: boolean }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = { } as any;\r\n/*    ret.source = LGraphElement.fromPointer(ownProps.sourceID);\r\n    ret.target = LGraphElement.fromPointer(ownProps.targetID);\r\n    ret.options = state._edgeSettings;\r\n    ret.display = state._edgesDisplayed.referenceM1;*/\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ValueEdgeConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ValueEdgeComponent);\r\n\r\nexport const ValueEdge = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ValueEdgeConnected {...{...props, children}} />;\r\n}\r\nexport default ValueEdge;\r\n","import {DState} from \"../../redux/store\";\r\nimport React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport type {DModel, Pointer} from \"../../joiner\";\r\nimport {LClass, LClassifier, LModel, LObject} from \"../../joiner\";\r\nimport ReferenceEdge from \"./ReferenceEdge\";\r\nimport ExtendEdge from \"./ExtendEdge\";\r\nimport ValueEdge from \"./ValueEdge\";\r\n\r\ninterface IReferenceEdge { source: LClass, target: LClassifier, containment: boolean }\r\ninterface IExtendEdge { source: LClass, target: LClass }\r\ninterface IValueEdge { source: LObject, target: LObject }\r\nfunction EdgesManagerComponent(props: AllProps) {\r\n    const model = props.model;\r\n\r\n    const classes = model.classes && Array.isArray(model.classes) ? model.classes : [];\r\n    const _references: IReferenceEdge[] = [];\r\n    const _extends: IExtendEdge[] = [];\r\n    for(let classifier of classes) {\r\n        for(let reference of classifier.references) {\r\n            _references.push({source: reference.father, target: reference.type, containment: reference.containment});\r\n        }\r\n        for(let father of classifier.extends) {\r\n            _extends.push({source: classifier, target: father});\r\n        }\r\n    }\r\n\r\n    const objects = model.objects;\r\n    const _values: IValueEdge[] = [];\r\n    for(let object of objects) {\r\n        for(let feature of object.features) {\r\n            const instanceOf = feature.instanceof;\r\n            if(instanceOf?.className === 'DReference') {\r\n                const valuePointers = feature.__raw.values;\r\n                for(let pointer of valuePointers) {\r\n                    _values.push({source: object, target: LObject.fromPointer(pointer as Pointer)});\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // return <div> to rework </div>\r\n    return <div>\r\n        {_references.map((referenceEdge, index) => {\r\n            const source = referenceEdge.source.node;\r\n            const target = referenceEdge.target.node;\r\n            const containment = referenceEdge.containment;\r\n            if(source && target) {\r\n                return(<ReferenceEdge key={index} sourceID={source.id} targetID={target.id} containment={containment} />);\r\n            }\r\n        })}\r\n        {_extends.map((extendEdge, index) => {\r\n            const source = extendEdge.source?.node;\r\n            const target = extendEdge.target?.node;\r\n            if(source && target) {\r\n                return(<ExtendEdge key={index} sourceID={source.id} targetID={target.id} />);\r\n            }\r\n        })}\r\n        {_values.map((valueEdge, index) => {\r\n            const source = valueEdge.source?.node;\r\n            const target = valueEdge.target?.node;\r\n            if(source && target) {\r\n                return(<ValueEdge key={index} sourceID={source.id} targetID={target.id} />);\r\n            }\r\n        })}\r\n    </div>\r\n}\r\ninterface OwnProps { modelid: Pointer<DModel, 1, 1, LModel> }\r\ninterface StateProps { model: LModel }\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = { } as any;\r\n    ret.model = LModel.fromPointer(ownProps.modelid);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const EdgesManagerConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EdgesManagerComponent);\r\n\r\nexport const EdgesManager = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <EdgesManagerConnected {...{...props, children}} />;\r\n}\r\nexport default EdgesManager;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport type {DModel, Pointer} from \"../../../joiner\";\r\nimport {DState, CreateElementAction, DGraph, LGraph, LModel} from \"../../../joiner\";\r\nimport {DefaultNode} from \"../../../joiner/components\";\r\nimport ToolBar from \"../../toolbar/ToolBar\";\r\nimport PendingEdge from \"../../../graph/edge/PendingEdge\";\r\nimport ContextMenu from \"../../toolbar/ContextMenu\";\r\nimport EdgesManager from \"../../../graph/edges/EdgesManager\";\r\n\r\nfunction MetamodelTabComponent(props: AllProps) {\r\n    const model = props.model;\r\n    const graph = props.graph;\r\n\r\n    if (!model) return(<>closed tab</>);\r\n    if (!graph) {\r\n        CreateElementAction.new(DGraph.new(0, model.id));\r\n        return(<div style={{width: \"100%\", height: \"100%\", display: \"flex\"}}>\r\n            <span style={{margin: \"auto\"}}>Building the Graph...</span>\r\n        </div>);\r\n    }\r\n\r\n    return(<div className={'w-100 h-100'}>\r\n        <ContextMenu />\r\n        <PendingEdge />\r\n        <div className={'d-flex h-100'}>\r\n            <ToolBar model={model.id} isMetamodel={model.isMetamodel} />\r\n            <div className={\"GraphContainer h-100 w-100\"} style={{position:\"relative\"}}>\r\n                {graph && <DefaultNode data={model.id} nodeid={graph.id} graphid={graph.id}/> || <div>Error: missing DGraph prop</div> }\r\n                {false && <EdgesManager modelid={model.id} />}\r\n            </div>\r\n        </div>\r\n    </div>);\r\n\r\n}\r\ninterface OwnProps { modelid: Pointer<DModel, 1, 1, LModel> }\r\ninterface StateProps { model: LModel, graph: LGraph }\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.model = LModel.fromPointer(ownProps.modelid);\r\n    const graphs: DGraph[] = DGraph.fromPointer(state.graphs);\r\n    const pointers = graphs.filter((graph) => { return graph.model === ret.model?.id });\r\n    if(pointers.length > 0) ret.graph = LGraph.fromPointer(pointers[0].id);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const MetamodelTabConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MetamodelTabComponent);\r\n\r\nexport const MetamodelTab = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <MetamodelTabConnected {...{...props, children}} />;\r\n}\r\nexport default MetamodelTab;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport type {Pointer, DModel} from \"../../../joiner\";\r\nimport {DState, LGraph, LModel, DGraph, DModelElement, LModelElement, CreateElementAction} from \"../../../joiner\";\r\nimport {DefaultNode} from \"../../../joiner/components\";\r\nimport ToolBar from \"../../toolbar/ToolBar\";\r\nimport PendingEdge from \"../../../graph/edge/PendingEdge\";\r\nimport ContextMenu from \"../../toolbar/ContextMenu\";\r\nimport EdgesManager from \"../../../graph/edges/EdgesManager\";\r\n\r\n\r\nfunction ModelTabComponent(props: AllProps) {\r\n    const model = props.model;\r\n    const graph = props.graph;\r\n\r\n    if (!model) return(<>closed tab</>);\r\n    if (!graph) {\r\n        CreateElementAction.new(DGraph.new(0, model.id));\r\n        return(<div style={{width: \"100%\", height: \"100%\", display: \"flex\"}}>\r\n            <span style={{margin: \"auto\"}}>Building the Graph...</span>\r\n        </div>);\r\n    }\r\n\r\n    return(<div className={'w-100 h-100'}>\r\n        <ContextMenu />\r\n        <PendingEdge />\r\n        <div className={'d-flex h-100'}>\r\n            <ToolBar model={model.id} isMetamodel={model.isMetamodel} metamodelId={props.metamodelid} />\r\n            <div className={\"GraphContainer h-100 w-100\"} style={{position:\"relative\"}}>\r\n                {graph && <DefaultNode data={model.id} nodeid={graph.id} graphid={graph.id} />}\r\n                {false && <EdgesManager modelid={model.id} />}\r\n            </div>\r\n        </div>\r\n    </div>);\r\n}\r\ninterface OwnProps {\r\n    modelid: Pointer<DModel, 1, 1, LModel>,\r\n    metamodelid?: Pointer<DModelElement, 1, 1, LModelElement>,\r\n}\r\ninterface StateProps { model: LModel, graph?: LGraph }\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.model = LModel.fromPointer(ownProps.modelid);\r\n    const graphs: DGraph[] = DGraph.fromPointer(state.graphs);\r\n    const pointers = graphs.filter((graph) => { return graph.model === ownProps.modelid });\r\n    if(pointers.length > 0) ret.graph = LGraph.fromPointer(pointers[0].id);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const ModelTabConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(ModelTabComponent);\r\n\r\nexport const ModelTab = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <ModelTabConnected {...{...props, children}} />;\r\n}\r\nexport default ModelTab;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport type {Pointer, DModel} from \"../../../joiner\";\r\nimport {DState, LGraph, LModel, DGraph, DModelElement, LModelElement} from \"../../../joiner\";\r\nimport {DefaultNode} from \"../../../joiner/components\";\r\nimport ToolBar from \"../../toolbar/ToolBar\";\r\nimport PendingEdge from \"../../../graph/edge/PendingEdge\";\r\nimport ContextMenu from \"../../toolbar/ContextMenu\";\r\nimport EdgesManager from \"../../../graph/edges/EdgesManager\";\r\n\r\n\r\nfunction InfoTabComponent(props: AllProps) {\r\n    const metamodels = props.metamodels;\r\n    const models = props.models;\r\n\r\n    return(<div className={'p-1'}>\r\n        <b><label className={'ms-1 text-primary'}>Metamodels ({metamodels.length}):</label></b>\r\n        <br />\r\n        {metamodels.map((model, index) => {\r\n            return(<>\r\n                <label className={'ms-3'} key={index}>-{model.name}</label>\r\n                <br />\r\n            </>);\r\n        })}\r\n        <b><label className={'ms-1 text-primary'}>Models ({models.length}):</label></b><br />\r\n        {models.map((model, index) => {\r\n            return(<>\r\n                <label className={'ms-3'} key={index}>\r\n                    -{model.name} <b className={'text-success'}>{model.instanceof ? \"conforms to\" : \"is shapeless\"}</b> {model.instanceof?.name}\r\n                </label>\r\n                <br />\r\n            </>);\r\n        })}\r\n    </div>);\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {models: LModel[], metamodels: LModel[]}\r\ninterface DispatchProps { }\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    // ret.metamodels = LModel.fromPointer(state.m2models);\r\n    // ret.models = LModel.fromPointer(state.m1models);\r\n    const models: LModel[] = LModel.fromPointer(state.models);\r\n    ret.metamodels = models.filter((m) => {return m.isMetamodel});\r\n    ret.models = models.filter((m) => {return !m.isMetamodel});\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const InfoTabConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(InfoTabComponent);\r\n\r\nexport const InfoTab = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <InfoTabConnected {...{...props, children}} />;\r\n}\r\nexport default InfoTab;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState, DUser, GObject, LModelElement, Selectors, U} from \"../../../joiner\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\n\r\nfunction TestTabComponent(props: AllProps) {\r\n\r\n    const selected = props.selected;\r\n\r\n    const click = () => {\r\n    }\r\n\r\n    return(<div>\r\n        <button onClick={click}>click</button>\r\n        {selected?.id}\r\n    </div>);\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {selected: LModelElement|null}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.selected = LModelElement.fromPointer(state.selected[DUser.current] as any);\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nconst TestTabConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(TestTabComponent);\r\n\r\nconst TestTab = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <TestTabConnected {...{...props, children}} />;\r\n}\r\nexport default TestTab;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {DState, SetRootFieldAction} from \"../../../joiner\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\n\r\n\r\nfunction IotTabComponent(props: AllProps) {\r\n    const iot = props.iot;\r\n    const [topics, setTopics] = useStateIfMounted<string[]>([]);\r\n\r\n    const editTopic = (evt: React.ChangeEvent<HTMLInputElement>, topic: number) => {\r\n        topics[topic] = evt.target.value;\r\n        setTopics([...topics]);\r\n    }\r\n\r\n    const save = () => {\r\n        SetRootFieldAction.new('topics', topics, '', false);\r\n        alert('Configuration Saved!');\r\n    }\r\n\r\n    if(!iot) return(<></>);\r\n\r\n    return(<div className={'px-4'}>\r\n        <div className={'mt-3'}>\r\n            <div className={'p-1 d-flex'}>\r\n                <label className={'my-auto'}>Broker IP</label>\r\n                <input spellCheck={false} className={'my-auto input ms-auto'} type={'text'} />\r\n            </div>\r\n            <hr className={'my-3'} />\r\n            <div className={'d-block text-center mb-2'}>\r\n                <button disabled={topics.length <= 0} className={'me-3 px-2 btn btn-danger'} onClick={() => setTopics(topics.slice(0, -1))}>\r\n                    -\r\n                </button>\r\n                <label>Topics (<b>{topics.length}</b>)</label>\r\n                <button className={'ms-3 px-2 btn btn-success'} onClick={() => setTopics([...topics, ''])}>\r\n                    +\r\n                </button>\r\n            </div>\r\n            {topics.map((value, index) => {\r\n                return(<div className={'p-1 d-flex'}>\r\n                    <label className={'my-auto'}>Topic #<b>{index}</b></label>\r\n                    <input onChange={(evt) => editTopic(evt, index)} spellCheck={false} className={'my-auto input ms-auto'} type={'text'} />\r\n                </div>)\r\n            })}\r\n        </div>\r\n        <button onClick={save} className={'mt-3 d-block btn btn-primary p-1 mx-auto'}>Save</button>\r\n    </div>);\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {iot: null|boolean}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const iot = state.iot;\r\n    return {iot};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nconst IotTabConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(IotTabComponent);\r\n\r\nconst IotTab = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <IotTabConnected {...{...props, children}} />;\r\n}\r\nexport default IotTab;\r\n","import React, {Dispatch, PureComponent, ReactElement, ReactNode} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {DockContext, DockLayout, PanelData, TabData} from \"rc-dock\";\r\nimport {LayoutData} from \"rc-dock/lib/DockData\";\r\nimport Swal from 'sweetalert2'\r\nimport './style.scss';\r\nimport {DState, BEGIN, DGraph, DModel, DModelElement, END, LModel, LModelElement, Pointer, Selectors, U} from '../../joiner';\r\nimport StructureEditor from \"../rightbar/structureEditor/StructureEditor\";\r\nimport TreeEditor from \"../rightbar/treeEditor/treeEditor\";\r\nimport ViewsEditor from \"../rightbar/viewsEditor/ViewsEditor\";\r\nimport StyleEditor from \"../rightbar/styleEditor/StyleEditor\";\r\nimport EdgeEditor from \"../rightbar/edgeEditor/EdgeEditor\";\r\nimport ViewpointEditor from \"../rightbar/viewpointsEditor/ViewpointsEditor\";\r\nimport Console from \"../rightbar/console/Console\";\r\nimport MetamodelTab from \"./tabs/MetamodelTab\";\r\nimport ModelTab from \"./tabs/ModelTab\";\r\nimport InfoTab from \"./tabs/InfoTab\";\r\nimport TestTab from \"./tabs/TestTab\";\r\nimport IotTab from \"./tabs/IotTab\";\r\n\r\nexport class TabDataMaker {\r\n    static metamodel (model: LModel | DModel): TabData {\r\n        if (model.isMetamodel) return { id: model.id, title: model.name, group: 'group1', closable: true, content: <MetamodelTab modelid={model.id} /> };\r\n        return {} as any;\r\n    }\r\n    static model(model: LModel | DModel): TabData {\r\n        return { id: model.id, title: model.name, group: 'group1', closable: true, content:\r\n            <ModelTab modelid={model.id} metamodelid={(model.instanceof as any)?.id || model.instanceof} />\r\n        };\r\n    }\r\n\r\n}\r\n\r\n\r\ninterface ThisState {}\r\nclass DockLayoutComponent extends PureComponent<AllProps, ThisState>{\r\n    private dock: DockLayout|null;\r\n    private dockPanel!: PanelData;\r\n    private dockContext!: DockContext;\r\n\r\n    private groups = {\r\n        'group1': {\r\n            floatable: true,\r\n            maximizable: true,\r\n            panelExtra: (panelData: PanelData, context: DockContext) => {\r\n                this.dockPanel = panelData;\r\n                this.dockContext = context;\r\n                return (<div className={'my-auto'}>\r\n                    <button className={'btn btn-primary me-1'}\r\n                                onClick={(evt) => this.open(evt, context, panelData)}>\r\n                        <i className={'p-1 bi bi-search'}></i>\r\n                    </button>\r\n                    <button className={'btn btn-primary me-1'}\r\n                            onClick={(evt) => this.addMetamodel(evt, context, panelData)}>\r\n                        <i className={'p-1 bi bi-chevron-double-up'}></i>\r\n                    </button>\r\n                    <button className={'btn btn-primary me-1'}\r\n                            onClick={(evt) => this.addModel(evt, context, panelData)}>\r\n                        <i className={'p-1 bi bi-chevron-up'}></i>\r\n                    </button>\r\n                </div>);\r\n            }\r\n        },\r\n        'group2': {\r\n            floatable: true,\r\n            maximizable: true,\r\n        }\r\n    };\r\n\r\n    private test = { id: '999', title: \"Test\", group: \"2\", closable: false, content: <TestTab /> };\r\n    private iotEditor = { id: '0', title: 'Config', group: 'group2', closable: false, content: <IotTab /> };\r\n    private structureEditor = { id: '1', title: 'Structure', group: 'group2', closable: false, content: <StructureEditor /> };\r\n    private treeEditor = { id: '2', title: 'Tree View', group: 'group2', closable: false, content: <TreeEditor /> };\r\n    private viewsEditor = { id: '3', title: 'Views', group: 'group2', closable: false, content: <ViewsEditor /> };\r\n    private styleEditor = { id: '4', title: 'Node', group: 'group2', closable: false, content: <StyleEditor /> };\r\n    private edgeEditor = { id: '5', title: 'Edges', group: 'group2', closable: true, content: <EdgeEditor /> };\r\n    private viewpointEditor = { id: '6', title: 'Viewpoints', group: 'group2', closable: false, content: <ViewpointEditor /> };\r\n    private console = { id: '7', title: 'Console', group: 'group2', closable: false, content: <Console /> };\r\n\r\n    private selected = this.props.selected;\r\n    private views = this.props.views;\r\n    private moveOnStructure = false;\r\n    private moveOnViews = false;\r\n    private iotLoaded = false;\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        this.dock = null;\r\n    }\r\n\r\n    OPEN(model: DModel|LModel): void {\r\n        new Promise(resolve => setTimeout(resolve, 100)).then(() => {\r\n            let tab: TabData;\r\n            if(model.isMetamodel) tab = TabDataMaker.metamodel(model);\r\n            else tab = TabDataMaker.model(model);\r\n            this.dockContext.dockMove(tab, this.dockPanel, 'middle');\r\n        });\r\n    }\r\n\r\n    CLOSE(pointer: Pointer<DModel, 1, 1, LModel>): void {\r\n        new Promise(resolve => setTimeout(resolve, 50)).then(() => {\r\n            this.dockPanel.tabs = this.dockPanel.tabs.filter(tab => tab.id !== pointer);\r\n        });\r\n    }\r\n\r\n    shouldComponentUpdate(newProps: Readonly<AllProps>, newState: Readonly<ThisState>, newContext: any): boolean {\r\n        const oldProps = this.props;\r\n        // if(oldProps.selected !== newProps.selected) { this.moveOnStructure = true; return true; }\r\n        if (oldProps.views !== newProps.views) { this.moveOnViews = true; return true; }\r\n\r\n        const deltaM2 = U.arrayDifference(oldProps.m2, newProps.m2);\r\n        const addedM2: LModel[] = LModel.wrapAll(deltaM2.added);\r\n        const removedM2: Pointer<DModel, 0, 'N', LModel> = deltaM2.removed;\r\n        for(let model of addedM2) this.OPEN(model);\r\n        for(let pointer of removedM2) this.CLOSE(pointer);\r\n\r\n        const deltaM1 = U.arrayDifference(oldProps.m1, newProps.m1);\r\n        const addedM1: LModel[] = LModel.wrapAll(deltaM1.added);\r\n        const removedM1: Pointer<DModel, 0, 'N', LModel> = deltaM1.removed;\r\n        for(let model of addedM1) this.OPEN(model);\r\n        for(let pointer of removedM1) this.CLOSE(pointer);\r\n\r\n        return !!(deltaM2.added.length || deltaM1.added.length || this.props.iot);\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Readonly<AllProps>, prevState: Readonly<ThisState>, snapshot?: any) {\r\n        if(this.dock) {\r\n            if(this.moveOnViews) {\r\n                this.dock.dockMove(this.viewsEditor, this.dock.find('3'), 'middle');\r\n                this.moveOnViews = false;\r\n                return;\r\n            }\r\n            if(this.moveOnStructure) {\r\n                this.dock.dockMove(this.structureEditor, this.dock.find('1'), 'middle');\r\n                this.moveOnStructure = false;\r\n                return;\r\n            }\r\n            if(this.props.iot && !this.iotLoaded) {\r\n                const layout = this.dock.getLayout();\r\n                const tabs = [\r\n                    this.iotEditor,\r\n                    this.structureEditor,\r\n                    this.treeEditor,\r\n                    this.viewsEditor,\r\n                    this.viewpointEditor,\r\n                    this.console,\r\n                    this.edgeEditor\r\n                ];\r\n                layout.dockbox.children[1] = {tabs};\r\n                this.dock.setLayout(layout);\r\n                this.iotLoaded = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    open(evt: React.MouseEvent<HTMLButtonElement>, context: DockContext, panelData: PanelData) {\r\n        let html = '<style>body.swal2-no-backdrop .swal2-container {background-color: rgb(0 0 0 / 60%) !important}</style>';\r\n        html += `<div><b><label class='text-primary'>OPEN AN EXISTING MODEL</label></b><br/>`;\r\n        html += `<select class='mt-2 select' id='select-open-model'>`;\r\n        html += `<optgroup label='Metamodels'>`;\r\n        for(let metamodel of Selectors.getAllMetamodels()) {\r\n            html += `<option value=${metamodel.id}>${metamodel.name}</option>`;\r\n        }\r\n        html += '</optgroup>';\r\n        html += `<optgroup label='Models'>`;\r\n        for(let model of Selectors.getAllModels()) {\r\n            html += `<option value=${model.id}>${model.name}</option>`;\r\n        }\r\n        html += '</optgroup>';\r\n        html += '</select></div>';\r\n        const result = Swal.fire({\r\n            html: html, showCloseButton: true, confirmButtonText: 'OPEN',\r\n            preConfirm: () => {\r\n                const model: HTMLElement|null = document.getElementById('select-open-model');\r\n                return (model) ? (model as HTMLSelectElement).value : null;\r\n            },\r\n            backdrop: false\r\n        });\r\n        result.then((data) => {\r\n            if(data.isConfirmed && data.value) {\r\n                const model: LModel = LModel.fromPointer(data.value);\r\n                this.OPEN(model);\r\n            }\r\n        });\r\n    }\r\n\r\n    async addMetamodel(evt: undefined|React.MouseEvent<HTMLButtonElement>, context: DockContext, panelData: PanelData, model?: DModel) {\r\n        let name = 'metamodel_' + 0;\r\n        let names: (string)[] = Selectors.getAllMetamodels().map(m => m.name);\r\n        name = U.increaseEndingNumber(name, false, false, (newName) => names.indexOf(newName) >= 0)\r\n        model = model || DModel.new(name, undefined, true);\r\n        // DGraph.new(model.id);  <-- viene fatto in autamatico ?\r\n        this.OPEN(model);\r\n    }\r\n    addModel(evt: React.MouseEvent<HTMLButtonElement>, context: DockContext, panelData: PanelData) {\r\n        let html = '<style>body.swal2-no-backdrop .swal2-container {background-color: rgb(0 0 0 / 60%) !important}</style>';\r\n        html += `<div><b><label class='text-primary'>CREATE A MODEL</label></b><br/>`;\r\n        html += `<label>The model will be conform to:</label><br/>`;\r\n        html += `<select class='mt-2 select' id='select-add-model'>`;\r\n        html += `<optgroup label='Metamodels'>`;\r\n        for(let metamodel of Selectors.getAllMetamodels()) {\r\n            html += `<option value=${metamodel.id}>${metamodel.name}</option>`;\r\n        }\r\n        html += '</optgroup>';\r\n        html += '</select></div>';\r\n        const result = Swal.fire({\r\n            html: html, showCloseButton: true, confirmButtonText: 'CREATE',\r\n            preConfirm: () => {\r\n                const metamodel: HTMLElement|null = document.getElementById('select-add-model');\r\n                return (metamodel) ? (metamodel as HTMLSelectElement).value : null;\r\n            },\r\n            backdrop: false\r\n        });\r\n        result.then((data) => {\r\n            if(data.isConfirmed && data.value) {\r\n                let mmid: Pointer<DModel> = data.value;\r\n                const metamodel: LModel = LModel.fromPointer(mmid);\r\n                let name = 'model_' + 0;\r\n                let modelNames: (string)[] = metamodel.models.map(m => m.name);\r\n                name = U.increaseEndingNumber(name, false, false, (newName) => modelNames.indexOf(newName) >= 0)\r\n                BEGIN()\r\n                const model: DModel = DModel.new(name, mmid, false, true);\r\n                DGraph.new(0, model.id);\r\n                END()\r\n                this.OPEN(model);\r\n            }\r\n        });\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const layout: LayoutData = { dockbox: { mode: 'horizontal', children: [] }};\r\n        const infoTab = { id: 'info', title: 'Info', group: 'group1', closable: false, content:\r\n            <InfoTab />\r\n        };\r\n        layout.dockbox.children.push({tabs: [infoTab]});\r\n        const tabs = [\r\n            // this.test,\r\n            // this.iotEditor,\r\n            this.structureEditor,\r\n            this.treeEditor,\r\n            this.viewsEditor,\r\n            this.viewpointEditor,\r\n            // this.styleEditor,\r\n            this.edgeEditor,\r\n            this.console\r\n        ];\r\n        layout.dockbox.children.push({tabs});\r\n\r\n        return (<DockLayout ref={(dockRef) => { this.dock = dockRef }} defaultLayout={layout}\r\n                            groups={this.groups} />);\r\n    }\r\n}\r\n\r\ninterface OwnProps { }\r\ninterface StateProps {\r\n    selected: Pointer<DModelElement, 0, 1, LModelElement>;\r\n    views: number;\r\n    m2: Pointer<DModel, 0, 'N', LModel>;\r\n    m1: Pointer<DModel, 0, 'N', LModel>;\r\n    iot: null|boolean;\r\n}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const selected = state._lastSelected?.modelElement;\r\n    if(selected) ret.selected = selected;\r\n    ret.views = state.viewelements.length;\r\n    ret.m2 = state.m2models;\r\n    ret.m1 = state.m1models;\r\n    ret.iot = state.iot;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const DockLayoutConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(DockLayoutComponent);\r\n\r\nexport const Dock = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <DockLayoutConnected {...{...props, children}} />;\r\n}\r\nexport default Dock;\r\n","export default __webpack_public_path__ + \"static/media/splash.70a592ca.png\";","import {\r\n    Dictionary, DUser,\r\n    EcoreParser, GObject, DState,\r\n    Json,\r\n    LModel,\r\n    LoadAction,\r\n    Log, U,\r\n    LPointerTargetable, prjson2xml, prxml2json,\r\n    store, RuntimeAccessible, DModelElement, SetRootFieldAction, Selectors\r\n} from '../../joiner';\r\n\r\n@RuntimeAccessible\r\nexport class SaveManager {\r\n    public static cname: string = \"SaveManager\";\r\n    private static tmpsave: DState;\r\n\r\n    static save(): void {\r\n        SaveManager.tmpsave = store.getState();\r\n        localStorage.setItem(\"tmpsave\", JSON.stringify(SaveManager.tmpsave));\r\n    }\r\n\r\n    static load(fullstatestr?: string): void {\r\n        if (!fullstatestr && SaveManager.tmpsave) { LoadAction.new(SaveManager.tmpsave); return; }\r\n        fullstatestr = fullstatestr || localStorage.getItem(\"tmpsave\") || 'null'; // priorities: 1) argument from file 2) state variable cached 3) localstorage 4) null prevent crash\r\n        SaveManager.tmpsave = JSON.parse(fullstatestr);\r\n        LoadAction.new(SaveManager.tmpsave);\r\n        // SetRootFieldAction.new('metamodel', Selectors.getActiveModel()?.id, '', true); already set by loadaction in batch\r\n    }\r\n\r\n    public static exportEcore_click(toXML: boolean = false, toFile: boolean = true): void { // e: React.MouseEvent,\r\n        let lmodel: null|LModel = Selectors.getActiveModel();\r\n        if (!lmodel) return;\r\n        let json = SaveManager.exportEcore(lmodel);\r\n        let str = JSON.stringify(json, null, \"\\t\");\r\n        if (toXML) {\r\n            str = prjson2xml.json2xml(json, '\\t');\r\n            str = U.formatXml(str);\r\n        }\r\n\r\n        if (!toFile) {\r\n            // (document.querySelector(\"#export-tmp\") as any).innerText = str;\r\n            localStorage.setItem(\"import\", str);\r\n            return;\r\n        }\r\n        let ism2 = (lmodel as LModel).isMetamodel;\r\n        let name = (lmodel.name || (ism2 ? 'M2' : 'M1') + '_unnamed')  + (toXML ? \".xml\" : '.json') + \".\"+ (ism2 ? \"ecore\" : lmodel.instanceof?.name || \"shapeless\");\r\n        console.log(\"download file:\", {name, ism2, toXML, lmodel, instanceof:lmodel.instanceof});\r\n        U.download(name, str);\r\n    }\r\n\r\n    public static importEcore_click(fromXML: boolean = false, fromfile: boolean = true): void {\r\n        try { this.importEcore_click0(fromXML, fromfile); } catch (e: any) {\r\n            let str = e?.message?.substring?.(0, 1000) || 'some error';\r\n            console.trace(str, e);\r\n            // throw new Error(str);\r\n        }\r\n    }\r\n    public static importEcore_click0(fromXML: boolean = false, fromfile: boolean = true): void {\r\n        const extensions: string[] = [(fromXML ? \"*.xml.*\" : \"*.json.*\")]; // [\".ecore\"]; // Selectors.getActiveModel().isM1() ? '.' + Selectors.getActiveModel().metamodel.fullname() : '.ecore';\r\n        let filestring: string, jsonstring: string, jsonobj: GObject = undefined as any;\r\n        console.log(\"importEcore: prefromfile\");\r\n        if (!fromfile) {\r\n            filestring = localStorage.getItem(\"import\") || 'null';\r\n            if (fromXML) {\r\n                const xmlDoc = new DOMParser().parseFromString(filestring,\"text/xml\");\r\n                jsonobj = prxml2json.xml2jsonobj(xmlDoc, ' ');\r\n            }\r\n            //if (filestring.includes(\"\\n\")) throw new Error(filestring.substring(0, 1000));\r\n            SaveManager.importEcore(jsonobj || filestring, true, undefined, true); // todo: trova il modo di determinare se è m1 o m2 senza filename\r\n            return; }\r\n\r\n        console.log(\"importEcore: pre file read\");\r\n        let filename;\r\n        U.fileRead((e: Event, files?: FileList | null, fileContents?: string[]) => {\r\n            Log.ex(!fileContents || !files || fileContents.length !== files.length, 'Failed to get file contents:', files, fileContents);\r\n            Log.ex(fileContents && fileContents.length > 1, 'Should not be possible to input multiple files yet.');\r\n            if (!fileContents) return;\r\n            if (fileContents.length == 0) return;\r\n            // @ts-ignore\r\n            filename = e.target.files?.[0].name;\r\n            console.log(\"file read\", {e, fileContents, files, filename});\r\n            filestring = fileContents[0];\r\n            console.log('importEcore filestring input: ', filestring);\r\n            if (fromXML) {\r\n                let windoww = window as any;\r\n                windoww.file = filestring;\r\n                windoww.todoc = (str: any) => new DOMParser().parseFromString(str,\"text/xml\");\r\n                windoww.doctojson = (doc: any) => prxml2json.xml2jsonobj(doc, ' ');\r\n                // problemi doctojson or xmi parser: \\n replacemet causa crash per stringa in posizione invalida. \\\" anche per attributi inline che iniiano con \\\\\"\r\n                // filestring = U.multiReplaceAll(filestring, [\"\\t\", \"\\r\", \"\\n\", '&amp;', '&#38;', '&quot;', '&', '\\'', '\"'], [\"\\\\t\", \"\\\\r\", \"\\\\n\", '\\\\&', \"\\\\'\", '\\\\\"', '\\\\&', \"\\\\'\", '\\\\\"']);//,  \"\\\\t\"), \"\\r\", \"\\\\r\"), \"\\n\", \"\\\\n\");\r\n\r\n                const xmlDoc = new DOMParser().parseFromString(filestring,\"text/xml\");\r\n                console.log('importEcore xml:', xmlDoc);\r\n                let jsonstring0 = '';\r\n                jsonobj = prxml2json.xml2jsonobj(xmlDoc, ' ');//doto: non devo wrappare con \\\" i nomi di chiavi o valori ma solo i contenuti\r\n                /*jsonstring = jsonstring0;\r\n                //jsonstring = U.multiReplaceAll(jsonstring0, [\"\\t\", \"\\r\", \"\\n\", '&amp;', '&#38;', '&quot;', '&', '\\'', '\"'], [\"\\\\t\", \"\\\\r\", \"\\\\n\", '\\\\&', \"\\\\'\", '\\\\\"', '\\\\&', \"\\\\'\", '\\\\\"']);//,  \"\\\\t\"), \"\\r\", \"\\\\r\"), \"\\n\", \"\\\\n\");\r\n                *///jsonstring = jsonstring.replaceAll(/(\\{|\\,)\\\\n\\s*/gm, \"\")\r\n                /*if (jsonstring.includes(\"\\n\")) throw new Error(jsonstring0.substring(0, 1000)+\"\\n\\n\\n\\n\" + jsonstring.substring(0, 1000));\r\n                */\r\n                // jsonstring = JSON.stringify(jsonobj);\r\n                console.log('importEcore jsonstr input: ', jsonobj);\r\n            }\r\n            else jsonstring = filestring;\r\n            let isMetamodel = filename.indexOf(\".ecore\") === filename.length - \".ecore\".length;\r\n            console.log(\"ismetamodel\", {filename, isMetamodel});\r\n            let end = SaveManager.importEcore(jsonobj || jsonstring || 'null', isMetamodel,filename, true);\r\n            console.error({end});\r\n        }, extensions, true);\r\n    }\r\n\r\n    public static exportEcore(model: LModel): Json {\r\n        let loopobj = {};\r\n        try { return model.generateEcoreJson(loopobj); }\r\n        catch(e) { Log.exx(\"possible loop in model:\\t\\n\" + (e as Error).message, {loopobj, e}); }\r\n        return {\"error\": true, loopobj};\r\n    }\r\n    public static importEcore(jsonstr: GObject | string | null, isMetamodel: boolean, filename: string | undefined, loadOnModel: boolean = true): DModelElement[] {\r\n        return EcoreParser.parse(jsonstr, isMetamodel, filename, loadOnModel);\r\n    }\r\n\r\n    static exportLayout_click(toFile: boolean) {\r\n        let lmodel: LModel = (LPointerTargetable.wrap(store.getState().models[0]) as LModel);\r\n        // lmodel.node?.allSubNodes\r\n\r\n    }\r\n    static importLayout_click(fromFile: boolean) {\r\n\r\n    }\r\n}\r\n\r\n","import React, {Dispatch, PureComponent, ReactNode} from 'react';\r\nimport {\r\n    Dictionary, DUser,\r\n    GObject, DState,\r\n    Log, U, RedoAction,\r\n    statehistory,\r\n    UndoAction, store,\r\n} from '../../joiner';\r\nimport {connect} from \"react-redux\";\r\n\r\ninterface SaveManagerProps {}\r\n\r\nclass UndoRedoState{\r\n    hover: boolean = false;\r\n    jsx: any | null;\r\n    constructor(jsx: any) {  this.jsx = jsx; }\r\n}\r\n\r\n// private\r\ninterface ThisState {\r\n    undo: UndoRedoState;\r\n    redo: UndoRedoState;\r\n}\r\n\r\n// private\r\ninterface OwnProps {\r\n    // propsRequestedFromHtmlAsAttributes: string;\r\n}\r\n// private\r\ninterface StateProps {\r\n    // propsFromReduxStateOrOtherKindOfStateManagement: boolean; // flux or custom things too, unrelated to this.state of react.\r\n    maxlistsize: number;\r\n    undo: GObject<\"delta\">[],\r\n    redo: GObject<\"delta\">[],\r\n}\r\n\r\n// private\r\ninterface DispatchProps {\r\n    // propsFromReduxActions: typeof funzioneTriggeraAzioneDaImportare;\r\n}\r\n\r\ntype R = {str: string, fullstr: string, path:string[], fullpath:string[], val: string, fullvalue: string, pathlength?: number};\r\n\r\n// private\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\nexport class SaveManagerComponent extends PureComponent<AllProps, ThisState>{\r\n    public static cname: string = \"SaveManagerComponent\";\r\n    private undoredolistoutdated: boolean;\r\n    do_undo = (index: number) => {\r\n        console.error(\"undo(\" + index + \")\");\r\n        UndoAction.new(index+1);\r\n        this.undoenter(); // updates list\r\n    }\r\n    do_redo = (index: number) => {\r\n        console.error(\"redo(\" + index + \")\");\r\n        RedoAction.new(index+1);\r\n        this.redoenter();\r\n    }\r\n    printablePointer(pathsegment: string, state: DState){\r\n        let obj = state.idlookup[pathsegment] as GObject;\r\n        if (!obj) return pathsegment;\r\n        if (obj.name) return \"@\"+obj.name;\r\n        if (obj.className) return \"#\"+obj.className;\r\n        return pathsegment;\r\n    }\r\n    // redo list is updated only when the user mouse-enters it. for efficiency.\r\n    undoredoenter = (key: string = \"undo\") => {\r\n        console.log(\"statemanager undo update\", {thiss:this, undo:this.props.undo, redo: this.props.redo, props: this.props, state:this.state});\r\n        if (!this.undoredolistoutdated) return;\r\n        let s: DState = store.getState();\r\n        let jsx = <>\r\n            {\r\n                [...(this.props as GObject)[key]].reverse().slice(0, this.props.maxlistsize).map((delta, index) => {\r\n                    let out: {best: R}&R[] = [] as GObject as R[] & {best:R};\r\n                    let retuseless = U.ObjectToAssignementStrings(delta, 10, 6, 20, \"…\", out, true);\r\n                    console.log(\"undoredo update\", out);\r\n                    if (out.best.fullstr.includes(\"Pointer\")) {\r\n                        let editedfullpath = out.best.fullpath.map( (pathsegment) => {\r\n                            //  console.log(\"undoredo replace attempt\", {pathsegment, idlookup:s.idlookup, dobj:s.idlookup[pathsegment], replacement: this.printablePointer(pathsegment, s)});\r\n                            return this.printablePointer(pathsegment, s); });\r\n                        out.best.str = editedfullpath.join(\".\") + \" = \" + out.best.val;\r\n                        console.log(\"undoredo replace attempt\", {editedfullpath, beststr:out.best.str, best: out.best});\r\n\r\n                    }\r\n\r\n                    if (out.best.path[0] === \"idlookup\") out.best.str = \"\" + out.best.str.substring(\"idlookup.\".length);\r\n                    if (out.best.fullvalue.includes(\"Pointer\")) {\r\n                        out.best.val = this.printablePointer(out.best.fullvalue.substring(1, out.best.fullvalue.length-1), s); // 1, -1 because string values have quotes \"\"\r\n                        out.best.str = out.best.str.substring(0, out.best.str.lastIndexOf(\"=\")) + \"= \" + out.best.val;\r\n                    }\r\n                    return <li onClick={() => ((this as GObject)[\"do_\"+key](index))} className=\"hoverable\" key={index} style={{overflow: \"visible\", height: \"24px\"}}>\r\n                        <div className={\"preview\"}>{out.best.str}</div>\r\n                        <div className={\"content\"} style={{overflow: \"visible\", height:\"100%\",\r\n                            width: \"max-content\", maxWidth: \"75vw\"}}>{\r\n                            out.map(row => <div style={{background: \"#ddd\", marginLeft: \"-20px\", paddingLeft:\"20px\", height:\"fit-content\", pointerEvents:\"none\"}}>{row.fullpath.join(\".\") + \" = \" + row.fullvalue}</div>)\r\n                        }</div>\r\n                    </li>\r\n                })}</>;\r\n        let obj: GObject = {};\r\n        obj[key] = {...(this.state as GObject)[key], hover: true, jsx};\r\n        // {undo: {...this.state.undo, hover: true, jsx}}\r\n        this.undoredolistoutdated = false;\r\n        this.setState(obj as ThisState);\r\n    }\r\n\r\n    undoenter = ()=>{ return this.undoredoenter(\"undo\"); }\r\n    redoenter = ()=>{ return this.undoredoenter(\"redo\"); }\r\n    undoleave = ()=>{ this.setState({undo: {...this.state.undo, hover: false}}); }\r\n    redoleave = ()=>{ this.setState({redo: {...this.state.redo, hover: false}}); }\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        let undo = new UndoRedoState(<div>undolist example</div>);\r\n        let redo = new UndoRedoState(<div>redolist example</div>);\r\n        this.state = {undo, redo};\r\n        this.undoredolistoutdated = true;\r\n        // this.setState({undo, redo});\r\n    }\r\n    render(): ReactNode {\r\n        this.undoredolistoutdated = true; // if render is called it means redux state props he's watching (redux-state) changed, so the preview list in component-state is outdated.\r\n        // console.log(\"undoredomanager\", {thiss:this, undo:this.props.undo, props: this.props, state:this.state});\r\n\r\n        // simple version without list of changes\r\n        return(<>\r\n            <label className={'item border round ms-1'} onClick={(e)=> { this.do_undo(0) }}>Undo ({this.props.undo.length})</label>\r\n            <label className={'item border round ms-1'} onClick={(e)=> { this.do_redo(0) }}>Redo ({this.props.redo.length})</label>\r\n        </>);\r\n\r\n        // complex version with list of changes\r\n        return(<>\r\n            <div style={{display: \"inline-block\"}}>\r\n                <span className={\"hoverable\"} style={{position: \"relative\", background: \"white\"}} onMouseEnter={this.undoenter} onMouseLeave={this.undoleave}>\r\n                    <button className={'item border round ms-1'} onClick={(e)=> { this.do_undo(0) }}>Undo ({this.props.undo.length})</button>\r\n                    {this.props.undo.length ? <ul style={{background: \"inherit\", width: \"max-content\", zIndex:10000}} className={\"content\"}>{this.state.undo.jsx}</ul> : null}\r\n                </span>\r\n                <span className={\"hoverable\"} style={{position: \"relative\", background: \"white\"}} onMouseEnter={this.redoenter} onMouseLeave={this.redoleave}>\r\n                    <button className={'item border round ms-1'} onClick={(e)=> { this.do_redo(0) }}>Redo ({this.props.redo.length})</button>\r\n                    {this.props.redo.length ? <ul style={{background: \"inherit\", width: \"max-content\", zIndex:10000}} className={\"content\"}>{this.state.redo.jsx}</ul> : null}\r\n                </span>\r\n            </div>\r\n        </>);\r\n    }\r\n}\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.undo = statehistory[DUser.current].undoable;\r\n    ret.redo = statehistory[DUser.current].redoable;\r\n    ret.maxlistsize = 10;\r\n    /// to fill\r\n    return ret; }\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {} as any;\r\n    /// to fill\r\n    return ret; }\r\n\r\nexport const SaveManagerConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(SaveManagerComponent);\r\n\r\nexport default SaveManagerConnected;\r\n","import React, {Dispatch, ReactElement} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport '../topbar/style.scss';\r\nimport {Firebase} from \"../../firebase\";\r\nimport {DUser, DState, U, SetRootFieldAction} from \"../../joiner\";\r\nimport {SaveManager} from \"../topbar/SaveManager\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\n\r\nfunction RoomManagerComponent(props: AllProps) {\r\n    const debug = props.debug;\r\n    const room = (props.room) ? props.room : '';\r\n    const iot = props.iot;\r\n    const root = 'http://localhost:3000/jodel-react/';\r\n    const [loading, setLoading] = useStateIfMounted(false);\r\n\r\n    const create = async(iot: boolean) => {\r\n        const code = U.getRandomString(5);\r\n        await Firebase.add('rooms', code, {\r\n            code: code,\r\n            actions: [],\r\n            createdBy: DUser.current,\r\n            iot: iot\r\n        });\r\n        window.open(root + 'room/' + code, '_blank');\r\n    }\r\n\r\n    const share = () => {U.alert('info', root + 'room/' + room);}\r\n\r\n    const quit = async() => {\r\n        await Firebase.removeRoom(room);\r\n        window.location.replace(root);\r\n    }\r\n\r\n    const deleteAllRoms = async() => {\r\n        setLoading(true);\r\n        console.clear();\r\n        await Firebase.removeAllRooms();\r\n        setLoading(false);\r\n    }\r\n\r\n    if(!room) {\r\n        return(<div >\r\n            <label>Loading: {loading + ''}</label>\r\n            {debug && <label onClick={() => create(true)} className={'item border round ms-1 bg-primary px-2'}>IoT</label>}\r\n            {debug && <label onClick={deleteAllRoms} className={'item border round ms-1 bg-danger px-2'}>Delete All Roms</label>}\r\n            <label onClick={() => create(false)} className={'item border round ms-1 bg-primary'}>Collaborative</label>\r\n        </div>);\r\n    } else {\r\n        if(iot === null) return(<></>);\r\n        return(<div className={'ms-auto'}>\r\n            {(!iot) && <label onClick={share} className={'item border round ms-1 bg-primary'}>Share</label>}\r\n            <label onClick={quit} className={'item border round ms-1 bg-danger'}>Quit</label>\r\n        </div>);\r\n    }\r\n\r\n}\r\ninterface OwnProps {room?: string}\r\ninterface StateProps {iot: null|boolean, debug: boolean}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    const iot = state.iot;\r\n    const debug = state.debug;\r\n    return {iot, debug};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const RoomManagerConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(RoomManagerComponent);\r\n\r\nexport const RoomManager = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <RoomManagerConnected {...{...props, children}} />;\r\n}\r\n\r\nexport default RoomManager;\r\n","import React, {Dispatch, ReactElement, useState} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport './style.scss';\r\nimport {\r\n    DState,\r\n    CreateElementAction,\r\n    DEdgePoint,\r\n    DViewElement,\r\n    DVoidEdge,\r\n    EdgeBendingMode,\r\n    GObject,\r\n    GraphSize,\r\n    Input,\r\n    Selectors,\r\n    SetFieldAction,\r\n    SetRootFieldAction,\r\n    store\r\n} from \"../../joiner\";\r\nimport {SaveManager} from \"./SaveManager\";\r\nimport {DamEdge} from \"../../graph/damedges/damedge\";\r\nimport toast from \"react-hot-toast\";\r\nimport Undoredocomponent from \"./undoredocomponent\";\r\nimport RoomManager from \"../room/RoomManager\";\r\n\r\nfunction Topbar(props: AllProps) {\r\n\r\n    const debug = props.debug;\r\n\r\n    const notify = (text: string) => toast((t: GObject) => (\r\n        <div onClick={() => toast.dismiss(t.id)}>\r\n            <label className={'ms-1'}>{text}</label>\r\n        </div>\r\n    ));\r\n    const [edgetest, setEdgeTest] = useState(<div id={\"edgetest-empty\"}></div>);\r\n\r\n    const save = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.save();\r\n        notify('Saved');\r\n    }\r\n    const load = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.load();\r\n    }\r\n\r\n    const importJson = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.importEcore_click(false, true);\r\n    }\r\n    const exportJson = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.exportEcore_click(false, true);\r\n    }\r\n\r\n    const importXml = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.importEcore_click(true, true);\r\n    }\r\n    const exportXml = (evt: React.MouseEvent<HTMLLabelElement>) => {\r\n        SaveManager.exportEcore_click(true, true);\r\n    }\r\n\r\n    if (debug && !document.body.classList.contains(\"debug\")) document.body.classList.add(\"debug\");\r\n    else document.body.classList.remove(\"debug\")\r\n\r\n    return(<div className={'topbar d-flex'}>\r\n        <label className={'item border round ms-1'} onClick={save}>Save</label>\r\n        <label className={'item border round ms-1'} onClick={load}>Load</label>\r\n        {debug && <Undoredocomponent /> }\r\n\r\n        <label className={'item border round ms-1'} onClick={exportJson}>Export JSON</label>\r\n        <label className={'item border round ms-1'} onClick={importJson}>Import JSON</label>\r\n\r\n        {debug && <>\r\n                <label className={'item border round ms-1'} onClick={exportXml}>Export XML</label>\r\n                <label className={'item border round ms-1'} onClick={importXml}>Import XML</label>\r\n\r\n                <div className={'ms-auto me-1 d-flex'}>\r\n                    <label className={'item border round ms-1'} onClick={ () => SaveManager.exportLayout_click(false) }>Export Layout</label>\r\n                    <label className={'item border round ms-1'} onClick={ () => SaveManager.importLayout_click(false) }>Import Layout</label>\r\n                </div>\r\n            </>\r\n        }\r\n\r\n        <label className={\"p-1 \"} style={{display: \"flex\", cursor: \"auto\"}}>\r\n            <label className={\"my-auto\"}>Debug mode</label>\r\n            <input className={\"my-auto input ms-auto\"} type={\"checkbox\"} checked={props.debug}\r\n                   onChange={(e)=>{SetRootFieldAction.new(\"debug\", e.target.checked)}}\r\n            />\r\n        </label>\r\n\r\n        <div className={'ms-auto d-flex'}>\r\n            <RoomManager room={props.room} />\r\n        </div>\r\n    </div>);\r\n}\r\ninterface OwnProps {room?: string}\r\ninterface StateProps {debug: boolean}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.debug = state.debug;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const TopBarConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Topbar);\r\n\r\nexport const TopBar = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <TopBarConnected {...{...props, children}} />;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n//             <ellipse stroke={\"black\"} fill={\"red\"} cx={this.props.node.end.x} cy={this.props.node.end.y}\r\n//                         rx={this.props.node.end.w} ry={this.props.node.end.h} />\r\n//             <ellipse stroke={\"black\"} fill={\"red\"} cx={this.props.node.start.x} cy={this.props.node.start.y}\r\n//                         rx={this.props.node.start.w} ry={this.props.node.start.h} />\r\nfunction edgetestclick(){\r\n    let jsxmn_svg = `<ellipse stroke={\"black\"} fill={\"red\"} cx={this.props.node.x} cy={this.props.node.y} rx={this.props.node.w} ry={this.props.node.h} />`;\r\n    let jsxmn_html = `<div style={{borderRadius:\"999px\", border: \"2px solid black\", background:\"red\", width:(this.props.node.w+50)+\"px\", height:(this.props.node.h+50)+\"px\"}} y={this.props.node.y}/>`;\r\n    let jsxmn_html_nonodeaccess = `<div style={{borderRadius:\"999px\", border: \"2px solid black\", background:\"red\", width:\"100%\", height:\"100%\"}} />`;\r\n\r\n    let jsxmn_html_manualpos = `<div style={{borderRadius:\"999px\", border: \"2px solid black\", position:\"absolute\", background:\"red\",\r\ntop:(this.props.node.y-this.props.node.h/2+50)+\"px\", left:(this.props.node.x-this.props.node.w/2+50)+\"px\",\r\nwidth:(this.props.node.w+50)+\"px\", height:(this.props.node.h+50)+\"px\"}} y={this.props.node.y}/>`;\r\n    let midnodeviewsvg = DViewElement.new2(\"edgepoint view svg\", jsxmn_svg, (d)=>{d.defaultVSize=new GraphSize(0, 0, 5, 5);  d.adaptHeight=true; d.adaptWidth=true; });\r\n    let midnodeview = DViewElement.new2(\"edgepoint view html\", jsxmn_html_nonodeaccess, (d)=>{d.defaultVSize=new GraphSize(0, 0, 25, 25); /*d.adaptHeight=true; d.adaptWidth=true;*/ });\r\n    let dataid = store.getState().models[0];\r\n    // <g>{this.props.node.midnodes.map((mn) => <VoidVertex nodeid={mn.id+\"_svg\"} view={\"`+midnodeviewsvg.id+`\"} />)}</g>\r\n    let jsx =\r\n        `<svg>\r\n            <path stroke={\"black\"} fill={\"none\"} d={this.props.path()}></path>\r\n            {\r\n                \r\n                <foreignObject style={{overflow:\"visible\"}}>\r\n                    <VoidVertex key={\"midnode1\"} view={\"` + midnodeview.id + `\"} />\r\n                    <VoidVertex />\r\n                </foreignObject>\r\n            }\r\n        </svg>`;\r\n\r\n    let view = DViewElement.new2(\"edge view\", jsx, (d)=> { d.bendingMode = EdgeBendingMode.Line; });\r\n    // let node: DVoidEdge = DVoidEdge.new();\r\n    /*function makeep(x:number, y:number, w=5, h=5) {\r\n        // return new GraphSize(x, y, w, h);\r\n        let e = DEdgePoint.new(undefined, node.id, undefined, undefined, new GraphSize(x, y, w, h));\r\n        return e.id;\r\n    }*/\r\n    // let makeedgepoints = [makeep(50, 100), makeep(80, 100), makeep(120, 120), makeep(150,120), makeep(150, 80)];\r\n    // SetFieldAction.new(node.id, \"midnodes\",  makeedgepoints, '', true);\r\n    // node.midnodes = [makeep(50, 100), makeep(80, 100), makeep(120, 120), makeep(150,120), makeep(150, 80)];\r\n    // CreateElementAction.new(view); CreateElementAction.new(midnodeview); CreateElementAction.new(node);\r\n    let graphid = store.getState().graphs[0];\r\n    return <div style={{position:\"absolute\", zIndex:1000, top:\"50px\", left:\"50px\", width:\"500px\", height:\"500px\", background:\"white\", border:\"4px solid black\"}}>\r\n        <div style={{height:\"100%\", width:\"100%\", position:\"relative\"}}>\r\n            {/*<DamEdge view={view.id} graphid={graphid} />*/}\r\n        </div>\r\n    </div>\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default TopBar;\r\n","import './style.scss';\r\nimport {Oval} from \"react-loader-spinner\";\r\nimport React from \"react\";\r\n\r\nfunction Cleaning() {\r\n    return(<div className={'popup-container'}>\r\n        <div className={'popup'}>\r\n            <label className={'d-block text-center mt-3'}>\r\n                <b style={{color: '#475e6c'}}>CLEANING...</b>\r\n                <Oval height={60} width={60} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-5'}\r\n                      color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n            </label>\r\n        </div>\r\n    </div>);\r\n}\r\n\r\nexport default Cleaning;\r\n","import React, {Dispatch} from 'react';\r\nimport './App.scss';\r\nimport './styles/view.scss';\r\nimport './styles/style.scss';\r\nimport Dock from \"./components/abstract/DockLayout\";\r\nimport {DState, statehistory, U} from \"./joiner\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport SplashImage from './static/img/splash.png';\r\nimport {Oval} from \"react-loader-spinner\";\r\nimport TopBar from \"./components/topbar/Topbar\";\r\nimport {connect} from \"react-redux\";\r\nimport Cleaning from \"./popup/Cleaning\";\r\n\r\nfunction App(props: AllProps) {\r\n    const debug = props.debug;\r\n    const isCleaning = props.isCleaning;\r\n    const [splash, setSplash] = useStateIfMounted(!debug);\r\n\r\n    useEffectOnce(() => {\r\n        if(debug) setSplash(false);\r\n        else U.sleep(3).then(() => {setSplash(false)});\r\n    });\r\n\r\n    if(splash) {\r\n        return(<div className={'w-100 h-100 text-center bg-smoke'}>\r\n            <img style={{height: '60%', width: '80%'}} className={'mt-3 rounded shadow'} src={SplashImage}></img>\r\n            <Oval height={80} width={80} wrapperStyle={{justifyContent: 'center'}} wrapperClass={'mt-3'}\r\n                  color={'#475e6c'} secondaryColor={'#ff8811'} />\r\n        </div>);\r\n    } else {\r\n        return(<div className={'d-flex flex-column h-100 p-1 REACT-ROOT' + (props.debug ? \" debug\" : \"\")} onClick={() => {statehistory.globalcanundostate = true;} } >\r\n            {<TopBar room={props.room} />}\r\n            {<Dock />}\r\n            {isCleaning && <Cleaning />}\r\n        </div>);\r\n    }\r\n\r\n}\r\n\r\ninterface OwnProps {room?: string}\r\ninterface StateProps {debug: boolean, isCleaning: boolean}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.debug = state.debug;\r\n    ret.isCleaning = state.isCleaning;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\nexport const AppConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(App);\r\n\r\nexport default AppConnected;\r\n","import type {Dictionary, GObject, Pointer} from \"../../joiner\";\r\nimport React, {Dispatch, ReactElement} from \"react\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport IotEngine from \"./IotEngine\";\r\nimport {connect} from \"react-redux\";\r\nimport {doc, onSnapshot} from \"@firebase/firestore\";\r\nimport {Firebase} from \"../../firebase\";\r\nimport {Action, DUser, Selectors, SetRootFieldAction, DState, U, } from \"../../joiner\";\r\n\r\nconst ROOM_SIZE_LIMIT = 200;\r\nfunction RoomAttacherComponent(props: AllProps) {\r\n    const room = props.room;\r\n    const [actions, setActions] = useStateIfMounted<Dictionary<Pointer, boolean>>({});\r\n    const [roomSize, setRoomSize] = useStateIfMounted<number>(0);\r\n    const [error, setError] = useStateIfMounted<boolean>(false);\r\n    const [iot, setIot] = useStateIfMounted<boolean|null>(null);\r\n    const [iotData, setIotData] = useStateIfMounted<GObject>({});\r\n\r\n    if(!room) return(<></>);\r\n    onSnapshot(doc(Firebase.db, 'rooms', room),\r\n        (doc: GObject) => {\r\n            if(!Selectors.getRoom()) return;\r\n            const data = doc.data(); if(!data) return;\r\n            setRoomSize(data.actions.length);\r\n            /*\r\n            if(!U.deepEqual(iotData, data.iotData)) setIotData(data.iotData);\r\n            if(iot === null) {\r\n                setIot(data.iot);\r\n                SetRootFieldAction.new('iot', data.iot, '', false);\r\n            }\r\n            */\r\n            for(let action of data.actions.filter((item: GObject) => !actions[item.id])) {\r\n                const receivedAction = Action.fromJson(action);\r\n                if(action.token === DUser.token) continue;\r\n                console.log('FB: Executing Action:' + action.id + ' from ' + action.token);\r\n                receivedAction.hasFired = receivedAction.hasFired - 1;\r\n                receivedAction.fire();\r\n                actions[action.id] = true; setActions(actions);\r\n            }\r\n        },\r\n        (doc: GObject) => {setError(true)},\r\n        () => {}\r\n    );\r\n    return(<div style={{bottom: 10, right: 10}} className={'p-1 bg-white border position-absolute'}>\r\n        {roomSize}\r\n    </div>);\r\n}\r\ninterface OwnProps {}\r\ninterface StateProps {room: string}\r\ninterface DispatchProps {}\r\ntype AllProps = OwnProps & StateProps & DispatchProps;\r\n\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    const ret: StateProps = {} as any;\r\n    ret.room = state.room;\r\n    return ret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const ret: DispatchProps = {};\r\n    return ret;\r\n}\r\n\r\n\r\nexport const RoomAttacherConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(RoomAttacherComponent);\r\n\r\nexport const RoomAttacher = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <RoomAttacherConnected {...{...props, children}} />;\r\n}\r\n\r\nexport default RoomAttacher;\r\n","import {useParams} from 'react-router-dom';\r\nimport {useEffectOnce} from \"usehooks-ts\";\r\nimport {CONSTRAINT, Firebase} from \"../../firebase\";\r\nimport {useStateIfMounted} from \"use-state-if-mounted\";\r\nimport App from \"../../App\";\r\nimport RoomAttacher from \"./RoomAttacher\";\r\nimport {SetRootFieldAction} from \"../../redux/action/action\";\r\nimport {SaveManager} from \"../topbar/SaveManager\";\r\n\r\nfunction RoomChecker() {\r\n    const {id} = useParams();\r\n    const [loading, setLoading] = useStateIfMounted(true);\r\n    const [validCode, setValidCode] = useStateIfMounted(false);\r\n\r\n    useEffectOnce(() => {\r\n        const constraint: CONSTRAINT = {field: 'code', operator: '==', value: id};\r\n        Firebase.select('rooms', constraint).then((results) => {\r\n            if(results.length) {\r\n                const result = results[0];\r\n                if(result.state) SaveManager.load(result.state)\r\n                SetRootFieldAction.new('room', id); setValidCode(true);\r\n            }\r\n            setLoading(false);\r\n        });\r\n    })\r\n\r\n    if(loading) return(<div>Loading...</div>);\r\n    if(validCode) return(<>\r\n        <App room={id} />\r\n        <RoomAttacher />\r\n    </>);\r\n    return(<div>Invalid code</div>)\r\n}\r\n\r\nexport default RoomChecker;\r\n","import {BrowserRouter , Routes, Route} from 'react-router-dom';\r\nimport RoomChecker from \"../components/room/RoomChecker\";\r\nimport App from \"../App\";\r\n\r\nfunction Router() {\r\n    const root = 'jodel-react/'\r\n\r\n    return(<BrowserRouter>\r\n        <Routes>\r\n            <Route path={''} element={<App />} />\r\n            <Route path={root} element={<App />} />\r\n            <Route path={root + 'build'} element={<App />} />\r\n            <Route path={root + 'room/:id'} element={<RoomChecker />} />\r\n            <Route path={'*'} element={<b>404: Not Found</b>} />\r\n        </Routes>\r\n    </BrowserRouter>);\r\n}\r\n\r\nexport default Router;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'bootstrap-icons/font/bootstrap-icons.css';\r\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\r\nimport {Provider} from \"react-redux\";\r\nimport {jodelInit, store} from \"./joiner\";\r\nimport Router from \"./router/Router\";\r\nimport axios from 'axios';\r\n\r\n\r\nfunction start() {\r\n    jodelInit();\r\n    ReactDOM.render(\r\n        <Provider store={store}>\r\n            <Router />\r\n        </Provider>,\r\n        document.getElementById('root')\r\n    );\r\n}\r\nsetTimeout(start, 10);\r\n\r\n","export class Env {\r\n    public static apiKey = \"AIzaSyCibYFREIn-uQL2e0bfzBX05uB57KYWhpI\";\r\n    public static authDomain = \"jjodel.firebaseapp.com\";\r\n    public static projectId = \"jjodel\";\r\n    public static storageBucket = \"jjodel.appspot.com\";\r\n    public static messagingSenderId = \"301705335217\";\r\n    public static appId = \"1:301705335217:web:3aaca45d25559e09d9ad90\";\r\n}\r\n\r\n","import {initializeApp} from \"firebase/app\";\r\nimport {\r\n    collection,\r\n    CollectionReference,\r\n    doc,\r\n    getDocs,\r\n    getFirestore,\r\n    or,\r\n    Query,\r\n    query,\r\n    QueryFieldFilterConstraint,\r\n    setDoc,\r\n    updateDoc,\r\n    where,\r\n    deleteDoc\r\n} from '@firebase/firestore';\r\nimport {Env} from \"./environment\";\r\nimport firebase from \"firebase/compat\";\r\nimport { GObject } from \"../joiner\";\r\n\r\ntype OPERATOR = '=='|'!=';\r\nexport interface CONSTRAINT {field: string, operator: OPERATOR, value: any}\r\n\r\nexport class Firebase {\r\n    static config = {\r\n        apiKey: Env.apiKey,\r\n        authDomain: Env.authDomain,\r\n        projectId: Env.projectId,\r\n        storageBucket: Env.storageBucket,\r\n        messagingSenderId: Env.messagingSenderId,\r\n        appId: Env.appId\r\n    };\r\n\r\n    static app = initializeApp(Firebase.config);\r\n    static db = getFirestore(Firebase.app);\r\n\r\n    static async select(collectionName: string, constraints?: CONSTRAINT|CONSTRAINT[], isAND: boolean = true): Promise<any> {\r\n        const DOC = collection(Firebase.db, collectionName);\r\n        if(constraints) {\r\n            const _constraints = (Array.isArray(constraints)) ? constraints : [constraints];\r\n            if(_constraints.length > 0) return await Firebase._selectWithConditions(DOC, _constraints, isAND);\r\n            else return await Firebase._selectWithoutConditions(DOC);\r\n        }\r\n        else return await Firebase._selectWithoutConditions(DOC);\r\n    }\r\n\r\n    private static async _selectWithConditions(DOC: CollectionReference, constraints: CONSTRAINT[], isAND: boolean): Promise<any> {\r\n        const objects: any = [];\r\n        const conditions: QueryFieldFilterConstraint[] = [];\r\n        for(let constraint of constraints) {\r\n            const field = constraint.field;\r\n            const operator = constraint.operator;\r\n            const value = constraint.value;\r\n            conditions.push(where(String(field), operator, value));\r\n        }\r\n        let q: Query;\r\n        if(isAND) q = query(DOC, ...conditions);\r\n        else q = query(DOC, or(...conditions));\r\n        const qs = await getDocs(q);\r\n        qs.forEach((doc: GObject) => {objects.push({...doc.data()})});\r\n        return objects;\r\n    }\r\n\r\n    private static async _selectWithoutConditions(DOC: CollectionReference): Promise<any> {\r\n        const objects: any = [];\r\n        const q = query(DOC); const qs = await getDocs(q);\r\n        qs.forEach((doc: GObject) => {objects.push({...doc.data()})});\r\n        return objects\r\n    }\r\n\r\n    static async add(collection: string, id: string, obj: any): Promise<void> {\r\n        const DOC = doc(Firebase.db, collection, id);\r\n        await setDoc(DOC, obj,{merge: false});\r\n    }\r\n\r\n    static async edit(room: string, field: string, value: any): Promise<void> {\r\n        const collection = 'rooms';\r\n        const DOC = doc(Firebase.db, collection, room);\r\n        await updateDoc(DOC, field, value);\r\n    }\r\n\r\n    static async remove(id: string, path: string): Promise<void> {\r\n        const DOC = doc(Firebase.db, path, id);\r\n        await deleteDoc(DOC);\r\n    }\r\n\r\n    static async addAction(room: string, action: JSON): Promise<void> {\r\n        await Firebase.edit(room, 'actions', firebase.firestore.FieldValue.arrayUnion(action));\r\n    }\r\n\r\n    static async removeRoom(room: string): Promise<void> {\r\n        await Firebase.remove(room, 'rooms');\r\n    }\r\n\r\n    static async removeAllRooms(): Promise<void> {\r\n        const rooms = await Firebase.select('rooms');\r\n        for(let room of rooms) {\r\n            const code = room.code;\r\n            console.log('DELETING ROOM: ' + code);\r\n            await Firebase.removeRoom(code)\r\n        }\r\n    }\r\n\r\n}\r\n","import React, {Dispatch, ReactElement, ReactNode} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    DGraph,\r\n    DGraphElement,\r\n    DGraphVertex,\r\n    DVoidVertex,\r\n    GraphElementComponent,\r\n    GraphElementDispatchProps,\r\n    GraphElementOwnProps,\r\n    GraphElementReduxStateProps,\r\n    GraphElementStatee,\r\n    DState,\r\n    LClass,\r\n    LModelElement,\r\n    LPointerTargetable,\r\n    LUser,\r\n    LVoidVertex,\r\n    RuntimeAccessibleClass, LViewPoint,\r\n    U, GraphSize, GraphPoint, GObject, Size, SetRootFieldAction, SetFieldAction, DVertex, DVoidEdge, DEdgePoint, DUser, Dictionary, Pointer,\r\n} from \"../../joiner\";\r\nimport $ from \"jquery\";\r\nimport \"jqueryui\";\r\nimport \"jqueryui/jquery-ui.css\";\r\nimport {DamEdge} from \"../damedges/damedge\";\r\n\r\nconst superclassGraphElementComponent: typeof GraphElementComponent = RuntimeAccessibleClass.classes.GraphElementComponent as any as typeof GraphElementComponent;\r\nclass ThisStatee extends GraphElementStatee { forceupdate?: number }\r\n\r\nvar dragHelper = document.createElement(\"div\");\r\ndragHelper.style.backgroundColor = \"transparent\";\r\ndragHelper.style.outline = \"4px solid black\";\r\n\r\nexport class VertexComponent<AllProps extends AllPropss = AllPropss, ThisState extends ThisStatee = ThisStatee>\r\n    extends superclassGraphElementComponent<AllProps, ThisState> {\r\n    public static cname: string = \"VertexComponent\";\r\n\r\n    /*\r\n    shouldComponentUpdate(newProps: Readonly<AllProps>, newState: Readonly<ThisState>, newContext: any): boolean {\r\n        const oldProps = this.props;\r\n        const newData = newProps.data; const oldData = oldProps.data;\r\n        const newNode = newProps.node; const oldNode = oldProps.node;\r\n        const newViewpoint = newProps.viewpoint; const oldViewpoint = oldProps.viewpoint;\r\n        const newEdgePending = newProps.isEdgePending; const oldEdgePending = oldProps.isEdgePending;\r\n\r\n        if(newData.__raw !== oldData.__raw) return true;\r\n        if(newNode?.__raw !== oldNode?.__raw) return true;\r\n        if(newViewpoint.__raw !== oldViewpoint.__raw) return true;\r\n        if(newEdgePending !== oldEdgePending) return true;\r\n        return false;\r\n    }\r\n     */\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        this.getSize = this.getSize.bind(this);\r\n        this.setSize = this.setSize.bind(this);\r\n        // this.state={forceupdate:1};\r\n        setTimeout(()=>{\r\n            this.getSize = this.getSize.bind(this);\r\n            this.setSize = this.setSize.bind(this);\r\n            // this.get_size = console.error as any;\r\n            // this.r = (<RootVertex props={this.props} render={super.render()} super={this} />);\r\n            this.forceUpdate();\r\n            this.setState({forceupdate:2});\r\n        },1)\r\n    }\r\n\r\n\r\n    setVertexProperties(){\r\n        if(!this.props.node || !this.html.current) return;\r\n        if (this.hasSetVertexProperties) return;\r\n        this.hasSetVertexProperties = true;\r\n\r\n        let html = this.html.current;\r\n\r\n        const $measurable: GObject<\"JQuery + ui plugin\"> = $(html); // todo: install typings\r\n        // $element = $(html).find(\".measurable\").addBack();\r\n        $measurable.draggable({\r\n            cursor: 'grabbing',\r\n            containment: 'parent',\r\n            opacity: 0.0,\r\n            disabled: !(this.props.view.draggable),\r\n            distance: 5,\r\n            helper: () => { // or \"clone\",\r\n                // dragHelper.style.display=\"block\";\r\n                let size = this.getSize();\r\n                // let actualSize = Size.of(html);\r\n                // if (size.w !== actualSize.w || size.h !== actualSize.h) this.setSize({w:actualSize.w, h:actualSize.h});\r\n                dragHelper.style.width = size.w+\"px\";\r\n                dragHelper.style.height = size.h+\"px\";\r\n                dragHelper.style.opacity = this.props.view.constraints.length ? \"1\" : \"0.5\";\r\n                if (this.props.view.lazySizeUpdate) dragHelper.classList.add(\"lazySizeUpdate\");\r\n                else dragHelper.classList.remove(\"lazySizeUpdate\");\r\n                return dragHelper;\r\n            },\r\n\r\n            // disabled: !(view.draggable),\r\n            start: (event: GObject, obj: GObject) => {\r\n                // this.select();\r\n                SetRootFieldAction.new(\"contextMenu\", { display: false, x: 0, y: 0 }); // todo: should probably be done in a document event\r\n                if (this.props.view.onDragStart) {\r\n                    try{ eval(this.props.view.onDragStart); } // todo: eval in context\r\n                    catch (e) { console.log(e) }\r\n                }\r\n            },\r\n            drag: (event: GObject, obj: GObject) => {\r\n                if (!this.props.view.lazySizeUpdate) this.setSize({x:obj.position.left, y:obj.position.top});\r\n            },\r\n            stop: (event: GObject, obj: GObject) => {\r\n                console.log(\"drag stop setsize\", {x:obj.position.left, y:obj.position.top});\r\n                this.setSize({x:obj.position.left, y:obj.position.top});\r\n                if (this.props.view.onDragEnd) {\r\n                    try{ eval(this.props.view.onDragEnd); } // todo: eval in context\r\n                    catch (e) { console.log(e) }\r\n                }\r\n            }\r\n        });\r\n        let resizeoptions: GObject = {\r\n            disabled: !(this.props.view.resizable),\r\n            start: (event: GObject, obj: GObject) => {\r\n                this.select();\r\n                if (!this.props.node.isResized) this.props.node.isResized = true; // set only on manual resize, so here and not on setSize()\r\n                SetRootFieldAction.new(\"contextMenu\", { display: false, x: 0, y: 0 });\r\n                if (this.props.view.onResizeStart) {\r\n                    try{ eval(this.props.view.onResizeStart); }\r\n                    catch (e) { console.log(e) }\r\n                }\r\n            },\r\n            resize: (event: GObject, obj: GObject) => {\r\n                if (!this.props.view.lazySizeUpdate) this.setSize({w:obj.position.width, h:obj.position.height});\r\n                // SetRootFieldAction.new(\"resizing\", {})\r\n            },\r\n            stop: (event: GObject, obj: GObject) => {\r\n                if (!this.state.classes.includes(\"resized\")) this.setState({classes:[...this.state.classes, \"resized\"]});\r\n                // if (!withSetSize) { node.width = obj.size.width; node.height = obj.size.height; } else {\r\n                this.setSize({w:obj.size.width, h:obj.size.height});\r\n                // console.log(\"resize setsize:\", obj, {w:obj.size.width, h:obj.size.height});\r\n                if (this.props.view.onResizeEnd) {\r\n                    try{ eval(this.props.view.onResizeEnd); }\r\n                    catch (e) { console.log(e) }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.props.view.lazySizeUpdate) {\r\n            // this does not accept a func or htmlElem, but only a classname...\r\n            // and makes his own empty proxy element to resize in his place. inchoherent.\r\n            resizeoptions.helper = \"resizable-helper-bad\";\r\n        }\r\n        else {\r\n            resizeoptions.containment = 'parent';\r\n        }\r\n        $measurable.resizable(resizeoptions);\r\n\r\n    }\r\n\r\n\r\n\r\n    getSize(): Readonly<GraphSize> {\r\n        return this.props.node.size;\r\n        /*console.log(\"get_size(\"+(this.props?.data as any).name+\")\", {\r\n            view:this.props.view.getSize(this.props.dataid || this.props.nodeid as string),\r\n            node:this.props.node?.size,\r\n            default: this.props.view.defaultVSize});*/\r\n\r\n        let ret = this.props.view.getSize(this.props.dataid || this.props.nodeid as string)\r\n            || this.props.node?.size\r\n            || this.props.view.defaultVSize;\r\n        if (this.props.node.isResized) return ret;\r\n        let actualSize: Partial<Size>&{w:number, h:number} = this.html.current ? Size.of(this.html.current as Element) : {w:0, h:0};\r\n        if (this.props.view.adaptWidth && ret.w !== actualSize.w) {\r\n            this.setSize({w:actualSize.w});\r\n            ret.w = actualSize.w;\r\n        }\r\n        if (this.props.view.adaptHeight && ret.h !== actualSize.h) {\r\n            this.setSize({h:actualSize.h});\r\n            ret.h = actualSize.h;\r\n        }\r\n        return ret;\r\n    }\r\n    // setSize(x_or_size_or_point: number, y?: number, w?:number, h?:number): void;\r\n    setSize(x_or_size_or_point: Partial<GraphPoint>): void;\r\n    setSize(x_or_size_or_point: Partial<GraphSize>): void;\r\n    // setSize(x_or_size_or_point: number | GraphSize | GraphPoint, y?: number, w?:number, h?:number): void;\r\n    setSize(size0: Partial<GraphSize> | Partial<GraphPoint>): void {\r\n        return this.props.node.size = size0 as any;\r\n        // console.log(\"setSize(\"+(this.props?.data as any).name+\") thisss\", this);\r\n        let size: Partial<GraphSize> = size0 as Partial<GraphSize>;\r\n        if (this.props.view.storeSize) {\r\n            let id = (this.props.dataid || this.props.nodeid) as string;\r\n            this.props.view.updateSize(id, size);\r\n            return;\r\n        }\r\n        let olds = this.props.node.size;\r\n        size.x = size.x === undefined ? olds?.x : size.x;\r\n        size.y = size.y === undefined ? olds?.y : size.y;\r\n        size.w = size.w === undefined ? olds?.w : size.w;\r\n        size.h = size.h === undefined ? olds?.h : size.h;\r\n        this.props.node.size = size as GraphSize;\r\n    }\r\n\r\n    render(): ReactNode {\r\n        if (!this.props.node) return 'Loading...';\r\n\r\n\r\n        const cssOverride: string[] = [];\r\n\r\n        let selected = false;\r\n        for(let me of Object.values(this.props.selected))\r\n            if(me?.id === this.props.dataid) selected = true;\r\n\r\n        if (selected) {\r\n            cssOverride.push('selected-by-me');\r\n            /*\r\n            if (this.props.dataid === this.props.selected[DUser.current]?.id)\r\n                cssOverride.push('selected-by-me');\r\n            else\r\n                cssOverride.push('selected-by-others');\r\n            */\r\n        }\r\n\r\n        // if(!windoww.cpts) windoww.cpts = {};\r\n        // windoww.cpts[this.props.nodeid]=this;\r\n        // console.log(\"updated\");\r\n        //return this.r || <div>loading...</div>;\r\n\r\n        // set classes\r\n        let nodeType = \"NODE_TYPE_ERROR\";\r\n        if ( this.props.isEdgePoint) nodeType = \"EdgePoint\"; else\r\n        if ( this.props.isGraph &&  this.props.isVertex) nodeType = \"GraphVertex\"; else\r\n        if ( this.props.isGraph && !this.props.isVertex) nodeType = \"Graph\"; else\r\n        if (!this.props.isGraph &&  this.props.isVertex && (this.props.isVoid || !this.props.data)) nodeType = \"VoidVertex\"; else\r\n        if (!this.props.isGraph &&  this.props.isVertex) nodeType = \"Vertex\"; else\r\n        if (!this.props.isGraph && !this.props.isVertex) nodeType = \"Field\";\r\n\r\n        const classesOverride = [nodeType, ...cssOverride];\r\n        const styleOverride: React.CSSProperties = {};\r\n        // set classes end\r\n        const size: Readonly<GraphSize> = this.getSize() as any;\r\n        switch (nodeType){\r\n            case \"GraphVertex\":\r\n            case \"Vertex\":\r\n            case \"VoidVertex\":\r\n            case \"EdgePoint\":\r\n                styleOverride.top= size.y+\"px\";\r\n                styleOverride.left= size.x+\"px\";\r\n                let isResized = this.props.node.isResized;\r\n                if (isResized || !this.props.view.adaptWidth) styleOverride.width = size.w+\"px\";\r\n                else styleOverride.width = undefined;\r\n                if (isResized || !this.props.view.adaptHeight) styleOverride.height = size.h+\"px\";\r\n                else styleOverride.height = undefined; // todo: the goal is to reset jqui inline style, but not override user-defined inline style\r\n                this.setVertexProperties(); break;\r\n            default: break;\r\n        }\r\n\r\n\r\n        return super.render(nodeType, styleOverride, classesOverride);\r\n        // return <RootVertex props={this.props} render={super.render()} super={this} key={this.props.nodeid+\".\"+this.state?.forceupdate} />;\r\n    }\r\n}\r\n\r\nclass OwnProps extends GraphElementOwnProps {\r\n    // onclick?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n    // onmousedown?: (e: React.MouseEvent<HTMLDivElement>) => void;\r\n    isEdgePoint?: boolean = false;\r\n    isGraph?: boolean = false;\r\n    isVertex?: boolean = true;\r\n    isVoid?: boolean = false;\r\n}\r\n\r\nclass StateProps extends GraphElementReduxStateProps {\r\n    node!: LVoidVertex;\r\n    lastSelected!: LModelElement | null;\r\n    selected!: Dictionary<Pointer<DUser>, LModelElement|null>;\r\n    isEdgePending!: { user: LUser, source: LClass };\r\n    viewpoint!: LViewPoint\r\n}\r\n\r\nclass DispatchProps extends GraphElementDispatchProps {\r\n}\r\n\r\nexport type AllPropss = OwnProps & StateProps & DispatchProps;\r\n\r\nfunction mapStateToProps(state: DState, ownProps: OwnProps): StateProps {\r\n    let DGraphElementClass: typeof DGraphElement;\r\n    if (ownProps.isEdgePoint) DGraphElementClass = DEdgePoint; else\r\n    if (ownProps.isVertex && ownProps.isGraph) DGraphElementClass = DGraphVertex; else\r\n    if (ownProps.isVertex && !ownProps.isGraph) DGraphElementClass = DVertex; else\r\n    if (!ownProps.isVertex && ownProps.isGraph) DGraphElementClass = DGraph;\r\n    else DGraphElementClass = DGraphElement; // DField;\r\n\r\n    if (DGraphElementClass === DVertex && ownProps.isVoid) DGraphElementClass = DVoidVertex;\r\n    const superret: StateProps = GraphElementComponent.mapStateToProps(state, ownProps, DGraphElementClass) as StateProps;\r\n    //superret.lastSelected = state._lastSelected?.modelElement;\r\n    superret.lastSelected = state._lastSelected ? LPointerTargetable.from(state._lastSelected.modelElement) : null;\r\n\r\n    const selected = state.selected;\r\n    superret.selected = {};\r\n    for(let user of Object.keys(selected)) {\r\n        const pointer = selected[user];\r\n        if (pointer) superret.selected[user] = LModelElement.fromPointer(pointer);\r\n        else superret.selected[user] = null;\r\n    }\r\n\r\n\r\n    superret.isEdgePending = {\r\n        user: LPointerTargetable.from(state.isEdgePending.user),\r\n        source: LPointerTargetable.from(state.isEdgePending.source)\r\n    };\r\n    // superret.viewpoint = LViewPoint.fromPointer(state.viewpoint);\r\n    const ret: StateProps = new StateProps();\r\n    U.objectMergeInPlace(superret, ret);\r\n    U.removeEmptyObjectKeys(superret);\r\n    return superret;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): DispatchProps {\r\n    const superret: GraphElementDispatchProps = GraphElementComponent.mapDispatchToProps(dispatch);\r\n    const ret: GraphElementDispatchProps = new GraphElementDispatchProps();\r\n    U.objectMergeInPlace(superret, ret);\r\n    U.removeEmptyObjectKeys(superret);\r\n    return superret;\r\n}\r\n\r\n\r\nexport const VertexConnected = connect<StateProps, DispatchProps, OwnProps, DState>(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(VertexComponent as any);\r\n\r\nexport const Vertex = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <VertexConnected {...{...props, children}} isGraph={false} isVertex={true}/>;\r\n}\r\nexport const VoidVertex = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <VertexConnected {...{...props, children}} isGraph={false} isVertex={true} isVoid={true}/>;\r\n}\r\nexport const EdgePoint = function EdgePoint (props: OwnProps, children: (string | React.Component)[] = []): ReactElement {\r\n    return <VertexConnected {...{...props, children}} isGraph={false} isEdgePoint={true}/>;\r\n}\r\n// todo: name them all or verify the name is still usable.\r\n\r\nexport const Graph = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => { // doesn't work?\r\n    return <VertexConnected {...{...props, children}} isGraph={true} isVertex={false} />;\r\n}\r\n\r\nexport const GraphVertex = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <VertexConnected {...{...props, children}} isGraph={true} isVertex={true} />;\r\n}\r\n\r\nexport const Field = (props: OwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <VertexConnected {...{...props, children}} isGraph={false} isVertex={false} />;\r\n}\r\n(window as any).componentdebug = {Graph, GraphVertex, Field, Vertex, VoidVertex, EdgePoint, VertexConnected, VertexComponent};\r\n\r\n\r\nGraph.cname = \"Graph\";\r\nGraphVertex.cname = \"GraphVertex\";\r\nField.cname = \"Field\";\r\nVertex.cname = \"Vertex\";\r\nVoidVertex.cname = \"VoidVertex\";\r\nEdgePoint.cname = \"EdgePoint\";\r\n\r\n// GraphConnected.cname = \"GraphConnected\";\r\n// GraphVertexConnected.cname = \"GraphVertexConnected\";\r\n// FieldConnected.cname = \"FieldConnected\";\r\nVertexConnected.cname = \"VertexConnected\";\r\n// VoidVertexConnected.cname = \"VoidVertexConnected\";\r\n// EdgePointConnected.cname = \"EdgePointConnected\";\r\n\r\n// GraphComponent.cname = \"GraphComponent\";\r\n// GraphVertexComponent.cname = \"GraphVertexComponent\";\r\n// FieldComponent.cname = \"FieldComponent\";\r\nVertexComponent.cname = \"VertexComponent\";\r\n// VoidVertexComponent.cname = \"VoidVertexComponent\";\r\n// EdgePointComponent.cname = \"EdgePointComponent\";\r\n\r\n\r\n\r\n/*\r\nlet windoww = window as any;\r\n\r\nwindoww.VoidVertex = VoidVertex;\r\nwindoww.Vertex = Vertex;\r\n// windoww.Graph = Graph;\r\nwindoww.GraphVertex = GraphVertex;\r\nwindoww.Field = Field;\r\n\r\nwindoww.VoidVertexComponent = VoidVertex;\r\nwindoww.VertexComponent = Vertex;\r\n// windoww.GraphComponent = Graph;\r\nwindoww.GraphVertexComponent = GraphVertex;\r\nwindoww.FieldComponent = Field;*/\r\n\r\n","import {\r\n    Action, bool,\r\n    Constructors, CoordinateMode,\r\n    DGraphElement,\r\n    Dictionary,\r\n    DModelElement,\r\n    DocString,\r\n    DPointerTargetable,\r\n    DViewPoint,\r\n    EdgeBendingMode,\r\n    getWParams,\r\n    GObject, GraphPoint,\r\n    GraphSize,\r\n    Info,\r\n    LogicContext,\r\n    LPointerTargetable,\r\n    LViewPoint,\r\n    MyProxyHandler,\r\n    Pointer,\r\n    RuntimeAccessible,\r\n    RuntimeAccessibleClass,\r\n    SetFieldAction,\r\n    ShortAttribETypes\r\n} from \"../../joiner\";\r\nimport { EdgeGapMode } from \"../../joiner/types\";\r\n\r\n@RuntimeAccessible\r\nexport class DViewElement extends DPointerTargetable {\r\n    public static cname: string = \"DViewElement\";\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LViewElement;\r\n    // static logic: typeof LViewDViewElementElement;\r\n    // static structure: typeof DViewElement;\r\n\r\n    // inherited redefine\r\n    // public __raw!: DViewElement;\r\n    id!: Pointer<DViewElement, 1, 1, LViewElement>;\r\n\r\n\r\n    // own properties\r\n    bindVertexSizeToView: boolean = true;\r\n    name!: string;\r\n    constants?: string; // evalutate 1 sola volta all'applicazione della vista o alla creazione dell'elemento.\r\n    preRenderFunc?: string; // evalutate tutte le volte che l'elemento viene aggiornato (il model o la view cambia)\r\n    jsxString!: string; // l'html template\r\n    usageDeclarations?: string;\r\n    forceNodeType?: DocString<'component name (Vertex, Field, GraphVertex, Graph)'>;\r\n    scalezoomx: boolean = false; // whether to resize the element normally using width-height or resize it using zoom-scale css\r\n    scalezoomy: boolean = false;\r\n    // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\r\n    // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\r\n    // __transient: DViewTransientProperties;\r\n    storeTemporaryPositions: boolean = false; // if true updates vertex position every X millisecond while dragging, if false updates it once when the vertex is released.\r\n    appliableToClasses!: string[]; // class names: DModel, DPackage, DAttribute...\r\n    subViews!: Pointer<DViewElement, 0, 'N', LViewElement>;\r\n    oclApplyCondition!: string; // ocl selector\r\n    explicitApplicationPriority!: number; // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\r\n    defaultVSize!: GraphSize;\r\n    adaptHeight!: boolean;// | 'fit-content' | '-webkit-fill-available';\r\n    adaptWidth!: boolean;\r\n    width!: number;\r\n    height!: number;\r\n    draggable!: boolean;\r\n    resizable!: boolean;\r\n    query!: string;\r\n    viewpoint: Pointer<DViewPoint, 0, 1, LViewElement> = '';\r\n    display!: 'block'|'contents'|'flex'|string;\r\n    constraints!: GObject<\"todo, used in Vertex. they are triggered by events (view.onDragStart....) and can bound the size of the vertex\">[];\r\n    onDragStart: string = '';\r\n    onDragEnd: string = '';\r\n    onResizeStart: string = '';\r\n    onResizeEnd: string = '';\r\n    bendingMode!: EdgeBendingMode;\r\n    edgeGapMode!: EdgeGapMode;\r\n    //useSizeFrom!: EuseSizeFrom;\r\n    storeSize!: boolean;\r\n    size!: Dictionary<Pointer<DModelElement> | Pointer<DGraphElement>, GraphSize>;\r\n    lazySizeUpdate!: boolean;\r\n    edgeStartOffset!: GraphPoint;\r\n    edgeEndOffset!: GraphPoint;\r\n    edgeStartOffset_isPercentage!: boolean;\r\n    edgeEndOffset_isPercentage!: boolean;\r\n    edgeStartStopAtBoundaries!: boolean;\r\n    edgeEndStopAtBoundaries!: boolean;\r\n    edgePointCoordMode!: CoordinateMode;\r\n    edgeHeadSize!: GraphPoint;\r\n    edgeTailSize!: GraphPoint;\r\n\r\n    public static new(name: string, jsxString: string, defaultVSize?: GraphSize, usageDeclarations: string = '', constants: string = '',\r\n                      preRenderFunc: string = '', appliableToClasses: string[] = [], oclApplyCondition: string = '',\r\n                      priority: number = 1 , persist: boolean = false): DViewElement {\r\n        return new Constructors(new DViewElement('dwc'), undefined, persist, undefined).DPointerTargetable().DViewElement(name, jsxString, defaultVSize, usageDeclarations, constants,\r\n            preRenderFunc, appliableToClasses, oclApplyCondition, priority).end();\r\n    }\r\n    public static new2(name: string, jsxString: string, callback?: (d:DViewElement)=>void, persist: boolean = true): DViewElement {\r\n        return new Constructors(new DViewElement('dwc'), undefined, persist, undefined)\r\n            .DPointerTargetable().DViewElement(name, jsxString).end(callback);\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LViewElement<Context extends LogicContext<DViewElement, LViewElement> = any, D extends DViewElement = any>\r\n    extends LPointerTargetable { // MixOnlyFuncs(DViewElement, LPointerTargetable)\r\n    public static cname: string = \"LViewElement\";\r\n\r\n    static subclasses: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    static _extends: (typeof RuntimeAccessibleClass | string)[] = [];\r\n    // static singleton: LViewElement;\r\n    // static logic: typeof LViewElement;\r\n    // static structure: typeof DViewElement;\r\n\r\n    // inherited redefine\r\n    public __raw!: DViewElement;\r\n    id!: Pointer<DViewElement, 1, 1, LViewElement>;\r\n\r\n\r\n    // own properties\r\n    bindVertexSizeToView!: boolean;\r\n    __info_of__bindVertexSizeToView: Info = {txt: 'empty', isNode: false, isEdge: false, isEdgePoint: false}\r\n\r\n    name!: string;\r\n    __info_of__name: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    constants?: string; // evalutate 1 sola volta all'applicazione della vista o alla creazione dell'elemento.\r\n    __info_of__constants: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    preRenderFunc?: string; // evalutate tutte le volte che l'elemento viene aggiornato (il model o la view cambia)\r\n    __info_of__preRenderFunc: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    jsxString!: string; // l'html template\r\n    __info_of__jsxString: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    usageDeclarations?: string; // example: state\r\n    __info_of__usageDeclarations: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    forceNodeType?: DocString<'component name'>;\r\n    __info_of__forceNodeType: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    scalezoomx!: boolean; // whether to resize the element normally using width-height or resize it using zoom-scale css\r\n    __info_of__scalezoomx: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    scalezoomy!: boolean;\r\n    __info_of__scalezoomy: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    // not persistent, some not shared. deve essere diverso da utente ad utente perchè dipende dal pan e zoom nel grafo dell'utente attuale.\r\n    // facendo pan su grafo html sposti gli elementi, per simulare uno spostamento del grafo e farlo sembrare illimitato.\r\n    // __transient: DViewTransientProperties;\r\n    storeTemporaryPositions!: boolean; // if true updates vertex position every X millisecond while dragging, if false updates it once when the vertex is released.\r\n\r\n    appliableToClasses!: string[]; // class names: DModel, DPackage, DAttribute...\r\n    __info_of__appliableToClasses: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    subViews!: LViewElement[];\r\n    __info_of__subViews: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    oclApplyCondition!: string; // ocl selector\r\n    __info_of__oclApplyCondition: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    explicitApplicationPriority!: number; // priority of the view, if a node have multiple applicable views, the view with highest priority is applied.\r\n    __info_of__explicitApplicationPriority: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    defaultVSize!: GraphSize;\r\n    __info_of__defaultVSize: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    adaptWidth!: boolean;\r\n    __info_of__adaptWidth: Info = {type: 'boolean', txt: 'Whether the element should expand his width to accomodate his own contents.', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    adaptHeight!: boolean;\r\n    __info_of__adaptHeight: Info = {type: 'boolean', txt: 'Whether the element should expand his height to accomodate his own contents.', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n\r\n    draggable!: boolean;\r\n    __info_of__draggable: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    resizable!: boolean;\r\n    __info_of__resizable: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    query!: string;\r\n    __info_of__query: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    viewpoint!: LViewPoint | undefined;\r\n    __info_of__viewpoint: Info = {txt: 'empty', isNode: true, isEdge: true, isEdgePoint: true}\r\n\r\n    display!: 'block'|'contents';\r\n    __info_of__display: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    onDragStart!: string;\r\n    __info_of__onDragStart: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    onDragEnd!: string;\r\n    __info_of__onDragEnd: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    onResizeStart!: string;\r\n    __info_of__onResizeStart: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    onResizeEnd!: string;\r\n    __info_of__onResizeEnd: Info = {txt: 'empty', isNode: true, isEdge: false, isEdgePoint: false}\r\n\r\n    constraints!: GObject<\"todo, used in Vertex. they are triggered by events (view.onDragStart....) and can bound the size of the vertex\">[];\r\n    __info_of__constraints: Info = {txt: 'empty', isNode: false, isEdge: false, isEdgePoint: false}\r\n\r\n\r\n    bendingMode!: EdgeBendingMode;\r\n    __info_of__bendingMode: Info = {isNode: false, isEdge: true, isEdgePoint: false, type: '\"L\" | \"Q\" | \"C\" | \"T\" | \"S\" | \"A\" | \"QT\" | \"CS\"', txt: <><div>How Svg path should use the EdgePoints <a href={\"https://css-tricks.com/svg-path-syntax-illustrated-guide/\"}>to bend his shape</a></div></>}\r\n\r\n    edgeGapMode!: EdgeGapMode;\r\n    __info_of__edgeGapMode: Info = {isNode: false, isEdge: true, isEdgePoint: false, type: '\"gap\" | \"average\" | \"autoFill\" | \"lineFill\" | \"arcFill\"', txt: <><div></div></>}\r\n\r\n    storeSize!: boolean;\r\n    __info_of__storeSize: Info = {isNode: true, isEdge: true, isEdgePoint: true, type: ShortAttribETypes.EBoolean, txt: \"Active: the node position depends from the view currently displayed.\\nInactive: it depends from the graph.\"}\r\n\r\n    lazySizeUpdate!: boolean;\r\n    __info_of__lazySizeUpdate: Info = {isNode: true, isEdge: true, isEdgePoint: true, type: ShortAttribETypes.EBoolean,txt: \"When activated, the layout position will only be updated once when the drag or resize operation is completed. (best performance)\"}\r\n\r\n    edgeStartOffset!: GraphPoint;\r\n    __info_of__edgeStartOffset: Info = {isNode: false, isEdge: true, isEdgePoint: false, type:\"GraphPoint\", txt: \"location where outgoing edges should start their path, relative to top-upper corner of the element.\"}\r\n\r\n    edgeEndOffset!: GraphPoint;\r\n    __info_of__edgeEndOffset: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n\r\n    edgeStartOffset_isPercentage!: boolean;\r\n    __info_of__edgeStartOffset_isPercentage: Info = {isNode: false, isEdge: true, isEdgePoint: false,  type:\"GraphPoint\", txt: \"Whether edgeStartOffset is an absolute value or a percentage (eg: 50% of top edge, vs 50 pixels on the right).\"}\r\n\r\n    edgeEndOffset_isPercentage!: boolean;\r\n    __info_of__edgeEndOffset_isPercentage: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n\r\n    edgeStartStopAtBoundaries!: boolean;\r\n    __info_of__edgeStartStopAtBoundaries: Info = {isNode: false, isEdge: true, isEdgePoint: false, type:\"GraphPoint\", txt: \"Whether outgoing edges should cross the node boundaries overlapping the node or stop at them (edge arrows might enter the node if this is on).\"}\r\n\r\n    edgeEndStopAtBoundaries!: boolean;\r\n    __info_of__edgeEndStopAtBoundaries: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n\r\n    edgePointCoordMode!: CoordinateMode;\r\n    __info_of__edgePointCoordMode: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n\r\n    // edge\r\n    edgeHeadSize!: GraphPoint;\r\n    __info_of__edgeHeadSize: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n    edgeTailSize!: GraphPoint;\r\n    __info_of__edgeTailSize: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n    edgeStrokeWidth!: number;\r\n    __info_of__edgeStrokeWidth: Info = {txt: 'empty', isNode: false, isEdge: true, isEdgePoint: false}\r\n\r\n    protected size!: Dictionary<Pointer<DModelElement> | Pointer<DGraphElement>, GraphSize>; // use getSize, updateSize;\r\n\r\n\r\n    public get_edgeHeadSize(c: Context): this[\"edgeHeadSize\"] { return new GraphPoint(c.data.edgeHeadSize.x, c.data.edgeHeadSize.y); }\r\n    public get_edgeTailSize(c: Context): this[\"edgeTailSize\"] { return new GraphPoint(c.data.edgeTailSize.x, c.data.edgeTailSize.y); }\r\n    public set_edgeHeadSize(v: Partial<this[\"edgeHeadSize\"]>, c: Context): boolean {\r\n        let s = c.data.edgeHeadSize || new GraphPoint(0, 0);\r\n        if (!(\"x\" in v)) v.x = s.x;\r\n        if (!(\"y\" in v)) v.y = s.y;\r\n        return SetFieldAction.new(c.data.id, \"edgeHeadSize\", v as GraphPoint, '', false); }\r\n    public set_edgeTailSize(v: Partial<this[\"edgeTailSize\"]>, c: Context): boolean {\r\n        let s = c.data.edgeTailSize || new GraphPoint(0, 0);\r\n        if (!(\"x\" in v)) v.x = s.x;\r\n        if (!(\"y\" in v)) v.y = s.y;\r\n        return SetFieldAction.new(c.data.id, \"edgeTailSize\", v as GraphPoint, '', false); }\r\n\r\n    public get_viewpoint(context: Context): this[\"viewpoint\"] {\r\n        return (context.data.viewpoint || undefined) && (LViewPoint.fromPointer(context.data.viewpoint as Pointer<DViewPoint>));\r\n    }\r\n\r\n\r\n    public get_subViews(context: Context, key: string): LViewElement[]{\r\n        let subViewsPointers = context.data.subViews;\r\n        let subViews: LViewElement[] = [];\r\n        for(let pointer of subViewsPointers){\r\n            let item: LViewElement = MyProxyHandler.wrap(pointer);\r\n            if(item !== undefined) subViews.push(item);\r\n        }\r\n        return subViews;\r\n    }\r\n    /*\r\n    get_useSizeFrom(context: Context): D[\"useSizeFrom\"] { return context.data.useSizeFrom; }\r\n    set_useSizeFrom(val: D[\"useSizeFrom\"], context: Context): boolean {\r\n        let r: boolean = true;\r\n        BEGIN()\r\n        if (val === EuseSizeFrom.view && !context.data.size) r = SetFieldAction.new(context.data.id, \"size\", {});\r\n        // NB: se setti val == \"both\", va letto da Graph[viewid][nodeid] e non da view.\r\n        r = r && SetFieldAction.new(context.data.id,  \"useSizeFrom\", val, undefined, false);\r\n        END()\r\n        return r; }*/\r\n\r\n    // protected get_size(context: Context): D[\"size\"] { return context.data.useSizeFrom === EuseSizeFrom.node ? undefined as any : context.data.size; }\r\n    /* protected set_size(val: D[\"size\"], context: Context): boolean {\r\n        return SetFieldAction.new(context.data.id,  \"size\", val); }*/\r\n\r\n    // returns the delta of change\r\n    public updateSize(id: Pointer<DModelElement> | Pointer<DGraphElement>, size: Partial<GraphSize>): boolean { return this.wrongAccessMessage(\"updateSize\"); }\r\n    public get_updateSize(context: Context): this[\"updateSize\"] {\r\n        return (id: Pointer<DModelElement> | Pointer<DGraphElement>, size: Partial<GraphSize>) => {\r\n            let vp = context.proxyObject.viewpoint;\r\n            if (!context.data.storeSize) {\r\n                if (vp?.storeSize) return vp.updateSize(id, size);\r\n                return false;\r\n            }\r\n            let vsize = context.data.size[id] || vp?.__raw.size[id] || context.data.defaultVSize || vp?.__raw.defaultVSize;\r\n            let newSize: GraphSize = new GraphSize();\r\n            newSize.x = size?.x !== undefined ? size.x : vsize.x;\r\n            newSize.y = size?.y !== undefined ? size.y : vsize.y;\r\n            newSize.w = size?.w !== undefined ? size.w : vsize.w;\r\n            newSize.h = size?.h !== undefined ? size.h : vsize.h;\r\n            if (!newSize.equals(vsize)) SetFieldAction.new(context.data.id, \"size.\" + id as any, newSize);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    public get_defaultVSize(context: Context): this[\"defaultVSize\"]{ return context.data.defaultVSize; }\r\n    public getSize(id: Pointer<DModelElement> | Pointer<DGraphElement>): GraphSize | undefined{ return this.wrongAccessMessage(\"getSize\"); }\r\n    public get_getSize(context: Context): ((...a:Parameters<this[\"getSize\"]>)=>ReturnType<LViewElement[\"getSize\"]>) {\r\n        function impl_getSize(id: Pointer<DModelElement> | Pointer<DGraphElement>): ReturnType<LViewElement[\"getSize\"]> {\r\n            let view = context.data;\r\n            let ret: GraphSize;\r\n            if (view.storeSize){\r\n                ret = view.size[id];\r\n                if(ret) return ret; }\r\n            let vp = context.proxyObject.viewpoint;\r\n            if (vp && view.id !== vp.id && vp.storeSize){\r\n                ret = vp.size[id];\r\n                if(ret) return ret; }\r\n            return undefined;\r\n        }\r\n\r\n        return impl_getSize; }\r\n\r\n    set_generic_entry(context: Context, key: keyof DViewElement, val: any): boolean {\r\n        console.log('set_generic_entry', {context, key, val});\r\n        SetFieldAction.new(context.data, key, val);\r\n        return true;\r\n    }\r\n\r\n    get_children(context: Context): never[] { return []; }\r\n    get_bendingMode(context: Context): D[\"bendingMode\"] { return context.data.bendingMode; }\r\n    set_bendingMode(val: D[\"bendingMode\"], context: Context): boolean {\r\n        return this.set_generic_entry(context, 'bendingMode', val);\r\n    }\r\n\r\n    get_appliableToClasses(context: Context): this[\"appliableToClasses\"] { return context.data.appliableToClasses || []; }\r\n    set_appliableToClasses(val: this[\"appliableToClasses\"], context: Context): boolean {\r\n        if (!val) val = [];\r\n        else if (!Array.isArray(val)) val = [val];\r\n        return this.set_generic_entry(context, \"appliableToClasses\", val); }\r\n\r\n    set_defaultVSize(val: GraphSize, context: Context): boolean {\r\n        console.log('set_defaultVSize', {context, val});\r\n        return this.set_generic_entry(context, 'defaultVSize', val); }\r\n    /*\r\n        get___transient(context: LogicContext<this>): LViewTransientProperties {\r\n            return DPointerTargetable.wrap<DViewTransientProperties, LViewTransientProperties>(context.data.__transient, context.data,\r\n                // @ts-ignore for $ at end of getpath\r\n                'idlookup.' + context.data.id + '.' + (getPath as LViewElement).__transient.$); }*/\r\n}\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewElement);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewElement);\r\nexport type WViewElement = getWParams<LViewElement, DPointerTargetable>;\r\n\r\n@RuntimeAccessible\r\nexport class DViewTransientProperties extends RuntimeAccessibleClass{\r\n    public static cname: string = \"DViewTransientProperties\";\r\n    static logic: typeof LPointerTargetable;\r\n    _isDViewTransientProperties!: true;\r\n    // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // private: DViewPrivateTransientProperties;\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(RuntimeAccessibleClass, DViewTransientProperties);\r\n@RuntimeAccessible\r\nexport class LViewTransientProperties extends LPointerTargetable{\r\n    public static cname: string = \"LViewTransientProperties\";\r\n    static structure: typeof DPointerTargetable;\r\n    static singleton: LViewTransientProperties;\r\n    _isLViewTransientProperties!: true;\r\n\r\n    // isSelected: Dictionary<DocString<Pointer<DUser>>, boolean> = {};\r\n    // private!: LViewPrivateTransientProperties;\r\n    /*\r\n        get_private(context: LogicContext<DViewTransientProperties>): LViewPrivateTransientProperties {\r\n            return LViewTransientProperties.wrap(context.data.private, context.proxy.baseObjInLookup, context.proxy.additionalPath + '.private'); }*/\r\n    /*\r\n        get_isSelected(logicContext: LogicContext<TargetableProxyHandler<DViewTransientProperties>, DViewTransientProperties>): Proxyfied<Dictionary> {\r\n            // @ts-ignore for $ at end of getpath\r\n            console.log('GET_ISSELECTED handler func');\r\n            return TargetableProxyHandler.getMap(logicContext.data.isSelected, logicContext, logicContext.proxy.additionalPath + '.' + (getPath as this).isSelected.$);\r\n        }*/\r\n}\r\n\r\nRuntimeAccessibleClass.set_extend(DPointerTargetable, DViewTransientProperties);\r\nRuntimeAccessibleClass.set_extend(LPointerTargetable, LViewTransientProperties);\r\nexport type WViewTransientProperties = getWParams<LViewTransientProperties, DViewTransientProperties>;\r\n\r\n/*\r\n\r\n@RuntimeAccessible\r\nexport class DViewPrivateTransientProperties extends DPointerTargetable{\r\n    static logic: typeof LViewPrivateTransientProperties;\r\n\r\n    public size: GraphSize\r\n    constructor(size?: GraphSize) {\r\n        super();\r\n        this.size = size || defaultVSize;\r\n    }\r\n}\r\n\r\n@RuntimeAccessible\r\nexport class LViewPrivateTransientProperties extends DViewPrivateTransientProperties{\r\n    static structure: typeof DViewPrivateTransientProperties;\r\n    static singleton: LViewPrivateTransientProperties;\r\n\r\n}*/\r\n// shapeless component, receive jsx from redux\r\n// can access any of the redux state, but will usually access 1-2 var among many,\r\n// how can i dynamically mapStateToProps to map only the required ones?\r\n\r\n","import React, {CSSProperties, Dispatch, PureComponent, ReactElement, ReactNode, useRef,} from \"react\";\r\nimport {createPortal} from \"react-dom\";\r\nimport {connect} from \"react-redux\";\r\nimport './graphElement.scss';\r\nimport type {VertexComponent, EdgeStateProps} from \"../../joiner\";\r\nimport {\r\n    CreateElementAction,\r\n    DGraph,\r\n    DGraphElement,\r\n    Dictionary,\r\n    DModelElement,\r\n    DocString,\r\n    DViewElement,\r\n    GObject,\r\n    GraphElementDispatchProps,\r\n    GraphElementOwnProps,\r\n    GraphElementReduxStateProps,\r\n    GraphElementStatee,\r\n    InOutParam,\r\n    DState,\r\n    JSXT,\r\n    LModelElement,\r\n    Log,\r\n    LPointerTargetable,\r\n    LViewElement,\r\n    MyProxyHandler,\r\n    Overlap,\r\n    Pointer,\r\n    RuntimeAccessible,\r\n    Selectors,\r\n    SetRootFieldAction,\r\n    U,\r\n    UX,\r\n    windoww,\r\n    DV,\r\n    GraphSize,\r\n    GraphPoint,\r\n    LVoidVertex,\r\n    DUser,\r\n    Size,\r\n    LClass,\r\n    SetFieldAction,\r\n    DGraphVertex,\r\n    DVoidVertex, DEdge,\r\n    LEdge, LUser, LViewPoint,\r\n    LGraphElement, RuntimeAccessibleClass,\r\n    DEdgePoint, DPointerTargetable,\r\n    BEGIN, END,\r\n} from \"../../joiner\";\r\n\r\n\r\nimport {end} from \"@popperjs/core\";\r\nimport { EdgeOwnProps } from \"./sharedTypes/sharedTypes\";\r\n\r\n\r\nexport function makeEvalContext(props: AllPropss, view: LViewElement): GObject {\r\n    let evalContext: GObject = view.constants ? eval('window.tmp = ' + view.constants) : {};\r\n    let component = GraphElementComponent.map[props.nodeid as Pointer<DGraphElement>];\r\n    let vcomponent = component as VertexComponent;\r\n    evalContext = {...windoww.defaultContext, ...evalContext, model: props.data, ...props,\r\n        edge: (RuntimeAccessibleClass.extends(props.node?.className, \"DVoidEdge\") ? props.node : undefined),\r\n        component, getSize:vcomponent?.getSize, setSize: vcomponent?.setSize};\r\n    // windoww.evalContext = evalContext;\r\n    console.log(\"proto makeevalcontext\", {evalContext, proto:evalContext.__proto__});\r\n    return evalContext;\r\n}\r\n\r\nfunction setTemplateString(stateProps: InOutParam<GraphElementReduxStateProps>, ownProps: Readonly<GraphElementOwnProps>): void {\r\n    //if (!jsxString) { this.setState({template: this.getDefaultTemplate()}); return; }\r\n    // sintassi: '||' + anything + (opzionale: '|' + anything)*N_Volte + '||' + jsx oppure direttamente: jsx\r\n    const view: LViewElement = stateProps.view; //data._transient.currentView;\r\n    // eslint-disable-next-line no-mixed-operators\r\n    let allProps: AllPropss = {...ownProps, ...stateProps} as AllPropss;\r\n    (allProps as GObject).props = allProps;\r\n    const evalContext = makeEvalContext(allProps, view);\r\n    // const evalContextOld = U.evalInContext(this, constants);\r\n    // this.setState({evalContext});\r\n    //console.error({jsx:view.jsxString, view});\r\n\r\n    // todo: invece di fare un mapping ricorsivo dei figli per inserirgli delle prop, forse posso farlo passando una mia factory che wrappa React.createElement\r\n    let jsxCodeString: DocString<ReactNode>;\r\n    let jsxparsedfunc: () => React.ReactNode;\r\n    try { jsxCodeString = JSXT.fromString(view.jsxString, {factory: 'React.createElement'}); }\r\n    catch (e: any) {\r\n        Log.eDevv();\r\n        stateProps.preRenderFunc = view.preRenderFunc;\r\n        stateProps.evalContext = evalContext;\r\n        stateProps.template = DV.errorView_string(e.message.split(\"\\n\")[0],\r\n            {msg: 'Syntax Error in custom user-defined template. try to remove typescript typings.', evalContext, e, view, jsx:view.jsxString});\r\n        return;\r\n    }\r\n    /*\r\n    try {\r\n        jsxparsedfunc = U.evalInContextAndScope<() => ReactNode>('()=>{ return ' + jsxCodeString + '}', evalContext);\r\n        // U.evalInContext({...this, ...evalContext}, res); // todo: remove eval and add new Function() ?\r\n    }\r\n    catch (e: any) {\r\n        let errormsg = ''; // 'Syntax Error in custom user-defined template.\\n';\r\n        let otherargs: any = {e, jsxCodeString, evalContext, where:\"setTemplateString()\", view};\r\n        if (e.message.indexOf(\"Unexpected token .\") >= 0 || view.jsxString.indexOf('?.') >= 0 || view.jsxString.indexOf('??') >= 0)\r\n        { errormsg += 'Reminder: nullish operators \".?\" and \"??\" are not supported.\\n\\n' +e.toString() + '\\n\\n' + view.jsxString; }\r\n        else if (view.jsxString.indexOf('?.') >= 0) { errormsg += 'Reminder: ?. operator and empty tags <></> are not supported.\\n\\n' +e.toString() + '\\n\\n' + view.jsxString; }\r\n        jsxparsedfunc = ()=> DV.errorView(errormsg, otherargs);\r\n    }*/\r\n\r\n    stateProps.preRenderFunc = view.preRenderFunc;\r\n    stateProps.evalContext = evalContext;\r\n    stateProps.template = jsxCodeString;\r\n    // console.log('GE settemplatestring:', {stateProps});\r\n}\r\n\r\nlet debugcount = 0;\r\nlet debug = true;\r\nlet maxRenderCounter = Number.POSITIVE_INFINITY;\r\n@RuntimeAccessible\r\nexport class GraphElementComponent<AllProps extends AllPropss = AllPropss, GraphElementState extends GraphElementStatee = GraphElementStatee>\r\n    extends PureComponent<AllProps, GraphElementState>{\r\n    public static cname: string = \"GraphElementComponent\";\r\n    static all: Dictionary<number, GraphElementComponent> = {};\r\n    public static map: Dictionary<Pointer<DGraphElement>, GraphElementComponent> = {};\r\n    static maxid: number = 0;\r\n    id: number;\r\n    public static refresh() {\r\n        for (let key in GraphElementComponent.all) {\r\n            GraphElementComponent.all[key].forceUpdate();\r\n        }\r\n        console.log(GraphElementComponent.all);\r\n    }\r\n\r\n    public static defaultShouldComponentUpdate<AllProps extends GObject, State extends GObject, Context extends any>\r\n    (instance: React.Component, nextProps: Readonly<AllProps>, nextState: Readonly<State>, nextContext: Context) {\r\n        return (\r\n            !U.shallowEqual(instance.props, nextProps) ||\r\n            !U.shallowEqual(instance.state, nextState)\r\n        );\r\n    }\r\n\r\n    static mapViewStuff(state: DState, ret: GraphElementReduxStateProps, ownProps: GraphElementOwnProps) {\r\n        let dnode: DGraphElement | undefined = ownProps?.nodeid && state.idlookup[ownProps.nodeid] as any;\r\n        if (ownProps.view) {\r\n            ret.views = [];\r\n            ret.view = LPointerTargetable.wrap(ownProps.view) as LViewElement;\r\n        }\r\n        else {\r\n            const viewScores = Selectors.getAppliedViews(ret.data, dnode, ret.graph, ownProps.view || null, ownProps.parentViewId || null);\r\n            ret.views = viewScores.map(e => MyProxyHandler.wrap(e.element));\r\n            ret.view = ret.views[0];\r\n            (ret as any).viewScores = viewScores; // debug only\r\n        }\r\n\r\n        /*        if (ownProps.view) {\r\n                    ret.view = DPointerTargetable.wrap(state.idlookup[ownProps.view]);\r\n                } else {\r\n                    ret.view = ret.views[0];\r\n                }*/\r\n    }\r\n\r\n    static mapLModelStuff(state: DState, ownProps: GraphElementOwnProps, ret: GraphElementReduxStateProps): void {\r\n        const meid: string = (typeof ownProps.data === 'string' ? ownProps.data as string : (ownProps.data as any as DModelElement)?.id) as string;\r\n        ret.dataid = meid;\r\n        // Log.exDev(!meid, \"model element id not found in GE.mapstatetoprops\", {meid, ret, ownProps, state});\r\n        ret.data = MyProxyHandler.wrap(state.idlookup[meid as any]);\r\n        // Log.ex(!ret.data, \"can't find model data:\", {meid, state, ownpropsdata:ownProps.data, ownProps});\r\n\r\n    }\r\n\r\n    static mapLGraphElementStuff(state: DState,\r\n                                 ownProps: GraphElementOwnProps,\r\n                                 ret: GraphElementReduxStateProps,\r\n                                 dGraphElementDataClass: typeof DGraphElement = DGraphElement,\r\n                                 isDGraph?: DGraph): void {\r\n        const idlookup = state.idlookup;\r\n        let nodeid: string = ownProps.nodeid as string;\r\n        let graphid: string = isDGraph ? isDGraph.id : ownProps.graphid as string;\r\n        let parentnodeid: string = ownProps.parentnodeid as string;\r\n        let dataid: Pointer<DModelElement, 0, 1, LModelElement> = ownProps.data || null;\r\n        // Log.exDev(!nodeid || !graphid, 'node id injection failed', {ownProps, data: ret.data, name:(ret.data as any)?.name || (ret.data as any)?.className}); /*\r\n        /*if (!nodeid) {\r\n            nodeid = 'nodeof_' + stateProps.data.id + (stateProps.view.bindVertexSizeToView ? '^' + stateProps.view.id : '') + '^1';\r\n            stateProps.nodeid = U.increaseEndingNumber(nodeid, false, false, id => !idlookup[id]);\r\n            todo: quando il componente si aggiorna questo viene perso, come posso rendere permanente un settaggio di reduxstate in mapstatetoprops? o devo metterlo nello stato normale?\r\n        }*/\r\n\r\n        ret.graph = idlookup[graphid] as DGraphElement as any; // se non c'è un grafo lo creo\r\n        if (!ret.graph) {\r\n            // Log.exDev(!dataid, 'attempted to make a Graph element without model', {dataid, ownProps, ret, thiss:this});\r\n            if (dataid) CreateElementAction.new(DGraph.new(0, dataid, parentnodeid, graphid, graphid)); }\r\n        else {\r\n            ret.graph = MyProxyHandler.wrap(ret.graph);\r\n            Log.exDev(ret.graph.__raw.className !== \"DGraph\", 'graph class is wrong', {graph: ret.graph, ownProps});\r\n        }\r\n\r\n\r\n        let dnode: DGraphElement = idlookup[nodeid] as DGraphElement;\r\n\r\n\r\n        // console.log('dragx GE mapstate addGEStuff', {dGraphElementDataClass, created: new dGraphElementDataClass(false, nodeid, graphid)});\r\n        if (!dnode && !DPointerTargetable.pendingCreation[nodeid]) {\r\n            console.log(\"making node:\", {dGraphElementDataClass, nodeid, parentnodeid, graphid, dataid, ownProps, ret,\r\n                pendings: {...DPointerTargetable.pendingCreation}, pending:DPointerTargetable.pendingCreation[nodeid]});\r\n            // so this is called once, but createaction is triggered twice only for edgepoints? it works if i create it through console.\r\n            let dge;\r\n            /*\r\n            if (dGraphElementDataClass === DEdgePoint) { // made it same as dvertex\r\n                let initialSize = ownProps.initialSize;\r\n                dge = DEdgePoint.new(ownProps.htmlindex as number, dataid, parentnodeid, graphid, nodeid, initialSize);\r\n                ret.node =  MyProxyHandler.wrap(dge);\r\n            } else*/\r\n            if (dGraphElementDataClass === DEdge) {\r\n                // set start and end from ownprops;\r\n                let edgeProps: EdgeStateProps = ret as EdgeStateProps;\r\n                let edgeOwnProps: EdgeOwnProps = ownProps as EdgeOwnProps;\r\n                let start = edgeProps.start.id; //typeof edgeProps.start === \"string\" ? edgeProps.start : (edgeProps.start as any).id; // at runtime i found proxy wrapped instead of id, no idea why\r\n                let end = edgeProps.end.id; // typeof edgeProps.end === \"string\" ? edgeProps.end : (edgeProps.end as any).id;\r\n                let longestLabel = edgeOwnProps.label;\r\n                let labels = edgeOwnProps.labels || [];\r\n                dge = (DEdge as any).new(ownProps.htmlindex, dataid, parentnodeid, graphid, nodeid, start, end, longestLabel, labels);\r\n                ret.node = (ret as any).edge = MyProxyHandler.wrap(dge);\r\n            }\r\n            else {\r\n                let initialSize = ownProps.initialSize;\r\n                dge = dGraphElementDataClass.new(ownProps.htmlindex as number, dataid, parentnodeid, graphid, nodeid, initialSize);\r\n                ret.node =  MyProxyHandler.wrap(dge);\r\n            }\r\n            // let act = CreateElementAction.new(dge, false);\r\n            // console.log(\"map ge2\", {nodeid: nodeid+'', dge: {...dge}, dgeid: dge.id});\r\n        }\r\n        else { ret.node = MyProxyHandler.wrap(dnode); }\r\n    }\r\n\r\n    ////// mapper func\r\n    static mapStateToProps(state: DState, ownProps: GraphElementOwnProps, dGraphDataClass: (typeof DGraphElement | typeof DEdge) = DGraphElement, startingobj?: GObject): GraphElementReduxStateProps {\r\n        // console.log('dragx GE mapstate', {dGraphDataClass});\r\n        let ret: GraphElementReduxStateProps = (startingobj || {}) as GraphElementReduxStateProps; // NB: cannot use a constructor, must be pojo\r\n        GraphElementComponent.mapLModelStuff(state, ownProps, ret);\r\n        // console.log(\"map ge\", {ownProps, ret, state});\r\n        GraphElementComponent.mapLGraphElementStuff(state, ownProps, ret, dGraphDataClass);\r\n        GraphElementComponent.mapViewStuff(state, ret, ownProps);\r\n        // ret.view = LViewElement.wrap(state.idlookup[vid]);\r\n        // view non deve essere più injected ma calcolata, però devo fare inject della view dell'elemento parent. learn ocl to make view target\r\n        Log.exDev(!ret.view, 'failed to inject view:', {state, ownProps, reduxProps: ret});\r\n        // console.log(!ret.view, 'failed to inject view:', {state, ownProps, reduxProps: ret});\r\n        if (ret.view.usageDeclarations) U.objectMergeInPlace(ret, U.evalInContextAndScope(ret.view.usageDeclarations));\r\n        // console.log('GE mapstatetoprops:', {state, ownProps, reduxProps: ret});\r\n        // ret.model = state.models.length ? LModelElement.wrap(state.models[0]) as LModel : undefined;\r\n        setTemplateString(ret, ownProps); // todo: this is heavy, should be moved somewhere where it's executed once unless view changes (pre-render with if?)\r\n        // @ts-ignore\r\n        ret.forceupdate = state.forceupdate;\r\n        // @ts-ignore\r\n        ret.key = ret.key || ownProps.key;\r\n        return ret;\r\n    }\r\n\r\n    static mapDispatchToProps(dispatch: Dispatch<any>): GraphElementDispatchProps {\r\n        const ret: GraphElementDispatchProps = {} as any;\r\n        return ret;\r\n    }\r\n\r\n\r\n    _isMounted: boolean;\r\n    hasSetVertexProperties: boolean = false;\r\n    html: React.RefObject<HTMLElement | undefined>;\r\n    lastViewChanges: {t: number, vid: Pointer<DViewElement>, v: LViewElement, key?: string}[];\r\n    // todo: can be improved by import memoize from \"memoize-one\"; it is high-order function that memorize the result if params are the same without re-executing it (must not have side effects)\r\n    //  i could use memoization to parse the jsx and to execute the user-defined pre-render function\r\n\r\n    select(forUser:Pointer<DUser, 0, 1> = null) {\r\n        const id = this.props.data?.id;\r\n        if (!forUser) forUser = DUser.current;\r\n        // this.props.node.isSelected[forUser] = true;\r\n\r\n        BEGIN();\r\n        const selected = Selectors.getSelected();\r\n        if (id) {\r\n            selected[forUser] = id;\r\n            SetRootFieldAction.new('selected', selected);\r\n        }\r\n        SetRootFieldAction.new('_lastSelected', {\r\n            node: this.props.nodeid,\r\n            view: this.props.view.id,\r\n            modelElement: this.props.data?.id\r\n        });\r\n        END();\r\n    }\r\n\r\n    constructor(props: AllProps, context: any) {\r\n        super(props, context);\r\n        this.lastViewChanges = [];\r\n        this._isMounted = false;\r\n        this.id = GraphElementComponent.maxid++;\r\n        GraphElementComponent.all[this.id] = this;\r\n        GraphElementComponent.map[props.nodeid as Pointer<DGraphElement>] = this;\r\n        this.html = React.createRef();\r\n        // let functionsToBind = [this.onClick, this.onLeave, this.onContextMenu, this.onEnter, this.select];\r\n        this.onClick = this.onClick.bind(this);\r\n        this.onLeave = this.onLeave.bind(this);\r\n        this.onContextMenu = this.onContextMenu.bind(this);\r\n        this.onEnter = this.onEnter.bind(this);\r\n        this.select = this.select.bind(this);\r\n        // for (let f of functionsToBind) (this as any)[f.name] = f.bind(this);\r\n        // @ts-ignore\r\n        this.state = {classes:[] as string[]};\r\n\r\n/*\r\n        console.log('GE constructor props:', this.props);\r\n        this.setTemplateString(this.props.view, true);\r\n        /*if (false) this.setTemplateString('{colors:[\"rEd\", \"gReen\", \"blye\"], key2:[0,2,5]}',\r\n            '() => { colors = colors.map(c=>c.toLowerCase())}',\r\n            '<div><b>GraphElement colors:</b>{colors.map( (c, i) => <li key={c} style={{color: c}}>{c}</li>)}</div>', true);*/\r\n        // this.onMountBindID();\r\n    }\r\n/*\r\n    onMountBindID() {\r\n        /*if (!this.props.view.bindVertexSizeToView) {\r\n            // get position from view itself\r\n            nodeid = 'nodeof_' + this.props.data.id;\r\n            if (!store.getState().idlookup[nodeid]){\r\n                new CreateElementAction(this.createDataNode(nodeid));\r\n            } // view-indipendent fallback, i do not add view.id to node.id\r\n        } else {* /\r\n        if (this.getId()) return;\r\n        let dnode: DGraphElement = this.createDataNode(this.generateId());\r\n        new CreateElementAction(dnode);\r\n        // let nodeid: Pointer<DGraphElement, 1, 1, LGraphElement> = dnode.id;\r\n        // this.setState({nodeid} );\r\n    }\r\n\r\n    getId(): string | undefined {\r\n        return this.props.nodeid;\r\n    }\r\n\r\n    generateId(): Pointer<DGraphElement, 1, 1, LGraphElement> {\r\n        // if (this.state.nodeid) return this.state.nodeid;\r\n        let ret: string = 'nodeof_' + this.props.data.id + (this.props.view.bindVertexSizeToView ? '^' + this.props.view.id : '') + '^1';\r\n        const idlookup = store.getState().idlookup;\r\n        ret = U.increaseEndingNumber(ret, false, false, id => !idlookup[id]);\r\n        return ret;\r\n    }\r\n\r\n    // to override\r\n\r\n    createDataNode(id?: string): DGraphElement {\r\n        return new DGraphElement(id || this.generateId(), this);\r\n    }\r\n */\r\n\r\n    // constants: evalutate solo durante il primo render, può essere una funzione con effetti collaterali sul componente,\r\n    // in tal caso la si esegue e si prende il valore di ritorno.\r\n    // preRenderFunc: funzione evalutata ed eseguita sempre prima del render, ha senso solo per generare effetti collaterali sulle \"costanti\".\r\n    // jsxString: funzione evalutata una sola volta durante il primo render ed eseguita ad ogni update dei dati.\r\n\r\n\r\n\r\n    componentDidMount(): void {\r\n        // after first render\r\n        this._isMounted = true;\r\n    }\r\n\r\n    componentWillUnmount(): void {\r\n        // todo: devo fare in modo che il nodo venga cancellato solo se sto modificando la vista in modo che questo vertice non esista più.\r\n        //  e non venga cancellato se il componente viene smontato perchè ho solo cambiato vista\r\n        //  LOW PRIORITY perchè funziona anche senza, pur sprecando memoria che potrebbe essere liberata.\r\n        // if (view_is_still_active_but_got_modified_and_vertex_is_deleted) new DeleteElementAction(this.getId());\r\n    }\r\n    /*\r\n        componentDidUpdate(oldProps: Readonly<AllProps {/*\r\n            const newProps = this.props\r\n            if (oldProps.view !== newProps.view) { this.setTemplateString(newProps.view); }\r\n    }*/\r\n\r\n    private getTemplate(): ReactNode {\r\n        /*if (!this.state.template) {\r\n            this.setTemplateString('{c1: 118}', '()=>{this.setState({c1: this.state.c1+1})}',\r\n                '<div><input value=\"{name}\" onInput=\"{setName}\"></input><p>c1:{this.state.c1}</p><Attribute prop1={daa} prop2={1 + 1.5} stringPropdaa=\\\"daa\\\" /><ul>{colors.map( color => <li>color: {color}</li>)}</ul></div>');\r\n        }*/\r\n        // console.log('getTemplate:', {props: this.props, template: this.props.template, ctx: this.props.evalContext});\r\n\r\n        // Log.exDev(debug && maxRenderCounter-- < 0, \"loop involving render\");\r\n        let context: GObject = {component:this, __proto__:this.props.evalContext};\r\n        context._context = context;\r\n        console.log(\"proto gettemplate\", {context, proto:context.__proto__});\r\n\r\n        let displayError = (e: Error, where: string) => {\r\n            const view: LViewElement = this.props.view; //data._transient.currentView;\r\n            let errormsg = (where === \"preRenderFunc\" ? \"Pre-Render \" : \"\") +(e.message||\"\\n\").split(\"\\n\")[0];\r\n            if (e.message.indexOf(\"Unexpected token .\") >= 0 || view.jsxString.indexOf('?.') >= 0 || view.jsxString.indexOf('??') >= 0) {\r\n                errormsg += '\\n\\nReminder: nullish operators \".?\" and \"??\" are not supported.'; }\r\n            else if (view.jsxString.indexOf('?.') >= 0) { errormsg += '\\n\\nReminder: ?. operator and empty tags <></> are not supported.'; }\r\n            else if (e.message.indexOf(\"Unexpected token '<'\")) { errormsg += '\\n\\nDid you forgot to close a html </tag>?'; }\r\n            try {\r\n                let ee = e.stack || \"\";\r\n                let stackerrorlast = ee.split(\"\\n\")[1];\r\n\r\n                let icol = stackerrorlast.lastIndexOf(\":\");\r\n                let jsxString = view.jsxString;\r\n                // let col = stackerrorlast.substring(icol+1);\r\n                let irow = stackerrorlast.lastIndexOf(\":\", icol-1);\r\n                let stackerrorlinenum: GObject = {\r\n                    row: Number.parseInt(stackerrorlast.substring(irow+1, icol)),\r\n                    col: Number.parseInt(stackerrorlast.substring(icol+1)) };\r\n                let linesPre = 1;\r\n                let linesPost = 1;\r\n                let jsxlines = jsxString.split(\"\\n\");\r\n                let culpritlinesPre: string[] = jsxlines.slice(stackerrorlinenum.row-linesPre-1, stackerrorlinenum.row - 1);\r\n                let culpritline: string = jsxlines[stackerrorlinenum.row - 1]; // stack start counting lines from 1\r\n                let culpritlinesPost: string[] = jsxlines.slice(stackerrorlinenum.row, stackerrorlinenum.row + linesPost);\r\n                console.error(\"errr\", {e, jsxlines, culpritlinesPre, culpritline, culpritlinesPost, stackerrorlinenum, icol, irow, stackerrorlast});\r\n\r\n                let caretCursor = \"▓\" // ⵊ ꕯ 𝙸 Ꮖ\r\n                if (culpritline && stackerrorlinenum.col < culpritline.length && stackerrorlast.indexOf(\"main.chunk.js\") === -1) {\r\n                    let rowPre = culpritline.substring(0, stackerrorlinenum.col);\r\n                    let rowPost = culpritline.substring(stackerrorlinenum.col);\r\n                    let jsxcode =\r\n                        <div style={{fontFamily: \"monospaced sans-serif\", color:\"#444\"}}>\r\n                            { culpritlinesPre.map(l => <div>{l}</div>) }\r\n                            <div>{rowPre} <b style={{color:\"red\"}}> {caretCursor} </b> {rowPost}</div>\r\n                            { culpritlinesPost.map(l => <div>{l}</div>) }\r\n                        </div>;\r\n                    console.error(\"errr\", {e, ee, jsxlines, jsxcode, rowPre, rowPost, culpritlinesPre, culpritline, culpritlinesPost, stackerrorlinenum, icol, irow, stackerrorlast});\r\n                    errormsg += \" @line \" + stackerrorlinenum.row + \":\" + stackerrorlinenum.col;\r\n                    return DV.errorView(<div>{errormsg}{jsxcode}</div>, {where:\"in \"+where+\"()\", e, template: this.props.template, view: this.props.view});\r\n                } else {\r\n                    // it means it is likely accessing a minified.js src code, sending generic error without source mapping\r\n                }\r\n            } catch(e2) {\r\n                Log.eDevv(\"internal error in error view\", {e, e2, where} );\r\n            }\r\n            return DV.errorView(<div>{errormsg}</div>, {where:\"in \"+where+\"()\", e, template: this.props.template, view: this.props.view});\r\n        }\r\n\r\n        try {\r\n            console.log(\"prerenderfunc pre execution\", \"(\"+this.props.preRenderFunc+\")()\", context);\r\n            if (this.props.preRenderFunc) {\r\n                let obj = U.evalInContextAndScope<GObject>(\"(\"+this.props.preRenderFunc+\")()\", [], context);\r\n                console.log(\"prerenderfunc executed\", obj);\r\n                for (let key in obj) { context[key] = obj[key]; }\r\n            }\r\n        }\r\n        catch(e: any) { return displayError(e, \"preRenderFunc\");  }\r\n        let ret;\r\n        try {\r\n            console.log(\"executing template:\", {final:'(()=>{ return ' + this.props.template + '})()', context});\r\n            ret = U.evalInContextAndScope<() => ReactNode>('(()=>{ return ' + this.props.template + '})()', context);\r\n            // ret = this.props.template();\r\n            // ret = U.execInContextAndScope<() => ReactNode>(this.props.template, [], {});\r\n        }\r\n        catch(e: any) { return displayError(e, \"getTemplate\"); }\r\n        return ret;\r\n    }\r\n\r\n    onContextMenu(e: React.MouseEvent<HTMLDivElement>) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const selected = Selectors.getSelected();\r\n        const id = this.props.dataid;\r\n        const alreadySelected = Object.keys(selected).filter(function(key) {\r\n            return selected[key] === id;\r\n        });\r\n        if(alreadySelected.length === 0) this.select();\r\n        SetRootFieldAction.new(\"contextMenu\", {\r\n            display: true,\r\n            x: e.clientX,\r\n            y: e.clientY\r\n        });\r\n    }\r\n\r\n    onEnter(e: React.MouseEvent<HTMLDivElement>) { // instead of doing it here, might set this class on render, and trigger it visually operative with :hover selector css\r\n        const isEdgePending = this.props.isEdgePending?.source;\r\n        if (!isEdgePending || this.props.data?.className !== \"DClass\") return;\r\n        const extendError: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []}\r\n        const canBeExtend = isEdgePending.canExtend(this.props.data as any as LClass, extendError);\r\n\r\n        if (canBeExtend) this.setState({classes:[...this.state.classes, \"class-can-be-extended\"]});\r\n        else this.setState({classes:[...this.state.classes, \"class-cannot-be-extended\"]});\r\n    }\r\n    onLeave(e: React.MouseEvent<HTMLDivElement>) {\r\n        if (this.props.data?.className !== \"DClass\") return;\r\n        this.setState({classes: this.state.classes.filter((classname) => {\r\n            return classname !== \"class-can-be-extended\" && classname !== \"class-cannot-be-extended\"\r\n        })});\r\n    }\r\n    onClick(e: React.MouseEvent): void {\r\n        e.stopPropagation();\r\n        const selected = Selectors.getSelected();\r\n        const id = this.props.dataid;\r\n        const alreadySelected = Object.keys(selected).filter(function(key) {\r\n            return selected[key] === id;\r\n        });\r\n        SetRootFieldAction.new(\"contextMenu\", {display: false, x: 0, y: 0});\r\n        if(alreadySelected.length > 0) return;\r\n        const isEdgePending = (this.props.isEdgePending?.source);\r\n        if (!isEdgePending) { this.select(); e.stopPropagation(); return; }\r\n        if (!this.props.data) return;\r\n        if (this.props.data.className !== \"DClass\") return;\r\n        // const user = this.props.isEdgePending.user;\r\n        const source = isEdgePending;\r\n        const extendError: {reason: string, allTargetSuperClasses: LClass[]} = {reason: '', allTargetSuperClasses: []}\r\n        const canBeExtend = this.props.data && isEdgePending.canExtend(this.props.data as LClass, extendError);\r\n        if (canBeExtend && this.props.data) {\r\n            const lClass: LClass = LPointerTargetable.from(this.props.data.id);\r\n            // SetFieldAction.new(lClass.id, \"extendedBy\", source.id, \"\", true); // todo: this should throw a error for wrong type.\r\n            // todo: use source.addExtends(lClass); or something (source is LClass)\r\n            SetFieldAction.new(lClass.id, \"extendedBy\", source.id, \"+=\", true);\r\n            SetFieldAction.new(source.id, \"extends\", lClass.id, \"+=\", true);\r\n        }\r\n        SetRootFieldAction.new('isEdgePending', { user: '',  source: '' });\r\n\r\n    }\r\n\r\n    public render(nodeType?:string, styleoverride:React.CSSProperties={}, classes: string[]=[]): ReactNode {\r\n        if (!this.props.node) return \"loading\";\r\n        if (this.props.node.__raw.view !== this.props.view.id) {\r\n\r\n            let thischange = {t: Date.now(), vid: this.props.node.__raw.view, newvid:this.props.view.id, v: this.props.node.view, newv: this.props.view, key:this.props.key};\r\n            this.lastViewChanges.push(thischange);\r\n            // nan -> false <200 = true\r\n            if (this.lastViewChanges[this.lastViewChanges.length-20]?.t - thischange.t < 200) { // important! NaN<1  and NaN>1 are both false\r\n                // if 3 views changed in <= 0.2 sec\r\n                Log.exDevv(\"loop in updating View assigned to node. The cause might be missing or invalid keys on GraphElement JSX nodes.\", {change_log:this.lastViewChanges, component: this});\r\n            }\r\n\r\n            /*console.log(\"UPDATEVIEW \", {lnode:this.props.node, dnode:this.props.node.__raw, dstore: windoww.s().idlookup[this.props.node.__raw.id], view:this.props.view,\r\n                 data:this.props.data, vid:this.props.view.id, nview:this.props.node.__raw.view});*/\r\n            this.props.node.view = this.props.view;\r\n            return \"Updating view...\";\r\n        }\r\n\r\n        /// set classes\r\n        classes.push(this.props.data?.className || 'DVoid');\r\n        U.arrayMergeInPlace(classes, this.state.classes);\r\n        if (Array.isArray(this.props.className)) { U.arrayMergeInPlace(classes, this.props.className); }\r\n        else if (this.props.className) { classes.push(this.props.className); }\r\n        if (Array.isArray(this.props.class)) { U.arrayMergeInPlace(classes, this.props.class); }\r\n        else if (this.props.class) { classes.push(this.props.class); }\r\n        /// end set classes\r\n\r\n        const rnode: ReactNode = this.getTemplate();\r\n        console.log(\"get template \" + this.props.node?.className , {t: this.props.template, rnode});\r\n        let rawRElement: ReactElement | null = UX.ReactNodeAsElement(rnode);\r\n        const me: LModelElement | undefined = this.props.data; // this.props.model;\r\n\r\n        // \\console.log('GE render', {thiss: this, data:me, rnode, rawRElement, props:this.props, name: (me as any)?.name});\r\n\r\n        const addprops: boolean = true;\r\n        let fiximport = !!this.props.node;\r\n        if (addprops && rawRElement && fiximport) {\r\n            if (windoww.debugcount && debugcount++>windoww.debugcount) throw new Error(\"debug triggered stop\");\r\n            // console.log(\"pre-injecting\", {thiss:this, data:this.props.data, props:this.props});\r\n            let fixdoubleroot = true;\r\n            const onDragTestInject = () => {}; // might inject event handlers like this with cloneelement\r\n            // add view props to GraphElement children (any level down)\r\n            const subElements: Dictionary<DocString<'nodeid'>, boolean> = {}; // this.props.getGVidMap();\r\n            try {\r\n                let viewStyle: GObject = {};\r\n                /*\r\n                    if (view.adaptWidth) viewStyle.width = view.adaptWidth; // '-webkit-fill-available';\r\n                    else viewStyle.height = (rootProps.view.height) && rootProps.view.height + 'px';\r\n                    if (view.adaptHeight) viewStyle.height = view.adaptHeight; //'fit-content'; // '-webkit-fill-available'; if needs to actually fill all it's not a vertex but a field.\r\n                    else viewStyle.width = (rootProps.view.width) && rootProps.view.width + 'px';\r\n                    viewStyle = {};\r\n                */\r\n                // viewStyle.pointerEvents = \"all\";\r\n                viewStyle.order = viewStyle.zIndex = this.props.node?.zIndex;\r\n                viewStyle.display = this.props.view?.display;\r\n                rawRElement = React.cloneElement(rawRElement, // i'm cloning a raw html (like div) being root of the rendered view\r\n                    {\r\n                        key: this.props.key, // this key is not safe. because the component has already been made,\r\n                        // this would be the key of the first sub-component, which is always 1 so doesn't need a key (and is not even a component but a html node in 99% of cases)\r\n                        // could remove it safely but i'm keeping it for debug so i can read keys as html attributes.\r\n                        ref: this.html,\r\n                        // damiano: ref html viene settato correttamente a tutti tranne ad attribute, ref, operation (è perchè iniziano con <Select/> as root?)\r\n                        id: this.props.nodeid,\r\n                        \"data-nodeid\": this.props.nodeid,\r\n                        \"data-dataid\": me?.id,\r\n                        \"data-viewid\": this.props.view.id,\r\n                        \"data-modelname\": me?.className || \"model-less\",\r\n                        \"data-userselecting\": JSON.stringify(this.props.node?.__raw.isSelected || {}),\r\n                        \"data-nodetype\": nodeType,\r\n                        // \"data-order\": this.props.node?.zIndex,\r\n                        style: {...viewStyle, order:this.props.node.z, ...styleoverride},\r\n                        className: classes.join(' '),\r\n                        onClick: this.onClick,\r\n                        onContextMenu:this.onContextMenu,\r\n                        onMouseEnter:this.onEnter,\r\n                        onMouseLeave:this.onLeave,\r\n                        children: UX.recursiveMap(rawRElement/*.props.children*/,\r\n                            (rn: ReactNode, index: number, depthIndexes: number[]) => UX.injectProp(this, rn, subElements, this.props.parentnodeid as string, index, depthIndexes))});\r\n                fixdoubleroot = false; // need to set the props to new root in that case.\r\n                if (fixdoubleroot) rawRElement = rawRElement.props.children;\r\n                // console.log(\"probem\", {rawRElement, children:(rawRElement as any)?.children, pchildren:(rawRElement as any)?.props?.children});\r\n            } catch (e) {\r\n\r\n                rawRElement = U.evalInContextAndScope<ReactElement>('()=>{ return ' +\r\n                    DV.errorView(\"error while injecting props to subnodes\",\r\n                        {e, rawRElement, key:this.props.key, newid: this.props.nodeid}) + '}',\r\n                    {});\r\n\r\n                // rawRElement = DV.errorView(\"error while injecting props to subnodes\", {e, rawRElement, key:this.props.key, newid: this.props.nodeid});\r\n            }\r\n            /*console.log('tempdebug', {deepStrictEqual, okeys:Object.keys});\r\n            let isEqual = true;\r\n            try {deepStrictEqual(subElements, this.props.node.subElements)} catch(e) { isEqual = false; }\r\n            if (isEqual) {\r\n                this.props.node.subElements = Object.keys(subElements);\r\n            }*/\r\n        }\r\n        // const injectprops = {a:3, b:4} as DetailedHTMLProps<HTMLAttributes<HTMLDivElement>, HTMLDivElement>;\r\n        // rnode = React.cloneElement(rnode as ReactElement, injectprops);\r\n\r\n        // console.log(\"nodeee\", {thiss:this, props:this.props, node: this.props.node});\r\n        if (false && (this.props.node?.__raw as DGraphElement).father) {\r\n            let $containedIn = $('#' + this.props.node.father);\r\n            let $containerDropArea = $containedIn.find(\".VertexContainer\");\r\n            const droparea = $containerDropArea[0] || $containedIn[0];\r\n            Log.exDev(!droparea, 'invalid vertex container target', {$containedIn, $containerDropArea});\r\n            if (droparea) return createPortal(\r\n                rawRElement || rnode,\r\n                droparea\r\n            );\r\n        }\r\n        return rawRElement || rnode;\r\n    }\r\n\r\n}\r\n\r\n// private\r\n// type AllPropss = GraphElementOwnProps & GraphElementDispatchProps & GraphElementReduxStateProps;\r\ntype AllPropss = Overlap<Overlap<GraphElementOwnProps, GraphElementDispatchProps>, GraphElementReduxStateProps>;\r\n\r\nconst GraphElementConnected = connect<GraphElementReduxStateProps, GraphElementDispatchProps, GraphElementOwnProps, DState>(\r\n    GraphElementComponent.mapStateToProps,\r\n    GraphElementComponent.mapDispatchToProps\r\n)(GraphElementComponent as any);\r\n\r\nexport const GraphElement = (props: GraphElementOwnProps, children: (string | React.Component)[] = []): ReactElement => {\r\n    return <GraphElementConnected {...{...props, children}} />; }\r\nconsole.info('graphElement loaded');\r\n\r\n\r\nGraphElementComponent.cname = \"GraphElementComponent\";\r\nGraphElementConnected.cname = \"GraphElementConnected\";\r\nGraphElement.cname = \"GraphElement\";\r\n"],"sourceRoot":""}